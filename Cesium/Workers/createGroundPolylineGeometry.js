/**
 * Cesium - https://github.com/AnalyticalGraphicsInc/cesium
 *
 * Copyright 2011-2017 Cesium Contributors
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * Columbus View (Pat. Pend.)
 *
 * Portions licensed separately.
 * See https://github.com/AnalyticalGraphicsInc/cesium/blob/master/LICENSE.md for full licensing details.
 */
/**
 * @license
 *
 * Grauw URI utilities
 *
 * See: http://hg.grauw.nl/grauw-lib/file/tip/src/uri.js
 *
 * @author Laurens Holst (http://www.grauw.nl/)
 *
 *   Copyright 2012 Laurens Holst
 *
 *   Licensed under the Apache License, Version 2.0 (the "License");
 *   you may not use this file except in compliance with the License.
 *   You may obtain a copy of the License at
 *
 *       http://www.apache.org/licenses/LICENSE-2.0
 *
 *   Unless required by applicable law or agreed to in writing, software
 *   distributed under the License is distributed on an "AS IS" BASIS,
 *   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 *   See the License for the specific language governing permissions and
 *   limitations under the License.
 *
 */

/**
  @license
  when.js - https://github.com/cujojs/when

  MIT License (c) copyright B Cavalier & J Hann

 * A lightweight CommonJS Promises/A and when() implementation
 * when is part of the cujo.js family of libraries (http://cujojs.com/)
 *
 * Licensed under the MIT License at:
 * http://www.opensource.org/licenses/mit-license.php
 *
 * @version 1.7.1
 */

/**
@license
mersenne-twister.js - https://gist.github.com/banksean/300494

   Copyright (C) 1997 - 2002, Makoto Matsumoto and Takuji Nishimura,
   All rights reserved.

   Redistribution and use in source and binary forms, with or without
   modification, are permitted provided that the following conditions
   are met:

     1. Redistributions of source code must retain the above copyright
        notice, this list of conditions and the following disclaimer.

     2. Redistributions in binary form must reproduce the above copyright
        notice, this list of conditions and the following disclaimer in the
        documentation and/or other materials provided with the distribution.

     3. The names of its contributors may not be used to endorse or promote
        products derived from this software without specific prior written
        permission.

   THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
   "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
   LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
   A PARTICULAR PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE COPYRIGHT OWNER OR
   CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
   EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
   PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
   PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
   LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
   NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
   SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/

/**
@license
sprintf.js from the php.js project - https://github.com/kvz/phpjs
Directly from https://github.com/kvz/phpjs/blob/master/functions/strings/sprintf.js

php.js is copyright 2012 Kevin van Zonneveld.

Portions copyright Brett Zamir (http://brett-zamir.me), Kevin van Zonneveld
(http://kevin.vanzonneveld.net), Onno Marsman, Theriault, Michael White
(http://getsprink.com), Waldo Malqui Silva, Paulo Freitas, Jack, Jonas
Raoni Soares Silva (http://www.jsfromhell.com), Philip Peterson, Legaev
Andrey, Ates Goral (http://magnetiq.com), Alex, Ratheous, Martijn Wieringa,
Rafa? Kukawski (http://blog.kukawski.pl), lmeyrick
(https://sourceforge.net/projects/bcmath-js/), Nate, Philippe Baumann,
Enrique Gonzalez, Webtoolkit.info (http://www.webtoolkit.info/), Carlos R.
L. Rodrigues (http://www.jsfromhell.com), Ash Searle
(http://hexmen.com/blog/), Jani Hartikainen, travc, Ole Vrijenhoek,
Erkekjetter, Michael Grier, Rafa? Kukawski (http://kukawski.pl), Johnny
Mast (http://www.phpvrouwen.nl), T.Wild, d3x,
http://stackoverflow.com/questions/57803/how-to-convert-decimal-to-hex-in-javascript,
Rafa? Kukawski (http://blog.kukawski.pl/), stag019, pilus, WebDevHobo
(http://webdevhobo.blogspot.com/), marrtins, GeekFG
(http://geekfg.blogspot.com), Andrea Giammarchi
(http://webreflection.blogspot.com), Arpad Ray (mailto:arpad@php.net),
gorthaur, Paul Smith, Tim de Koning (http://www.kingsquare.nl), Joris, Oleg
Eremeev, Steve Hilder, majak, gettimeofday, KELAN, Josh Fraser
(http://onlineaspect.com/2007/06/08/auto-detect-a-time-zone-with-javascript/),
Marc Palau, Martin
(http://www.erlenwiese.de/), Breaking Par Consulting Inc
(http://www.breakingpar.com/bkp/home.nsf/0/87256B280015193F87256CFB006C45F7),
Chris, Mirek Slugen, saulius, Alfonso Jimenez
(http://www.alfonsojimenez.com), Diplom@t (http://difane.com/), felix,
Mailfaker (http://www.weedem.fr/), Tyler Akins (http://rumkin.com), Caio
Ariede (http://caioariede.com), Robin, Kankrelune
(http://www.webfaktory.info/), Karol Kowalski, Imgen Tata
(http://www.myipdf.com/), mdsjack (http://www.mdsjack.bo.it), Dreamer,
Felix Geisendoerfer (http://www.debuggable.com/felix), Lars Fischer, AJ,
David, Aman Gupta, Michael White, Public Domain
(http://www.json.org/json2.js), Steven Levithan
(http://blog.stevenlevithan.com), Sakimori, Pellentesque Malesuada,
Thunder.m, Dj (http://phpjs.org/functions/htmlentities:425#comment_134018),
Steve Clay, David James, Francois, class_exists, nobbler, T. Wild, Itsacon
(http://www.itsacon.net/), date, Ole Vrijenhoek (http://www.nervous.nl/),
Fox, Raphael (Ao RUDLER), Marco, noname, Mateusz "loonquawl" Zalega, Frank
Forte, Arno, ger, mktime, john (http://www.jd-tech.net), Nick Kolosov
(http://sammy.ru), marc andreu, Scott Cariss, Douglas Crockford
(http://javascript.crockford.com), madipta, Slawomir Kaniecki,
ReverseSyntax, Nathan, Alex Wilson, kenneth, Bayron Guevara, Adam Wallner
(http://web2.bitbaro.hu/), paulo kuong, jmweb, Lincoln Ramsay, djmix,
Pyerre, Jon Hohle, Thiago Mata (http://thiagomata.blog.com), lmeyrick
(https://sourceforge.net/projects/bcmath-js/this.), Linuxworld, duncan,
Gilbert, Sanjoy Roy, Shingo, sankai, Oskar Larsson H?gfeldt
(http://oskar-lh.name/), Denny Wardhana, 0m3r, Everlasto, Subhasis Deb,
josh, jd, Pier Paolo Ramon (http://www.mastersoup.com/), P, merabi, Soren
Hansen, Eugene Bulkin (http://doubleaw.com/), Der Simon
(http://innerdom.sourceforge.net/), echo is bad, Ozh, XoraX
(http://www.xorax.info), EdorFaus, JB, J A R, Marc Jansen, Francesco, LH,
Stoyan Kyosev (http://www.svest.org/), nord_ua, omid
(http://phpjs.org/functions/380:380#comment_137122), Brad Touesnard, MeEtc
(http://yass.meetcweb.com), Peter-Paul Koch
(http://www.quirksmode.org/js/beat.html), Olivier Louvignes
(http://mg-crea.com/), T0bsn, Tim Wiel, Bryan Elliott, Jalal Berrami,
Martin, JT, David Randall, Thomas Beaucourt (http://www.webapp.fr), taith,
vlado houba, Pierre-Luc Paour, Kristof Coomans (SCK-CEN Belgian Nucleair
Research Centre), Martin Pool, Kirk Strobeck, Rick Waldron, Brant Messenger
(http://www.brantmessenger.com/), Devan Penner-Woelk, Saulo Vallory, Wagner
B. Soares, Artur Tchernychev, Valentina De Rosa, Jason Wong
(http://carrot.org/), Christoph, Daniel Esteban, strftime, Mick@el, rezna,
Simon Willison (http://simonwillison.net), Anton Ongson, Gabriel Paderni,
Marco van Oort, penutbutterjelly, Philipp Lenssen, Bjorn Roesbeke
(http://www.bjornroesbeke.be/), Bug?, Eric Nagel, Tomasz Wesolowski,
Evertjan Garretsen, Bobby Drake, Blues (http://tech.bluesmoon.info/), Luke
Godfrey, Pul, uestla, Alan C, Ulrich, Rafal Kukawski, Yves Sucaet,
sowberry, Norman "zEh" Fuchs, hitwork, Zahlii, johnrembo, Nick Callen,
Steven Levithan (stevenlevithan.com), ejsanders, Scott Baker, Brian Tafoya
(http://www.premasolutions.com/), Philippe Jausions
(http://pear.php.net/user/jausions), Aidan Lister
(http://aidanlister.com/), Rob, e-mike, HKM, ChaosNo1, metjay, strcasecmp,
strcmp, Taras Bogach, jpfle, Alexander Ermolaev
(http://snippets.dzone.com/user/AlexanderErmolaev), DxGx, kilops, Orlando,
dptr1988, Le Torbi, James (http://www.james-bell.co.uk/), Pedro Tainha
(http://www.pedrotainha.com), James, Arnout Kazemier
(http://www.3rd-Eden.com), Chris McMacken, gabriel paderni, Yannoo,
FGFEmperor, baris ozdil, Tod Gentille, Greg Frazier, jakes, 3D-GRAF, Allan
Jensen (http://www.winternet.no), Howard Yeend, Benjamin Lupton, davook,
daniel airton wermann (http://wermann.com.br), Atli T¨®r, Maximusya, Ryan
W Tenney (http://ryan.10e.us), Alexander M Beedie, fearphage
(http://http/my.opera.com/fearphage/), Nathan Sepulveda, Victor, Matteo,
Billy, stensi, Cord, Manish, T.J. Leahy, Riddler
(http://www.frontierwebdev.com/), Rafa? Kukawski, FremyCompany, Matt
Bradley, Tim de Koning, Luis Salazar (http://www.freaky-media.com/), Diogo
Resende, Rival, Andrej Pavlovic, Garagoth, Le Torbi
(http://www.letorbi.de/), Dino, Josep Sanz (http://www.ws3.es/), rem,
Russell Walker (http://www.nbill.co.uk/), Jamie Beck
(http://www.terabit.ca/), setcookie, Michael, YUI Library:
http://developer.yahoo.com/yui/docs/YAHOO.util.DateLocale.html, Blues at
http://hacks.bluesmoon.info/strftime/strftime.js, Ben
(http://benblume.co.uk/), DtTvB
(http://dt.in.th/2008-09-16.string-length-in-bytes.html), Andreas, William,
meo, incidence, Cagri Ekin, Amirouche, Amir Habibi
(http://www.residence-mixte.com/), Luke Smith (http://lucassmith.name),
Kheang Hok Chin (http://www.distantia.ca/), Jay Klehr, Lorenzo Pisani,
Tony, Yen-Wei Liu, Greenseed, mk.keck, Leslie Hoare, dude, booeyOH, Ben
Bryan

Licensed under the MIT (MIT-LICENSE.txt) license.

Permission is hereby granted, free of charge, to any person obtaining a
copy of this software and associated documentation files (the
"Software"), to deal in the Software without restriction, including
without limitation the rights to use, copy, modify, merge, publish,
distribute, sublicense, and/or sell copies of the Software, and to
permit persons to whom the Software is furnished to do so, subject to
the following conditions:

The above copyright notice and this permission notice shall be included
in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.
IN NO EVENT SHALL KEVIN VAN ZONNEVELD BE LIABLE FOR ANY CLAIM, DAMAGES
OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE,
ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
OTHER DEALINGS IN THE SOFTWARE.
*/

!function(){define("Core/defined",[],function(){"use strict";function e(e){return void 0!==e&&null!==e}return e}),define("Core/DeveloperError",["./defined"],function(e){"use strict";function t(e){this.name="DeveloperError",this.message=e;var t;try{throw new Error}catch(e){t=e.stack}this.stack=t}return e(Object.create)&&(t.prototype=Object.create(Error.prototype),t.prototype.constructor=t),t.prototype.toString=function(){var t=this.name+": "+this.message;return e(this.stack)&&(t+="\n"+this.stack.toString()),t},t.throwInstantiationError=function(){throw new t("This function defines an interface and should not be called directly.")},t}),define("ThirdParty/Uri",[],function(){function e(t){if(t instanceof e)this.scheme=t.scheme,this.authority=t.authority,this.path=t.path,this.query=t.query,this.fragment=t.fragment;else if(t){var n=r.exec(t);this.scheme=n[1],this.authority=n[2],this.path=n[3],this.query=n[4],this.fragment=n[5]}}function t(e){var t=unescape(e);return a.test(t)?t:e.toUpperCase()}function n(e,t,n,r){return(t||"")+n.toLowerCase()+(r||"")}e.prototype.scheme=null,e.prototype.authority=null,e.prototype.path="",e.prototype.query=null,e.prototype.fragment=null;var r=new RegExp("^(?:([^:/?#]+):)?(?://([^/?#]*))?([^?#]*)(?:\\?([^#]*))?(?:#(.*))?$");e.prototype.getScheme=function(){return this.scheme},e.prototype.getAuthority=function(){return this.authority},e.prototype.getPath=function(){return this.path},e.prototype.getQuery=function(){return this.query},e.prototype.getFragment=function(){return this.fragment},e.prototype.isAbsolute=function(){return!!this.scheme&&!this.fragment},e.prototype.isSameDocumentAs=function(e){return e.scheme==this.scheme&&e.authority==this.authority&&e.path==this.path&&e.query==this.query},e.prototype.equals=function(e){return this.isSameDocumentAs(e)&&e.fragment==this.fragment},e.prototype.normalize=function(){this.removeDotSegments(),this.scheme&&(this.scheme=this.scheme.toLowerCase()),this.authority&&(this.authority=this.authority.replace(o,n).replace(i,t)),this.path&&(this.path=this.path.replace(i,t)),this.query&&(this.query=this.query.replace(i,t)),this.fragment&&(this.fragment=this.fragment.replace(i,t))};var i=/%[0-9a-z]{2}/gi,a=/[a-zA-Z0-9\-\._~]/,o=/(.*@)?([^@:]*)(:.*)?/;return e.prototype.resolve=function(t){var n=new e;return this.scheme?(n.scheme=this.scheme,n.authority=this.authority,n.path=this.path,n.query=this.query):(n.scheme=t.scheme,this.authority?(n.authority=this.authority,n.path=this.path,n.query=this.query):(n.authority=t.authority,""==this.path?(n.path=t.path,n.query=this.query||t.query):("/"==this.path.charAt(0)?(n.path=this.path,n.removeDotSegments()):(t.authority&&""==t.path?n.path="/"+this.path:n.path=t.path.substring(0,t.path.lastIndexOf("/")+1)+this.path,n.removeDotSegments()),n.query=this.query))),n.fragment=this.fragment,n},e.prototype.removeDotSegments=function(){var e,t=this.path.split("/"),n=[],r=""==t[0];r&&t.shift();for(""==t[0]&&t.shift();t.length;)e=t.shift(),".."==e?n.pop():"."!=e&&n.push(e);"."!=e&&".."!=e||n.push(""),r&&n.unshift(""),this.path=n.join("/")},e.prototype.toString=function(){var e="";return this.scheme&&(e+=this.scheme+":"),this.authority&&(e+="//"+this.authority),e+=this.path,this.query&&(e+="?"+this.query),this.fragment&&(e+="#"+this.fragment),e},e}),define("Core/freezeObject",["./defined"],function(e){"use strict";var t=Object.freeze;return e(t)||(t=function(e){return e}),t}),define("Core/defaultValue",["./freezeObject"],function(e){"use strict";function t(e,t){return void 0!==e&&null!==e?e:t}return t.EMPTY_OBJECT=e({}),t}),define("Core/getAbsoluteUri",["../ThirdParty/Uri","./defaultValue","./defined","./DeveloperError"],function(e,t,n,r){"use strict";function i(e,t){var n;return"undefined"!=typeof document&&(n=document),i._implementation(e,t,n)}return i._implementation=function(i,a,o){if(!n(i))throw new r("relative uri is required.");if(!n(a)){if(void 0===o)return i;a=t(o.baseURI,o.location.href)}var s=new e(a);return new e(i).resolve(s).toString()},i}),function(e){"use strict";e("ThirdParty/when",[],function(){function e(e,n,r,i){return t(e).then(n,r,i)}function t(e){var t,n;return e instanceof r?t=e:s(e)?(n=o(),e.then(function(e){n.resolve(e)},function(e){n.reject(e)},function(e){n.progress(e)}),t=n.promise):t=i(e),t}function n(t){return e(t,a)}function r(e){this.then=e}function i(e){return new r(function(n){try{return t(n?n(e):e)}catch(e){return a(e)}})}function a(e){return new r(function(n,r){try{return r?t(r(e)):a(e)}catch(e){return a(e)}})}function o(){function e(e,t,n){return d(e,t,n)}function n(e){return p(e)}function i(e){return p(a(e))}function s(e){return h(e)}var u,c,l,f,d,h,p;return c=new r(e),u={then:e,resolve:n,reject:i,progress:s,promise:c,resolver:{resolve:n,reject:i,progress:s}},l=[],f=[],d=function(e,t,n){var r,i;return r=o(),i="function"==typeof n?function(e){try{r.progress(n(e))}catch(e){r.progress(e)}}:function(e){r.progress(e)},l.push(function(n){n.then(e,t).then(r.resolve,r.reject,i)}),f.push(i),r.promise},h=function(e){return m(f,e),e},p=function(e){return e=t(e),d=e.then,p=t,h=y,m(l,e),f=l=T,e},u}function s(e){return e&&"function"==typeof e.then}function u(t,n,r,i,a){return _(2,arguments),e(t,function(t){function s(e){m(e)}function u(e){p(e)}var c,l,f,d,h,p,m,_,v,g;if(v=t.length>>>0,c=Math.max(0,Math.min(n,v)),f=[],l=v-c+1,d=[],h=o(),c)for(_=h.progress,m=function(e){d.push(e),--l||(p=m=y,h.reject(d))},p=function(e){f.push(e),--c||(p=m=y,h.resolve(f))},g=0;g<v;++g)g in t&&e(t[g],u,s,_);else h.resolve(f);return h.then(r,i,a)})}function c(e,t,n,r){function i(e){return t?t(e[0]):e[0]}return u(e,1,i,n,r)}function l(e,t,n,r){return _(1,arguments),d(e,v).then(t,n,r)}function f(){return d(arguments,v)}function d(t,n){return e(t,function(t){var r,i,a,s,u,c;if(a=i=t.length>>>0,r=[],c=o(),a)for(s=function(t,i){e(t,n).then(function(e){r[i]=e,--a||c.resolve(r)},c.reject)},u=0;u<i;u++)u in t?s(t[u],u):--a;else c.resolve(r);return c.promise})}function h(t,n){var r=E.call(arguments,1);return e(t,function(t){var i;return i=t.length,r[0]=function(t,r,a){return e(t,function(t){return e(r,function(e){return n(t,e,a,i)})})},g.apply(t,r)})}function p(t,n,r){var i=arguments.length>2;return e(t,function(e){return e=i?r:e,n.resolve(e),e},function(e){return n.reject(e),a(e)},n.progress)}function m(e,t){for(var n,r=0;n=e[r++];)n(t)}function _(e,t){for(var n,r=t.length;r>e;)if(null!=(n=t[--r])&&"function"!=typeof n)throw new Error("arg "+r+" must be a function")}function y(){}function v(e){return e}var g,E,T;return e.defer=o,e.resolve=t,e.reject=n,e.join=f,e.all=l,e.map=d,e.reduce=h,e.any=c,e.some=u,e.chain=p,e.isPromise=s,r.prototype={always:function(e,t){return this.then(e,e,t)},otherwise:function(e){return this.then(T,e)},yield:function(e){return this.then(function(){return e})},spread:function(e){return this.then(function(t){return l(t,function(t){return e.apply(T,t)})})}},E=[].slice,g=[].reduce||function(e){var t,n,r,i,a;if(a=0,t=Object(this),i=t.length>>>0,n=arguments,n.length<=1)for(;;){if(a in t){r=t[a++];break}if(++a>=i)throw new TypeError}else r=n[1];for(;a<i;++a)a in t&&(r=e(r,t[a],a,t));return r},e})}("function"==typeof define&&define.amd?define:function(e){"object"==typeof exports?module.exports=e():this.when=e()}),define("Core/appendForwardSlash",[],function(){"use strict";function e(e){return 0!==e.length&&"/"===e[e.length-1]||(e+="/"),e}return e}),define("Core/Check",["./defined","./DeveloperError"],function(e,t){"use strict";function n(e){return e+" is required, actual value was undefined"}function r(e,t,n){return"Expected "+n+" to be typeof "+t+", actual typeof was "+e}var i={};return i.typeOf={},i.defined=function(r,i){if(!e(i))throw new t(n(r))},i.typeOf.func=function(e,n){if("function"!=typeof n)throw new t(r(typeof n,"function",e))},i.typeOf.string=function(e,n){if("string"!=typeof n)throw new t(r(typeof n,"string",e))},i.typeOf.number=function(e,n){if("number"!=typeof n)throw new t(r(typeof n,"number",e))},i.typeOf.number.lessThan=function(e,n,r){if(i.typeOf.number(e,n),n>=r)throw new t("Expected "+e+" to be less than "+r+", actual value was "+n)},i.typeOf.number.lessThanOrEquals=function(e,n,r){if(i.typeOf.number(e,n),n>r)throw new t("Expected "+e+" to be less than or equal to "+r+", actual value was "+n)},i.typeOf.number.greaterThan=function(e,n,r){if(i.typeOf.number(e,n),n<=r)throw new t("Expected "+e+" to be greater than "+r+", actual value was "+n)},i.typeOf.number.greaterThanOrEquals=function(e,n,r){if(i.typeOf.number(e,n),n<r)throw new t("Expected "+e+" to be greater than or equal to"+r+", actual value was "+n)},i.typeOf.object=function(e,n){if("object"!=typeof n)throw new t(r(typeof n,"object",e))},i.typeOf.bool=function(e,n){if("boolean"!=typeof n)throw new t(r(typeof n,"boolean",e))},i.typeOf.number.equals=function(e,n,r,a){if(i.typeOf.number(e,r),i.typeOf.number(n,a),r!==a)throw new t(e+" must be equal to "+n+", the actual values are "+r+" and "+a)},i}),define("Core/clone",["./defaultValue"],function(e){"use strict";function t(n,r){if(null===n||"object"!=typeof n)return n;r=e(r,!1);var i=new n.constructor;for(var a in n)if(n.hasOwnProperty(a)){var o=n[a];r&&(o=t(o,r)),i[a]=o}return i}return t}),define("Core/combine",["./defaultValue","./defined"],function(e,t){"use strict";function n(r,i,a){a=e(a,!1);var o,s,u,c={},l=t(r),f=t(i);if(l)for(o in r)r.hasOwnProperty(o)&&(s=r[o],f&&a&&"object"==typeof s&&i.hasOwnProperty(o)?(u=i[o],c[o]="object"==typeof u?n(s,u,a):s):c[o]=s);if(f)for(o in i)i.hasOwnProperty(o)&&!c.hasOwnProperty(o)&&(u=i[o],c[o]=u);return c}return n}),define("Core/defineProperties",["./defined"],function(e){"use strict";var t=function(){try{return"x"in Object.defineProperty({},"x",{})}catch(e){return!1}}(),n=Object.defineProperties;return t&&e(n)||(n=function(e){return e}),n}),define("Core/oneTimeWarning",["./defaultValue","./defined","./DeveloperError"],function(e,t,n){"use strict";function r(r,a){if(!t(r))throw new n("identifier is required.");t(i[r])||(i[r]=!0,console.warn(e(a,r)))}var i={};return r.geometryOutlines="Entity geometry outlines are unsupported on terrain. Outlines will be disabled. To enable outlines, disable geometry terrain clamping by explicitly setting height to 0.",r.geometryZIndex="Entity geometry with zIndex are unsupported when height or extrudedHeight are defined.  zIndex will be ignored",r}),define("Core/deprecationWarning",["./defined","./DeveloperError","./oneTimeWarning"],function(e,t,n){"use strict";function r(r,i){if(!e(r)||!e(i))throw new t("identifier and message are required.");n(r,i)}return r}),define("Core/Fullscreen",["./defined","./defineProperties"],function(e,t){"use strict";var n,r={requestFullscreen:void 0,exitFullscreen:void 0,fullscreenEnabled:void 0,fullscreenElement:void 0,fullscreenchange:void 0,fullscreenerror:void 0},i={};return t(i,{element:{get:function(){if(i.supportsFullscreen())return document[r.fullscreenElement]}},changeEventName:{get:function(){if(i.supportsFullscreen())return r.fullscreenchange}},errorEventName:{get:function(){if(i.supportsFullscreen())return r.fullscreenerror}},enabled:{get:function(){if(i.supportsFullscreen())return document[r.fullscreenEnabled]}},fullscreen:{get:function(){if(i.supportsFullscreen())return null!==i.element}}}),i.supportsFullscreen=function(){if(e(n))return n;n=!1;var t=document.body;if("function"==typeof t.requestFullscreen)return r.requestFullscreen="requestFullscreen",r.exitFullscreen="exitFullscreen",r.fullscreenEnabled="fullscreenEnabled",r.fullscreenElement="fullscreenElement",r.fullscreenchange="fullscreenchange",r.fullscreenerror="fullscreenerror",n=!0;for(var i,a=["webkit","moz","o","ms","khtml"],o=0,s=a.length;o<s;++o){var u=a[o];i=u+"RequestFullscreen","function"==typeof t[i]?(r.requestFullscreen=i,n=!0):(i=u+"RequestFullScreen","function"==typeof t[i]&&(r.requestFullscreen=i,n=!0)),i=u+"ExitFullscreen","function"==typeof document[i]?r.exitFullscreen=i:(i=u+"CancelFullScreen","function"==typeof document[i]&&(r.exitFullscreen=i)),i=u+"FullscreenEnabled",void 0!==document[i]?r.fullscreenEnabled=i:(i=u+"FullScreenEnabled",void 0!==document[i]&&(r.fullscreenEnabled=i)),i=u+"FullscreenElement",void 0!==document[i]?r.fullscreenElement=i:(i=u+"FullScreenElement",void 0!==document[i]&&(r.fullscreenElement=i)),i=u+"fullscreenchange",void 0!==document["on"+i]&&("ms"===u&&(i="MSFullscreenChange"),r.fullscreenchange=i),i=u+"fullscreenerror",void 0!==document["on"+i]&&("ms"===u&&(i="MSFullscreenError"),r.fullscreenerror=i)}return n},i.requestFullscreen=function(e,t){i.supportsFullscreen()&&e[r.requestFullscreen]({vrDisplay:t})},i.exitFullscreen=function(){i.supportsFullscreen()&&document[r.exitFullscreen]()},i}),define("Core/FeatureDetection",["./defaultValue","./defined","./Fullscreen"],function(e,t,n){"use strict";function r(e){for(var t=e.split("."),n=0,r=t.length;n<r;++n)t[n]=parseInt(t[n],10);return t}function i(){if(!t(T)&&(T=!1,!d())){var e=/ Chrome\/([\.0-9]+)/.exec(E.userAgent);null!==e&&(T=!0,w=r(e[1]))}return T}function a(){return i()&&w}function o(){if(!t(b)&&(b=!1,!i()&&!d()&&/ Safari\/[\.0-9]+/.test(E.userAgent))){var e=/ Version\/([\.0-9]+)/.exec(E.userAgent);null!==e&&(b=!0,S=r(e[1]))}return b}function s(){return o()&&S}function u(){if(!t(C)){C=!1;var e=/ AppleWebKit\/([\.0-9]+)(\+?)/.exec(E.userAgent);null!==e&&(C=!0,O=r(e[1]),O.isNightly=!!e[2])}return C}function c(){return u()&&O}function l(){if(!t(A)){A=!1;var e;"Microsoft Internet Explorer"===E.appName?null!==(e=/MSIE ([0-9]{1,}[\.0-9]{0,})/.exec(E.userAgent))&&(A=!0,x=r(e[1])):"Netscape"===E.appName&&null!==(e=/Trident\/.*rv:([0-9]{1,}[\.0-9]{0,})/.exec(E.userAgent))&&(A=!0,x=r(e[1]))}return A}function f(){return l()&&x}function d(){if(!t(R)){R=!1;var e=/ Edge\/([\.0-9]+)/.exec(E.userAgent);null!==e&&(R=!0,I=r(e[1]))}return R}function h(){return d()&&I}function p(){if(!t(D)){D=!1;var e=/Firefox\/([\.0-9]+)/.exec(E.userAgent);null!==e&&(D=!0,P=r(e[1]))}return D}function m(){return t(N)||(N=/Windows/i.test(E.appVersion)),N}function _(){return p()&&P}function y(){return t(M)||(M="undefined"!=typeof PointerEvent&&(!t(E.pointerEnabled)||E.pointerEnabled)),M}function v(){if(!t(F)){var e=document.createElement("canvas");e.setAttribute("style","image-rendering: -moz-crisp-edges;image-rendering: pixelated;");var n=e.style.imageRendering;F=t(n)&&""!==n,F&&(z=n)}return F}function g(){return v()?z:void 0}var E;E="undefined"!=typeof navigator?navigator:{};var T,w,b,S,C,O,A,x,R,I,D,P,N,M,z,F,L=[];"undefined"!=typeof ArrayBuffer&&(L.push(Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array),"undefined"!=typeof Uint8ClampedArray&&L.push(Uint8ClampedArray),"undefined"!=typeof CanvasPixelArray&&L.push(CanvasPixelArray));var B={isChrome:i,chromeVersion:a,isSafari:o,safariVersion:s,isWebkit:u,webkitVersion:c,isInternetExplorer:l,internetExplorerVersion:f,isEdge:d,edgeVersion:h,isFirefox:p,firefoxVersion:_,isWindows:m,hardwareConcurrency:e(E.hardwareConcurrency,3),supportsPointerEvents:y,supportsImageRenderingPixelated:v,imageRenderingValue:g,typedArrayTypes:L};return B.supportsFullscreen=function(){return n.supportsFullscreen()},B.supportsTypedArrays=function(){return"undefined"!=typeof ArrayBuffer},B.supportsWebWorkers=function(){return"undefined"!=typeof Worker},B.supportsWebAssembly=function(){return"undefined"!=typeof WebAssembly&&!B.isEdge()},B}),define("Core/getBaseUri",["../ThirdParty/Uri","./defined","./DeveloperError"],function(e,t,n){"use strict";function r(r,i){if(!t(r))throw new n("uri is required.");var a="",o=r.lastIndexOf("/");return-1!==o&&(a=r.substring(0,o+1)),i?(r=new e(r),t(r.query)&&(a+="?"+r.query),t(r.fragment)&&(a+="#"+r.fragment),a):a}return r}),define("Core/getExtensionFromUri",["../ThirdParty/Uri","./defined","./DeveloperError"],function(e,t,n){"use strict";function r(r){if(!t(r))throw new n("uri is required.");var i=new e(r);i.normalize();var a=i.path,o=a.lastIndexOf("/");return-1!==o&&(a=a.substr(o+1)),o=a.lastIndexOf("."),a=-1===o?"":a.substr(o+1)}return r}),define("Core/isBlobUri",["./Check"],function(e){"use strict";function t(t){return e.typeOf.string("uri",t),n.test(t)}var n=/^blob:/i;return t}),define("Core/isCrossOriginUrl",["./defined"],function(e){"use strict";function t(t){e(n)||(n=document.createElement("a")),n.href=window.location.href;var r=n.host,i=n.protocol;return n.href=t,n.href=n.href,i!==n.protocol||r!==n.host}var n;return t}),define("Core/isDataUri",["./Check"],function(e){"use strict";function t(t){return e.typeOf.string("uri",t),n.test(t)}var n=/^data:/i;return t}),define("Core/isArray",["./defined"],function(e){"use strict";var t=Array.isArray;return e(t)||(t=function(e){return"[object Array]"===Object.prototype.toString.call(e)}),t}),define("Core/objectToQuery",["./defined","./DeveloperError","./isArray"],function(e,t,n){"use strict";function r(r){if(!e(r))throw new t("obj is required.");var i="";for(var a in r)if(r.hasOwnProperty(a)){var o=r[a],s=encodeURIComponent(a)+"=";if(n(o))for(var u=0,c=o.length;u<c;++u)i+=s+encodeURIComponent(o[u])+"&";else i+=s+encodeURIComponent(o)+"&"}return i=i.slice(0,-1)}return r}),define("Core/queryToObject",["./defined","./DeveloperError","./isArray"],function(e,t,n){"use strict";function r(r){if(!e(r))throw new t("queryString is required.");var i={};if(""===r)return i;for(var a=r.replace(/\+/g,"%20").split(/[&;]/),o=0,s=a.length;o<s;++o){var u=a[o].split("="),c=decodeURIComponent(u[0]),l=u[1];l=e(l)?decodeURIComponent(l):"";var f=i[c];"string"==typeof f?i[c]=[f,l]:n(f)?f.push(l):i[c]=l}return i}return r}),define("Core/RequestState",["../Core/freezeObject"],function(e){"use strict";return e({UNISSUED:0,ISSUED:1,ACTIVE:2,RECEIVED:3,CANCELLED:4,FAILED:5})}),define("Core/RequestType",["../Core/freezeObject"],function(e){"use strict";return e({TERRAIN:0,IMAGERY:1,TILES3D:2,OTHER:3})}),define("Core/Request",["./defaultValue","./defined","./RequestState","./RequestType"],function(e,t,n,r){"use strict";function i(t){t=e(t,e.EMPTY_OBJECT);var i=e(t.throttleByServer,!1),a=i||e(t.throttle,!1);this.url=t.url,this.requestFunction=t.requestFunction,this.cancelFunction=t.cancelFunction,this.priorityFunction=t.priorityFunction,this.priority=e(t.priority,0),this.throttle=a,this.throttleByServer=i,this.type=e(t.type,r.OTHER),this.serverKey=void 0,this.state=n.UNISSUED,this.deferred=void 0,this.cancelled=!1}return i.prototype.cancel=function(){this.cancelled=!0},i.prototype.clone=function(e){return t(e)?(e.url=this.url,e.requestFunction=this.requestFunction,e.cancelFunction=this.cancelFunction,e.priorityFunction=this.priorityFunction,e.priority=this.priority,e.throttle=this.throttle,e.throttleByServer=this.throttleByServer,e.type=this.type,e.serverKey=this.serverKey,e.state=this.RequestState.UNISSUED,e.deferred=void 0,e.cancelled=!1,e):new i(this)},i}),define("Core/parseResponseHeaders",[],function(){"use strict";function e(e){var t={};if(!e)return t;for(var n=e.split("\r\n"),r=0;r<n.length;++r){var i=n[r],a=i.indexOf(": ");if(a>0){var o=i.substring(0,a),s=i.substring(a+2);t[o]=s}}return t}return e}),define("Core/RequestErrorEvent",["./defined","./parseResponseHeaders"],function(e,t){"use strict";function n(e,n,r){this.statusCode=e,this.response=n,this.responseHeaders=r,"string"==typeof this.responseHeaders&&(this.responseHeaders=t(this.responseHeaders))}return n.prototype.toString=function(){var t="Request has failed.";return e(this.statusCode)&&(t+=" Status Code: "+this.statusCode),t},n}),define("Core/Event",["./Check","./defined","./defineProperties"],function(e,t,n){"use strict";function r(){this._listeners=[],this._scopes=[],this._toRemove=[],this._insideRaiseEvent=!1}function i(e,t){return t-e}return n(r.prototype,{numberOfListeners:{get:function(){return this._listeners.length-this._toRemove.length}}}),r.prototype.addEventListener=function(t,n){e.typeOf.func("listener",t),this._listeners.push(t),this._scopes.push(n);var r=this;return function(){r.removeEventListener(t,n)}},r.prototype.removeEventListener=function(t,n){e.typeOf.func("listener",t);for(var r=this._listeners,i=this._scopes,a=-1,o=0;o<r.length;o++)if(r[o]===t&&i[o]===n){a=o;break}return-1!==a&&(this._insideRaiseEvent?(this._toRemove.push(a),r[a]=void 0,i[a]=void 0):(r.splice(a,1),i.splice(a,1)),!0)},r.prototype.raiseEvent=function(){this._insideRaiseEvent=!0;var e,n=this._listeners,r=this._scopes,a=n.length;for(e=0;e<a;e++){var o=n[e];t(o)&&n[e].apply(r[e],arguments)}var s=this._toRemove;if((a=s.length)>0){for(s.sort(i),e=0;e<a;e++){var u=s[e];n.splice(u,1),r.splice(u,1)}s.length=0}this._insideRaiseEvent=!1},r}),define("Core/Heap",["./Check","./defaultValue","./defined","./defineProperties"],function(e,t,n,r){"use strict";function i(t){e.typeOf.object("options",t),e.defined("options.comparator",t.comparator),this._comparator=t.comparator,this._array=[],this._length=0,this._maximumLength=void 0}function a(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}return r(i.prototype,{length:{get:function(){return this._length}},internalArray:{get:function(){return this._array}},maximumLength:{get:function(){return this._maximumLength},set:function(e){this._maximumLength=e,this._length>e&&e>0&&(this._length=e,this._array.length=e)}},comparator:{get:function(){return this._comparator}}}),i.prototype.reserve=function(e){e=t(e,this._length),this._array.length=e},i.prototype.heapify=function(e){e=t(e,0);for(var n=this._length,r=this._comparator,i=this._array,o=-1,s=!0;s;){var u=2*(e+1),c=u-1;o=c<n&&r(i[c],i[e])<0?c:e,u<n&&r(i[u],i[o])<0&&(o=u),o!==e?(a(i,o,e),e=o):s=!1}},i.prototype.resort=function(){for(var e=this._length,t=Math.ceil(e/2);t>=0;--t)this.heapify(t)},i.prototype.insert=function(t){e.defined("element",t);var r=this._array,i=this._comparator,o=this._maximumLength,s=this._length++;for(s<r.length?r[s]=t:r.push(t);0!==s;){var u=Math.floor((s-1)/2);if(!(i(r[s],r[u])<0))break;a(r,s,u),s=u}var c;return n(o)&&this._length>o&&(c=r[o],this._length=o),c},i.prototype.pop=function(n){if(n=t(n,0),0!==this._length){e.typeOf.number.lessThan("index",n,this._length);var r=this._array,i=r[n];return a(r,n,--this._length),this.heapify(n),i}},i}),define("Core/RequestScheduler",["../ThirdParty/Uri","../ThirdParty/when","./Check","./defaultValue","./defined","./defineProperties","./Event","./Heap","./isBlobUri","./isDataUri","./RequestState"],function(e,t,n,r,i,a,o,s,u,c,l){"use strict";function f(e,t){return e.priority-t.priority}function d(){}function h(e){i(e.priorityFunction)&&(e.priority=e.priorityFunction())}function p(e){var t=r(d.requestsByServer[e],d.maximumRequestsPerServer);return O[e]<t}function m(e){return e.state===l.UNISSUED&&(e.state=l.ISSUED,e.deferred=t.defer()),e.deferred.promise}function _(e){return function(t){e.state!==l.CANCELLED&&(--w.numberOfActiveRequests,--O[e.serverKey],x.raiseEvent(),e.state=l.RECEIVED,e.deferred.resolve(t))}}function y(e){return function(t){e.state!==l.CANCELLED&&(++w.numberOfFailedRequests,--w.numberOfActiveRequests,--O[e.serverKey],x.raiseEvent(t),e.state=l.FAILED,e.deferred.reject(t))}}function v(e){var t=m(e);return e.state=l.ACTIVE,C.push(e),++w.numberOfActiveRequests,++w.numberOfActiveRequestsEver,++O[e.serverKey],e.requestFunction().then(_(e)).otherwise(y(e)),t}function g(e){var t=e.state===l.ACTIVE;e.state=l.CANCELLED,++w.numberOfCancelledRequests,e.deferred.reject(),t&&(--w.numberOfActiveRequests,--O[e.serverKey],++w.numberOfCancelledActiveRequests),i(e.cancelFunction)&&e.cancelFunction()}function E(){w.numberOfAttemptedRequests=0,w.numberOfCancelledRequests=0,w.numberOfCancelledActiveRequests=0}function T(){d.debugShowStatistics&&(w.numberOfAttemptedRequests>0&&console.log("Number of attempted requests: "+w.numberOfAttemptedRequests),w.numberOfActiveRequests>0&&console.log("Number of active requests: "+w.numberOfActiveRequests),w.numberOfCancelledRequests>0&&console.log("Number of cancelled requests: "+w.numberOfCancelledRequests),w.numberOfCancelledActiveRequests>0&&console.log("Number of cancelled active requests: "+w.numberOfCancelledActiveRequests),w.numberOfFailedRequests>0&&console.log("Number of failed requests: "+w.numberOfFailedRequests),E())}var w={numberOfAttemptedRequests:0,numberOfActiveRequests:0,numberOfCancelledRequests:0,numberOfCancelledActiveRequests:0,numberOfFailedRequests:0,numberOfActiveRequestsEver:0},b=20,S=new s({comparator:f});S.maximumLength=b,S.reserve(b);var C=[],O={},A="undefined"!=typeof document?new e(document.location.href):new e,x=new o;return d.maximumRequests=50,d.maximumRequestsPerServer=6,d.requestsByServer={"api.cesium.com:443":18,"assets.cesium.com:443":18},d.throttleRequests=!0,d.debugShowStatistics=!1,d.requestCompletedEvent=x,a(d,{statistics:{get:function(){return w}},priorityHeapLength:{get:function(){return b},set:function(e){if(e<b)for(;S.length>e;){var t=S.pop();g(t)}b=e,S.maximumLength=e,S.reserve(e)}}}),d.update=function(){var e,t,n=0,r=C.length;for(e=0;e<r;++e)t=C[e],t.cancelled&&g(t),t.state===l.ACTIVE?n>0&&(C[e-n]=t):++n;C.length-=n;var i=S.internalArray,a=S.length;for(e=0;e<a;++e)h(i[e]);S.resort();for(var o=Math.max(d.maximumRequests-C.length,0),s=0;s<o&&S.length>0;)t=S.pop(),t.cancelled?g(t):!t.throttleByServer||p(t.serverKey)?(v(t),++s):g(t);T()},d.getServerKey=function(t){n.typeOf.string("url",t);var r=new e(t).resolve(A);r.normalize();var a=r.authority;/:/.test(a)||(a=a+":"+("https"===r.scheme?"443":"80"));var o=O[a];return i(o)||(O[a]=0),a},d.request=function(e){if(n.typeOf.object("request",e),n.typeOf.string("request.url",e.url),n.typeOf.func("request.requestFunction",e.requestFunction),c(e.url)||u(e.url))return x.raiseEvent(),e.state=l.RECEIVED,e.requestFunction();if(++w.numberOfAttemptedRequests,i(e.serverKey)||(e.serverKey=d.getServerKey(e.url)),!d.throttleRequests||!e.throttle)return v(e);if(!(C.length>=d.maximumRequests)&&(!e.throttleByServer||p(e.serverKey))){h(e);var t=S.insert(e);if(i(t)){if(t===e)return;g(t)}return m(e)}},d.clearForSpecs=function(){for(;S.length>0;){g(S.pop())}for(var e=C.length,t=0;t<e;++t)g(C[t]);C.length=0,O={},w.numberOfAttemptedRequests=0,w.numberOfActiveRequests=0,w.numberOfCancelledRequests=0,w.numberOfCancelledActiveRequests=0,w.numberOfFailedRequests=0,w.numberOfActiveRequestsEver=0},d.numberOfActiveRequestsByServer=function(e){return O[e]},d.requestHeap=S,d}),define("Core/RuntimeError",["./defined"],function(e){"use strict";function t(e){this.name="RuntimeError",this.message=e;var t;try{throw new Error}catch(e){t=e.stack}this.stack=t}return e(Object.create)&&(t.prototype=Object.create(Error.prototype),t.prototype.constructor=t),t.prototype.toString=function(){var t=this.name+": "+this.message;return e(this.stack)&&(t+="\n"+this.stack.toString()),t},t}),define("Core/TrustedServers",["../ThirdParty/Uri","./defined","./DeveloperError"],function(e,t,n){"use strict";function r(n){var r=new e(n);r.normalize();var i=r.getAuthority();if(t(i)){if(-1!==i.indexOf("@")){i=i.split("@")[1]}if(-1===i.indexOf(":")){var a=r.getScheme();if(t(a)||(a=window.location.protocol,a=a.substring(0,a.length-1)),"http"===a)i+=":80";else{if("https"!==a)return;i+=":443"}}return i}}var i={},a={};return i.add=function(e,r){if(!t(e))throw new n("host is required.");if(!t(r)||r<=0)throw new n("port is required to be greater than 0.");var i=e.toLowerCase()+":"+r;t(a[i])||(a[i]=!0)},i.remove=function(e,r){if(!t(e))throw new n("host is required.");if(!t(r)||r<=0)throw new n("port is required to be greater than 0.");var i=e.toLowerCase()+":"+r;t(a[i])&&delete a[i]},i.contains=function(e){if(!t(e))throw new n("url is required.");var i=r(e);return!(!t(i)||!t(a[i]))},i.clear=function(){a={}},i}),define("Core/Resource",["../ThirdParty/Uri","../ThirdParty/when","./appendForwardSlash","./Check","./clone","./combine","./defaultValue","./defined","./defineProperties","./deprecationWarning","./DeveloperError","./FeatureDetection","./freezeObject","./getAbsoluteUri","./getBaseUri","./getExtensionFromUri","./isBlobUri","./isCrossOriginUrl","./isDataUri","./objectToQuery","./queryToObject","./Request","./RequestErrorEvent","./RequestScheduler","./RequestState","./RuntimeError","./TrustedServers"],function(e,t,n,r,i,a,o,s,u,c,l,f,d,h,p,m,_,y,v,g,E,T,w,b,S,C,O){"use strict";function A(e,t,n,r){var i=e.query;if(!s(i)||0===i.length)return{};var a;if(-1===i.indexOf("=")){var o={};o[i]=void 0,a=o}else a=E(i);t._queryParameters=n?D(a,t._queryParameters,r):a,e.query=void 0}function x(e,t){var n=t._queryParameters,r=Object.keys(n);1!==r.length||s(n[r[0]])?e.query=g(n):e.query=r[0]}function R(e,t){return s(e)?s(e.clone)?e.clone():i(e):t}function I(e){if(e.state===S.ISSUED||e.state===S.ACTIVE)throw new C("The Resource is already being fetched.");e.state=S.UNISSUED,e.deferred=void 0}function D(e,t,n){if(!n)return a(e,t);var r=i(e,!0);for(var o in t)if(t.hasOwnProperty(o)){var u=r[o],c=t[o];s(u)?(Array.isArray(u)||(u=r[o]=[u]),r[o]=u.concat(c)):r[o]=Array.isArray(c)?c.slice():c}return r}function P(t){t=o(t,o.EMPTY_OBJECT),"string"==typeof t&&(t={url:t}),r.typeOf.string("options.url",t.url),this._url=void 0,this._templateValues=R(t.templateValues,{}),this._queryParameters=R(t.queryParameters,{}),this.headers=R(t.headers,{}),this.request=o(t.request,new T),this.proxy=t.proxy,this.retryCallback=t.retryCallback,this.retryAttempts=o(t.retryAttempts,0),this._retryCount=0;var n=new e(t.url);A(n,this,!0,!0),n.fragment=void 0,this._url=n.toString()}function N(e){var n=e.request;n.url=e.url,n.requestFunction=function(){var n=e.url,r=!1;e.isDataUri||e.isBlobUri||(r=e.isCrossOriginUrl);var i=t.defer();return P._Implementations.createImage(n,r,i),i.promise};var r=b.request(n);if(s(r))return r.otherwise(function(r){return n.state!==S.FAILED?t.reject(r):e.retryOnError(r).then(function(i){return i?(n.state=S.UNISSUED,n.deferred=void 0,N(e)):t.reject(r)})})}function M(e,n,r){var i={};i[n]=r,e.setQueryParameters(i);var a=e.request;a.url=e.url,a.requestFunction=function(){var n=t.defer();return window[r]=function(e){n.resolve(e);try{delete window[r]}catch(e){window[r]=void 0}},P._Implementations.loadAndExecuteScript(e.url,r,n),n.promise};var o=b.request(a);if(s(o))return o.otherwise(function(i){return a.state!==S.FAILED?t.reject(i):e.retryOnError(i).then(function(o){return o?(a.state=S.UNISSUED,a.deferred=void 0,M(e,n,r)):t.reject(i)})})}function z(e,t){var n=decodeURIComponent(t);return e?atob(n):n}function F(e,t){for(var n=z(e,t),r=new ArrayBuffer(n.length),i=new Uint8Array(r),a=0;a<n.length;a++)i[a]=n.charCodeAt(a);return r}function L(e,t){t=o(t,"");var n=e[1],r=!!e[2],i=e[3];switch(t){case"":case"text":return z(r,i);case"arraybuffer":return F(r,i);case"blob":var a=F(r,i);return new Blob([a],{type:n});case"document":return(new DOMParser).parseFromString(z(r,i),n);case"json":return JSON.parse(z(r,i));default:throw new l("Unhandled responseType: "+t)}}function B(e,t){switch(t){case"text":return e.toString("utf8");case"json":return JSON.parse(e.toString("utf8"));default:return new Uint8Array(e).buffer}}function U(e,t,n,r,i,a,o){var s=require("url").parse(e),u="https:"===s.protocol?require("https"):require("http"),c=require("zlib"),l={protocol:s.protocol,hostname:s.hostname,port:s.port,path:s.path,query:s.query,method:n,headers:i};u.request(l).on("response",function(e){if(e.statusCode<200||e.statusCode>=300)return void a.reject(new w(e.statusCode,e,e.headers));var n=[];e.on("data",function(e){n.push(e)}),e.on("end",function(){var r=Buffer.concat(n);"gzip"===e.headers["content-encoding"]?c.gunzip(r,function(e,n){e?a.reject(new C("Error decompressing response.")):a.resolve(B(n,t))}):a.resolve(B(r,t))})}).on("error",function(e){a.reject(new w)}).end()}var q=function(){try{var e=new XMLHttpRequest;return e.open("GET","#",!0),e.responseType="blob","blob"===e.responseType}catch(e){return!1}}();P.createIfNeeded=function(e){return e instanceof P?e.getDerivedResource({request:e.request}):"string"!=typeof e?e:new P({url:e})},u(P,{isBlobSupported:{get:function(){return q}}}),u(P.prototype,{queryParameters:{get:function(){return this._queryParameters}},templateValues:{get:function(){return this._templateValues}
},url:{get:function(){return this.getUrlComponent(!0,!0)},set:function(t){var n=new e(t);A(n,this,!1),n.fragment=void 0,this._url=n.toString()}},extension:{get:function(){return m(this._url)}},isDataUri:{get:function(){return v(this._url)}},isBlobUri:{get:function(){return _(this._url)}},isCrossOriginUrl:{get:function(){return y(this._url)}},hasHeaders:{get:function(){return Object.keys(this.headers).length>0}}}),P.prototype.getUrlComponent=function(t,n){if(this.isDataUri)return this._url;var r=new e(this._url);t&&x(r,this);var i=r.toString().replace(/%7B/g,"{").replace(/%7D/g,"}"),a=this._templateValues,o=Object.keys(a);if(o.length>0)for(var u=0;u<o.length;u++){var c=o[u],l=a[c];i=i.replace(new RegExp("{"+c+"}","g"),encodeURIComponent(l))}return n&&s(this.proxy)&&(i=this.proxy.getURL(i)),i},P.prototype.setQueryParameters=function(e,t){this._queryParameters=t?D(this._queryParameters,e,!1):D(e,this._queryParameters,!1)},P.prototype.addQueryParameters=function(e,t){return c("Resource.addQueryParameters","addQueryParameters has been deprecated and will be removed 1.45. Use setQueryParameters or appendQueryParameters instead."),this.setQueryParameters(e,t)},P.prototype.appendQueryParameters=function(e){this._queryParameters=D(e,this._queryParameters,!0)},P.prototype.setTemplateValues=function(e,t){this._templateValues=t?a(this._templateValues,e):a(e,this._templateValues)},P.prototype.addTemplateValues=function(e,t){return c("Resource.addTemplateValues","addTemplateValues has been deprecated and will be removed 1.45. Use setTemplateValues."),this.setTemplateValues(e,t)},P.prototype.getDerivedResource=function(t){var n=this.clone();if(n._retryCount=0,s(t.url)){var r=new e(t.url);A(r,n,!0,o(t.preserveQueryParameters,!1)),r.fragment=void 0,n._url=r.resolve(new e(h(this._url))).toString()}return s(t.queryParameters)&&(n._queryParameters=a(t.queryParameters,n._queryParameters)),s(t.templateValues)&&(n._templateValues=a(t.templateValues,n.templateValues)),s(t.headers)&&(n.headers=a(t.headers,n.headers)),s(t.proxy)&&(n.proxy=t.proxy),s(t.request)&&(n.request=t.request),s(t.retryCallback)&&(n.retryCallback=t.retryCallback),s(t.retryAttempts)&&(n.retryAttempts=t.retryAttempts),n},P.prototype.retryOnError=function(e){var n=this.retryCallback;if("function"!=typeof n||this._retryCount>=this.retryAttempts)return t(!1);var r=this;return t(n(this,e)).then(function(e){return++r._retryCount,e})},P.prototype.clone=function(e){return s(e)||(e=new P({url:this._url})),e._url=this._url,e._queryParameters=i(this._queryParameters),e._templateValues=i(this._templateValues),e.headers=i(this.headers),e.proxy=this.proxy,e.retryCallback=this.retryCallback,e.retryAttempts=this.retryAttempts,e._retryCount=0,e.request=this.request.clone(),e},P.prototype.getBaseUri=function(e){return p(this.getUrlComponent(e),e)},P.prototype.appendForwardSlash=function(){this._url=n(this._url)},P.prototype.fetchArrayBuffer=function(){return this.fetch({responseType:"arraybuffer"})},P.fetchArrayBuffer=function(e){return new P(e).fetchArrayBuffer()},P.prototype.fetchBlob=function(){return this.fetch({responseType:"blob"})},P.fetchBlob=function(e){return new P(e).fetchBlob()},P.prototype.fetchImage=function(e){if(e=o(e,!1),I(this.request),!q||this.isDataUri||this.isBlobUri||!this.hasHeaders&&!e)return N(this,!0);var n=this.fetchBlob();if(s(n)){var r,i;return n.then(function(e){if(s(e)){i=e;var t=window.URL.createObjectURL(e);return r=new P({url:t}),N(r)}}).then(function(e){if(s(e))return window.URL.revokeObjectURL(r.url),e.blob=i,e}).otherwise(function(e){return s(r)&&window.URL.revokeObjectURL(r.url),t.reject(e)})}},P.fetchImage=function(e){return new P(e).fetchImage(e.preferBlob)},P.prototype.fetchText=function(){return this.fetch({responseType:"text"})},P.fetchText=function(e){return new P(e).fetchText()},P.prototype.fetchJson=function(){var e=this.fetch({responseType:"text",headers:{Accept:"application/json,*/*;q=0.01"}});if(s(e))return e.then(function(e){if(s(e))return JSON.parse(e)})},P.fetchJson=function(e){return new P(e).fetchJson()},P.prototype.fetchXML=function(){return this.fetch({responseType:"document",overrideMimeType:"text/xml"})},P.fetchXML=function(e){return new P(e).fetchXML()},P.prototype.fetchJsonp=function(e){e=o(e,"callback"),I(this.request);var t;do{t="loadJsonp"+Math.random().toString().substring(2,8)}while(s(window[t]));return M(this,e,t)},P.fetchJsonp=function(e){return new P(e).fetchJsonp(e.callbackParameterName)},P.prototype._makeRequest=function(e){var n=this;I(n.request);var r=n.request;r.url=n.url,r.requestFunction=function(){var i=e.responseType,o=a(e.headers,n.headers),u=e.overrideMimeType,c=e.method,l=e.data,f=t.defer(),d=P._Implementations.loadWithXhr(n.url,i,c,l,o,f,u);return s(d)&&s(d.abort)&&(r.cancelFunction=function(){d.abort()}),f.promise};var i=b.request(r);if(s(i))return i.then(function(e){return e}).otherwise(function(i){return r.state!==S.FAILED?t.reject(i):n.retryOnError(i).then(function(a){return a?(r.state=S.UNISSUED,r.deferred=void 0,n.fetch(e)):t.reject(i)})})};var G=/^data:(.*?)(;base64)?,(.*)$/;P.prototype.fetch=function(e){return e=R(e,{}),e.method="GET",this._makeRequest(e)},P.fetch=function(e){return new P(e).fetch({responseType:e.responseType,overrideMimeType:e.overrideMimeType})},P.prototype.delete=function(e){return e=R(e,{}),e.method="DELETE",this._makeRequest(e)},P.delete=function(e){return new P(e).delete({responseType:e.responseType,overrideMimeType:e.overrideMimeType,data:e.data})},P.prototype.head=function(e){return e=R(e,{}),e.method="HEAD",this._makeRequest(e)},P.head=function(e){return new P(e).head({responseType:e.responseType,overrideMimeType:e.overrideMimeType})},P.prototype.options=function(e){return e=R(e,{}),e.method="OPTIONS",this._makeRequest(e)},P.options=function(e){return new P(e).options({responseType:e.responseType,overrideMimeType:e.overrideMimeType})},P.prototype.post=function(e,t){return r.defined("data",e),t=R(t,{}),t.method="POST",t.data=e,this._makeRequest(t)},P.post=function(e){return new P(e).post(e.data,{responseType:e.responseType,overrideMimeType:e.overrideMimeType})},P.prototype.put=function(e,t){return r.defined("data",e),t=R(t,{}),t.method="PUT",t.data=e,this._makeRequest(t)},P.put=function(e){return new P(e).put(e.data,{responseType:e.responseType,overrideMimeType:e.overrideMimeType})},P.prototype.patch=function(e,t){return r.defined("data",e),t=R(t,{}),t.method="PATCH",t.data=e,this._makeRequest(t)},P.patch=function(e){return new P(e).patch(e.data,{responseType:e.responseType,overrideMimeType:e.overrideMimeType})},P._Implementations={},P._Implementations.createImage=function(e,t,n){var r=new Image;r.onload=function(){n.resolve(r)},r.onerror=function(e){n.reject(e)},t&&(O.contains(e)?r.crossOrigin="use-credentials":r.crossOrigin=""),r.src=e};var V="undefined"==typeof XMLHttpRequest;return P._Implementations.loadWithXhr=function(e,t,n,r,i,a,o){var u=G.exec(e);if(null!==u)return void a.resolve(L(u,t));if(V)return void U(e,t,n,r,i,a,o);var c=new XMLHttpRequest;if(O.contains(e)&&(c.withCredentials=!0),s(o)&&s(c.overrideMimeType)&&c.overrideMimeType(o),c.open(n,e,!0),s(i))for(var l in i)i.hasOwnProperty(l)&&c.setRequestHeader(l,i[l]);s(t)&&(c.responseType=t);var f=!1;return"string"==typeof e&&(f=0===e.indexOf("file://")||"undefined"!=typeof window&&"file://"===window.location.origin),c.onload=function(){if((c.status<200||c.status>=300)&&(!f||0!==c.status))return void a.reject(new w(c.status,c.response,c.getAllResponseHeaders()));var e=c.response,r=c.responseType;if("HEAD"===n||"OPTIONS"===n){var i=c.getAllResponseHeaders(),o=i.trim().split(/[\r\n]+/),u={};return o.forEach(function(e){var t=e.split(": "),n=t.shift();u[n]=t.join(": ")}),void a.resolve(u)}if(204===c.status)a.resolve();else if(!s(e)||s(t)&&r!==t)if("json"===t&&"string"==typeof e)try{a.resolve(JSON.parse(e))}catch(e){a.reject(e)}else(""===r||"document"===r)&&s(c.responseXML)&&c.responseXML.hasChildNodes()?a.resolve(c.responseXML):""!==r&&"text"!==r||!s(c.responseText)?a.reject(new C("Invalid XMLHttpRequest response type.")):a.resolve(c.responseText);else a.resolve(e)},c.onerror=function(e){a.reject(new w)},c.send(r),c},P._Implementations.loadAndExecuteScript=function(e,t,n){var r=document.createElement("script");r.async=!0,r.src=e;var i=document.getElementsByTagName("head")[0];r.onload=function(){r.onload=void 0,i.removeChild(r)},r.onerror=function(e){n.reject(e)},i.appendChild(r)},P._DefaultImplementations={},P._DefaultImplementations.createImage=P._Implementations.createImage,P._DefaultImplementations.loadWithXhr=P._Implementations.loadWithXhr,P._DefaultImplementations.loadAndExecuteScript=P._Implementations.loadAndExecuteScript,P.DEFAULT=d(new P({url:"undefined"==typeof document?"":document.location.href.split("?")[0]})),P}),define("Core/buildModuleUrl",["./defined","./DeveloperError","./getAbsoluteUri","./Resource","require"],function(e,t,n,r,i){"use strict";function a(){for(var e=document.getElementsByTagName("script"),t=0,n=e.length;t<n;++t){var r=e[t].getAttribute("src"),i=p.exec(r);if(null!==i)return i[1]}}function o(t){return"undefined"==typeof document?t:(e(f)||(f=document.createElement("a")),f.href=t,f.href=f.href,f.href)}function s(){if(e(d))return d;var s;if(s="undefined"!=typeof CESIUM_BASE_URL?CESIUM_BASE_URL:e(define.amd)&&!define.amd.toUrlUndefined&&e(i.toUrl)?n("..",l("Core/buildModuleUrl.js")):a(),!e(s))throw new t("Unable to determine Cesium base URL automatically, try defining a global variable called CESIUM_BASE_URL.");return d=new r({url:o(s)}),d.appendForwardSlash(),d}function u(e){return o(i.toUrl("../"+e))}function c(e){return s().getDerivedResource({url:e}).url}function l(t){return e(h)||(h=e(define.amd)&&!define.amd.toUrlUndefined&&e(i.toUrl)?u:c),h(t)}var f,d,h,p=/((?:.*\/)|^)cesium[\w-]*\.js(?:\W|$)/i;return l._cesiumScriptRegex=p,l._buildModuleUrlFromBaseUrl=c,l._clearBaseResource=function(){d=void 0},l.setBaseUrl=function(e){d=r.DEFAULT.getDerivedResource({url:e})},l.getCesiumBaseUrl=s,l}),define("ThirdParty/mersenne-twister",[],function(){var e=function(e){void 0==e&&(e=(new Date).getTime()),this.N=624,this.M=397,this.MATRIX_A=2567483615,this.UPPER_MASK=2147483648,this.LOWER_MASK=2147483647,this.mt=new Array(this.N),this.mti=this.N+1,this.init_genrand(e)};return e.prototype.init_genrand=function(e){for(this.mt[0]=e>>>0,this.mti=1;this.mti<this.N;this.mti++){var e=this.mt[this.mti-1]^this.mt[this.mti-1]>>>30;this.mt[this.mti]=(1812433253*((4294901760&e)>>>16)<<16)+1812433253*(65535&e)+this.mti,this.mt[this.mti]>>>=0}},e.prototype.genrand_int32=function(){var e,t=new Array(0,this.MATRIX_A);if(this.mti>=this.N){var n;for(this.mti==this.N+1&&this.init_genrand(5489),n=0;n<this.N-this.M;n++)e=this.mt[n]&this.UPPER_MASK|this.mt[n+1]&this.LOWER_MASK,this.mt[n]=this.mt[n+this.M]^e>>>1^t[1&e];for(;n<this.N-1;n++)e=this.mt[n]&this.UPPER_MASK|this.mt[n+1]&this.LOWER_MASK,this.mt[n]=this.mt[n+(this.M-this.N)]^e>>>1^t[1&e];e=this.mt[this.N-1]&this.UPPER_MASK|this.mt[0]&this.LOWER_MASK,this.mt[this.N-1]=this.mt[this.M-1]^e>>>1^t[1&e],this.mti=0}return e=this.mt[this.mti++],e^=e>>>11,e^=e<<7&2636928640,e^=e<<15&4022730752,(e^=e>>>18)>>>0},e.prototype.random=function(){return this.genrand_int32()*(1/4294967296)},e}),define("Core/Math",["../ThirdParty/mersenne-twister","./Check","./defaultValue","./defined","./DeveloperError"],function(e,t,n,r,i){"use strict";var a={};a.EPSILON1=.1,a.EPSILON2=.01,a.EPSILON3=.001,a.EPSILON4=1e-4,a.EPSILON5=1e-5,a.EPSILON6=1e-6,a.EPSILON7=1e-7,a.EPSILON8=1e-8,a.EPSILON9=1e-9,a.EPSILON10=1e-10,a.EPSILON11=1e-11,a.EPSILON12=1e-12,a.EPSILON13=1e-13,a.EPSILON14=1e-14,a.EPSILON15=1e-15,a.EPSILON16=1e-16,a.EPSILON17=1e-17,a.EPSILON18=1e-18,a.EPSILON19=1e-19,a.EPSILON20=1e-20,a.GRAVITATIONALPARAMETER=3986004418e5,a.SOLAR_RADIUS=6955e5,a.LUNAR_RADIUS=1737400,a.SIXTY_FOUR_KILOBYTES=65536,a.sign=n(Math.sign,function(e){return e=+e,0===e||e!==e?e:e>0?1:-1}),a.signNotZero=function(e){return e<0?-1:1},a.toSNorm=function(e,t){return t=n(t,255),Math.round((.5*a.clamp(e,-1,1)+.5)*t)},a.fromSNorm=function(e,t){return t=n(t,255),a.clamp(e,0,t)/t*2-1},a.sinh=n(Math.sinh,function(e){return(Math.exp(e)-Math.exp(-e))/2}),a.cosh=n(Math.cosh,function(e){return(Math.exp(e)+Math.exp(-e))/2}),a.lerp=function(e,t,n){return(1-n)*e+n*t},a.PI=Math.PI,a.ONE_OVER_PI=1/Math.PI,a.PI_OVER_TWO=Math.PI/2,a.PI_OVER_THREE=Math.PI/3,a.PI_OVER_FOUR=Math.PI/4,a.PI_OVER_SIX=Math.PI/6,a.THREE_PI_OVER_TWO=3*Math.PI/2,a.TWO_PI=2*Math.PI,a.ONE_OVER_TWO_PI=1/(2*Math.PI),a.RADIANS_PER_DEGREE=Math.PI/180,a.DEGREES_PER_RADIAN=180/Math.PI,a.RADIANS_PER_ARCSECOND=a.RADIANS_PER_DEGREE/3600,a.toRadians=function(e){if(!r(e))throw new i("degrees is required.");return e*a.RADIANS_PER_DEGREE},a.toDegrees=function(e){if(!r(e))throw new i("radians is required.");return e*a.DEGREES_PER_RADIAN},a.convertLongitudeRange=function(e){if(!r(e))throw new i("angle is required.");var t=a.TWO_PI,n=e-Math.floor(e/t)*t;return n<-Math.PI?n+t:n>=Math.PI?n-t:n},a.clampToLatitudeRange=function(e){if(!r(e))throw new i("angle is required.");return a.clamp(e,-1*a.PI_OVER_TWO,a.PI_OVER_TWO)},a.negativePiToPi=function(e){if(!r(e))throw new i("angle is required.");return a.zeroToTwoPi(e+a.PI)-a.PI},a.zeroToTwoPi=function(e){if(!r(e))throw new i("angle is required.");var t=a.mod(e,a.TWO_PI);return Math.abs(t)<a.EPSILON14&&Math.abs(e)>a.EPSILON14?a.TWO_PI:t},a.mod=function(e,t){if(!r(e))throw new i("m is required.");if(!r(t))throw new i("n is required.");return(e%t+t)%t},a.equalsEpsilon=function(e,t,a,o){if(!r(e))throw new i("left is required.");if(!r(t))throw new i("right is required.");if(!r(a))throw new i("relativeEpsilon is required.");o=n(o,a);var s=Math.abs(e-t);return s<=o||s<=a*Math.max(Math.abs(e),Math.abs(t))};var o=[1];a.factorial=function(e){if("number"!=typeof e||e<0)throw new i("A number greater than or equal to 0 is required.");var t=o.length;if(e>=t)for(var n=o[t-1],r=t;r<=e;r++)o.push(n*r);return o[e]},a.incrementWrap=function(e,t,a){if(a=n(a,0),!r(e))throw new i("n is required.");if(t<=a)throw new i("maximumValue must be greater than minimumValue.");return++e,e>t&&(e=a),e},a.isPowerOfTwo=function(e){if("number"!=typeof e||e<0)throw new i("A number greater than or equal to 0 is required.");return 0!==e&&0==(e&e-1)},a.nextPowerOfTwo=function(e){if("number"!=typeof e||e<0)throw new i("A number greater than or equal to 0 is required.");return--e,e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,e|=e>>16,++e},a.clamp=function(e,t,n){if(!r(e))throw new i("value is required");if(!r(t))throw new i("min is required.");if(!r(n))throw new i("max is required.");return e<t?t:e>n?n:e};var s=new e;return a.setRandomNumberSeed=function(t){if(!r(t))throw new i("seed is required.");s=new e(t)},a.nextRandomNumber=function(){return s.random()},a.randomBetween=function(e,t){return a.nextRandomNumber()*(t-e)+e},a.acosClamped=function(e){if(!r(e))throw new i("value is required.");return Math.acos(a.clamp(e,-1,1))},a.asinClamped=function(e){if(!r(e))throw new i("value is required.");return Math.asin(a.clamp(e,-1,1))},a.chordLength=function(e,t){if(!r(e))throw new i("angle is required.");if(!r(t))throw new i("radius is required.");return 2*t*Math.sin(.5*e)},a.logBase=function(e,t){if(!r(e))throw new i("number is required.");if(!r(t))throw new i("base is required.");return Math.log(e)/Math.log(t)},a.cbrt=n(Math.cbrt,function(e){var t=Math.pow(Math.abs(e),1/3);return e<0?-t:t}),a.log2=n(Math.log2,function(e){return Math.log(e)*Math.LOG2E}),a.fog=function(e,t){var n=e*t;return 1-Math.exp(-n*n)},a.fastApproximateAtan=function(e){return t.typeOf.number("x",e),e*(-.1784*Math.abs(e)-.0663*e*e+1.0301)},a.fastApproximateAtan2=function(e,n){t.typeOf.number("x",e),t.typeOf.number("y",n);var r,o,s=Math.abs(e);r=Math.abs(n),o=Math.max(s,r),r=Math.min(s,r);var u=r/o;if(isNaN(u))throw new i("either x or y must be nonzero");return s=a.fastApproximateAtan(u),s=Math.abs(n)>Math.abs(e)?a.PI_OVER_TWO-s:s,s=e<0?a.PI-s:s,s=n<0?-s:s},a}),define("Core/Cartesian3",["./Check","./defaultValue","./defined","./DeveloperError","./freezeObject","./Math"],function(e,t,n,r,i,a){"use strict";function o(e,n,r){this.x=t(e,0),this.y=t(n,0),this.z=t(r,0)}o.fromSpherical=function(r,i){e.typeOf.object("spherical",r),n(i)||(i=new o);var a=r.clock,s=r.cone,u=t(r.magnitude,1),c=u*Math.sin(s);return i.x=c*Math.cos(a),i.y=c*Math.sin(a),i.z=u*Math.cos(s),i},o.fromElements=function(e,t,r,i){return n(i)?(i.x=e,i.y=t,i.z=r,i):new o(e,t,r)},o.clone=function(e,t){if(n(e))return n(t)?(t.x=e.x,t.y=e.y,t.z=e.z,t):new o(e.x,e.y,e.z)},o.fromCartesian4=o.clone,o.packedLength=3,o.pack=function(n,r,i){return e.typeOf.object("value",n),e.defined("array",r),i=t(i,0),r[i++]=n.x,r[i++]=n.y,r[i]=n.z,r},o.unpack=function(r,i,a){return e.defined("array",r),i=t(i,0),n(a)||(a=new o),a.x=r[i++],a.y=r[i++],a.z=r[i],a},o.packArray=function(t,r){e.defined("array",t);var i=t.length;n(r)?r.length=3*i:r=new Array(3*i);for(var a=0;a<i;++a)o.pack(t[a],r,3*a);return r},o.unpackArray=function(t,i){if(e.defined("array",t),e.typeOf.number.greaterThanOrEquals("array.length",t.length,3),t.length%3!=0)throw new r("array length must be a multiple of 3.");var a=t.length;n(i)?i.length=a/3:i=new Array(a/3);for(var s=0;s<a;s+=3){var u=s/3;i[u]=o.unpack(t,s,i[u])}return i},o.fromArray=o.unpack,o.maximumComponent=function(t){return e.typeOf.object("cartesian",t),Math.max(t.x,t.y,t.z)},o.minimumComponent=function(t){return e.typeOf.object("cartesian",t),Math.min(t.x,t.y,t.z)},o.minimumByComponent=function(t,n,r){return e.typeOf.object("first",t),e.typeOf.object("second",n),e.typeOf.object("result",r),r.x=Math.min(t.x,n.x),r.y=Math.min(t.y,n.y),r.z=Math.min(t.z,n.z),r},o.maximumByComponent=function(t,n,r){return e.typeOf.object("first",t),e.typeOf.object("second",n),e.typeOf.object("result",r),r.x=Math.max(t.x,n.x),r.y=Math.max(t.y,n.y),r.z=Math.max(t.z,n.z),r},o.magnitudeSquared=function(t){return e.typeOf.object("cartesian",t),t.x*t.x+t.y*t.y+t.z*t.z},o.magnitude=function(e){return Math.sqrt(o.magnitudeSquared(e))};var s=new o;o.distance=function(t,n){return e.typeOf.object("left",t),e.typeOf.object("right",n),o.subtract(t,n,s),o.magnitude(s)},o.distanceSquared=function(t,n){return e.typeOf.object("left",t),e.typeOf.object("right",n),o.subtract(t,n,s),o.magnitudeSquared(s)},o.normalize=function(t,n){e.typeOf.object("cartesian",t),e.typeOf.object("result",n);var i=o.magnitude(t);if(n.x=t.x/i,n.y=t.y/i,n.z=t.z/i,isNaN(n.x)||isNaN(n.y)||isNaN(n.z))throw new r("normalized result is not a number");return n},o.dot=function(t,n){return e.typeOf.object("left",t),e.typeOf.object("right",n),t.x*n.x+t.y*n.y+t.z*n.z},o.multiplyComponents=function(t,n,r){return e.typeOf.object("left",t),e.typeOf.object("right",n),e.typeOf.object("result",r),r.x=t.x*n.x,r.y=t.y*n.y,r.z=t.z*n.z,r},o.divideComponents=function(t,n,r){return e.typeOf.object("left",t),e.typeOf.object("right",n),e.typeOf.object("result",r),r.x=t.x/n.x,r.y=t.y/n.y,r.z=t.z/n.z,r},o.add=function(t,n,r){return e.typeOf.object("left",t),e.typeOf.object("right",n),e.typeOf.object("result",r),r.x=t.x+n.x,r.y=t.y+n.y,r.z=t.z+n.z,r},o.subtract=function(t,n,r){return e.typeOf.object("left",t),e.typeOf.object("right",n),e.typeOf.object("result",r),r.x=t.x-n.x,r.y=t.y-n.y,r.z=t.z-n.z,r},o.multiplyByScalar=function(t,n,r){return e.typeOf.object("cartesian",t),e.typeOf.number("scalar",n),e.typeOf.object("result",r),r.x=t.x*n,r.y=t.y*n,r.z=t.z*n,r},o.divideByScalar=function(t,n,r){return e.typeOf.object("cartesian",t),e.typeOf.number("scalar",n),e.typeOf.object("result",r),r.x=t.x/n,r.y=t.y/n,r.z=t.z/n,r},o.negate=function(t,n){return e.typeOf.object("cartesian",t),e.typeOf.object("result",n),n.x=-t.x,n.y=-t.y,n.z=-t.z,n},o.abs=function(t,n){return e.typeOf.object("cartesian",t),e.typeOf.object("result",n),n.x=Math.abs(t.x),n.y=Math.abs(t.y),n.z=Math.abs(t.z),n};var u=new o;o.lerp=function(t,n,r,i){return e.typeOf.object("start",t),e.typeOf.object("end",n),e.typeOf.number("t",r),e.typeOf.object("result",i),o.multiplyByScalar(n,r,u),i=o.multiplyByScalar(t,1-r,i),o.add(u,i,i)};var c=new o,l=new o;o.angleBetween=function(t,n){e.typeOf.object("left",t),e.typeOf.object("right",n),o.normalize(t,c),o.normalize(n,l);var r=o.dot(c,l),i=o.magnitude(o.cross(c,l,c));return Math.atan2(i,r)};var f=new o;o.mostOrthogonalAxis=function(t,n){e.typeOf.object("cartesian",t),e.typeOf.object("result",n);var r=o.normalize(t,f);return o.abs(r,r),n=r.x<=r.y?r.x<=r.z?o.clone(o.UNIT_X,n):o.clone(o.UNIT_Z,n):r.y<=r.z?o.clone(o.UNIT_Y,n):o.clone(o.UNIT_Z,n)},o.projectVector=function(t,n,r){e.defined("a",t),e.defined("b",n),e.defined("result",r);var i=o.dot(t,n)/o.dot(n,n);return o.multiplyByScalar(n,i,r)},o.equals=function(e,t){return e===t||n(e)&&n(t)&&e.x===t.x&&e.y===t.y&&e.z===t.z},o.equalsArray=function(e,t,n){return e.x===t[n]&&e.y===t[n+1]&&e.z===t[n+2]},o.equalsEpsilon=function(e,t,r,i){return e===t||n(e)&&n(t)&&a.equalsEpsilon(e.x,t.x,r,i)&&a.equalsEpsilon(e.y,t.y,r,i)&&a.equalsEpsilon(e.z,t.z,r,i)},o.cross=function(t,n,r){e.typeOf.object("left",t),e.typeOf.object("right",n),e.typeOf.object("result",r);var i=t.x,a=t.y,o=t.z,s=n.x,u=n.y,c=n.z,l=a*c-o*u,f=o*s-i*c,d=i*u-a*s;return r.x=l,r.y=f,r.z=d,r},o.fromDegrees=function(t,n,r,i,s){return e.typeOf.number("longitude",t),e.typeOf.number("latitude",n),t=a.toRadians(t),n=a.toRadians(n),o.fromRadians(t,n,r,i,s)};var d=new o,h=new o,p=new o(40680631590769,40680631590769,40408299984661.445);return o.fromRadians=function(r,i,a,s,u){e.typeOf.number("longitude",r),e.typeOf.number("latitude",i),a=t(a,0);var c=n(s)?s.radiiSquared:p,l=Math.cos(i);d.x=l*Math.cos(r),d.y=l*Math.sin(r),d.z=Math.sin(i),d=o.normalize(d,d),o.multiplyComponents(c,d,h);var f=Math.sqrt(o.dot(d,h));return h=o.divideByScalar(h,f,h),d=o.multiplyByScalar(d,a,d),n(u)||(u=new o),o.add(h,d,u)},o.fromDegreesArray=function(t,i,a){if(e.defined("coordinates",t),t.length<2||t.length%2!=0)throw new r("the number of coordinates must be a multiple of 2 and at least 2");var s=t.length;n(a)?a.length=s/2:a=new Array(s/2);for(var u=0;u<s;u+=2){var c=t[u],l=t[u+1],f=u/2;a[f]=o.fromDegrees(c,l,0,i,a[f])}return a},o.fromRadiansArray=function(t,i,a){if(e.defined("coordinates",t),t.length<2||t.length%2!=0)throw new r("the number of coordinates must be a multiple of 2 and at least 2");var s=t.length;n(a)?a.length=s/2:a=new Array(s/2);for(var u=0;u<s;u+=2){var c=t[u],l=t[u+1],f=u/2;a[f]=o.fromRadians(c,l,0,i,a[f])}return a},o.fromDegreesArrayHeights=function(t,i,a){if(e.defined("coordinates",t),t.length<3||t.length%3!=0)throw new r("the number of coordinates must be a multiple of 3 and at least 3");var s=t.length;n(a)?a.length=s/3:a=new Array(s/3);for(var u=0;u<s;u+=3){var c=t[u],l=t[u+1],f=t[u+2],d=u/3;a[d]=o.fromDegrees(c,l,f,i,a[d])}return a},o.fromRadiansArrayHeights=function(t,i,a){if(e.defined("coordinates",t),t.length<3||t.length%3!=0)throw new r("the number of coordinates must be a multiple of 3 and at least 3");var s=t.length;n(a)?a.length=s/3:a=new Array(s/3);for(var u=0;u<s;u+=3){var c=t[u],l=t[u+1],f=t[u+2],d=u/3;a[d]=o.fromRadians(c,l,f,i,a[d])}return a},o.ZERO=i(new o(0,0,0)),o.UNIT_X=i(new o(1,0,0)),o.UNIT_Y=i(new o(0,1,0)),o.UNIT_Z=i(new o(0,0,1)),o.prototype.clone=function(e){return o.clone(this,e)},o.prototype.equals=function(e){return o.equals(this,e)},o.prototype.equalsEpsilon=function(e,t,n){return o.equalsEpsilon(this,e,t,n)},o.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.z+")"},o}),define("Core/scaleToGeodeticSurface",["./Cartesian3","./defined","./DeveloperError","./Math"],function(e,t,n,r){"use strict";function i(i,s,u,c,l){if(!t(i))throw new n("cartesian is required.");if(!t(s))throw new n("oneOverRadii is required.");if(!t(u))throw new n("oneOverRadiiSquared is required.");if(!t(c))throw new n("centerToleranceSquared is required.");var f=i.x,d=i.y,h=i.z,p=s.x,m=s.y,_=s.z,y=f*f*p*p,v=d*d*m*m,g=h*h*_*_,E=y+v+g,T=Math.sqrt(1/E),w=e.multiplyByScalar(i,T,a);if(E<c)return isFinite(T)?e.clone(w,l):void 0;var b=u.x,S=u.y,C=u.z,O=o;O.x=w.x*b*2,O.y=w.y*S*2,O.z=w.z*C*2;var A,x,R,I,D,P,N,M,z,F,L,B=(1-T)*e.magnitude(i)/(.5*e.magnitude(O)),U=0;do{B-=U,R=1/(1+B*b),I=1/(1+B*S),D=1/(1+B*C),P=R*R,N=I*I,M=D*D,z=P*R,F=N*I,L=M*D,A=y*P+v*N+g*M-1,x=y*z*b+v*F*S+g*L*C;U=A/(-2*x)}while(Math.abs(A)>r.EPSILON12);return t(l)?(l.x=f*R,l.y=d*I,l.z=h*D,l):new e(f*R,d*I,h*D)}var a=new e,o=new e;return i}),define("Core/Cartographic",["./Cartesian3","./Check","./defaultValue","./defined","./freezeObject","./Math","./scaleToGeodeticSurface"],function(e,t,n,r,i,a,o){"use strict";function s(e,t,r){this.longitude=n(e,0),this.latitude=n(t,0),this.height=n(r,0)}s.fromRadians=function(e,i,a,o){return t.typeOf.number("longitude",e),t.typeOf.number("latitude",i),a=n(a,0),r(o)?(o.longitude=e,o.latitude=i,o.height=a,o):new s(e,i,a)},s.fromDegrees=function(e,n,r,i){return t.typeOf.number("longitude",e),t.typeOf.number("latitude",n),e=a.toRadians(e),n=a.toRadians(n),s.fromRadians(e,n,r,i)};var u=new e,c=new e,l=new e,f=new e(1/6378137,1/6378137,1/6356752.314245179),d=new e(1/40680631590769,1/40680631590769,1/40408299984661.445),h=a.EPSILON1;return s.fromCartesian=function(t,n,i){var p=r(n)?n.oneOverRadii:f,m=r(n)?n.oneOverRadiiSquared:d,_=r(n)?n._centerToleranceSquared:h,y=o(t,p,m,_,c);if(r(y)){var v=e.multiplyComponents(y,m,u);v=e.normalize(v,v);var g=e.subtract(t,y,l),E=Math.atan2(v.y,v.x),T=Math.asin(v.z),w=a.sign(e.dot(g,t))*e.magnitude(g);return r(i)?(i.longitude=E,i.latitude=T,i.height=w,i):new s(E,T,w)}},s.toCartesian=function(n,r,i){return t.defined("cartographic",n),e.fromRadians(n.longitude,n.latitude,n.height,r,i)},s.clone=function(e,t){if(r(e))return r(t)?(t.longitude=e.longitude,t.latitude=e.latitude,t.height=e.height,t):new s(e.longitude,e.latitude,e.height)},s.equals=function(e,t){return e===t||r(e)&&r(t)&&e.longitude===t.longitude&&e.latitude===t.latitude&&e.height===t.height},s.equalsEpsilon=function(e,n,i){return t.typeOf.number("epsilon",i),e===n||r(e)&&r(n)&&Math.abs(e.longitude-n.longitude)<=i&&Math.abs(e.latitude-n.latitude)<=i&&Math.abs(e.height-n.height)<=i},s.ZERO=i(new s(0,0,0)),s.prototype.clone=function(e){return s.clone(this,e)},s.prototype.equals=function(e){return s.equals(this,e)},s.prototype.equalsEpsilon=function(e,t){return s.equalsEpsilon(this,e,t)},s.prototype.toString=function(){return"("+this.longitude+", "+this.latitude+", "+this.height+")"},s}),define("Core/Ellipsoid",["./Cartesian3","./Cartographic","./Check","./defaultValue","./defined","./defineProperties","./DeveloperError","./freezeObject","./Math","./scaleToGeodeticSurface"],function(e,t,n,r,i,a,o,s,u,c){"use strict";function l(t,i,a,o){i=r(i,0),a=r(a,0),o=r(o,0),n.typeOf.number.greaterThanOrEquals("x",i,0),n.typeOf.number.greaterThanOrEquals("y",a,0),n.typeOf.number.greaterThanOrEquals("z",o,0),t._radii=new e(i,a,o),t._radiiSquared=new e(i*i,a*a,o*o),t._radiiToTheFourth=new e(i*i*i*i,a*a*a*a,o*o*o*o),t._oneOverRadii=new e(0===i?0:1/i,0===a?0:1/a,0===o?0:1/o),t._oneOverRadiiSquared=new e(0===i?0:1/(i*i),0===a?0:1/(a*a),0===o?0:1/(o*o)),t._minimumRadius=Math.min(i,a,o),t._maximumRadius=Math.max(i,a,o),t._centerToleranceSquared=u.EPSILON1,0!==t._radiiSquared.z&&(t._squaredXOverSquaredZ=t._radiiSquared.x/t._radiiSquared.z)}function f(e,t,n){this._radii=void 0,this._radiiSquared=void 0,this._radiiToTheFourth=void 0,this._oneOverRadii=void 0,this._oneOverRadiiSquared=void 0,this._minimumRadius=void 0,this._maximumRadius=void 0,this._centerToleranceSquared=void 0,this._squaredXOverSquaredZ=void 0,l(this,e,t,n)}a(f.prototype,{radii:{get:function(){return this._radii}},radiiSquared:{get:function(){return this._radiiSquared}},radiiToTheFourth:{get:function(){return this._radiiToTheFourth}},oneOverRadii:{get:function(){return this._oneOverRadii}},oneOverRadiiSquared:{get:function(){return this._oneOverRadiiSquared}},minimumRadius:{get:function(){return this._minimumRadius}},maximumRadius:{get:function(){return this._maximumRadius}}}),f.clone=function(t,n){if(i(t)){var r=t._radii;return i(n)?(e.clone(r,n._radii),e.clone(t._radiiSquared,n._radiiSquared),e.clone(t._radiiToTheFourth,n._radiiToTheFourth),e.clone(t._oneOverRadii,n._oneOverRadii),e.clone(t._oneOverRadiiSquared,n._oneOverRadiiSquared),n._minimumRadius=t._minimumRadius,n._maximumRadius=t._maximumRadius,n._centerToleranceSquared=t._centerToleranceSquared,n):new f(r.x,r.y,r.z)}},f.fromCartesian3=function(e,t){return i(t)||(t=new f),i(e)?(l(t,e.x,e.y,e.z),t):t},f.WGS84=s(new f(6378137,6378137,6356752.314245179)),f.UNIT_SPHERE=s(new f(1,1,1)),f.MOON=s(new f(u.LUNAR_RADIUS,u.LUNAR_RADIUS,u.LUNAR_RADIUS)),f.prototype.clone=function(e){return f.clone(this,e)},f.packedLength=e.packedLength,f.pack=function(t,i,a){return n.typeOf.object("value",t),n.defined("array",i),a=r(a,0),e.pack(t._radii,i,a),i},f.unpack=function(t,i,a){n.defined("array",t),i=r(i,0);var o=e.unpack(t,i);return f.fromCartesian3(o,a)},f.prototype.geocentricSurfaceNormal=e.normalize,f.prototype.geodeticSurfaceNormalCartographic=function(t,r){n.typeOf.object("cartographic",t);var a=t.longitude,o=t.latitude,s=Math.cos(o),u=s*Math.cos(a),c=s*Math.sin(a),l=Math.sin(o);return i(r)||(r=new e),r.x=u,r.y=c,r.z=l,e.normalize(r,r)},f.prototype.geodeticSurfaceNormal=function(t,n){return i(n)||(n=new e),n=e.multiplyComponents(t,this._oneOverRadiiSquared,n),e.normalize(n,n)};var d=new e,h=new e;f.prototype.cartographicToCartesian=function(t,n){var r=d,a=h;this.geodeticSurfaceNormalCartographic(t,r),e.multiplyComponents(this._radiiSquared,r,a);var o=Math.sqrt(e.dot(r,a));return e.divideByScalar(a,o,a),e.multiplyByScalar(r,t.height,r),i(n)||(n=new e),e.add(a,r,n)},f.prototype.cartographicArrayToCartesianArray=function(e,t){n.defined("cartographics",e);var r=e.length;i(t)?t.length=r:t=new Array(r);for(var a=0;a<r;a++)t[a]=this.cartographicToCartesian(e[a],t[a]);return t};var p=new e,m=new e,_=new e;return f.prototype.cartesianToCartographic=function(n,r){var a=this.scaleToGeodeticSurface(n,m);if(i(a)){var o=this.geodeticSurfaceNormal(a,p),s=e.subtract(n,a,_),c=Math.atan2(o.y,o.x),l=Math.asin(o.z),f=u.sign(e.dot(s,n))*e.magnitude(s);return i(r)?(r.longitude=c,r.latitude=l,r.height=f,r):new t(c,l,f)}},f.prototype.cartesianArrayToCartographicArray=function(e,t){n.defined("cartesians",e);var r=e.length;i(t)?t.length=r:t=new Array(r);for(var a=0;a<r;++a)t[a]=this.cartesianToCartographic(e[a],t[a]);return t},f.prototype.scaleToGeodeticSurface=function(e,t){return c(e,this._oneOverRadii,this._oneOverRadiiSquared,this._centerToleranceSquared,t)},f.prototype.scaleToGeocentricSurface=function(t,r){n.typeOf.object("cartesian",t),i(r)||(r=new e);var a=t.x,o=t.y,s=t.z,u=this._oneOverRadiiSquared,c=1/Math.sqrt(a*a*u.x+o*o*u.y+s*s*u.z);return e.multiplyByScalar(t,c,r)},f.prototype.transformPositionToScaledSpace=function(t,n){return i(n)||(n=new e),e.multiplyComponents(t,this._oneOverRadii,n)},f.prototype.transformPositionFromScaledSpace=function(t,n){return i(n)||(n=new e),e.multiplyComponents(t,this._radii,n)},f.prototype.equals=function(t){return this===t||i(t)&&e.equals(this._radii,t._radii)},f.prototype.toString=function(){return this._radii.toString()},f.prototype.getSurfaceNormalIntersectionWithZAxis=function(t,a,s){if(n.typeOf.object("position",t),!u.equalsEpsilon(this._radii.x,this._radii.y,u.EPSILON15))throw new o("Ellipsoid must be an ellipsoid of revolution (radii.x == radii.y)");n.typeOf.number.greaterThan("Ellipsoid.radii.z",this._radii.z,0),a=r(a,0);var c=this._squaredXOverSquaredZ;if(i(s)||(s=new e),s.x=0,s.y=0,s.z=t.z*(1-c),!(Math.abs(s.z)>=this._radii.z-a))return s},f}),define("Core/GeographicProjection",["./Cartesian3","./Cartographic","./defaultValue","./defined","./defineProperties","./DeveloperError","./Ellipsoid"],function(e,t,n,r,i,a,o){"use strict";function s(e){this._ellipsoid=n(e,o.WGS84),this._semimajorAxis=this._ellipsoid.maximumRadius,this._oneOverSemimajorAxis=1/this._semimajorAxis}return i(s.prototype,{ellipsoid:{get:function(){return this._ellipsoid}}}),s.prototype.project=function(t,n){
var i=this._semimajorAxis,a=t.longitude*i,o=t.latitude*i,s=t.height;return r(n)?(n.x=a,n.y=o,n.z=s,n):new e(a,o,s)},s.prototype.unproject=function(e,n){if(!r(e))throw new a("cartesian is required");var i=this._oneOverSemimajorAxis,o=e.x*i,s=e.y*i,u=e.z;return r(n)?(n.longitude=o,n.latitude=s,n.height=u,n):new t(o,s,u)},s}),define("Core/Intersect",["./freezeObject"],function(e){"use strict";return e({OUTSIDE:-1,INTERSECTING:0,INSIDE:1})}),define("Core/Interval",["./defaultValue"],function(e){"use strict";function t(t,n){this.start=e(t,0),this.stop=e(n,0)}return t}),define("Core/Matrix3",["./Cartesian3","./Check","./defaultValue","./defined","./defineProperties","./DeveloperError","./freezeObject","./Math"],function(e,t,n,r,i,a,o,s){"use strict";function u(e,t,r,i,a,o,s,u,c){this[0]=n(e,0),this[1]=n(i,0),this[2]=n(s,0),this[3]=n(t,0),this[4]=n(a,0),this[5]=n(u,0),this[6]=n(r,0),this[7]=n(o,0),this[8]=n(c,0)}function c(e){for(var t=0,n=0;n<9;++n){var r=e[n];t+=r*r}return Math.sqrt(t)}function l(e){for(var t=0,n=0;n<3;++n){var r=e[u.getElementIndex(m[n],p[n])];t+=2*r*r}return Math.sqrt(t)}function f(e,t){for(var n=s.EPSILON15,r=0,i=1,a=0;a<3;++a){var o=Math.abs(e[u.getElementIndex(m[a],p[a])]);o>r&&(i=a,r=o)}var c=1,l=0,f=p[i],d=m[i];if(Math.abs(e[u.getElementIndex(d,f)])>n){var h,_=e[u.getElementIndex(d,d)],y=e[u.getElementIndex(f,f)],v=e[u.getElementIndex(d,f)],g=(_-y)/2/v;h=g<0?-1/(-g+Math.sqrt(1+g*g)):1/(g+Math.sqrt(1+g*g)),c=1/Math.sqrt(1+h*h),l=h*c}return t=u.clone(u.IDENTITY,t),t[u.getElementIndex(f,f)]=t[u.getElementIndex(d,d)]=c,t[u.getElementIndex(d,f)]=l,t[u.getElementIndex(f,d)]=-l,t}u.packedLength=9,u.pack=function(e,r,i){return t.typeOf.object("value",e),t.defined("array",r),i=n(i,0),r[i++]=e[0],r[i++]=e[1],r[i++]=e[2],r[i++]=e[3],r[i++]=e[4],r[i++]=e[5],r[i++]=e[6],r[i++]=e[7],r[i++]=e[8],r},u.unpack=function(e,i,a){return t.defined("array",e),i=n(i,0),r(a)||(a=new u),a[0]=e[i++],a[1]=e[i++],a[2]=e[i++],a[3]=e[i++],a[4]=e[i++],a[5]=e[i++],a[6]=e[i++],a[7]=e[i++],a[8]=e[i++],a},u.clone=function(e,t){if(r(e))return r(t)?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t):new u(e[0],e[3],e[6],e[1],e[4],e[7],e[2],e[5],e[8])},u.fromArray=function(e,i,a){return t.defined("array",e),i=n(i,0),r(a)||(a=new u),a[0]=e[i],a[1]=e[i+1],a[2]=e[i+2],a[3]=e[i+3],a[4]=e[i+4],a[5]=e[i+5],a[6]=e[i+6],a[7]=e[i+7],a[8]=e[i+8],a},u.fromColumnMajorArray=function(e,n){return t.defined("values",e),u.clone(e,n)},u.fromRowMajorArray=function(e,n){return t.defined("values",e),r(n)?(n[0]=e[0],n[1]=e[3],n[2]=e[6],n[3]=e[1],n[4]=e[4],n[5]=e[7],n[6]=e[2],n[7]=e[5],n[8]=e[8],n):new u(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8])},u.fromQuaternion=function(e,n){t.typeOf.object("quaternion",e);var i=e.x*e.x,a=e.x*e.y,o=e.x*e.z,s=e.x*e.w,c=e.y*e.y,l=e.y*e.z,f=e.y*e.w,d=e.z*e.z,h=e.z*e.w,p=e.w*e.w,m=i-c-d+p,_=2*(a-h),y=2*(o+f),v=2*(a+h),g=-i+c-d+p,E=2*(l-s),T=2*(o-f),w=2*(l+s),b=-i-c+d+p;return r(n)?(n[0]=m,n[1]=v,n[2]=T,n[3]=_,n[4]=g,n[5]=w,n[6]=y,n[7]=E,n[8]=b,n):new u(m,_,y,v,g,E,T,w,b)},u.fromHeadingPitchRoll=function(e,n){t.typeOf.object("headingPitchRoll",e);var i=Math.cos(-e.pitch),a=Math.cos(-e.heading),o=Math.cos(e.roll),s=Math.sin(-e.pitch),c=Math.sin(-e.heading),l=Math.sin(e.roll),f=i*a,d=-o*c+l*s*a,h=l*c+o*s*a,p=i*c,m=o*a+l*s*c,_=-l*a+o*s*c,y=-s,v=l*i,g=o*i;return r(n)?(n[0]=f,n[1]=p,n[2]=y,n[3]=d,n[4]=m,n[5]=v,n[6]=h,n[7]=_,n[8]=g,n):new u(f,d,h,p,m,_,y,v,g)},u.fromScale=function(e,n){return t.typeOf.object("scale",e),r(n)?(n[0]=e.x,n[1]=0,n[2]=0,n[3]=0,n[4]=e.y,n[5]=0,n[6]=0,n[7]=0,n[8]=e.z,n):new u(e.x,0,0,0,e.y,0,0,0,e.z)},u.fromUniformScale=function(e,n){return t.typeOf.number("scale",e),r(n)?(n[0]=e,n[1]=0,n[2]=0,n[3]=0,n[4]=e,n[5]=0,n[6]=0,n[7]=0,n[8]=e,n):new u(e,0,0,0,e,0,0,0,e)},u.fromCrossProduct=function(e,n){return t.typeOf.object("vector",e),r(n)?(n[0]=0,n[1]=e.z,n[2]=-e.y,n[3]=-e.z,n[4]=0,n[5]=e.x,n[6]=e.y,n[7]=-e.x,n[8]=0,n):new u(0,-e.z,e.y,e.z,0,-e.x,-e.y,e.x,0)},u.fromRotationX=function(e,n){t.typeOf.number("angle",e);var i=Math.cos(e),a=Math.sin(e);return r(n)?(n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=i,n[5]=a,n[6]=0,n[7]=-a,n[8]=i,n):new u(1,0,0,0,i,-a,0,a,i)},u.fromRotationY=function(e,n){t.typeOf.number("angle",e);var i=Math.cos(e),a=Math.sin(e);return r(n)?(n[0]=i,n[1]=0,n[2]=-a,n[3]=0,n[4]=1,n[5]=0,n[6]=a,n[7]=0,n[8]=i,n):new u(i,0,a,0,1,0,-a,0,i)},u.fromRotationZ=function(e,n){t.typeOf.number("angle",e);var i=Math.cos(e),a=Math.sin(e);return r(n)?(n[0]=i,n[1]=a,n[2]=0,n[3]=-a,n[4]=i,n[5]=0,n[6]=0,n[7]=0,n[8]=1,n):new u(i,-a,0,a,i,0,0,0,1)},u.toArray=function(e,n){return t.typeOf.object("matrix",e),r(n)?(n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[8]=e[8],n):[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8]]},u.getElementIndex=function(e,n){return t.typeOf.number.greaterThanOrEquals("row",n,0),t.typeOf.number.lessThanOrEquals("row",n,2),t.typeOf.number.greaterThanOrEquals("column",e,0),t.typeOf.number.lessThanOrEquals("column",e,2),3*e+n},u.getColumn=function(e,n,r){t.typeOf.object("matrix",e),t.typeOf.number.greaterThanOrEquals("index",n,0),t.typeOf.number.lessThanOrEquals("index",n,2),t.typeOf.object("result",r);var i=3*n,a=e[i],o=e[i+1],s=e[i+2];return r.x=a,r.y=o,r.z=s,r},u.setColumn=function(e,n,r,i){t.typeOf.object("matrix",e),t.typeOf.number.greaterThanOrEquals("index",n,0),t.typeOf.number.lessThanOrEquals("index",n,2),t.typeOf.object("cartesian",r),t.typeOf.object("result",i),i=u.clone(e,i);var a=3*n;return i[a]=r.x,i[a+1]=r.y,i[a+2]=r.z,i},u.getRow=function(e,n,r){t.typeOf.object("matrix",e),t.typeOf.number.greaterThanOrEquals("index",n,0),t.typeOf.number.lessThanOrEquals("index",n,2),t.typeOf.object("result",r);var i=e[n],a=e[n+3],o=e[n+6];return r.x=i,r.y=a,r.z=o,r},u.setRow=function(e,n,r,i){return t.typeOf.object("matrix",e),t.typeOf.number.greaterThanOrEquals("index",n,0),t.typeOf.number.lessThanOrEquals("index",n,2),t.typeOf.object("cartesian",r),t.typeOf.object("result",i),i=u.clone(e,i),i[n]=r.x,i[n+3]=r.y,i[n+6]=r.z,i};var d=new e;u.getScale=function(n,r){return t.typeOf.object("matrix",n),t.typeOf.object("result",r),r.x=e.magnitude(e.fromElements(n[0],n[1],n[2],d)),r.y=e.magnitude(e.fromElements(n[3],n[4],n[5],d)),r.z=e.magnitude(e.fromElements(n[6],n[7],n[8],d)),r};var h=new e;u.getMaximumScale=function(t){return u.getScale(t,h),e.maximumComponent(h)},u.multiply=function(e,n,r){t.typeOf.object("left",e),t.typeOf.object("right",n),t.typeOf.object("result",r);var i=e[0]*n[0]+e[3]*n[1]+e[6]*n[2],a=e[1]*n[0]+e[4]*n[1]+e[7]*n[2],o=e[2]*n[0]+e[5]*n[1]+e[8]*n[2],s=e[0]*n[3]+e[3]*n[4]+e[6]*n[5],u=e[1]*n[3]+e[4]*n[4]+e[7]*n[5],c=e[2]*n[3]+e[5]*n[4]+e[8]*n[5],l=e[0]*n[6]+e[3]*n[7]+e[6]*n[8],f=e[1]*n[6]+e[4]*n[7]+e[7]*n[8],d=e[2]*n[6]+e[5]*n[7]+e[8]*n[8];return r[0]=i,r[1]=a,r[2]=o,r[3]=s,r[4]=u,r[5]=c,r[6]=l,r[7]=f,r[8]=d,r},u.add=function(e,n,r){return t.typeOf.object("left",e),t.typeOf.object("right",n),t.typeOf.object("result",r),r[0]=e[0]+n[0],r[1]=e[1]+n[1],r[2]=e[2]+n[2],r[3]=e[3]+n[3],r[4]=e[4]+n[4],r[5]=e[5]+n[5],r[6]=e[6]+n[6],r[7]=e[7]+n[7],r[8]=e[8]+n[8],r},u.subtract=function(e,n,r){return t.typeOf.object("left",e),t.typeOf.object("right",n),t.typeOf.object("result",r),r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],r[3]=e[3]-n[3],r[4]=e[4]-n[4],r[5]=e[5]-n[5],r[6]=e[6]-n[6],r[7]=e[7]-n[7],r[8]=e[8]-n[8],r},u.multiplyByVector=function(e,n,r){t.typeOf.object("matrix",e),t.typeOf.object("cartesian",n),t.typeOf.object("result",r);var i=n.x,a=n.y,o=n.z,s=e[0]*i+e[3]*a+e[6]*o,u=e[1]*i+e[4]*a+e[7]*o,c=e[2]*i+e[5]*a+e[8]*o;return r.x=s,r.y=u,r.z=c,r},u.multiplyByScalar=function(e,n,r){return t.typeOf.object("matrix",e),t.typeOf.number("scalar",n),t.typeOf.object("result",r),r[0]=e[0]*n,r[1]=e[1]*n,r[2]=e[2]*n,r[3]=e[3]*n,r[4]=e[4]*n,r[5]=e[5]*n,r[6]=e[6]*n,r[7]=e[7]*n,r[8]=e[8]*n,r},u.multiplyByScale=function(e,n,r){return t.typeOf.object("matrix",e),t.typeOf.object("scale",n),t.typeOf.object("result",r),r[0]=e[0]*n.x,r[1]=e[1]*n.x,r[2]=e[2]*n.x,r[3]=e[3]*n.y,r[4]=e[4]*n.y,r[5]=e[5]*n.y,r[6]=e[6]*n.z,r[7]=e[7]*n.z,r[8]=e[8]*n.z,r},u.negate=function(e,n){return t.typeOf.object("matrix",e),t.typeOf.object("result",n),n[0]=-e[0],n[1]=-e[1],n[2]=-e[2],n[3]=-e[3],n[4]=-e[4],n[5]=-e[5],n[6]=-e[6],n[7]=-e[7],n[8]=-e[8],n},u.transpose=function(e,n){t.typeOf.object("matrix",e),t.typeOf.object("result",n);var r=e[0],i=e[3],a=e[6],o=e[1],s=e[4],u=e[7],c=e[2],l=e[5],f=e[8];return n[0]=r,n[1]=i,n[2]=a,n[3]=o,n[4]=s,n[5]=u,n[6]=c,n[7]=l,n[8]=f,n};var p=[1,0,0],m=[2,2,1],_=new u,y=new u;return u.computeEigenDecomposition=function(e,n){t.typeOf.object("matrix",e);var i=s.EPSILON20,a=0,o=0;r(n)||(n={});for(var d=n.unitary=u.clone(u.IDENTITY,n.unitary),h=n.diagonal=u.clone(e,n.diagonal),p=i*c(h);o<10&&l(h)>p;)f(h,_),u.transpose(_,y),u.multiply(h,_,h),u.multiply(y,h,h),u.multiply(d,_,d),++a>2&&(++o,a=0);return n},u.abs=function(e,n){return t.typeOf.object("matrix",e),t.typeOf.object("result",n),n[0]=Math.abs(e[0]),n[1]=Math.abs(e[1]),n[2]=Math.abs(e[2]),n[3]=Math.abs(e[3]),n[4]=Math.abs(e[4]),n[5]=Math.abs(e[5]),n[6]=Math.abs(e[6]),n[7]=Math.abs(e[7]),n[8]=Math.abs(e[8]),n},u.determinant=function(e){t.typeOf.object("matrix",e);var n=e[0],r=e[3],i=e[6],a=e[1],o=e[4],s=e[7],u=e[2],c=e[5],l=e[8];return n*(o*l-c*s)+a*(c*i-r*l)+u*(r*s-o*i)},u.inverse=function(e,n){t.typeOf.object("matrix",e),t.typeOf.object("result",n);var r=e[0],i=e[1],o=e[2],c=e[3],l=e[4],f=e[5],d=e[6],h=e[7],p=e[8],m=u.determinant(e);if(Math.abs(m)<=s.EPSILON15)throw new a("matrix is not invertible");n[0]=l*p-h*f,n[1]=h*o-i*p,n[2]=i*f-l*o,n[3]=d*f-c*p,n[4]=r*p-d*o,n[5]=c*o-r*f,n[6]=c*h-d*l,n[7]=d*i-r*h,n[8]=r*l-c*i;var _=1/m;return u.multiplyByScalar(n,_,n)},u.equals=function(e,t){return e===t||r(e)&&r(t)&&e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]},u.equalsEpsilon=function(e,n,i){return t.typeOf.number("epsilon",i),e===n||r(e)&&r(n)&&Math.abs(e[0]-n[0])<=i&&Math.abs(e[1]-n[1])<=i&&Math.abs(e[2]-n[2])<=i&&Math.abs(e[3]-n[3])<=i&&Math.abs(e[4]-n[4])<=i&&Math.abs(e[5]-n[5])<=i&&Math.abs(e[6]-n[6])<=i&&Math.abs(e[7]-n[7])<=i&&Math.abs(e[8]-n[8])<=i},u.IDENTITY=o(new u(1,0,0,0,1,0,0,0,1)),u.ZERO=o(new u(0,0,0,0,0,0,0,0,0)),u.COLUMN0ROW0=0,u.COLUMN0ROW1=1,u.COLUMN0ROW2=2,u.COLUMN1ROW0=3,u.COLUMN1ROW1=4,u.COLUMN1ROW2=5,u.COLUMN2ROW0=6,u.COLUMN2ROW1=7,u.COLUMN2ROW2=8,i(u.prototype,{length:{get:function(){return u.packedLength}}}),u.prototype.clone=function(e){return u.clone(this,e)},u.prototype.equals=function(e){return u.equals(this,e)},u.equalsArray=function(e,t,n){return e[0]===t[n]&&e[1]===t[n+1]&&e[2]===t[n+2]&&e[3]===t[n+3]&&e[4]===t[n+4]&&e[5]===t[n+5]&&e[6]===t[n+6]&&e[7]===t[n+7]&&e[8]===t[n+8]},u.prototype.equalsEpsilon=function(e,t){return u.equalsEpsilon(this,e,t)},u.prototype.toString=function(){return"("+this[0]+", "+this[3]+", "+this[6]+")\n("+this[1]+", "+this[4]+", "+this[7]+")\n("+this[2]+", "+this[5]+", "+this[8]+")"},u}),define("Core/Cartesian4",["./Check","./defaultValue","./defined","./DeveloperError","./freezeObject","./Math"],function(e,t,n,r,i,a){"use strict";function o(e,n,r,i){this.x=t(e,0),this.y=t(n,0),this.z=t(r,0),this.w=t(i,0)}o.fromElements=function(e,t,r,i,a){return n(a)?(a.x=e,a.y=t,a.z=r,a.w=i,a):new o(e,t,r,i)},o.fromColor=function(t,r){return e.typeOf.object("color",t),n(r)?(r.x=t.red,r.y=t.green,r.z=t.blue,r.w=t.alpha,r):new o(t.red,t.green,t.blue,t.alpha)},o.clone=function(e,t){if(n(e))return n(t)?(t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t):new o(e.x,e.y,e.z,e.w)},o.packedLength=4,o.pack=function(n,r,i){return e.typeOf.object("value",n),e.defined("array",r),i=t(i,0),r[i++]=n.x,r[i++]=n.y,r[i++]=n.z,r[i]=n.w,r},o.unpack=function(r,i,a){return e.defined("array",r),i=t(i,0),n(a)||(a=new o),a.x=r[i++],a.y=r[i++],a.z=r[i++],a.w=r[i],a},o.packArray=function(t,r){e.defined("array",t);var i=t.length;n(r)?r.length=4*i:r=new Array(4*i);for(var a=0;a<i;++a)o.pack(t[a],r,4*a);return r},o.unpackArray=function(t,r){e.defined("array",t);var i=t.length;n(r)?r.length=i/4:r=new Array(i/4);for(var a=0;a<i;a+=4){var s=a/4;r[s]=o.unpack(t,a,r[s])}return r},o.fromArray=o.unpack,o.maximumComponent=function(t){return e.typeOf.object("cartesian",t),Math.max(t.x,t.y,t.z,t.w)},o.minimumComponent=function(t){return e.typeOf.object("cartesian",t),Math.min(t.x,t.y,t.z,t.w)},o.minimumByComponent=function(t,n,r){return e.typeOf.object("first",t),e.typeOf.object("second",n),e.typeOf.object("result",r),r.x=Math.min(t.x,n.x),r.y=Math.min(t.y,n.y),r.z=Math.min(t.z,n.z),r.w=Math.min(t.w,n.w),r},o.maximumByComponent=function(t,n,r){return e.typeOf.object("first",t),e.typeOf.object("second",n),e.typeOf.object("result",r),r.x=Math.max(t.x,n.x),r.y=Math.max(t.y,n.y),r.z=Math.max(t.z,n.z),r.w=Math.max(t.w,n.w),r},o.magnitudeSquared=function(t){return e.typeOf.object("cartesian",t),t.x*t.x+t.y*t.y+t.z*t.z+t.w*t.w},o.magnitude=function(e){return Math.sqrt(o.magnitudeSquared(e))};var s=new o;o.distance=function(t,n){return e.typeOf.object("left",t),e.typeOf.object("right",n),o.subtract(t,n,s),o.magnitude(s)},o.distanceSquared=function(t,n){return e.typeOf.object("left",t),e.typeOf.object("right",n),o.subtract(t,n,s),o.magnitudeSquared(s)},o.normalize=function(t,n){e.typeOf.object("cartesian",t),e.typeOf.object("result",n);var i=o.magnitude(t);if(n.x=t.x/i,n.y=t.y/i,n.z=t.z/i,n.w=t.w/i,isNaN(n.x)||isNaN(n.y)||isNaN(n.z)||isNaN(n.w))throw new r("normalized result is not a number");return n},o.dot=function(t,n){return e.typeOf.object("left",t),e.typeOf.object("right",n),t.x*n.x+t.y*n.y+t.z*n.z+t.w*n.w},o.multiplyComponents=function(t,n,r){return e.typeOf.object("left",t),e.typeOf.object("right",n),e.typeOf.object("result",r),r.x=t.x*n.x,r.y=t.y*n.y,r.z=t.z*n.z,r.w=t.w*n.w,r},o.divideComponents=function(t,n,r){return e.typeOf.object("left",t),e.typeOf.object("right",n),e.typeOf.object("result",r),r.x=t.x/n.x,r.y=t.y/n.y,r.z=t.z/n.z,r.w=t.w/n.w,r},o.add=function(t,n,r){return e.typeOf.object("left",t),e.typeOf.object("right",n),e.typeOf.object("result",r),r.x=t.x+n.x,r.y=t.y+n.y,r.z=t.z+n.z,r.w=t.w+n.w,r},o.subtract=function(t,n,r){return e.typeOf.object("left",t),e.typeOf.object("right",n),e.typeOf.object("result",r),r.x=t.x-n.x,r.y=t.y-n.y,r.z=t.z-n.z,r.w=t.w-n.w,r},o.multiplyByScalar=function(t,n,r){return e.typeOf.object("cartesian",t),e.typeOf.number("scalar",n),e.typeOf.object("result",r),r.x=t.x*n,r.y=t.y*n,r.z=t.z*n,r.w=t.w*n,r},o.divideByScalar=function(t,n,r){return e.typeOf.object("cartesian",t),e.typeOf.number("scalar",n),e.typeOf.object("result",r),r.x=t.x/n,r.y=t.y/n,r.z=t.z/n,r.w=t.w/n,r},o.negate=function(t,n){return e.typeOf.object("cartesian",t),e.typeOf.object("result",n),n.x=-t.x,n.y=-t.y,n.z=-t.z,n.w=-t.w,n},o.abs=function(t,n){return e.typeOf.object("cartesian",t),e.typeOf.object("result",n),n.x=Math.abs(t.x),n.y=Math.abs(t.y),n.z=Math.abs(t.z),n.w=Math.abs(t.w),n};var u=new o;o.lerp=function(t,n,r,i){return e.typeOf.object("start",t),e.typeOf.object("end",n),e.typeOf.number("t",r),e.typeOf.object("result",i),o.multiplyByScalar(n,r,u),i=o.multiplyByScalar(t,1-r,i),o.add(u,i,i)};var c=new o;o.mostOrthogonalAxis=function(t,n){e.typeOf.object("cartesian",t),e.typeOf.object("result",n);var r=o.normalize(t,c);return o.abs(r,r),n=r.x<=r.y?r.x<=r.z?r.x<=r.w?o.clone(o.UNIT_X,n):o.clone(o.UNIT_W,n):r.z<=r.w?o.clone(o.UNIT_Z,n):o.clone(o.UNIT_W,n):r.y<=r.z?r.y<=r.w?o.clone(o.UNIT_Y,n):o.clone(o.UNIT_W,n):r.z<=r.w?o.clone(o.UNIT_Z,n):o.clone(o.UNIT_W,n)},o.equals=function(e,t){return e===t||n(e)&&n(t)&&e.x===t.x&&e.y===t.y&&e.z===t.z&&e.w===t.w},o.equalsArray=function(e,t,n){return e.x===t[n]&&e.y===t[n+1]&&e.z===t[n+2]&&e.w===t[n+3]},o.equalsEpsilon=function(e,t,r,i){return e===t||n(e)&&n(t)&&a.equalsEpsilon(e.x,t.x,r,i)&&a.equalsEpsilon(e.y,t.y,r,i)&&a.equalsEpsilon(e.z,t.z,r,i)&&a.equalsEpsilon(e.w,t.w,r,i)},o.ZERO=i(new o(0,0,0,0)),o.UNIT_X=i(new o(1,0,0,0)),o.UNIT_Y=i(new o(0,1,0,0)),o.UNIT_Z=i(new o(0,0,1,0)),o.UNIT_W=i(new o(0,0,0,1)),o.prototype.clone=function(e){return o.clone(this,e)},o.prototype.equals=function(e){return o.equals(this,e)},o.prototype.equalsEpsilon=function(e,t,n){return o.equalsEpsilon(this,e,t,n)},o.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.z+", "+this.w+")"};var l=new Float32Array(1);return o.packFloat=function(t,r){if(e.typeOf.number("value",t),n(r)||(r=new o),l[0]=t,0===(t=l[0]))return o.clone(o.ZERO,r);var i,s=t<0?1:0;isFinite(t)?(t=Math.abs(t),i=Math.floor(a.logBase(t,10))+1,t/=Math.pow(10,i)):(t=.1,i=38);var u=256*t;return r.x=Math.floor(u),u=256*(u-r.x),r.y=Math.floor(u),u=256*(u-r.y),r.z=Math.floor(u),r.w=2*(i+38)+s,r},o.unpackFloat=function(t){e.typeOf.object("packedFloat",t);var n=t.w/2,r=Math.floor(n),i=2*(n-r);if(r-=38,i=2*i-1,i=-i,r>=38)return i<0?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY;var a=i*t.x*(1/256);return a+=i*t.y*(1/65536),(a+=i*t.z*(1/16777216))*Math.pow(10,r)},o}),define("Core/Matrix4",["./Cartesian3","./Cartesian4","./Check","./defaultValue","./defined","./defineProperties","./freezeObject","./Math","./Matrix3","./RuntimeError"],function(e,t,n,r,i,a,o,s,u,c){"use strict";function l(e,t,n,i,a,o,s,u,c,l,f,d,h,p,m,_){this[0]=r(e,0),this[1]=r(a,0),this[2]=r(c,0),this[3]=r(h,0),this[4]=r(t,0),this[5]=r(o,0),this[6]=r(l,0),this[7]=r(p,0),this[8]=r(n,0),this[9]=r(s,0),this[10]=r(f,0),this[11]=r(m,0),this[12]=r(i,0),this[13]=r(u,0),this[14]=r(d,0),this[15]=r(_,0)}l.packedLength=16,l.pack=function(e,t,i){return n.typeOf.object("value",e),n.defined("array",t),i=r(i,0),t[i++]=e[0],t[i++]=e[1],t[i++]=e[2],t[i++]=e[3],t[i++]=e[4],t[i++]=e[5],t[i++]=e[6],t[i++]=e[7],t[i++]=e[8],t[i++]=e[9],t[i++]=e[10],t[i++]=e[11],t[i++]=e[12],t[i++]=e[13],t[i++]=e[14],t[i]=e[15],t},l.unpack=function(e,t,a){return n.defined("array",e),t=r(t,0),i(a)||(a=new l),a[0]=e[t++],a[1]=e[t++],a[2]=e[t++],a[3]=e[t++],a[4]=e[t++],a[5]=e[t++],a[6]=e[t++],a[7]=e[t++],a[8]=e[t++],a[9]=e[t++],a[10]=e[t++],a[11]=e[t++],a[12]=e[t++],a[13]=e[t++],a[14]=e[t++],a[15]=e[t],a},l.clone=function(e,t){if(i(e))return i(t)?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t):new l(e[0],e[4],e[8],e[12],e[1],e[5],e[9],e[13],e[2],e[6],e[10],e[14],e[3],e[7],e[11],e[15])},l.fromArray=l.unpack,l.fromColumnMajorArray=function(e,t){return n.defined("values",e),l.clone(e,t)},l.fromRowMajorArray=function(e,t){return n.defined("values",e),i(t)?(t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15],t):new l(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])},l.fromRotationTranslation=function(t,a,o){return n.typeOf.object("rotation",t),a=r(a,e.ZERO),i(o)?(o[0]=t[0],o[1]=t[1],o[2]=t[2],o[3]=0,o[4]=t[3],o[5]=t[4],o[6]=t[5],o[7]=0,o[8]=t[6],o[9]=t[7],o[10]=t[8],o[11]=0,o[12]=a.x,o[13]=a.y,o[14]=a.z,o[15]=1,o):new l(t[0],t[3],t[6],a.x,t[1],t[4],t[7],a.y,t[2],t[5],t[8],a.z,0,0,0,1)},l.fromTranslationQuaternionRotationScale=function(e,t,r,a){n.typeOf.object("translation",e),n.typeOf.object("rotation",t),n.typeOf.object("scale",r),i(a)||(a=new l);var o=r.x,s=r.y,u=r.z,c=t.x*t.x,f=t.x*t.y,d=t.x*t.z,h=t.x*t.w,p=t.y*t.y,m=t.y*t.z,_=t.y*t.w,y=t.z*t.z,v=t.z*t.w,g=t.w*t.w,E=c-p-y+g,T=2*(f-v),w=2*(d+_),b=2*(f+v),S=-c+p-y+g,C=2*(m-h),O=2*(d-_),A=2*(m+h),x=-c-p+y+g;return a[0]=E*o,a[1]=b*o,a[2]=O*o,a[3]=0,a[4]=T*s,a[5]=S*s,a[6]=A*s,a[7]=0,a[8]=w*u,a[9]=C*u,a[10]=x*u,a[11]=0,a[12]=e.x,a[13]=e.y,a[14]=e.z,a[15]=1,a},l.fromTranslationRotationScale=function(e,t){return n.typeOf.object("translationRotationScale",e),l.fromTranslationQuaternionRotationScale(e.translation,e.rotation,e.scale,t)},l.fromTranslation=function(e,t){return n.typeOf.object("translation",e),l.fromRotationTranslation(u.IDENTITY,e,t)},l.fromScale=function(e,t){return n.typeOf.object("scale",e),i(t)?(t[0]=e.x,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e.y,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e.z,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t):new l(e.x,0,0,0,0,e.y,0,0,0,0,e.z,0,0,0,0,1)},l.fromUniformScale=function(e,t){return n.typeOf.number("scale",e),i(t)?(t[0]=e,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t):new l(e,0,0,0,0,e,0,0,0,0,e,0,0,0,0,1)};var f=new e,d=new e,h=new e;l.fromCamera=function(t,r){n.typeOf.object("camera",t);var a=t.position,o=t.direction,s=t.up;n.typeOf.object("camera.position",a),n.typeOf.object("camera.direction",o),n.typeOf.object("camera.up",s),e.normalize(o,f),e.normalize(e.cross(f,s,d),d),e.normalize(e.cross(d,f,h),h);var u=d.x,c=d.y,p=d.z,m=f.x,_=f.y,y=f.z,v=h.x,g=h.y,E=h.z,T=a.x,w=a.y,b=a.z,S=u*-T+c*-w+p*-b,C=v*-T+g*-w+E*-b,O=m*T+_*w+y*b;return i(r)?(r[0]=u,r[1]=v,r[2]=-m,r[3]=0,r[4]=c,r[5]=g,r[6]=-_,r[7]=0,r[8]=p,r[9]=E,r[10]=-y,r[11]=0,r[12]=S,r[13]=C,r[14]=O,r[15]=1,r):new l(u,c,p,S,v,g,E,C,-m,-_,-y,O,0,0,0,1)},l.computePerspectiveFieldOfView=function(e,t,r,i,a){n.typeOf.number.greaterThan("fovY",e,0),n.typeOf.number.lessThan("fovY",e,Math.PI),n.typeOf.number.greaterThan("near",r,0),n.typeOf.number.greaterThan("far",i,0),n.typeOf.object("result",a);var o=Math.tan(.5*e),s=1/o,u=s/t,c=(i+r)/(r-i),l=2*i*r/(r-i);return a[0]=u,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=s,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=c,a[11]=-1,a[12]=0,a[13]=0,a[14]=l,a[15]=0,a},l.computeOrthographicOffCenter=function(e,t,r,i,a,o,s){n.typeOf.number("left",e),n.typeOf.number("right",t),n.typeOf.number("bottom",r),n.typeOf.number("top",i),n.typeOf.number("near",a),n.typeOf.number("far",o),n.typeOf.object("result",s);var u=1/(t-e),c=1/(i-r),l=1/(o-a),f=-(t+e)*u,d=-(i+r)*c,h=-(o+a)*l;return u*=2,c*=2,l*=-2,s[0]=u,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=c,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=l,s[11]=0,s[12]=f,s[13]=d,s[14]=h,s[15]=1,s},l.computePerspectiveOffCenter=function(e,t,r,i,a,o,s){n.typeOf.number("left",e),n.typeOf.number("right",t),n.typeOf.number("bottom",r),n.typeOf.number("top",i),n.typeOf.number("near",a),n.typeOf.number("far",o),n.typeOf.object("result",s);var u=2*a/(t-e),c=2*a/(i-r),l=(t+e)/(t-e),f=(i+r)/(i-r),d=-(o+a)/(o-a),h=-2*o*a/(o-a);return s[0]=u,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=c,s[6]=0,s[7]=0,s[8]=l,s[9]=f,s[10]=d,s[11]=-1,s[12]=0,s[13]=0,s[14]=h,s[15]=0,s},l.computeInfinitePerspectiveOffCenter=function(e,t,r,i,a,o){n.typeOf.number("left",e),n.typeOf.number("right",t),n.typeOf.number("bottom",r),n.typeOf.number("top",i),n.typeOf.number("near",a),n.typeOf.object("result",o);var s=2*a/(t-e),u=2*a/(i-r),c=(t+e)/(t-e),l=(i+r)/(i-r),f=-2*a;return o[0]=s,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=u,o[6]=0,o[7]=0,o[8]=c,o[9]=l,o[10]=-1,o[11]=-1,o[12]=0,o[13]=0,o[14]=f,o[15]=0,o},l.computeViewportTransformation=function(e,t,i,a){n.typeOf.object("result",a),e=r(e,r.EMPTY_OBJECT);var o=r(e.x,0),s=r(e.y,0),u=r(e.width,0),c=r(e.height,0);t=r(t,0),i=r(i,1);var l=.5*u,f=.5*c,d=.5*(i-t),h=l,p=f,m=d,_=o+l,y=s+f,v=t+d;return a[0]=h,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=p,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=m,a[11]=0,a[12]=_,a[13]=y,a[14]=v,a[15]=1,a},l.computeView=function(t,r,i,a,o){return n.typeOf.object("position",t),n.typeOf.object("direction",r),n.typeOf.object("up",i),n.typeOf.object("right",a),n.typeOf.object("result",o),o[0]=a.x,o[1]=i.x,o[2]=-r.x,o[3]=0,o[4]=a.y,o[5]=i.y,o[6]=-r.y,o[7]=0,o[8]=a.z,o[9]=i.z,o[10]=-r.z,o[11]=0,o[12]=-e.dot(a,t),o[13]=-e.dot(i,t),o[14]=e.dot(r,t),o[15]=1,o},l.toArray=function(e,t){return n.typeOf.object("matrix",e),i(t)?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t):[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15]]},l.getElementIndex=function(e,t){return n.typeOf.number.greaterThanOrEquals("row",t,0),n.typeOf.number.lessThanOrEquals("row",t,3),n.typeOf.number.greaterThanOrEquals("column",e,0),n.typeOf.number.lessThanOrEquals("column",e,3),4*e+t},l.getColumn=function(e,t,r){n.typeOf.object("matrix",e),n.typeOf.number.greaterThanOrEquals("index",t,0),n.typeOf.number.lessThanOrEquals("index",t,3),n.typeOf.object("result",r);var i=4*t,a=e[i],o=e[i+1],s=e[i+2],u=e[i+3];return r.x=a,r.y=o,r.z=s,r.w=u,r},l.setColumn=function(e,t,r,i){n.typeOf.object("matrix",e),n.typeOf.number.greaterThanOrEquals("index",t,0),n.typeOf.number.lessThanOrEquals("index",t,3),n.typeOf.object("cartesian",r),n.typeOf.object("result",i),i=l.clone(e,i);var a=4*t;return i[a]=r.x,i[a+1]=r.y,i[a+2]=r.z,i[a+3]=r.w,i},l.setTranslation=function(e,t,r){return n.typeOf.object("matrix",e),n.typeOf.object("translation",t),n.typeOf.object("result",r),r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=e[11],r[12]=t.x,r[13]=t.y,r[14]=t.z,r[15]=e[15],r},l.getRow=function(e,t,r){n.typeOf.object("matrix",e),n.typeOf.number.greaterThanOrEquals("index",t,0),n.typeOf.number.lessThanOrEquals("index",t,3),n.typeOf.object("result",r);var i=e[t],a=e[t+4],o=e[t+8],s=e[t+12];return r.x=i,r.y=a,r.z=o,r.w=s,r},l.setRow=function(e,t,r,i){return n.typeOf.object("matrix",e),n.typeOf.number.greaterThanOrEquals("index",t,0),n.typeOf.number.lessThanOrEquals("index",t,3),n.typeOf.object("cartesian",r),n.typeOf.object("result",i),i=l.clone(e,i),i[t]=r.x,i[t+4]=r.y,i[t+8]=r.z,i[t+12]=r.w,i};var p=new e;l.getScale=function(t,r){return n.typeOf.object("matrix",t),n.typeOf.object("result",r),r.x=e.magnitude(e.fromElements(t[0],t[1],t[2],p)),r.y=e.magnitude(e.fromElements(t[4],t[5],t[6],p)),r.z=e.magnitude(e.fromElements(t[8],t[9],t[10],p)),r};var m=new e;l.getMaximumScale=function(t){return l.getScale(t,m),e.maximumComponent(m)},l.multiply=function(e,t,r){n.typeOf.object("left",e),n.typeOf.object("right",t),n.typeOf.object("result",r);var i=e[0],a=e[1],o=e[2],s=e[3],u=e[4],c=e[5],l=e[6],f=e[7],d=e[8],h=e[9],p=e[10],m=e[11],_=e[12],y=e[13],v=e[14],g=e[15],E=t[0],T=t[1],w=t[2],b=t[3],S=t[4],C=t[5],O=t[6],A=t[7],x=t[8],R=t[9],I=t[10],D=t[11],P=t[12],N=t[13],M=t[14],z=t[15],F=i*E+u*T+d*w+_*b,L=a*E+c*T+h*w+y*b,B=o*E+l*T+p*w+v*b,U=s*E+f*T+m*w+g*b,q=i*S+u*C+d*O+_*A,G=a*S+c*C+h*O+y*A,V=o*S+l*C+p*O+v*A,j=s*S+f*C+m*O+g*A,k=i*x+u*R+d*I+_*D,H=a*x+c*R+h*I+y*D,W=o*x+l*R+p*I+v*D,Y=s*x+f*R+m*I+g*D,X=i*P+u*N+d*M+_*z,Z=a*P+c*N+h*M+y*z,K=o*P+l*N+p*M+v*z,Q=s*P+f*N+m*M+g*z;return r[0]=F,r[1]=L,r[2]=B,r[3]=U,r[4]=q,r[5]=G,r[6]=V,r[7]=j,r[8]=k,r[9]=H,r[10]=W,r[11]=Y,r[12]=X,r[13]=Z,r[14]=K,r[15]=Q,r},l.add=function(e,t,r){return n.typeOf.object("left",e),n.typeOf.object("right",t),n.typeOf.object("result",r),r[0]=e[0]+t[0],r[1]=e[1]+t[1],r[2]=e[2]+t[2],r[3]=e[3]+t[3],r[4]=e[4]+t[4],r[5]=e[5]+t[5],r[6]=e[6]+t[6],r[7]=e[7]+t[7],r[8]=e[8]+t[8],r[9]=e[9]+t[9],r[10]=e[10]+t[10],r[11]=e[11]+t[11],r[12]=e[12]+t[12],r[13]=e[13]+t[13],r[14]=e[14]+t[14],r[15]=e[15]+t[15],r},l.subtract=function(e,t,r){return n.typeOf.object("left",e),n.typeOf.object("right",t),n.typeOf.object("result",r),r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],r[3]=e[3]-t[3],r[4]=e[4]-t[4],r[5]=e[5]-t[5],r[6]=e[6]-t[6],r[7]=e[7]-t[7],r[8]=e[8]-t[8],r[9]=e[9]-t[9],r[10]=e[10]-t[10],r[11]=e[11]-t[11],r[12]=e[12]-t[12],r[13]=e[13]-t[13],r[14]=e[14]-t[14],r[15]=e[15]-t[15],r},l.multiplyTransformation=function(e,t,r){n.typeOf.object("left",e),n.typeOf.object("right",t),n.typeOf.object("result",r);var i=e[0],a=e[1],o=e[2],s=e[4],u=e[5],c=e[6],l=e[8],f=e[9],d=e[10],h=e[12],p=e[13],m=e[14],_=t[0],y=t[1],v=t[2],g=t[4],E=t[5],T=t[6],w=t[8],b=t[9],S=t[10],C=t[12],O=t[13],A=t[14],x=i*_+s*y+l*v,R=a*_+u*y+f*v,I=o*_+c*y+d*v,D=i*g+s*E+l*T,P=a*g+u*E+f*T,N=o*g+c*E+d*T,M=i*w+s*b+l*S,z=a*w+u*b+f*S,F=o*w+c*b+d*S,L=i*C+s*O+l*A+h,B=a*C+u*O+f*A+p,U=o*C+c*O+d*A+m;return r[0]=x,r[1]=R,r[2]=I,r[3]=0,r[4]=D,r[5]=P,r[6]=N,r[7]=0,r[8]=M,r[9]=z,r[10]=F,r[11]=0,r[12]=L,r[13]=B,r[14]=U,r[15]=1,r},l.multiplyByMatrix3=function(e,t,r){n.typeOf.object("matrix",e),n.typeOf.object("rotation",t),n.typeOf.object("result",r);var i=e[0],a=e[1],o=e[2],s=e[4],u=e[5],c=e[6],l=e[8],f=e[9],d=e[10],h=t[0],p=t[1],m=t[2],_=t[3],y=t[4],v=t[5],g=t[6],E=t[7],T=t[8],w=i*h+s*p+l*m,b=a*h+u*p+f*m,S=o*h+c*p+d*m,C=i*_+s*y+l*v,O=a*_+u*y+f*v,A=o*_+c*y+d*v,x=i*g+s*E+l*T,R=a*g+u*E+f*T,I=o*g+c*E+d*T;return r[0]=w,r[1]=b,r[2]=S,r[3]=0,r[4]=C,r[5]=O,r[6]=A,r[7]=0,r[8]=x,r[9]=R,r[10]=I,r[11]=0,r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15],r},l.multiplyByTranslation=function(e,t,r){n.typeOf.object("matrix",e),n.typeOf.object("translation",t),n.typeOf.object("result",r);var i=t.x,a=t.y,o=t.z,s=i*e[0]+a*e[4]+o*e[8]+e[12],u=i*e[1]+a*e[5]+o*e[9]+e[13],c=i*e[2]+a*e[6]+o*e[10]+e[14];return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=e[11],r[12]=s,r[13]=u,r[14]=c,r[15]=e[15],r};var _=new e;l.multiplyByUniformScale=function(e,t,r){return n.typeOf.object("matrix",e),n.typeOf.number("scale",t),n.typeOf.object("result",r),_.x=t,_.y=t,_.z=t,l.multiplyByScale(e,_,r)},l.multiplyByScale=function(e,t,r){n.typeOf.object("matrix",e),n.typeOf.object("scale",t),n.typeOf.object("result",r);var i=t.x,a=t.y,o=t.z;return 1===i&&1===a&&1===o?l.clone(e,r):(r[0]=i*e[0],r[1]=i*e[1],r[2]=i*e[2],r[3]=0,r[4]=a*e[4],r[5]=a*e[5],r[6]=a*e[6],r[7]=0,r[8]=o*e[8],r[9]=o*e[9],r[10]=o*e[10],r[11]=0,r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=1,r)},l.multiplyByVector=function(e,t,r){n.typeOf.object("matrix",e),n.typeOf.object("cartesian",t),n.typeOf.object("result",r);var i=t.x,a=t.y,o=t.z,s=t.w,u=e[0]*i+e[4]*a+e[8]*o+e[12]*s,c=e[1]*i+e[5]*a+e[9]*o+e[13]*s,l=e[2]*i+e[6]*a+e[10]*o+e[14]*s,f=e[3]*i+e[7]*a+e[11]*o+e[15]*s;return r.x=u,r.y=c,r.z=l,r.w=f,r},l.multiplyByPointAsVector=function(e,t,r){n.typeOf.object("matrix",e),n.typeOf.object("cartesian",t),n.typeOf.object("result",r);var i=t.x,a=t.y,o=t.z,s=e[0]*i+e[4]*a+e[8]*o,u=e[1]*i+e[5]*a+e[9]*o,c=e[2]*i+e[6]*a+e[10]*o;return r.x=s,r.y=u,r.z=c,r},l.multiplyByPoint=function(e,t,r){n.typeOf.object("matrix",e),n.typeOf.object("cartesian",t),n.typeOf.object("result",r);var i=t.x,a=t.y,o=t.z,s=e[0]*i+e[4]*a+e[8]*o+e[12],u=e[1]*i+e[5]*a+e[9]*o+e[13],c=e[2]*i+e[6]*a+e[10]*o+e[14];return r.x=s,r.y=u,r.z=c,r},l.multiplyByScalar=function(e,t,r){return n.typeOf.object("matrix",e),n.typeOf.number("scalar",t),n.typeOf.object("result",r),r[0]=e[0]*t,r[1]=e[1]*t,r[2]=e[2]*t,r[3]=e[3]*t,r[4]=e[4]*t,r[5]=e[5]*t,r[6]=e[6]*t,r[7]=e[7]*t,r[8]=e[8]*t,r[9]=e[9]*t,r[10]=e[10]*t,r[11]=e[11]*t,r[12]=e[12]*t,r[13]=e[13]*t,r[14]=e[14]*t,r[15]=e[15]*t,r},l.negate=function(e,t){return n.typeOf.object("matrix",e),n.typeOf.object("result",t),t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t[4]=-e[4],t[5]=-e[5],t[6]=-e[6],t[7]=-e[7],t[8]=-e[8],t[9]=-e[9],t[10]=-e[10],t[11]=-e[11],t[12]=-e[12],t[13]=-e[13],t[14]=-e[14],t[15]=-e[15],t},l.transpose=function(e,t){n.typeOf.object("matrix",e),n.typeOf.object("result",t);var r=e[1],i=e[2],a=e[3],o=e[6],s=e[7],u=e[11];return t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=r,t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=i,t[9]=o,t[10]=e[10],t[11]=e[14],t[12]=a,t[13]=s,t[14]=u,t[15]=e[15],t},l.abs=function(e,t){return n.typeOf.object("matrix",e),n.typeOf.object("result",t),t[0]=Math.abs(e[0]),t[1]=Math.abs(e[1]),t[2]=Math.abs(e[2]),t[3]=Math.abs(e[3]),t[4]=Math.abs(e[4]),t[5]=Math.abs(e[5]),t[6]=Math.abs(e[6]),t[7]=Math.abs(e[7]),t[8]=Math.abs(e[8]),t[9]=Math.abs(e[9]),t[10]=Math.abs(e[10]),t[11]=Math.abs(e[11]),t[12]=Math.abs(e[12]),t[13]=Math.abs(e[13]),t[14]=Math.abs(e[14]),t[15]=Math.abs(e[15]),t},l.equals=function(e,t){return e===t||i(e)&&i(t)&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[3]===t[3]&&e[7]===t[7]&&e[11]===t[11]&&e[15]===t[15]},l.equalsEpsilon=function(e,t,r){return n.typeOf.number("epsilon",r),
e===t||i(e)&&i(t)&&Math.abs(e[0]-t[0])<=r&&Math.abs(e[1]-t[1])<=r&&Math.abs(e[2]-t[2])<=r&&Math.abs(e[3]-t[3])<=r&&Math.abs(e[4]-t[4])<=r&&Math.abs(e[5]-t[5])<=r&&Math.abs(e[6]-t[6])<=r&&Math.abs(e[7]-t[7])<=r&&Math.abs(e[8]-t[8])<=r&&Math.abs(e[9]-t[9])<=r&&Math.abs(e[10]-t[10])<=r&&Math.abs(e[11]-t[11])<=r&&Math.abs(e[12]-t[12])<=r&&Math.abs(e[13]-t[13])<=r&&Math.abs(e[14]-t[14])<=r&&Math.abs(e[15]-t[15])<=r},l.getTranslation=function(e,t){return n.typeOf.object("matrix",e),n.typeOf.object("result",t),t.x=e[12],t.y=e[13],t.z=e[14],t},l.getRotation=function(e,t){return n.typeOf.object("matrix",e),n.typeOf.object("result",t),t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t};var y=new u,v=new u,g=new t,E=new t(0,0,0,1);return l.inverse=function(e,r){if(n.typeOf.object("matrix",e),n.typeOf.object("result",r),u.equalsEpsilon(l.getRotation(e,y),v,s.EPSILON7)&&t.equals(l.getRow(e,3,g),E))return r[0]=0,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=0,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=0,r[11]=0,r[12]=-e[12],r[13]=-e[13],r[14]=-e[14],r[15]=1,r;var i=e[0],a=e[4],o=e[8],f=e[12],d=e[1],h=e[5],p=e[9],m=e[13],_=e[2],T=e[6],w=e[10],b=e[14],S=e[3],C=e[7],O=e[11],A=e[15],x=w*A,R=b*O,I=T*A,D=b*C,P=T*O,N=w*C,M=_*A,z=b*S,F=_*O,L=w*S,B=_*C,U=T*S,q=x*h+D*p+P*m-(R*h+I*p+N*m),G=R*d+M*p+L*m-(x*d+z*p+F*m),V=I*d+z*h+B*m-(D*d+M*h+U*m),j=N*d+F*h+U*p-(P*d+L*h+B*p),k=R*a+I*o+N*f-(x*a+D*o+P*f),H=x*i+z*o+F*f-(R*i+M*o+L*f),W=D*i+M*a+U*f-(I*i+z*a+B*f),Y=P*i+L*a+B*o-(N*i+F*a+U*o);x=o*m,R=f*p,I=a*m,D=f*h,P=a*p,N=o*h,M=i*m,z=f*d,F=i*p,L=o*d,B=i*h,U=a*d;var X=x*C+D*O+P*A-(R*C+I*O+N*A),Z=R*S+M*O+L*A-(x*S+z*O+F*A),K=I*S+z*C+B*A-(D*S+M*C+U*A),Q=N*S+F*C+U*O-(P*S+L*C+B*O),J=I*w+N*b+R*T-(P*b+x*T+D*w),$=F*b+x*_+z*w-(M*w+L*b+R*_),ee=M*T+U*b+D*_-(B*b+I*_+z*T),te=B*w+P*_+L*T-(F*T+U*w+N*_),ne=i*q+a*G+o*V+f*j;if(Math.abs(ne)<s.EPSILON20)throw new c("matrix is not invertible because its determinate is zero.");return ne=1/ne,r[0]=q*ne,r[1]=G*ne,r[2]=V*ne,r[3]=j*ne,r[4]=k*ne,r[5]=H*ne,r[6]=W*ne,r[7]=Y*ne,r[8]=X*ne,r[9]=Z*ne,r[10]=K*ne,r[11]=Q*ne,r[12]=J*ne,r[13]=$*ne,r[14]=ee*ne,r[15]=te*ne,r},l.inverseTransformation=function(e,t){n.typeOf.object("matrix",e),n.typeOf.object("result",t);var r=e[0],i=e[1],a=e[2],o=e[4],s=e[5],u=e[6],c=e[8],l=e[9],f=e[10],d=e[12],h=e[13],p=e[14],m=-r*d-i*h-a*p,_=-o*d-s*h-u*p,y=-c*d-l*h-f*p;return t[0]=r,t[1]=o,t[2]=c,t[3]=0,t[4]=i,t[5]=s,t[6]=l,t[7]=0,t[8]=a,t[9]=u,t[10]=f,t[11]=0,t[12]=m,t[13]=_,t[14]=y,t[15]=1,t},l.IDENTITY=o(new l(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)),l.ZERO=o(new l(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)),l.COLUMN0ROW0=0,l.COLUMN0ROW1=1,l.COLUMN0ROW2=2,l.COLUMN0ROW3=3,l.COLUMN1ROW0=4,l.COLUMN1ROW1=5,l.COLUMN1ROW2=6,l.COLUMN1ROW3=7,l.COLUMN2ROW0=8,l.COLUMN2ROW1=9,l.COLUMN2ROW2=10,l.COLUMN2ROW3=11,l.COLUMN3ROW0=12,l.COLUMN3ROW1=13,l.COLUMN3ROW2=14,l.COLUMN3ROW3=15,a(l.prototype,{length:{get:function(){return l.packedLength}}}),l.prototype.clone=function(e){return l.clone(this,e)},l.prototype.equals=function(e){return l.equals(this,e)},l.equalsArray=function(e,t,n){return e[0]===t[n]&&e[1]===t[n+1]&&e[2]===t[n+2]&&e[3]===t[n+3]&&e[4]===t[n+4]&&e[5]===t[n+5]&&e[6]===t[n+6]&&e[7]===t[n+7]&&e[8]===t[n+8]&&e[9]===t[n+9]&&e[10]===t[n+10]&&e[11]===t[n+11]&&e[12]===t[n+12]&&e[13]===t[n+13]&&e[14]===t[n+14]&&e[15]===t[n+15]},l.prototype.equalsEpsilon=function(e,t){return l.equalsEpsilon(this,e,t)},l.prototype.toString=function(){return"("+this[0]+", "+this[4]+", "+this[8]+", "+this[12]+")\n("+this[1]+", "+this[5]+", "+this[9]+", "+this[13]+")\n("+this[2]+", "+this[6]+", "+this[10]+", "+this[14]+")\n("+this[3]+", "+this[7]+", "+this[11]+", "+this[15]+")"},l}),define("Core/Rectangle",["./Cartographic","./Check","./defaultValue","./defined","./defineProperties","./Ellipsoid","./freezeObject","./Math"],function(e,t,n,r,i,a,o,s){"use strict";function u(e,t,r,i){this.west=n(e,0),this.south=n(t,0),this.east=n(r,0),this.north=n(i,0)}i(u.prototype,{width:{get:function(){return u.computeWidth(this)}},height:{get:function(){return u.computeHeight(this)}}}),u.packedLength=4,u.pack=function(e,r,i){return t.typeOf.object("value",e),t.defined("array",r),i=n(i,0),r[i++]=e.west,r[i++]=e.south,r[i++]=e.east,r[i]=e.north,r},u.unpack=function(e,i,a){return t.defined("array",e),i=n(i,0),r(a)||(a=new u),a.west=e[i++],a.south=e[i++],a.east=e[i++],a.north=e[i],a},u.computeWidth=function(e){t.typeOf.object("rectangle",e);var n=e.east,r=e.west;return n<r&&(n+=s.TWO_PI),n-r},u.computeHeight=function(e){return t.typeOf.object("rectangle",e),e.north-e.south},u.fromDegrees=function(e,t,i,a,o){return e=s.toRadians(n(e,0)),t=s.toRadians(n(t,0)),i=s.toRadians(n(i,0)),a=s.toRadians(n(a,0)),r(o)?(o.west=e,o.south=t,o.east=i,o.north=a,o):new u(e,t,i,a)},u.fromRadians=function(e,t,i,a,o){return r(o)?(o.west=n(e,0),o.south=n(t,0),o.east=n(i,0),o.north=n(a,0),o):new u(e,t,i,a)},u.fromCartographicArray=function(e,n){t.defined("cartographics",e);for(var i=Number.MAX_VALUE,a=-Number.MAX_VALUE,o=Number.MAX_VALUE,c=-Number.MAX_VALUE,l=Number.MAX_VALUE,f=-Number.MAX_VALUE,d=0,h=e.length;d<h;d++){var p=e[d];i=Math.min(i,p.longitude),a=Math.max(a,p.longitude),l=Math.min(l,p.latitude),f=Math.max(f,p.latitude);var m=p.longitude>=0?p.longitude:p.longitude+s.TWO_PI;o=Math.min(o,m),c=Math.max(c,m)}return a-i>c-o&&(i=o,a=c,a>s.PI&&(a-=s.TWO_PI),i>s.PI&&(i-=s.TWO_PI)),r(n)?(n.west=i,n.south=l,n.east=a,n.north=f,n):new u(i,l,a,f)},u.fromCartesianArray=function(e,i,o){t.defined("cartesians",e),i=n(i,a.WGS84);for(var c=Number.MAX_VALUE,l=-Number.MAX_VALUE,f=Number.MAX_VALUE,d=-Number.MAX_VALUE,h=Number.MAX_VALUE,p=-Number.MAX_VALUE,m=0,_=e.length;m<_;m++){var y=i.cartesianToCartographic(e[m]);c=Math.min(c,y.longitude),l=Math.max(l,y.longitude),h=Math.min(h,y.latitude),p=Math.max(p,y.latitude);var v=y.longitude>=0?y.longitude:y.longitude+s.TWO_PI;f=Math.min(f,v),d=Math.max(d,v)}return l-c>d-f&&(c=f,l=d,l>s.PI&&(l-=s.TWO_PI),c>s.PI&&(c-=s.TWO_PI)),r(o)?(o.west=c,o.south=h,o.east=l,o.north=p,o):new u(c,h,l,p)},u.clone=function(e,t){if(r(e))return r(t)?(t.west=e.west,t.south=e.south,t.east=e.east,t.north=e.north,t):new u(e.west,e.south,e.east,e.north)},u.equalsEpsilon=function(e,n,i){return t.typeOf.number("absoluteEpsilon",i),e===n||r(e)&&r(n)&&Math.abs(e.west-n.west)<=i&&Math.abs(e.south-n.south)<=i&&Math.abs(e.east-n.east)<=i&&Math.abs(e.north-n.north)<=i},u.prototype.clone=function(e){return u.clone(this,e)},u.prototype.equals=function(e){return u.equals(this,e)},u.equals=function(e,t){return e===t||r(e)&&r(t)&&e.west===t.west&&e.south===t.south&&e.east===t.east&&e.north===t.north},u.prototype.equalsEpsilon=function(e,n){return t.typeOf.number("epsilon",n),u.equalsEpsilon(this,e,n)},u.validate=function(e){t.typeOf.object("rectangle",e);var n=e.north;t.typeOf.number.greaterThanOrEquals("north",n,-s.PI_OVER_TWO),t.typeOf.number.lessThanOrEquals("north",n,s.PI_OVER_TWO);var r=e.south;t.typeOf.number.greaterThanOrEquals("south",r,-s.PI_OVER_TWO),t.typeOf.number.lessThanOrEquals("south",r,s.PI_OVER_TWO);var i=e.west;t.typeOf.number.greaterThanOrEquals("west",i,-Math.PI),t.typeOf.number.lessThanOrEquals("west",i,Math.PI);var a=e.east;t.typeOf.number.greaterThanOrEquals("east",a,-Math.PI),t.typeOf.number.lessThanOrEquals("east",a,Math.PI)},u.southwest=function(n,i){return t.typeOf.object("rectangle",n),r(i)?(i.longitude=n.west,i.latitude=n.south,i.height=0,i):new e(n.west,n.south)},u.northwest=function(n,i){return t.typeOf.object("rectangle",n),r(i)?(i.longitude=n.west,i.latitude=n.north,i.height=0,i):new e(n.west,n.north)},u.northeast=function(n,i){return t.typeOf.object("rectangle",n),r(i)?(i.longitude=n.east,i.latitude=n.north,i.height=0,i):new e(n.east,n.north)},u.southeast=function(n,i){return t.typeOf.object("rectangle",n),r(i)?(i.longitude=n.east,i.latitude=n.south,i.height=0,i):new e(n.east,n.south)},u.center=function(n,i){t.typeOf.object("rectangle",n);var a=n.east,o=n.west;a<o&&(a+=s.TWO_PI);var u=s.negativePiToPi(.5*(o+a)),c=.5*(n.south+n.north);return r(i)?(i.longitude=u,i.latitude=c,i.height=0,i):new e(u,c)},u.intersection=function(e,n,i){t.typeOf.object("rectangle",e),t.typeOf.object("otherRectangle",n);var a=e.east,o=e.west,c=n.east,l=n.west;a<o&&c>0?a+=s.TWO_PI:c<l&&a>0&&(c+=s.TWO_PI),a<o&&l<0?l+=s.TWO_PI:c<l&&o<0&&(o+=s.TWO_PI);var f=s.negativePiToPi(Math.max(o,l)),d=s.negativePiToPi(Math.min(a,c));if(!((e.west<e.east||n.west<n.east)&&d<=f)){var h=Math.max(e.south,n.south),p=Math.min(e.north,n.north);if(!(h>=p))return r(i)?(i.west=f,i.south=h,i.east=d,i.north=p,i):new u(f,h,d,p)}},u.simpleIntersection=function(e,n,i){t.typeOf.object("rectangle",e),t.typeOf.object("otherRectangle",n);var a=Math.max(e.west,n.west),o=Math.max(e.south,n.south),s=Math.min(e.east,n.east),c=Math.min(e.north,n.north);if(!(o>=c||a>=s))return r(i)?(i.west=a,i.south=o,i.east=s,i.north=c,i):new u(a,o,s,c)},u.union=function(e,n,i){t.typeOf.object("rectangle",e),t.typeOf.object("otherRectangle",n),r(i)||(i=new u);var a=e.east,o=e.west,c=n.east,l=n.west;a<o&&c>0?a+=s.TWO_PI:c<l&&a>0&&(c+=s.TWO_PI),a<o&&l<0?l+=s.TWO_PI:c<l&&o<0&&(o+=s.TWO_PI);var f=s.convertLongitudeRange(Math.min(o,l)),d=s.convertLongitudeRange(Math.max(a,c));return i.west=f,i.south=Math.min(e.south,n.south),i.east=d,i.north=Math.max(e.north,n.north),i},u.expand=function(e,n,i){return t.typeOf.object("rectangle",e),t.typeOf.object("cartographic",n),r(i)||(i=new u),i.west=Math.min(e.west,n.longitude),i.south=Math.min(e.south,n.latitude),i.east=Math.max(e.east,n.longitude),i.north=Math.max(e.north,n.latitude),i},u.contains=function(e,n){t.typeOf.object("rectangle",e),t.typeOf.object("cartographic",n);var r=n.longitude,i=n.latitude,a=e.west,o=e.east;return o<a&&(o+=s.TWO_PI,r<0&&(r+=s.TWO_PI)),(r>a||s.equalsEpsilon(r,a,s.EPSILON14))&&(r<o||s.equalsEpsilon(r,o,s.EPSILON14))&&i>=e.south&&i<=e.north};var c=new e;return u.subsample=function(e,i,o,l){t.typeOf.object("rectangle",e),i=n(i,a.WGS84),o=n(o,0),r(l)||(l=[]);var f=0,d=e.north,h=e.south,p=e.east,m=e.west,_=c;_.height=o,_.longitude=m,_.latitude=d,l[f]=i.cartographicToCartesian(_,l[f]),f++,_.longitude=p,l[f]=i.cartographicToCartesian(_,l[f]),f++,_.latitude=h,l[f]=i.cartographicToCartesian(_,l[f]),f++,_.longitude=m,l[f]=i.cartographicToCartesian(_,l[f]),f++,_.latitude=d<0?d:h>0?h:0;for(var y=1;y<8;++y)_.longitude=-Math.PI+y*s.PI_OVER_TWO,u.contains(e,_)&&(l[f]=i.cartographicToCartesian(_,l[f]),f++);return 0===_.latitude&&(_.longitude=m,l[f]=i.cartographicToCartesian(_,l[f]),f++,_.longitude=p,l[f]=i.cartographicToCartesian(_,l[f]),f++),l.length=f,l},u.MAX_VALUE=o(new u(-Math.PI,-s.PI_OVER_TWO,Math.PI,s.PI_OVER_TWO)),u}),define("Core/BoundingSphere",["./Cartesian3","./Cartographic","./Check","./defaultValue","./defined","./Ellipsoid","./GeographicProjection","./Intersect","./Interval","./Math","./Matrix3","./Matrix4","./Rectangle"],function(e,t,n,r,i,a,o,s,u,c,l,f,d){"use strict";function h(t,n){this.center=e.clone(r(t,e.ZERO)),this.radius=r(n,0)}var p=new e,m=new e,_=new e,y=new e,v=new e,g=new e,E=new e,T=new e,w=new e,b=new e,S=new e,C=new e,O=4/3*c.PI;h.fromPoints=function(t,n){if(i(n)||(n=new h),!i(t)||0===t.length)return n.center=e.clone(e.ZERO,n.center),n.radius=0,n;var r,a=e.clone(t[0],E),o=e.clone(a,p),s=e.clone(a,m),u=e.clone(a,_),c=e.clone(a,y),l=e.clone(a,v),f=e.clone(a,g),d=t.length;for(r=1;r<d;r++){e.clone(t[r],a);var O=a.x,A=a.y,x=a.z;O<o.x&&e.clone(a,o),O>c.x&&e.clone(a,c),A<s.y&&e.clone(a,s),A>l.y&&e.clone(a,l),x<u.z&&e.clone(a,u),x>f.z&&e.clone(a,f)}var R=e.magnitudeSquared(e.subtract(c,o,T)),I=e.magnitudeSquared(e.subtract(l,s,T)),D=e.magnitudeSquared(e.subtract(f,u,T)),P=o,N=c,M=R;I>M&&(M=I,P=s,N=l),D>M&&(M=D,P=u,N=f);var z=w;z.x=.5*(P.x+N.x),z.y=.5*(P.y+N.y),z.z=.5*(P.z+N.z);var F=e.magnitudeSquared(e.subtract(N,z,T)),L=Math.sqrt(F),B=b;B.x=o.x,B.y=s.y,B.z=u.z;var U=S;U.x=c.x,U.y=l.y,U.z=f.z;var q=e.multiplyByScalar(e.add(B,U,T),.5,C),G=0;for(r=0;r<d;r++){e.clone(t[r],a);var V=e.magnitude(e.subtract(a,q,T));V>G&&(G=V);var j=e.magnitudeSquared(e.subtract(a,z,T));if(j>F){var k=Math.sqrt(j);L=.5*(L+k),F=L*L;var H=k-L;z.x=(L*z.x+H*a.x)/k,z.y=(L*z.y+H*a.y)/k,z.z=(L*z.z+H*a.z)/k}}return L<G?(e.clone(z,n.center),n.radius=L):(e.clone(q,n.center),n.radius=G),n};var A=new o,x=new e,R=new e,I=new t,D=new t;h.fromRectangle2D=function(e,t,n){return h.fromRectangleWithHeights2D(e,t,0,0,n)},h.fromRectangleWithHeights2D=function(t,n,a,o,s){if(i(s)||(s=new h),!i(t))return s.center=e.clone(e.ZERO,s.center),s.radius=0,s;n=r(n,A),d.southwest(t,I),I.height=a,d.northeast(t,D),D.height=o;var u=n.project(I,x),c=n.project(D,R),l=c.x-u.x,f=c.y-u.y,p=c.z-u.z;s.radius=.5*Math.sqrt(l*l+f*f+p*p);var m=s.center;return m.x=u.x+.5*l,m.y=u.y+.5*f,m.z=u.z+.5*p,s};var P=[];h.fromRectangle3D=function(t,n,o,s){if(n=r(n,a.WGS84),o=r(o,0),i(s)||(s=new h),!i(t))return s.center=e.clone(e.ZERO,s.center),s.radius=0,s;var u=d.subsample(t,n,o,P);return h.fromPoints(u,s)},h.fromVertices=function(t,a,o,s){if(i(s)||(s=new h),!i(t)||0===t.length)return s.center=e.clone(e.ZERO,s.center),s.radius=0,s;a=r(a,e.ZERO),o=r(o,3),n.typeOf.number.greaterThanOrEquals("stride",o,3);var u=E;u.x=t[0]+a.x,u.y=t[1]+a.y,u.z=t[2]+a.z;var c,l=e.clone(u,p),f=e.clone(u,m),d=e.clone(u,_),O=e.clone(u,y),A=e.clone(u,v),x=e.clone(u,g),R=t.length;for(c=0;c<R;c+=o){var I=t[c]+a.x,D=t[c+1]+a.y,P=t[c+2]+a.z;u.x=I,u.y=D,u.z=P,I<l.x&&e.clone(u,l),I>O.x&&e.clone(u,O),D<f.y&&e.clone(u,f),D>A.y&&e.clone(u,A),P<d.z&&e.clone(u,d),P>x.z&&e.clone(u,x)}var N=e.magnitudeSquared(e.subtract(O,l,T)),M=e.magnitudeSquared(e.subtract(A,f,T)),z=e.magnitudeSquared(e.subtract(x,d,T)),F=l,L=O,B=N;M>B&&(B=M,F=f,L=A),z>B&&(B=z,F=d,L=x);var U=w;U.x=.5*(F.x+L.x),U.y=.5*(F.y+L.y),U.z=.5*(F.z+L.z);var q=e.magnitudeSquared(e.subtract(L,U,T)),G=Math.sqrt(q),V=b;V.x=l.x,V.y=f.y,V.z=d.z;var j=S;j.x=O.x,j.y=A.y,j.z=x.z;var k=e.multiplyByScalar(e.add(V,j,T),.5,C),H=0;for(c=0;c<R;c+=o){u.x=t[c]+a.x,u.y=t[c+1]+a.y,u.z=t[c+2]+a.z;var W=e.magnitude(e.subtract(u,k,T));W>H&&(H=W);var Y=e.magnitudeSquared(e.subtract(u,U,T));if(Y>q){var X=Math.sqrt(Y);G=.5*(G+X),q=G*G;var Z=X-G;U.x=(G*U.x+Z*u.x)/X,U.y=(G*U.y+Z*u.y)/X,U.z=(G*U.z+Z*u.z)/X}}return G<H?(e.clone(U,s.center),s.radius=G):(e.clone(k,s.center),s.radius=H),s},h.fromEncodedCartesianVertices=function(t,n,r){if(i(r)||(r=new h),!i(t)||!i(n)||t.length!==n.length||0===t.length)return r.center=e.clone(e.ZERO,r.center),r.radius=0,r;var a=E;a.x=t[0]+n[0],a.y=t[1]+n[1],a.z=t[2]+n[2];var o,s=e.clone(a,p),u=e.clone(a,m),c=e.clone(a,_),l=e.clone(a,y),f=e.clone(a,v),d=e.clone(a,g),O=t.length;for(o=0;o<O;o+=3){var A=t[o]+n[o],x=t[o+1]+n[o+1],R=t[o+2]+n[o+2];a.x=A,a.y=x,a.z=R,A<s.x&&e.clone(a,s),A>l.x&&e.clone(a,l),x<u.y&&e.clone(a,u),x>f.y&&e.clone(a,f),R<c.z&&e.clone(a,c),R>d.z&&e.clone(a,d)}var I=e.magnitudeSquared(e.subtract(l,s,T)),D=e.magnitudeSquared(e.subtract(f,u,T)),P=e.magnitudeSquared(e.subtract(d,c,T)),N=s,M=l,z=I;D>z&&(z=D,N=u,M=f),P>z&&(z=P,N=c,M=d);var F=w;F.x=.5*(N.x+M.x),F.y=.5*(N.y+M.y),F.z=.5*(N.z+M.z);var L=e.magnitudeSquared(e.subtract(M,F,T)),B=Math.sqrt(L),U=b;U.x=s.x,U.y=u.y,U.z=c.z;var q=S;q.x=l.x,q.y=f.y,q.z=d.z;var G=e.multiplyByScalar(e.add(U,q,T),.5,C),V=0;for(o=0;o<O;o+=3){a.x=t[o]+n[o],a.y=t[o+1]+n[o+1],a.z=t[o+2]+n[o+2];var j=e.magnitude(e.subtract(a,G,T));j>V&&(V=j);var k=e.magnitudeSquared(e.subtract(a,F,T));if(k>L){var H=Math.sqrt(k);B=.5*(B+H),L=B*B;var W=H-B;F.x=(B*F.x+W*a.x)/H,F.y=(B*F.y+W*a.y)/H,F.z=(B*F.z+W*a.z)/H}}return B<V?(e.clone(F,r.center),r.radius=B):(e.clone(G,r.center),r.radius=V),r},h.fromCornerPoints=function(t,r,a){n.typeOf.object("corner",t),n.typeOf.object("oppositeCorner",r),i(a)||(a=new h);var o=a.center;return e.add(t,r,o),e.multiplyByScalar(o,.5,o),a.radius=e.distance(o,r),a},h.fromEllipsoid=function(t,r){return n.typeOf.object("ellipsoid",t),i(r)||(r=new h),e.clone(e.ZERO,r.center),r.radius=t.maximumRadius,r};var N=new e;h.fromBoundingSpheres=function(t,n){if(i(n)||(n=new h),!i(t)||0===t.length)return n.center=e.clone(e.ZERO,n.center),n.radius=0,n;var r=t.length;if(1===r)return h.clone(t[0],n);if(2===r)return h.union(t[0],t[1],n);var a,o=[];for(a=0;a<r;a++)o.push(t[a].center);n=h.fromPoints(o,n);var s=n.center,u=n.radius;for(a=0;a<r;a++){var c=t[a];u=Math.max(u,e.distance(s,c.center,N)+c.radius)}return n.radius=u,n};var M=new e,z=new e,F=new e;h.fromOrientedBoundingBox=function(t,r){n.defined("orientedBoundingBox",t),i(r)||(r=new h);var a=t.halfAxes,o=l.getColumn(a,0,M),s=l.getColumn(a,1,z),u=l.getColumn(a,2,F);return e.add(o,s,o),e.add(o,u,o),r.center=e.clone(t.center,r.center),r.radius=e.magnitude(o),r},h.clone=function(t,n){if(i(t))return i(n)?(n.center=e.clone(t.center,n.center),n.radius=t.radius,n):new h(t.center,t.radius)},h.packedLength=4,h.pack=function(e,t,i){n.typeOf.object("value",e),n.defined("array",t),i=r(i,0);var a=e.center;return t[i++]=a.x,t[i++]=a.y,t[i++]=a.z,t[i]=e.radius,t},h.unpack=function(e,t,a){n.defined("array",e),t=r(t,0),i(a)||(a=new h);var o=a.center;return o.x=e[t++],o.y=e[t++],o.z=e[t++],a.radius=e[t],a};var L=new e,B=new e;h.union=function(t,r,a){n.typeOf.object("left",t),n.typeOf.object("right",r),i(a)||(a=new h);var o=t.center,s=t.radius,u=r.center,c=r.radius,l=e.subtract(u,o,L),f=e.magnitude(l);if(s>=f+c)return t.clone(a),a;if(c>=f+s)return r.clone(a),a;var d=.5*(s+f+c),p=e.multiplyByScalar(l,(-s+d)/f,B);return e.add(p,o,p),e.clone(p,a.center),a.radius=d,a};var U=new e;h.expand=function(t,r,i){n.typeOf.object("sphere",t),n.typeOf.object("point",r),i=h.clone(t,i);var a=e.magnitude(e.subtract(r,i.center,U));return a>i.radius&&(i.radius=a),i},h.intersectPlane=function(t,r){n.typeOf.object("sphere",t),n.typeOf.object("plane",r);var i=t.center,a=t.radius,o=r.normal,u=e.dot(o,i)+r.distance;return u<-a?s.OUTSIDE:u<a?s.INTERSECTING:s.INSIDE},h.transform=function(e,t,r){return n.typeOf.object("sphere",e),n.typeOf.object("transform",t),i(r)||(r=new h),r.center=f.multiplyByPoint(t,e.center,r.center),r.radius=f.getMaximumScale(t)*e.radius,r};var q=new e;h.distanceSquaredTo=function(t,r){n.typeOf.object("sphere",t),n.typeOf.object("cartesian",r);var i=e.subtract(t.center,r,q);return e.magnitudeSquared(i)-t.radius*t.radius},h.transformWithoutScale=function(e,t,r){return n.typeOf.object("sphere",e),n.typeOf.object("transform",t),i(r)||(r=new h),r.center=f.multiplyByPoint(t,e.center,r.center),r.radius=e.radius,r};var G=new e;h.computePlaneDistances=function(t,r,a,o){n.typeOf.object("sphere",t),n.typeOf.object("position",r),n.typeOf.object("direction",a),i(o)||(o=new u);var s=e.subtract(t.center,r,G),c=e.dot(a,s);return o.start=c-t.radius,o.stop=c+t.radius,o};for(var V=new e,j=new e,k=new e,H=new e,W=new e,Y=new t,X=new Array(8),Z=0;Z<8;++Z)X[Z]=new e;var K=new o;return h.projectTo2D=function(t,i,a){n.typeOf.object("sphere",t),i=r(i,K);var o=i.ellipsoid,s=t.center,u=t.radius,c=o.geodeticSurfaceNormal(s,V),l=e.cross(e.UNIT_Z,c,j);e.normalize(l,l);var f=e.cross(c,l,k);e.normalize(f,f),e.multiplyByScalar(c,u,c),e.multiplyByScalar(f,u,f),e.multiplyByScalar(l,u,l);var d=e.negate(f,W),p=e.negate(l,H),m=X,_=m[0];e.add(c,f,_),e.add(_,l,_),_=m[1],e.add(c,f,_),e.add(_,p,_),_=m[2],e.add(c,d,_),e.add(_,p,_),_=m[3],e.add(c,d,_),e.add(_,l,_),e.negate(c,c),_=m[4],e.add(c,f,_),e.add(_,l,_),_=m[5],e.add(c,f,_),e.add(_,p,_),_=m[6],e.add(c,d,_),e.add(_,p,_),_=m[7],e.add(c,d,_),e.add(_,l,_);for(var y=m.length,v=0;v<y;++v){var g=m[v];e.add(s,g,g);var E=o.cartesianToCartographic(g,Y);i.project(E,g)}a=h.fromPoints(m,a),s=a.center;var T=s.x,w=s.y,b=s.z;return s.x=b,s.y=T,s.z=w,a},h.isOccluded=function(e,t){return n.typeOf.object("sphere",e),n.typeOf.object("occluder",t),!t.isBoundingSphereVisible(e)},h.equals=function(t,n){return t===n||i(t)&&i(n)&&e.equals(t.center,n.center)&&t.radius===n.radius},h.prototype.intersectPlane=function(e){return h.intersectPlane(this,e)},h.prototype.distanceSquaredTo=function(e){return h.distanceSquaredTo(this,e)},h.prototype.computePlaneDistances=function(e,t,n){return h.computePlaneDistances(this,e,t,n)},h.prototype.isOccluded=function(e){return h.isOccluded(this,e)},h.prototype.equals=function(e){return h.equals(this,e)},h.prototype.clone=function(e){return h.clone(this,e)},h.prototype.volume=function(){var e=this.radius;return O*e*e*e},h}),define("Core/Cartesian2",["./Check","./defaultValue","./defined","./DeveloperError","./freezeObject","./Math"],function(e,t,n,r,i,a){"use strict";function o(e,n){this.x=t(e,0),this.y=t(n,0)}o.fromElements=function(e,t,r){return n(r)?(r.x=e,r.y=t,r):new o(e,t)},o.clone=function(e,t){if(n(e))return n(t)?(t.x=e.x,t.y=e.y,t):new o(e.x,e.y)},o.fromCartesian3=o.clone,o.fromCartesian4=o.clone,o.packedLength=2,o.pack=function(n,r,i){return e.typeOf.object("value",n),e.defined("array",r),i=t(i,0),r[i++]=n.x,r[i]=n.y,r},o.unpack=function(r,i,a){return e.defined("array",r),i=t(i,0),n(a)||(a=new o),a.x=r[i++],a.y=r[i],a},o.packArray=function(t,r){e.defined("array",t);var i=t.length;n(r)?r.length=2*i:r=new Array(2*i);for(var a=0;a<i;++a)o.pack(t[a],r,2*a);return r},o.unpackArray=function(t,r){e.defined("array",t);var i=t.length;n(r)?r.length=i/2:r=new Array(i/2);for(var a=0;a<i;a+=2){var s=a/2;r[s]=o.unpack(t,a,r[s])}return r},o.fromArray=o.unpack,o.maximumComponent=function(t){return e.typeOf.object("cartesian",t),Math.max(t.x,t.y)},o.minimumComponent=function(t){return e.typeOf.object("cartesian",t),Math.min(t.x,t.y)},o.minimumByComponent=function(t,n,r){return e.typeOf.object("first",t),e.typeOf.object("second",n),e.typeOf.object("result",r),r.x=Math.min(t.x,n.x),r.y=Math.min(t.y,n.y),r},o.maximumByComponent=function(t,n,r){return e.typeOf.object("first",t),e.typeOf.object("second",n),e.typeOf.object("result",r),r.x=Math.max(t.x,n.x),r.y=Math.max(t.y,n.y),r},o.magnitudeSquared=function(t){return e.typeOf.object("cartesian",t),t.x*t.x+t.y*t.y},o.magnitude=function(e){return Math.sqrt(o.magnitudeSquared(e))};var s=new o;o.distance=function(t,n){return e.typeOf.object("left",t),e.typeOf.object("right",n),o.subtract(t,n,s),o.magnitude(s)},o.distanceSquared=function(t,n){return e.typeOf.object("left",t),e.typeOf.object("right",n),o.subtract(t,n,s),o.magnitudeSquared(s)},o.normalize=function(t,n){e.typeOf.object("cartesian",t),e.typeOf.object("result",n);var i=o.magnitude(t);if(n.x=t.x/i,n.y=t.y/i,isNaN(n.x)||isNaN(n.y))throw new r("normalized result is not a number");return n},o.dot=function(t,n){return e.typeOf.object("left",t),e.typeOf.object("right",n),t.x*n.x+t.y*n.y},o.multiplyComponents=function(t,n,r){return e.typeOf.object("left",t),e.typeOf.object("right",n),e.typeOf.object("result",r),r.x=t.x*n.x,r.y=t.y*n.y,r},o.divideComponents=function(t,n,r){return e.typeOf.object("left",t),e.typeOf.object("right",n),e.typeOf.object("result",r),r.x=t.x/n.x,r.y=t.y/n.y,r},o.add=function(t,n,r){return e.typeOf.object("left",t),e.typeOf.object("right",n),e.typeOf.object("result",r),r.x=t.x+n.x,r.y=t.y+n.y,r},o.subtract=function(t,n,r){return e.typeOf.object("left",t),e.typeOf.object("right",n),e.typeOf.object("result",r),r.x=t.x-n.x,r.y=t.y-n.y,r},o.multiplyByScalar=function(t,n,r){return e.typeOf.object("cartesian",t),e.typeOf.number("scalar",n),e.typeOf.object("result",r),r.x=t.x*n,r.y=t.y*n,r},o.divideByScalar=function(t,n,r){return e.typeOf.object("cartesian",t),e.typeOf.number("scalar",n),e.typeOf.object("result",r),r.x=t.x/n,r.y=t.y/n,r},o.negate=function(t,n){return e.typeOf.object("cartesian",t),e.typeOf.object("result",n),n.x=-t.x,n.y=-t.y,n},o.abs=function(t,n){return e.typeOf.object("cartesian",t),e.typeOf.object("result",n),n.x=Math.abs(t.x),n.y=Math.abs(t.y),n};var u=new o;o.lerp=function(t,n,r,i){return e.typeOf.object("start",t),e.typeOf.object("end",n),e.typeOf.number("t",r),e.typeOf.object("result",i),o.multiplyByScalar(n,r,u),i=o.multiplyByScalar(t,1-r,i),o.add(u,i,i)};var c=new o,l=new o;o.angleBetween=function(t,n){return e.typeOf.object("left",t),e.typeOf.object("right",n),o.normalize(t,c),o.normalize(n,l),a.acosClamped(o.dot(c,l))};var f=new o;return o.mostOrthogonalAxis=function(t,n){e.typeOf.object("cartesian",t),e.typeOf.object("result",n);var r=o.normalize(t,f);return o.abs(r,r),n=r.x<=r.y?o.clone(o.UNIT_X,n):o.clone(o.UNIT_Y,n)},o.equals=function(e,t){return e===t||n(e)&&n(t)&&e.x===t.x&&e.y===t.y},o.equalsArray=function(e,t,n){return e.x===t[n]&&e.y===t[n+1]},o.equalsEpsilon=function(e,t,r,i){return e===t||n(e)&&n(t)&&a.equalsEpsilon(e.x,t.x,r,i)&&a.equalsEpsilon(e.y,t.y,r,i)},o.ZERO=i(new o(0,0)),o.UNIT_X=i(new o(1,0)),o.UNIT_Y=i(new o(0,1)),o.prototype.clone=function(e){return o.clone(this,e)},o.prototype.equals=function(e){return o.equals(this,e)},o.prototype.equalsEpsilon=function(e,t,n){return o.equalsEpsilon(this,e,t,n)},o.prototype.toString=function(){return"("+this.x+", "+this.y+")"},o}),define("Core/GeographicTilingScheme",["./Cartesian2","./Check","./defaultValue","./defined","./defineProperties","./Ellipsoid","./GeographicProjection","./Math","./Rectangle"],function(e,t,n,r,i,a,o,s,u){"use strict";function c(e){e=n(e,{}),this._ellipsoid=n(e.ellipsoid,a.WGS84),this._rectangle=n(e.rectangle,u.MAX_VALUE),this._projection=new o(this._ellipsoid),this._numberOfLevelZeroTilesX=n(e.numberOfLevelZeroTilesX,2),this._numberOfLevelZeroTilesY=n(e.numberOfLevelZeroTilesY,1)}return i(c.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},rectangle:{get:function(){return this._rectangle}},projection:{get:function(){return this._projection}}}),c.prototype.getNumberOfXTilesAtLevel=function(e){return this._numberOfLevelZeroTilesX<<e},c.prototype.getNumberOfYTilesAtLevel=function(e){return this._numberOfLevelZeroTilesY<<e},c.prototype.rectangleToNativeRectangle=function(e,n){t.defined("rectangle",e);var i=s.toDegrees(e.west),a=s.toDegrees(e.south),o=s.toDegrees(e.east),c=s.toDegrees(e.north);return r(n)?(n.west=i,n.south=a,n.east=o,n.north=c,n):new u(i,a,o,c)},c.prototype.tileXYToNativeRectangle=function(e,t,n,r){var i=this.tileXYToRectangle(e,t,n,r);return i.west=s.toDegrees(i.west),i.south=s.toDegrees(i.south),i.east=s.toDegrees(i.east),i.north=s.toDegrees(i.north),i},c.prototype.tileXYToRectangle=function(e,t,n,i){var a=this._rectangle,o=this.getNumberOfXTilesAtLevel(n),s=this.getNumberOfYTilesAtLevel(n),c=a.width/o,l=e*c+a.west,f=(e+1)*c+a.west,d=a.height/s,h=a.north-t*d,p=a.north-(t+1)*d;return r(i)||(i=new u(l,p,f,h)),i.west=l,i.south=p,i.east=f,i.north=h,i},c.prototype.positionToTileXY=function(t,n,i){var a=this._rectangle;if(u.contains(a,t)){var o=this.getNumberOfXTilesAtLevel(n),c=this.getNumberOfYTilesAtLevel(n),l=a.width/o,f=a.height/c,d=t.longitude;a.east<a.west&&(d+=s.TWO_PI);var h=(d-a.west)/l|0;h>=o&&(h=o-1);var p=(a.north-t.latitude)/f|0;return p>=c&&(p=c-1),r(i)?(i.x=h,i.y=p,i):new e(h,p)}},c}),define("Core/ApproximateTerrainHeights",["./buildModuleUrl","./defaultValue","./defined","./BoundingSphere","./Cartesian2","./Cartesian3","./Cartographic","./Check","./DeveloperError","./Ellipsoid","./GeographicTilingScheme","./Rectangle","./Resource"],function(e,t,n,r,i,a,o,s,u,c,l,f,d){"use strict";function h(e){o.fromRadians(e.east,e.north,0,T[0]),o.fromRadians(e.west,e.north,0,T[1]),o.fromRadians(e.east,e.south,0,T[2]),o.fromRadians(e.west,e.south,0,T[3]);var t,n=0,r=0,i=0,a=0,s=b._terrainHeightsMaxLevel;for(t=0;t<=s;++t){for(var u=!1,c=0;c<4;++c){var l=T[c];if(E.positionToTileXY(l,t,w),0===c)i=w.x,a=w.y;else if(i!==w.x||a!==w.y){u=!0;break}}if(u)break;n=i,r=a}if(0!==t)return{x:n,y:r,level:t>s?s:t-1}}var p=new a,m=new a,_=new o,y=new a,v=new a,g=new r,E=new l,T=[new o,new o,new o,new o],w=new i,b={};return b.initialize=function(){var t=b._initPromise;return n(t)?t:(t=d.fetchJson(e("Assets/approximateTerrainHeights.json")).then(function(e){b._terrainHeights=e}),b._initPromise=t,t)},b.getApproximateTerrainHeights=function(e,r){if(s.defined("rectangle",e),!n(b._terrainHeights))throw new u("You must call ApproximateTerrainHeights.initialize and wait for the promise to resolve before using this function");r=t(r,c.WGS84);var i=h(e),o=b._defaultMinTerrainHeight,l=b._defaultMaxTerrainHeight;if(n(i)){var d=i.level+"-"+i.x+"-"+i.y,g=b._terrainHeights[d];n(g)&&(o=g[0],l=g[1]),r.cartographicToCartesian(f.northeast(e,_),p),r.cartographicToCartesian(f.southwest(e,_),m),a.subtract(m,p,y),a.add(p,a.multiplyByScalar(y,.5,y),y);var E=r.scaleToGeodeticSurface(y,v);if(n(E)){var T=a.distance(y,E);o=Math.min(o,-T)}else o=b._defaultMinTerrainHeight}return o=Math.max(b._defaultMinTerrainHeight,o),{minimumTerrainHeight:o,maximumTerrainHeight:l}},b.getInstanceBoundingSphere=function(e,i){if(s.defined("rectangle",e),!n(b._terrainHeights))throw new u("You must call ApproximateTerrainHeights.initialize and wait for the promise to resolve before using this function");i=t(i,c.WGS84);var a=h(e),o=b._defaultMaxTerrainHeight;if(n(a)){var l=a.level+"-"+a.x+"-"+a.y,f=b._terrainHeights[l];n(f)&&(o=f[1])}var d=r.fromRectangle3D(e,i,0);return r.fromRectangle3D(e,i,o,g),r.union(d,g,d)},b._terrainHeightsMaxLevel=6,b._defaultMaxTerrainHeight=9e3,b._defaultMinTerrainHeight=-1e5,b._terrainHeights=void 0,b._initPromise=void 0,b}),define("Core/arrayRemoveDuplicates",["./Check","./defaultValue","./defined","./Math"],function(e,t,n,r){"use strict";function i(r,i,o){if(e.defined("equalsEpsilon",i),n(r)){o=t(o,!1);var s=r.length;if(s<2)return r;var u,c,l;for(u=1;u<s&&(c=r[u-1],l=r[u],!i(c,l,a));++u);if(u===s)return o&&i(r[0],r[r.length-1],a)?r.slice(1):r;for(var f=r.slice(0,u);u<s;++u)l=r[u],i(c,l,a)||(f.push(l),c=l);return o&&f.length>1&&i(f[0],f[f.length-1],a)&&f.shift(),f}}var a=r.EPSILON10;return i}),define("Core/WebGLConstants",["./freezeObject"],function(e){"use strict";return e({DEPTH_BUFFER_BIT:256,STENCIL_BUFFER_BIT:1024,COLOR_BUFFER_BIT:16384,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,ZERO:0,ONE:1,SRC_COLOR:768,ONE_MINUS_SRC_COLOR:769,SRC_ALPHA:770,ONE_MINUS_SRC_ALPHA:771,DST_ALPHA:772,ONE_MINUS_DST_ALPHA:773,DST_COLOR:774,ONE_MINUS_DST_COLOR:775,SRC_ALPHA_SATURATE:776,FUNC_ADD:32774,BLEND_EQUATION:32777,BLEND_EQUATION_RGB:32777,BLEND_EQUATION_ALPHA:34877,FUNC_SUBTRACT:32778,FUNC_REVERSE_SUBTRACT:32779,BLEND_DST_RGB:32968,BLEND_SRC_RGB:32969,BLEND_DST_ALPHA:32970,BLEND_SRC_ALPHA:32971,CONSTANT_COLOR:32769,ONE_MINUS_CONSTANT_COLOR:32770,CONSTANT_ALPHA:32771,ONE_MINUS_CONSTANT_ALPHA:32772,BLEND_COLOR:32773,ARRAY_BUFFER:34962,ELEMENT_ARRAY_BUFFER:34963,ARRAY_BUFFER_BINDING:34964,ELEMENT_ARRAY_BUFFER_BINDING:34965,STREAM_DRAW:35040,STATIC_DRAW:35044,DYNAMIC_DRAW:35048,BUFFER_SIZE:34660,BUFFER_USAGE:34661,CURRENT_VERTEX_ATTRIB:34342,FRONT:1028,BACK:1029,FRONT_AND_BACK:1032,CULL_FACE:2884,BLEND:3042,DITHER:3024,STENCIL_TEST:2960,DEPTH_TEST:2929,SCISSOR_TEST:3089,POLYGON_OFFSET_FILL:32823,SAMPLE_ALPHA_TO_COVERAGE:32926,SAMPLE_COVERAGE:32928,NO_ERROR:0,INVALID_ENUM:1280,INVALID_VALUE:1281,INVALID_OPERATION:1282,OUT_OF_MEMORY:1285,CW:2304,CCW:2305,LINE_WIDTH:2849,ALIASED_POINT_SIZE_RANGE:33901,ALIASED_LINE_WIDTH_RANGE:33902,CULL_FACE_MODE:2885,FRONT_FACE:2886,DEPTH_RANGE:2928,DEPTH_WRITEMASK:2930,DEPTH_CLEAR_VALUE:2931,DEPTH_FUNC:2932,STENCIL_CLEAR_VALUE:2961,STENCIL_FUNC:2962,STENCIL_FAIL:2964,STENCIL_PASS_DEPTH_FAIL:2965,STENCIL_PASS_DEPTH_PASS:2966,STENCIL_REF:2967,STENCIL_VALUE_MASK:2963,STENCIL_WRITEMASK:2968,STENCIL_BACK_FUNC:34816,STENCIL_BACK_FAIL:34817,STENCIL_BACK_PASS_DEPTH_FAIL:34818,STENCIL_BACK_PASS_DEPTH_PASS:34819,STENCIL_BACK_REF:36003,STENCIL_BACK_VALUE_MASK:36004,STENCIL_BACK_WRITEMASK:36005,VIEWPORT:2978,SCISSOR_BOX:3088,COLOR_CLEAR_VALUE:3106,COLOR_WRITEMASK:3107,UNPACK_ALIGNMENT:3317,PACK_ALIGNMENT:3333,MAX_TEXTURE_SIZE:3379,MAX_VIEWPORT_DIMS:3386,SUBPIXEL_BITS:3408,RED_BITS:3410,GREEN_BITS:3411,BLUE_BITS:3412,ALPHA_BITS:3413,DEPTH_BITS:3414,STENCIL_BITS:3415,POLYGON_OFFSET_UNITS:10752,POLYGON_OFFSET_FACTOR:32824,TEXTURE_BINDING_2D:32873,SAMPLE_BUFFERS:32936,SAMPLES:32937,SAMPLE_COVERAGE_VALUE:32938,SAMPLE_COVERAGE_INVERT:32939,COMPRESSED_TEXTURE_FORMATS:34467,DONT_CARE:4352,FASTEST:4353,NICEST:4354,GENERATE_MIPMAP_HINT:33170,BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,DEPTH_COMPONENT:6402,ALPHA:6406,RGB:6407,RGBA:6408,LUMINANCE:6409,LUMINANCE_ALPHA:6410,
UNSIGNED_SHORT_4_4_4_4:32819,UNSIGNED_SHORT_5_5_5_1:32820,UNSIGNED_SHORT_5_6_5:33635,FRAGMENT_SHADER:35632,VERTEX_SHADER:35633,MAX_VERTEX_ATTRIBS:34921,MAX_VERTEX_UNIFORM_VECTORS:36347,MAX_VARYING_VECTORS:36348,MAX_COMBINED_TEXTURE_IMAGE_UNITS:35661,MAX_VERTEX_TEXTURE_IMAGE_UNITS:35660,MAX_TEXTURE_IMAGE_UNITS:34930,MAX_FRAGMENT_UNIFORM_VECTORS:36349,SHADER_TYPE:35663,DELETE_STATUS:35712,LINK_STATUS:35714,VALIDATE_STATUS:35715,ATTACHED_SHADERS:35717,ACTIVE_UNIFORMS:35718,ACTIVE_ATTRIBUTES:35721,SHADING_LANGUAGE_VERSION:35724,CURRENT_PROGRAM:35725,NEVER:512,LESS:513,EQUAL:514,LEQUAL:515,GREATER:516,NOTEQUAL:517,GEQUAL:518,ALWAYS:519,KEEP:7680,REPLACE:7681,INCR:7682,DECR:7683,INVERT:5386,INCR_WRAP:34055,DECR_WRAP:34056,VENDOR:7936,RENDERER:7937,VERSION:7938,NEAREST:9728,LINEAR:9729,NEAREST_MIPMAP_NEAREST:9984,LINEAR_MIPMAP_NEAREST:9985,NEAREST_MIPMAP_LINEAR:9986,LINEAR_MIPMAP_LINEAR:9987,TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,TEXTURE_2D:3553,TEXTURE:5890,TEXTURE_CUBE_MAP:34067,TEXTURE_BINDING_CUBE_MAP:34068,TEXTURE_CUBE_MAP_POSITIVE_X:34069,TEXTURE_CUBE_MAP_NEGATIVE_X:34070,TEXTURE_CUBE_MAP_POSITIVE_Y:34071,TEXTURE_CUBE_MAP_NEGATIVE_Y:34072,TEXTURE_CUBE_MAP_POSITIVE_Z:34073,TEXTURE_CUBE_MAP_NEGATIVE_Z:34074,MAX_CUBE_MAP_TEXTURE_SIZE:34076,TEXTURE0:33984,TEXTURE1:33985,TEXTURE2:33986,TEXTURE3:33987,TEXTURE4:33988,TEXTURE5:33989,TEXTURE6:33990,TEXTURE7:33991,TEXTURE8:33992,TEXTURE9:33993,TEXTURE10:33994,TEXTURE11:33995,TEXTURE12:33996,TEXTURE13:33997,TEXTURE14:33998,TEXTURE15:33999,TEXTURE16:34e3,TEXTURE17:34001,TEXTURE18:34002,TEXTURE19:34003,TEXTURE20:34004,TEXTURE21:34005,TEXTURE22:34006,TEXTURE23:34007,TEXTURE24:34008,TEXTURE25:34009,TEXTURE26:34010,TEXTURE27:34011,TEXTURE28:34012,TEXTURE29:34013,TEXTURE30:34014,TEXTURE31:34015,ACTIVE_TEXTURE:34016,REPEAT:10497,CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,INT_VEC2:35667,INT_VEC3:35668,INT_VEC4:35669,BOOL:35670,BOOL_VEC2:35671,BOOL_VEC3:35672,BOOL_VEC4:35673,FLOAT_MAT2:35674,FLOAT_MAT3:35675,FLOAT_MAT4:35676,SAMPLER_2D:35678,SAMPLER_CUBE:35680,VERTEX_ATTRIB_ARRAY_ENABLED:34338,VERTEX_ATTRIB_ARRAY_SIZE:34339,VERTEX_ATTRIB_ARRAY_STRIDE:34340,VERTEX_ATTRIB_ARRAY_TYPE:34341,VERTEX_ATTRIB_ARRAY_NORMALIZED:34922,VERTEX_ATTRIB_ARRAY_POINTER:34373,VERTEX_ATTRIB_ARRAY_BUFFER_BINDING:34975,IMPLEMENTATION_COLOR_READ_TYPE:35738,IMPLEMENTATION_COLOR_READ_FORMAT:35739,COMPILE_STATUS:35713,LOW_FLOAT:36336,MEDIUM_FLOAT:36337,HIGH_FLOAT:36338,LOW_INT:36339,MEDIUM_INT:36340,HIGH_INT:36341,FRAMEBUFFER:36160,RENDERBUFFER:36161,RGBA4:32854,RGB5_A1:32855,RGB565:36194,DEPTH_COMPONENT16:33189,STENCIL_INDEX:6401,STENCIL_INDEX8:36168,DEPTH_STENCIL:34041,RENDERBUFFER_WIDTH:36162,RENDERBUFFER_HEIGHT:36163,RENDERBUFFER_INTERNAL_FORMAT:36164,RENDERBUFFER_RED_SIZE:36176,RENDERBUFFER_GREEN_SIZE:36177,RENDERBUFFER_BLUE_SIZE:36178,RENDERBUFFER_ALPHA_SIZE:36179,RENDERBUFFER_DEPTH_SIZE:36180,RENDERBUFFER_STENCIL_SIZE:36181,FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE:36048,FRAMEBUFFER_ATTACHMENT_OBJECT_NAME:36049,FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL:36050,FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE:36051,COLOR_ATTACHMENT0:36064,DEPTH_ATTACHMENT:36096,STENCIL_ATTACHMENT:36128,DEPTH_STENCIL_ATTACHMENT:33306,NONE:0,FRAMEBUFFER_COMPLETE:36053,FRAMEBUFFER_INCOMPLETE_ATTACHMENT:36054,FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:36055,FRAMEBUFFER_INCOMPLETE_DIMENSIONS:36057,FRAMEBUFFER_UNSUPPORTED:36061,FRAMEBUFFER_BINDING:36006,RENDERBUFFER_BINDING:36007,MAX_RENDERBUFFER_SIZE:34024,INVALID_FRAMEBUFFER_OPERATION:1286,UNPACK_FLIP_Y_WEBGL:37440,UNPACK_PREMULTIPLY_ALPHA_WEBGL:37441,CONTEXT_LOST_WEBGL:37442,UNPACK_COLORSPACE_CONVERSION_WEBGL:37443,BROWSER_DEFAULT_WEBGL:37444,COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,COMPRESSED_RGBA_S3TC_DXT3_EXT:33778,COMPRESSED_RGBA_S3TC_DXT5_EXT:33779,COMPRESSED_RGB_PVRTC_4BPPV1_IMG:35840,COMPRESSED_RGB_PVRTC_2BPPV1_IMG:35841,COMPRESSED_RGBA_PVRTC_4BPPV1_IMG:35842,COMPRESSED_RGBA_PVRTC_2BPPV1_IMG:35843,COMPRESSED_RGB_ETC1_WEBGL:36196,HALF_FLOAT_OES:36193,DOUBLE:5130,READ_BUFFER:3074,UNPACK_ROW_LENGTH:3314,UNPACK_SKIP_ROWS:3315,UNPACK_SKIP_PIXELS:3316,PACK_ROW_LENGTH:3330,PACK_SKIP_ROWS:3331,PACK_SKIP_PIXELS:3332,COLOR:6144,DEPTH:6145,STENCIL:6146,RED:6403,RGB8:32849,RGBA8:32856,RGB10_A2:32857,TEXTURE_BINDING_3D:32874,UNPACK_SKIP_IMAGES:32877,UNPACK_IMAGE_HEIGHT:32878,TEXTURE_3D:32879,TEXTURE_WRAP_R:32882,MAX_3D_TEXTURE_SIZE:32883,UNSIGNED_INT_2_10_10_10_REV:33640,MAX_ELEMENTS_VERTICES:33e3,MAX_ELEMENTS_INDICES:33001,TEXTURE_MIN_LOD:33082,TEXTURE_MAX_LOD:33083,TEXTURE_BASE_LEVEL:33084,TEXTURE_MAX_LEVEL:33085,MIN:32775,MAX:32776,DEPTH_COMPONENT24:33190,MAX_TEXTURE_LOD_BIAS:34045,TEXTURE_COMPARE_MODE:34892,TEXTURE_COMPARE_FUNC:34893,CURRENT_QUERY:34917,QUERY_RESULT:34918,QUERY_RESULT_AVAILABLE:34919,STREAM_READ:35041,STREAM_COPY:35042,STATIC_READ:35045,STATIC_COPY:35046,DYNAMIC_READ:35049,DYNAMIC_COPY:35050,MAX_DRAW_BUFFERS:34852,DRAW_BUFFER0:34853,DRAW_BUFFER1:34854,DRAW_BUFFER2:34855,DRAW_BUFFER3:34856,DRAW_BUFFER4:34857,DRAW_BUFFER5:34858,DRAW_BUFFER6:34859,DRAW_BUFFER7:34860,DRAW_BUFFER8:34861,DRAW_BUFFER9:34862,DRAW_BUFFER10:34863,DRAW_BUFFER11:34864,DRAW_BUFFER12:34865,DRAW_BUFFER13:34866,DRAW_BUFFER14:34867,DRAW_BUFFER15:34868,MAX_FRAGMENT_UNIFORM_COMPONENTS:35657,MAX_VERTEX_UNIFORM_COMPONENTS:35658,SAMPLER_3D:35679,SAMPLER_2D_SHADOW:35682,FRAGMENT_SHADER_DERIVATIVE_HINT:35723,PIXEL_PACK_BUFFER:35051,PIXEL_UNPACK_BUFFER:35052,PIXEL_PACK_BUFFER_BINDING:35053,PIXEL_UNPACK_BUFFER_BINDING:35055,FLOAT_MAT2x3:35685,FLOAT_MAT2x4:35686,FLOAT_MAT3x2:35687,FLOAT_MAT3x4:35688,FLOAT_MAT4x2:35689,FLOAT_MAT4x3:35690,SRGB:35904,SRGB8:35905,SRGB8_ALPHA8:35907,COMPARE_REF_TO_TEXTURE:34894,RGBA32F:34836,RGB32F:34837,RGBA16F:34842,RGB16F:34843,VERTEX_ATTRIB_ARRAY_INTEGER:35069,MAX_ARRAY_TEXTURE_LAYERS:35071,MIN_PROGRAM_TEXEL_OFFSET:35076,MAX_PROGRAM_TEXEL_OFFSET:35077,MAX_VARYING_COMPONENTS:35659,TEXTURE_2D_ARRAY:35866,TEXTURE_BINDING_2D_ARRAY:35869,R11F_G11F_B10F:35898,UNSIGNED_INT_10F_11F_11F_REV:35899,RGB9_E5:35901,UNSIGNED_INT_5_9_9_9_REV:35902,TRANSFORM_FEEDBACK_BUFFER_MODE:35967,MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS:35968,TRANSFORM_FEEDBACK_VARYINGS:35971,TRANSFORM_FEEDBACK_BUFFER_START:35972,TRANSFORM_FEEDBACK_BUFFER_SIZE:35973,TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN:35976,RASTERIZER_DISCARD:35977,MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS:35978,MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS:35979,INTERLEAVED_ATTRIBS:35980,SEPARATE_ATTRIBS:35981,TRANSFORM_FEEDBACK_BUFFER:35982,TRANSFORM_FEEDBACK_BUFFER_BINDING:35983,RGBA32UI:36208,RGB32UI:36209,RGBA16UI:36214,RGB16UI:36215,RGBA8UI:36220,RGB8UI:36221,RGBA32I:36226,RGB32I:36227,RGBA16I:36232,RGB16I:36233,RGBA8I:36238,RGB8I:36239,RED_INTEGER:36244,RGB_INTEGER:36248,RGBA_INTEGER:36249,SAMPLER_2D_ARRAY:36289,SAMPLER_2D_ARRAY_SHADOW:36292,SAMPLER_CUBE_SHADOW:36293,UNSIGNED_INT_VEC2:36294,UNSIGNED_INT_VEC3:36295,UNSIGNED_INT_VEC4:36296,INT_SAMPLER_2D:36298,INT_SAMPLER_3D:36299,INT_SAMPLER_CUBE:36300,INT_SAMPLER_2D_ARRAY:36303,UNSIGNED_INT_SAMPLER_2D:36306,UNSIGNED_INT_SAMPLER_3D:36307,UNSIGNED_INT_SAMPLER_CUBE:36308,UNSIGNED_INT_SAMPLER_2D_ARRAY:36311,DEPTH_COMPONENT32F:36012,DEPTH32F_STENCIL8:36013,FLOAT_32_UNSIGNED_INT_24_8_REV:36269,FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING:33296,FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE:33297,FRAMEBUFFER_ATTACHMENT_RED_SIZE:33298,FRAMEBUFFER_ATTACHMENT_GREEN_SIZE:33299,FRAMEBUFFER_ATTACHMENT_BLUE_SIZE:33300,FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE:33301,FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE:33302,FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE:33303,FRAMEBUFFER_DEFAULT:33304,UNSIGNED_INT_24_8:34042,DEPTH24_STENCIL8:35056,UNSIGNED_NORMALIZED:35863,DRAW_FRAMEBUFFER_BINDING:36006,READ_FRAMEBUFFER:36008,DRAW_FRAMEBUFFER:36009,READ_FRAMEBUFFER_BINDING:36010,RENDERBUFFER_SAMPLES:36011,FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER:36052,MAX_COLOR_ATTACHMENTS:36063,COLOR_ATTACHMENT1:36065,COLOR_ATTACHMENT2:36066,COLOR_ATTACHMENT3:36067,COLOR_ATTACHMENT4:36068,COLOR_ATTACHMENT5:36069,COLOR_ATTACHMENT6:36070,COLOR_ATTACHMENT7:36071,COLOR_ATTACHMENT8:36072,COLOR_ATTACHMENT9:36073,COLOR_ATTACHMENT10:36074,COLOR_ATTACHMENT11:36075,COLOR_ATTACHMENT12:36076,COLOR_ATTACHMENT13:36077,COLOR_ATTACHMENT14:36078,COLOR_ATTACHMENT15:36079,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE:36182,MAX_SAMPLES:36183,HALF_FLOAT:5131,RG:33319,RG_INTEGER:33320,R8:33321,RG8:33323,R16F:33325,R32F:33326,RG16F:33327,RG32F:33328,R8I:33329,R8UI:33330,R16I:33331,R16UI:33332,R32I:33333,R32UI:33334,RG8I:33335,RG8UI:33336,RG16I:33337,RG16UI:33338,RG32I:33339,RG32UI:33340,VERTEX_ARRAY_BINDING:34229,R8_SNORM:36756,RG8_SNORM:36757,RGB8_SNORM:36758,RGBA8_SNORM:36759,SIGNED_NORMALIZED:36764,COPY_READ_BUFFER:36662,COPY_WRITE_BUFFER:36663,COPY_READ_BUFFER_BINDING:36662,COPY_WRITE_BUFFER_BINDING:36663,UNIFORM_BUFFER:35345,UNIFORM_BUFFER_BINDING:35368,UNIFORM_BUFFER_START:35369,UNIFORM_BUFFER_SIZE:35370,MAX_VERTEX_UNIFORM_BLOCKS:35371,MAX_FRAGMENT_UNIFORM_BLOCKS:35373,MAX_COMBINED_UNIFORM_BLOCKS:35374,MAX_UNIFORM_BUFFER_BINDINGS:35375,MAX_UNIFORM_BLOCK_SIZE:35376,MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS:35377,MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS:35379,UNIFORM_BUFFER_OFFSET_ALIGNMENT:35380,ACTIVE_UNIFORM_BLOCKS:35382,UNIFORM_TYPE:35383,UNIFORM_SIZE:35384,UNIFORM_BLOCK_INDEX:35386,UNIFORM_OFFSET:35387,UNIFORM_ARRAY_STRIDE:35388,UNIFORM_MATRIX_STRIDE:35389,UNIFORM_IS_ROW_MAJOR:35390,UNIFORM_BLOCK_BINDING:35391,UNIFORM_BLOCK_DATA_SIZE:35392,UNIFORM_BLOCK_ACTIVE_UNIFORMS:35394,UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES:35395,UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER:35396,UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER:35398,INVALID_INDEX:4294967295,MAX_VERTEX_OUTPUT_COMPONENTS:37154,MAX_FRAGMENT_INPUT_COMPONENTS:37157,MAX_SERVER_WAIT_TIMEOUT:37137,OBJECT_TYPE:37138,SYNC_CONDITION:37139,SYNC_STATUS:37140,SYNC_FLAGS:37141,SYNC_FENCE:37142,SYNC_GPU_COMMANDS_COMPLETE:37143,UNSIGNALED:37144,SIGNALED:37145,ALREADY_SIGNALED:37146,TIMEOUT_EXPIRED:37147,CONDITION_SATISFIED:37148,WAIT_FAILED:37149,SYNC_FLUSH_COMMANDS_BIT:1,VERTEX_ATTRIB_ARRAY_DIVISOR:35070,ANY_SAMPLES_PASSED:35887,ANY_SAMPLES_PASSED_CONSERVATIVE:36202,SAMPLER_BINDING:35097,RGB10_A2UI:36975,INT_2_10_10_10_REV:36255,TRANSFORM_FEEDBACK:36386,TRANSFORM_FEEDBACK_PAUSED:36387,TRANSFORM_FEEDBACK_ACTIVE:36388,TRANSFORM_FEEDBACK_BINDING:36389,COMPRESSED_R11_EAC:37488,COMPRESSED_SIGNED_R11_EAC:37489,COMPRESSED_RG11_EAC:37490,COMPRESSED_SIGNED_RG11_EAC:37491,COMPRESSED_RGB8_ETC2:37492,COMPRESSED_SRGB8_ETC2:37493,COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:37494,COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:37495,COMPRESSED_RGBA8_ETC2_EAC:37496,COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:37497,TEXTURE_IMMUTABLE_FORMAT:37167,MAX_ELEMENT_INDEX:36203,TEXTURE_IMMUTABLE_LEVELS:33503,MAX_TEXTURE_MAX_ANISOTROPY_EXT:34047})}),define("Core/ComponentDatatype",["./defaultValue","./defined","./DeveloperError","./FeatureDetection","./freezeObject","./WebGLConstants"],function(e,t,n,r,i,a){"use strict";if(!r.supportsTypedArrays())return{};var o={BYTE:a.BYTE,UNSIGNED_BYTE:a.UNSIGNED_BYTE,SHORT:a.SHORT,UNSIGNED_SHORT:a.UNSIGNED_SHORT,INT:a.INT,UNSIGNED_INT:a.UNSIGNED_INT,FLOAT:a.FLOAT,DOUBLE:a.DOUBLE};return o.getSizeInBytes=function(e){if(!t(e))throw new n("value is required.");switch(e){case o.BYTE:return Int8Array.BYTES_PER_ELEMENT;case o.UNSIGNED_BYTE:return Uint8Array.BYTES_PER_ELEMENT;case o.SHORT:return Int16Array.BYTES_PER_ELEMENT;case o.UNSIGNED_SHORT:return Uint16Array.BYTES_PER_ELEMENT;case o.INT:return Int32Array.BYTES_PER_ELEMENT;case o.UNSIGNED_INT:return Uint32Array.BYTES_PER_ELEMENT;case o.FLOAT:return Float32Array.BYTES_PER_ELEMENT;case o.DOUBLE:return Float64Array.BYTES_PER_ELEMENT;default:throw new n("componentDatatype is not a valid value.")}},o.fromTypedArray=function(e){return e instanceof Int8Array?o.BYTE:e instanceof Uint8Array?o.UNSIGNED_BYTE:e instanceof Int16Array?o.SHORT:e instanceof Uint16Array?o.UNSIGNED_SHORT:e instanceof Int32Array?o.INT:e instanceof Uint32Array?o.UNSIGNED_INT:e instanceof Float32Array?o.FLOAT:e instanceof Float64Array?o.DOUBLE:void 0},o.validate=function(e){return t(e)&&(e===o.BYTE||e===o.UNSIGNED_BYTE||e===o.SHORT||e===o.UNSIGNED_SHORT||e===o.INT||e===o.UNSIGNED_INT||e===o.FLOAT||e===o.DOUBLE)},o.createTypedArray=function(e,r){if(!t(e))throw new n("componentDatatype is required.");if(!t(r))throw new n("valuesOrLength is required.");switch(e){case o.BYTE:return new Int8Array(r);case o.UNSIGNED_BYTE:return new Uint8Array(r);case o.SHORT:return new Int16Array(r);case o.UNSIGNED_SHORT:return new Uint16Array(r);case o.INT:return new Int32Array(r);case o.UNSIGNED_INT:return new Uint32Array(r);case o.FLOAT:return new Float32Array(r);case o.DOUBLE:return new Float64Array(r);default:throw new n("componentDatatype is not a valid value.")}},o.createArrayBufferView=function(r,i,a,s){if(!t(r))throw new n("componentDatatype is required.");if(!t(i))throw new n("buffer is required.");switch(a=e(a,0),s=e(s,(i.byteLength-a)/o.getSizeInBytes(r)),r){case o.BYTE:return new Int8Array(i,a,s);case o.UNSIGNED_BYTE:return new Uint8Array(i,a,s);case o.SHORT:return new Int16Array(i,a,s);case o.UNSIGNED_SHORT:return new Uint16Array(i,a,s);case o.INT:return new Int32Array(i,a,s);case o.UNSIGNED_INT:return new Uint32Array(i,a,s);case o.FLOAT:return new Float32Array(i,a,s);case o.DOUBLE:return new Float64Array(i,a,s);default:throw new n("componentDatatype is not a valid value.")}},o.fromName=function(e){switch(e){case"BYTE":return o.BYTE;case"UNSIGNED_BYTE":return o.UNSIGNED_BYTE;case"SHORT":return o.SHORT;case"UNSIGNED_SHORT":return o.UNSIGNED_SHORT;case"INT":return o.INT;case"UNSIGNED_INT":return o.UNSIGNED_INT;case"FLOAT":return o.FLOAT;case"DOUBLE":return o.DOUBLE;default:throw new n("name is not a valid value.")}},i(o)}),define("Core/EllipsoidGeodesic",["./Cartesian3","./Cartographic","./Check","./defaultValue","./defined","./defineProperties","./Ellipsoid","./Math"],function(e,t,n,r,i,a,o,s){"use strict";function u(e){var t=e._uSquared,n=e._ellipsoid.maximumRadius,r=e._ellipsoid.minimumRadius,i=(n-r)/n,a=Math.cos(e._startHeading),o=Math.sin(e._startHeading),s=(1-i)*Math.tan(e._start.latitude),u=1/Math.sqrt(1+s*s),c=u*s,l=Math.atan2(s,a),f=u*o,d=f*f,h=1-d,p=Math.sqrt(h),m=t/4,_=m*m,y=_*m,v=_*_,g=1+m-3*_/4+5*y/4-175*v/64,E=1-m+15*_/8-35*y/8,T=1-3*m+35*_/4,w=1-5*m,b=g*l-E*Math.sin(2*l)*m/2-T*Math.sin(4*l)*_/16-w*Math.sin(6*l)*y/48-5*Math.sin(8*l)*v/512,S=e._constants;S.a=n,S.b=r,S.f=i,S.cosineHeading=a,S.sineHeading=o,S.tanU=s,S.cosineU=u,S.sineU=c,S.sigma=l,S.sineAlpha=f,S.sineSquaredAlpha=d,S.cosineSquaredAlpha=h,S.cosineAlpha=p,S.u2Over4=m,S.u4Over16=_,S.u6Over64=y,S.u8Over256=v,S.a0=g,S.a1=E,S.a2=T,S.a3=w,S.distanceRatio=b}function c(e,t){return e*t*(4+e*(4-3*t))/16}function l(e,t,n,r,i,a,o){var s=c(e,n);return(1-s)*e*t*(r+s*i*(o+s*a*(2*o*o-1)))}function f(e,t,n,r,i,a,o){var u,c,f,d,h,p=(t-n)/t,m=a-r,_=Math.atan((1-p)*Math.tan(i)),y=Math.atan((1-p)*Math.tan(o)),v=Math.cos(_),g=Math.sin(_),E=Math.cos(y),T=Math.sin(y),w=v*E,b=v*T,S=g*T,C=g*E,O=m,A=s.TWO_PI,x=Math.cos(O),R=Math.sin(O);do{x=Math.cos(O),R=Math.sin(O);var I=b-C*x;f=Math.sqrt(E*E*R*R+I*I),c=S+w*x,u=Math.atan2(f,c);var D;0===f?(D=0,d=1):(D=w*R/f,d=1-D*D),A=O,h=c-2*S/d,isNaN(h)&&(h=0),O=m+l(p,D,d,u,f,c,h)}while(Math.abs(O-A)>s.EPSILON12);var P=d*(t*t-n*n)/(n*n),N=1+P*(4096+P*(P*(320-175*P)-768))/16384,M=P*(256+P*(P*(74-47*P)-128))/1024,z=h*h,F=M*f*(h+M*(c*(2*z-1)-M*h*(4*f*f-3)*(4*z-3)/6)/4),L=n*N*(u-F),B=Math.atan2(E*R,b-C*x),U=Math.atan2(v*R,b*x-C);e._distance=L,e._startHeading=B,e._endHeading=U,e._uSquared=P}function d(r,i,a,o){var s=e.normalize(o.cartographicToCartesian(i,m),p),c=e.normalize(o.cartographicToCartesian(a,m),m);n.typeOf.number.greaterThanOrEquals("value",Math.abs(Math.abs(e.angleBetween(s,c))-Math.PI),.0125),f(r,o.maximumRadius,o.minimumRadius,i.longitude,i.latitude,a.longitude,a.latitude),r._start=t.clone(i,r._start),r._end=t.clone(a,r._end),r._start.height=0,r._end.height=0,u(r)}function h(e,n,a){var s=r(a,o.WGS84);this._ellipsoid=s,this._start=new t,this._end=new t,this._constants={},this._startHeading=void 0,this._endHeading=void 0,this._distance=void 0,this._uSquared=void 0,i(e)&&i(n)&&d(this,e,n,s)}var p=new e,m=new e;return a(h.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},surfaceDistance:{get:function(){return n.defined("distance",this._distance),this._distance}},start:{get:function(){return this._start}},end:{get:function(){return this._end}},startHeading:{get:function(){return n.defined("distance",this._distance),this._startHeading}},endHeading:{get:function(){return n.defined("distance",this._distance),this._endHeading}}}),h.prototype.setEndPoints=function(e,t){n.defined("start",e),n.defined("end",t),d(this,e,t,this._ellipsoid)},h.prototype.interpolateUsingFraction=function(e,t){return this.interpolateUsingSurfaceDistance(this._distance*e,t)},h.prototype.interpolateUsingSurfaceDistance=function(e,r){n.defined("distance",this._distance);var a=this._constants,o=a.distanceRatio+e/a.b,s=Math.cos(2*o),u=Math.cos(4*o),c=Math.cos(6*o),f=Math.sin(2*o),d=Math.sin(4*o),h=Math.sin(6*o),p=Math.sin(8*o),m=o*o,_=o*m,y=a.u8Over256,v=a.u2Over4,g=a.u6Over64,E=a.u4Over16,T=2*_*y*s/3+o*(1-v+7*E/4-15*g/4+579*y/64-(E-15*g/4+187*y/16)*s-(5*g/4-115*y/16)*u-29*y*c/16)+(v/2-E+71*g/32-85*y/16)*f+(5*E/16-5*g/4+383*y/96)*d-m*((g-11*y/2)*f+5*y*d/2)+(29*g/96-29*y/16)*h+539*y*p/1536,w=Math.asin(Math.sin(T)*a.cosineAlpha),b=Math.atan(a.a/a.b*Math.tan(w));T-=a.sigma;var S=Math.cos(2*a.sigma+T),C=Math.sin(T),O=Math.cos(T),A=a.cosineU*O,x=a.sineU*C,R=Math.atan2(C*a.sineHeading,A-x*a.cosineHeading),I=R-l(a.f,a.sineAlpha,a.cosineSquaredAlpha,T,C,O,S);return i(r)?(r.longitude=this._start.longitude+I,r.latitude=b,r.height=0,r):new t(this._start.longitude+I,b,0)},h}),define("Core/EncodedCartesian3",["./Cartesian3","./Check","./defined"],function(e,t,n){"use strict";function r(){this.high=e.clone(e.ZERO),this.low=e.clone(e.ZERO)}r.encode=function(e,r){t.typeOf.number("value",e),n(r)||(r={high:0,low:0});var i;return e>=0?(i=65536*Math.floor(e/65536),r.high=i,r.low=e-i):(i=65536*Math.floor(-e/65536),r.high=-i,r.low=e+i),r};var i={high:0,low:0};r.fromCartesian=function(e,a){t.typeOf.object("cartesian",e),n(a)||(a=new r);var o=a.high,s=a.low;return r.encode(e.x,i),o.x=i.high,s.x=i.low,r.encode(e.y,i),o.y=i.high,s.y=i.low,r.encode(e.z,i),o.z=i.high,s.z=i.low,a};var a=new r;return r.writeElements=function(e,n,i){t.defined("cartesianArray",n),t.typeOf.number("index",i),t.typeOf.number.greaterThanOrEquals("index",i,0),r.fromCartesian(e,a);var o=a.high,s=a.low;n[i]=o.x,n[i+1]=o.y,n[i+2]=o.z,n[i+3]=s.x,n[i+4]=s.y,n[i+5]=s.z},r}),define("Core/GeometryOffsetAttribute",["../Core/freezeObject"],function(e){"use strict";return e({NONE:0,TOP:1,ALL:2})}),define("Core/GeometryType",["./freezeObject"],function(e){"use strict";return e({NONE:0,TRIANGLES:1,LINES:2,POLYLINES:3})}),define("Core/Matrix2",["./Cartesian2","./Check","./defaultValue","./defined","./defineProperties","./freezeObject"],function(e,t,n,r,i,a){"use strict";function o(e,t,r,i){this[0]=n(e,0),this[1]=n(r,0),this[2]=n(t,0),this[3]=n(i,0)}o.packedLength=4,o.pack=function(e,r,i){return t.typeOf.object("value",e),t.defined("array",r),i=n(i,0),r[i++]=e[0],r[i++]=e[1],r[i++]=e[2],r[i++]=e[3],r},o.unpack=function(e,i,a){return t.defined("array",e),i=n(i,0),r(a)||(a=new o),a[0]=e[i++],a[1]=e[i++],a[2]=e[i++],a[3]=e[i++],a},o.clone=function(e,t){if(r(e))return r(t)?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t):new o(e[0],e[2],e[1],e[3])},o.fromArray=function(e,i,a){return t.defined("array",e),i=n(i,0),r(a)||(a=new o),a[0]=e[i],a[1]=e[i+1],a[2]=e[i+2],a[3]=e[i+3],a},o.fromColumnMajorArray=function(e,n){return t.defined("values",e),o.clone(e,n)},o.fromRowMajorArray=function(e,n){return t.defined("values",e),r(n)?(n[0]=e[0],n[1]=e[2],n[2]=e[1],n[3]=e[3],n):new o(e[0],e[1],e[2],e[3])},o.fromScale=function(e,n){return t.typeOf.object("scale",e),r(n)?(n[0]=e.x,n[1]=0,n[2]=0,n[3]=e.y,n):new o(e.x,0,0,e.y)},o.fromUniformScale=function(e,n){return t.typeOf.number("scale",e),r(n)?(n[0]=e,n[1]=0,n[2]=0,n[3]=e,n):new o(e,0,0,e)},o.fromRotation=function(e,n){t.typeOf.number("angle",e);var i=Math.cos(e),a=Math.sin(e);return r(n)?(n[0]=i,n[1]=a,n[2]=-a,n[3]=i,n):new o(i,-a,a,i)},o.toArray=function(e,n){return t.typeOf.object("matrix",e),r(n)?(n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n):[e[0],e[1],e[2],e[3]]},o.getElementIndex=function(e,n){return t.typeOf.number.greaterThanOrEquals("row",n,0),t.typeOf.number.lessThanOrEquals("row",n,1),t.typeOf.number.greaterThanOrEquals("column",e,0),t.typeOf.number.lessThanOrEquals("column",e,1),2*e+n},o.getColumn=function(e,n,r){t.typeOf.object("matrix",e),t.typeOf.number.greaterThanOrEquals("index",n,0),t.typeOf.number.lessThanOrEquals("index",n,1),t.typeOf.object("result",r);var i=2*n,a=e[i],o=e[i+1];return r.x=a,r.y=o,r},o.setColumn=function(e,n,r,i){t.typeOf.object("matrix",e),t.typeOf.number.greaterThanOrEquals("index",n,0),t.typeOf.number.lessThanOrEquals("index",n,1),t.typeOf.object("cartesian",r),t.typeOf.object("result",i),i=o.clone(e,i);var a=2*n;return i[a]=r.x,i[a+1]=r.y,i},o.getRow=function(e,n,r){t.typeOf.object("matrix",e),t.typeOf.number.greaterThanOrEquals("index",n,0),t.typeOf.number.lessThanOrEquals("index",n,1),t.typeOf.object("result",r);var i=e[n],a=e[n+2];return r.x=i,r.y=a,r},o.setRow=function(e,n,r,i){return t.typeOf.object("matrix",e),t.typeOf.number.greaterThanOrEquals("index",n,0),t.typeOf.number.lessThanOrEquals("index",n,1),t.typeOf.object("cartesian",r),t.typeOf.object("result",i),i=o.clone(e,i),i[n]=r.x,i[n+2]=r.y,i};var s=new e;o.getScale=function(n,r){return t.typeOf.object("matrix",n),t.typeOf.object("result",r),r.x=e.magnitude(e.fromElements(n[0],n[1],s)),r.y=e.magnitude(e.fromElements(n[2],n[3],s)),r};var u=new e;return o.getMaximumScale=function(t){return o.getScale(t,u),e.maximumComponent(u)},o.multiply=function(e,n,r){t.typeOf.object("left",e),t.typeOf.object("right",n),t.typeOf.object("result",r);var i=e[0]*n[0]+e[2]*n[1],a=e[0]*n[2]+e[2]*n[3],o=e[1]*n[0]+e[3]*n[1],s=e[1]*n[2]+e[3]*n[3];return r[0]=i,r[1]=o,r[2]=a,r[3]=s,r},o.add=function(e,n,r){return t.typeOf.object("left",e),t.typeOf.object("right",n),t.typeOf.object("result",r),r[0]=e[0]+n[0],r[1]=e[1]+n[1],r[2]=e[2]+n[2],r[3]=e[3]+n[3],r},o.subtract=function(e,n,r){return t.typeOf.object("left",e),t.typeOf.object("right",n),t.typeOf.object("result",r),r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],r[3]=e[3]-n[3],r},o.multiplyByVector=function(e,n,r){t.typeOf.object("matrix",e),t.typeOf.object("cartesian",n),t.typeOf.object("result",r);var i=e[0]*n.x+e[2]*n.y,a=e[1]*n.x+e[3]*n.y;return r.x=i,r.y=a,r},o.multiplyByScalar=function(e,n,r){return t.typeOf.object("matrix",e),t.typeOf.number("scalar",n),t.typeOf.object("result",r),r[0]=e[0]*n,r[1]=e[1]*n,r[2]=e[2]*n,r[3]=e[3]*n,r},o.multiplyByScale=function(e,n,r){return t.typeOf.object("matrix",e),t.typeOf.object("scale",n),t.typeOf.object("result",r),r[0]=e[0]*n.x,r[1]=e[1]*n.x,r[2]=e[2]*n.y,r[3]=e[3]*n.y,r},o.negate=function(e,n){return t.typeOf.object("matrix",e),t.typeOf.object("result",n),n[0]=-e[0],n[1]=-e[1],n[2]=-e[2],n[3]=-e[3],n},o.transpose=function(e,n){t.typeOf.object("matrix",e),t.typeOf.object("result",n);var r=e[0],i=e[2],a=e[1],o=e[3];return n[0]=r,n[1]=i,n[2]=a,n[3]=o,n},o.abs=function(e,n){return t.typeOf.object("matrix",e),t.typeOf.object("result",n),n[0]=Math.abs(e[0]),n[1]=Math.abs(e[1]),n[2]=Math.abs(e[2]),n[3]=Math.abs(e[3]),n},o.equals=function(e,t){return e===t||r(e)&&r(t)&&e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]},o.equalsArray=function(e,t,n){return e[0]===t[n]&&e[1]===t[n+1]&&e[2]===t[n+2]&&e[3]===t[n+3]},o.equalsEpsilon=function(e,n,i){return t.typeOf.number("epsilon",i),e===n||r(e)&&r(n)&&Math.abs(e[0]-n[0])<=i&&Math.abs(e[1]-n[1])<=i&&Math.abs(e[2]-n[2])<=i&&Math.abs(e[3]-n[3])<=i},o.IDENTITY=a(new o(1,0,0,1)),o.ZERO=a(new o(0,0,0,0)),o.COLUMN0ROW0=0,o.COLUMN0ROW1=1,o.COLUMN1ROW0=2,o.COLUMN1ROW1=3,i(o.prototype,{length:{get:function(){return o.packedLength}}}),o.prototype.clone=function(e){return o.clone(this,e)},o.prototype.equals=function(e){return o.equals(this,e)},o.prototype.equalsEpsilon=function(e,t){return o.equalsEpsilon(this,e,t)},o.prototype.toString=function(){return"("+this[0]+", "+this[2]+")\n("+this[1]+", "+this[3]+")"},o}),define("Core/PrimitiveType",["./freezeObject","./WebGLConstants"],function(e,t){"use strict";var n={POINTS:t.POINTS,LINES:t.LINES,LINE_LOOP:t.LINE_LOOP,LINE_STRIP:t.LINE_STRIP,TRIANGLES:t.TRIANGLES,TRIANGLE_STRIP:t.TRIANGLE_STRIP,TRIANGLE_FAN:t.TRIANGLE_FAN,validate:function(e){return e===n.POINTS||e===n.LINES||e===n.LINE_LOOP||e===n.LINE_STRIP||e===n.TRIANGLES||e===n.TRIANGLE_STRIP||e===n.TRIANGLE_FAN}};return e(n)}),define("Core/Quaternion",["./Cartesian3","./Check","./defaultValue","./defined","./FeatureDetection","./freezeObject","./Math","./Matrix3"],function(e,t,n,r,i,a,o,s){"use strict";function u(e,t,r,i){this.x=n(e,0),this.y=n(t,0),this.z=n(r,0),this.w=n(i,0)}var c=new e;u.fromAxisAngle=function(n,i,a){t.typeOf.object("axis",n),t.typeOf.number("angle",i);var o=i/2,s=Math.sin(o);c=e.normalize(n,c);var l=c.x*s,f=c.y*s,d=c.z*s,h=Math.cos(o);return r(a)?(a.x=l,a.y=f,a.z=d,a.w=h,a):new u(l,f,d,h)};var l=[1,2,0],f=new Array(3);u.fromRotationMatrix=function(e,n){t.typeOf.object("matrix",e);var i,a,o,c,d,h=e[s.COLUMN0ROW0],p=e[s.COLUMN1ROW1],m=e[s.COLUMN2ROW2],_=h+p+m;if(_>0)i=Math.sqrt(_+1),d=.5*i,i=.5/i,a=(e[s.COLUMN1ROW2]-e[s.COLUMN2ROW1])*i,o=(e[s.COLUMN2ROW0]-e[s.COLUMN0ROW2])*i,c=(e[s.COLUMN0ROW1]-e[s.COLUMN1ROW0])*i;else{var y=l,v=0;p>h&&(v=1),m>h&&m>p&&(v=2);var g=y[v],E=y[g];i=Math.sqrt(e[s.getElementIndex(v,v)]-e[s.getElementIndex(g,g)]-e[s.getElementIndex(E,E)]+1);var T=f;T[v]=.5*i,i=.5/i,d=(e[s.getElementIndex(E,g)]-e[s.getElementIndex(g,E)])*i,T[g]=(e[s.getElementIndex(g,v)]+e[s.getElementIndex(v,g)])*i,T[E]=(e[s.getElementIndex(E,v)]+e[s.getElementIndex(v,E)])*i,a=-T[0],o=-T[1],c=-T[2]}return r(n)?(n.x=a,n.y=o,n.z=c,n.w=d,n):new u(a,o,c,d)};var d=new u,h=new u,p=new u,m=new u;u.fromHeadingPitchRoll=function(n,r){return t.typeOf.object("headingPitchRoll",n),m=u.fromAxisAngle(e.UNIT_X,n.roll,d),p=u.fromAxisAngle(e.UNIT_Y,-n.pitch,r),r=u.multiply(p,m,p),h=u.fromAxisAngle(e.UNIT_Z,-n.heading,d),u.multiply(h,r,r)};var _=new e,y=new e,v=new u,g=new u,E=new u;u.packedLength=4,u.pack=function(e,r,i){return t.typeOf.object("value",e),t.defined("array",r),i=n(i,0),r[i++]=e.x,r[i++]=e.y,r[i++]=e.z,r[i]=e.w,r},u.unpack=function(e,i,a){return t.defined("array",e),i=n(i,0),r(a)||(a=new u),a.x=e[i],a.y=e[i+1],a.z=e[i+2],a.w=e[i+3],a},u.packedInterpolationLength=3,u.convertPackedArrayForInterpolation=function(e,t,n,r){u.unpack(e,4*n,E),u.conjugate(E,E);for(var i=0,a=n-t+1;i<a;i++){var o=3*i;u.unpack(e,4*(t+i),v),u.multiply(v,E,v),v.w<0&&u.negate(v,v),u.computeAxis(v,_);var s=u.computeAngle(v);r[o]=_.x*s,r[o+1]=_.y*s,r[o+2]=_.z*s}},u.unpackInterpolationResult=function(t,n,i,a,o){r(o)||(o=new u),e.fromArray(t,0,y);var s=e.magnitude(y);return u.unpack(n,4*a,g),0===s?u.clone(u.IDENTITY,v):u.fromAxisAngle(y,s,v),u.multiply(v,g,o)},u.clone=function(e,t){if(r(e))return r(t)?(t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t):new u(e.x,e.y,e.z,e.w)},u.conjugate=function(e,n){return t.typeOf.object("quaternion",e),t.typeOf.object("result",n),n.x=-e.x,n.y=-e.y,n.z=-e.z,n.w=e.w,n},u.magnitudeSquared=function(e){return t.typeOf.object("quaternion",e),e.x*e.x+e.y*e.y+e.z*e.z+e.w*e.w},u.magnitude=function(e){return Math.sqrt(u.magnitudeSquared(e))},u.normalize=function(e,n){t.typeOf.object("result",n);var r=1/u.magnitude(e),i=e.x*r,a=e.y*r,o=e.z*r,s=e.w*r;return n.x=i,n.y=a,n.z=o,n.w=s,n},u.inverse=function(e,n){t.typeOf.object("result",n);var r=u.magnitudeSquared(e);return n=u.conjugate(e,n),u.multiplyByScalar(n,1/r,n)},u.add=function(e,n,r){return t.typeOf.object("left",e),t.typeOf.object("right",n),t.typeOf.object("result",r),r.x=e.x+n.x,r.y=e.y+n.y,r.z=e.z+n.z,r.w=e.w+n.w,r},u.subtract=function(e,n,r){return t.typeOf.object("left",e),t.typeOf.object("right",n),t.typeOf.object("result",r),r.x=e.x-n.x,r.y=e.y-n.y,r.z=e.z-n.z,r.w=e.w-n.w,r},u.negate=function(e,n){return t.typeOf.object("quaternion",e),t.typeOf.object("result",n),n.x=-e.x,n.y=-e.y,n.z=-e.z,n.w=-e.w,n},u.dot=function(e,n){return t.typeOf.object("left",e),t.typeOf.object("right",n),e.x*n.x+e.y*n.y+e.z*n.z+e.w*n.w},u.multiply=function(e,n,r){t.typeOf.object("left",e),t.typeOf.object("right",n),t.typeOf.object("result",r);var i=e.x,a=e.y,o=e.z,s=e.w,u=n.x,c=n.y,l=n.z,f=n.w,d=s*u+i*f+a*l-o*c,h=s*c-i*l+a*f+o*u,p=s*l+i*c-a*u+o*f,m=s*f-i*u-a*c-o*l;return r.x=d,r.y=h,r.z=p,r.w=m,r},u.multiplyByScalar=function(e,n,r){return t.typeOf.object("quaternion",e),t.typeOf.number("scalar",n),t.typeOf.object("result",r),r.x=e.x*n,r.y=e.y*n,r.z=e.z*n,r.w=e.w*n,r},u.divideByScalar=function(e,n,r){return t.typeOf.object("quaternion",e),t.typeOf.number("scalar",n),t.typeOf.object("result",r),r.x=e.x/n,r.y=e.y/n,r.z=e.z/n,r.w=e.w/n,r},u.computeAxis=function(e,n){t.typeOf.object("quaternion",e),t.typeOf.object("result",n);var r=e.w;if(Math.abs(r-1)<o.EPSILON6)return n.x=n.y=n.z=0,n;var i=1/Math.sqrt(1-r*r);return n.x=e.x*i,n.y=e.y*i,n.z=e.z*i,n},u.computeAngle=function(e){return t.typeOf.object("quaternion",e),Math.abs(e.w-1)<o.EPSILON6?0:2*Math.acos(e.w)};var T=new u;u.lerp=function(e,n,r,i){return t.typeOf.object("start",e),t.typeOf.object("end",n),t.typeOf.number("t",r),t.typeOf.object("result",i),T=u.multiplyByScalar(n,r,T),i=u.multiplyByScalar(e,1-r,i),u.add(T,i,i)};var w=new u,b=new u,S=new u;u.slerp=function(e,n,r,i){t.typeOf.object("start",e),t.typeOf.object("end",n),t.typeOf.number("t",r),t.typeOf.object("result",i);var a=u.dot(e,n),s=n;if(a<0&&(a=-a,s=w=u.negate(n,w)),1-a<o.EPSILON6)return u.lerp(e,s,r,i);var c=Math.acos(a);return b=u.multiplyByScalar(e,Math.sin((1-r)*c),b),S=u.multiplyByScalar(s,Math.sin(r*c),S),i=u.add(b,S,i),u.multiplyByScalar(i,1/Math.sin(c),i)},u.log=function(n,r){t.typeOf.object("quaternion",n),t.typeOf.object("result",r);var i=o.acosClamped(n.w),a=0;return 0!==i&&(a=i/Math.sin(i)),e.multiplyByScalar(n,a,r)},u.exp=function(n,r){t.typeOf.object("cartesian",n),t.typeOf.object("result",r);var i=e.magnitude(n),a=0;return 0!==i&&(a=Math.sin(i)/i),r.x=n.x*a,r.y=n.y*a,r.z=n.z*a,r.w=Math.cos(i),r};var C=new e,O=new e,A=new u,x=new u;u.computeInnerQuadrangle=function(n,r,i,a){t.typeOf.object("q0",n),t.typeOf.object("q1",r),t.typeOf.object("q2",i),t.typeOf.object("result",a);var o=u.conjugate(r,A);u.multiply(o,i,x);var s=u.log(x,C);u.multiply(o,n,x);var c=u.log(x,O);return e.add(s,c,s),e.multiplyByScalar(s,.25,s),e.negate(s,s),u.exp(s,A),u.multiply(r,A,a)},u.squad=function(e,n,r,i,a,o){t.typeOf.object("q0",e),t.typeOf.object("q1",n),t.typeOf.object("s0",r),t.typeOf.object("s1",i),t.typeOf.number("t",a),t.typeOf.object("result",o);var s=u.slerp(e,n,a,A),c=u.slerp(r,i,a,x);return u.slerp(s,c,2*a*(1-a),o)};for(var R=new u,I=1.9011074535173003,D=i.supportsTypedArrays()?new Float32Array(8):[],P=i.supportsTypedArrays()?new Float32Array(8):[],N=i.supportsTypedArrays()?new Float32Array(8):[],M=i.supportsTypedArrays()?new Float32Array(8):[],z=0;z<7;++z){var F=z+1,L=2*F+1;D[z]=1/(F*L),P[z]=F/L}return D[7]=I/136,P[7]=8*I/17,u.fastSlerp=function(e,n,r,i){t.typeOf.object("start",e),t.typeOf.object("end",n),t.typeOf.number("t",r),t.typeOf.object("result",i);var a,o=u.dot(e,n);o>=0?a=1:(a=-1,o=-o);for(var s=o-1,c=1-r,l=r*r,f=c*c,d=7;d>=0;--d)N[d]=(D[d]*l-P[d])*s,M[d]=(D[d]*f-P[d])*s;var h=a*r*(1+N[0]*(1+N[1]*(1+N[2]*(1+N[3]*(1+N[4]*(1+N[5]*(1+N[6]*(1+N[7])))))))),p=c*(1+M[0]*(1+M[1]*(1+M[2]*(1+M[3]*(1+M[4]*(1+M[5]*(1+M[6]*(1+M[7])))))))),m=u.multiplyByScalar(e,p,R);return u.multiplyByScalar(n,h,i),u.add(m,i,i)},u.fastSquad=function(e,n,r,i,a,o){t.typeOf.object("q0",e),t.typeOf.object("q1",n),t.typeOf.object("s0",r),t.typeOf.object("s1",i),t.typeOf.number("t",a),t.typeOf.object("result",o);var s=u.fastSlerp(e,n,a,A),c=u.fastSlerp(r,i,a,x);return u.fastSlerp(s,c,2*a*(1-a),o)},u.equals=function(e,t){return e===t||r(e)&&r(t)&&e.x===t.x&&e.y===t.y&&e.z===t.z&&e.w===t.w},
u.equalsEpsilon=function(e,n,i){return t.typeOf.number("epsilon",i),e===n||r(e)&&r(n)&&Math.abs(e.x-n.x)<=i&&Math.abs(e.y-n.y)<=i&&Math.abs(e.z-n.z)<=i&&Math.abs(e.w-n.w)<=i},u.ZERO=a(new u(0,0,0,0)),u.IDENTITY=a(new u(0,0,0,1)),u.prototype.clone=function(e){return u.clone(this,e)},u.prototype.equals=function(e){return u.equals(this,e)},u.prototype.equalsEpsilon=function(e,t){return u.equalsEpsilon(this,e,t)},u.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.z+", "+this.w+")"},u}),define("Core/binarySearch",["./Check"],function(e){"use strict";function t(t,n,r){e.defined("array",t),e.defined("itemToFind",n),e.defined("comparator",r);for(var i,a,o=0,s=t.length-1;o<=s;)if(i=~~((o+s)/2),(a=r(t[i],n))<0)o=i+1;else{if(!(a>0))return i;s=i-1}return~(s+1)}return t}),define("Core/EarthOrientationParametersSample",[],function(){"use strict";function e(e,t,n,r,i){this.xPoleWander=e,this.yPoleWander=t,this.xPoleOffset=n,this.yPoleOffset=r,this.ut1MinusUtc=i}return e}),define("ThirdParty/sprintf",[],function(){function e(){var e=/%%|%(\d+\$)?([-+\'#0 ]*)(\*\d+\$|\*|\d+)?(\.(\*\d+\$|\*|\d+))?([scboxXuideEfFgG])/g,t=arguments,n=0,r=t[n++],i=function(e,t,n,r){n||(n=" ");var i=e.length>=t?"":Array(1+t-e.length>>>0).join(n);return r?e+i:i+e},a=function(e,t,n,r,a,o){var s=r-e.length;return s>0&&(e=n||!a?i(e,r,o,n):e.slice(0,t.length)+i("",s,"0",!0)+e.slice(t.length)),e},o=function(e,t,n,r,o,s,u){var c=e>>>0;return n=n&&c&&{2:"0b",8:"0",16:"0x"}[t]||"",e=n+i(c.toString(t),s||0,"0",!1),a(e,n,r,o,u)},s=function(e,t,n,r,i,o){return null!=r&&(e=e.slice(0,r)),a(e,"",t,n,i,o)},u=function(e,r,u,c,l,f,d){var h,p,m,_,y;if("%%"==e)return"%";for(var v=!1,g="",E=!1,T=!1,w=" ",b=u.length,S=0;u&&S<b;S++)switch(u.charAt(S)){case" ":g=" ";break;case"+":g="+";break;case"-":v=!0;break;case"'":w=u.charAt(S+1);break;case"0":E=!0;break;case"#":T=!0}if(c=c?"*"==c?+t[n++]:"*"==c.charAt(0)?+t[c.slice(1,-1)]:+c:0,c<0&&(c=-c,v=!0),!isFinite(c))throw new Error("sprintf: (minimum-)width must be finite");switch(f=f?"*"==f?+t[n++]:"*"==f.charAt(0)?+t[f.slice(1,-1)]:+f:"fFeE".indexOf(d)>-1?6:"d"==d?0:void 0,y=r?t[r.slice(0,-1)]:t[n++],d){case"s":return s(String(y),v,c,f,E,w);case"c":return s(String.fromCharCode(+y),v,c,f,E);case"b":return o(y,2,T,v,c,f,E);case"o":return o(y,8,T,v,c,f,E);case"x":return o(y,16,T,v,c,f,E);case"X":return o(y,16,T,v,c,f,E).toUpperCase();case"u":return o(y,10,T,v,c,f,E);case"i":case"d":return h=+y||0,h=Math.round(h-h%1),p=h<0?"-":g,y=p+i(String(Math.abs(h)),f,"0",!1),a(y,p,v,c,E);case"e":case"E":case"f":case"F":case"g":case"G":return h=+y,p=h<0?"-":g,m=["toExponential","toFixed","toPrecision"]["efg".indexOf(d.toLowerCase())],_=["toString","toUpperCase"]["eEfFgG".indexOf(d)%2],y=p+Math.abs(h)[m](f),a(y,p,v,c,E)[_]();default:return e}};return r.replace(e,u)}return e}),define("Core/GregorianDate",[],function(){"use strict";function e(e,t,n,r,i,a,o,s){this.year=e,this.month=t,this.day=n,this.hour=r,this.minute=i,this.second=a,this.millisecond=o,this.isLeapSecond=s}return e}),define("Core/isLeapYear",["./DeveloperError"],function(e){"use strict";function t(t){if(null===t||isNaN(t))throw new e("year is required and must be a number.");return t%4==0&&t%100!=0||t%400==0}return t}),define("Core/LeapSecond",[],function(){"use strict";function e(e,t){this.julianDate=e,this.offset=t}return e}),define("Core/TimeConstants",["./freezeObject"],function(e){"use strict";return e({SECONDS_PER_MILLISECOND:.001,SECONDS_PER_MINUTE:60,MINUTES_PER_HOUR:60,HOURS_PER_DAY:24,SECONDS_PER_HOUR:3600,MINUTES_PER_DAY:1440,SECONDS_PER_DAY:86400,DAYS_PER_JULIAN_CENTURY:36525,PICOSECOND:1e-9,MODIFIED_JULIAN_DATE_DIFFERENCE:2400000.5})}),define("Core/TimeStandard",["./freezeObject"],function(e){"use strict";return e({UTC:0,TAI:1})}),define("Core/JulianDate",["../ThirdParty/sprintf","./binarySearch","./defaultValue","./defined","./DeveloperError","./GregorianDate","./isLeapYear","./LeapSecond","./TimeConstants","./TimeStandard"],function(e,t,n,r,i,a,o,s,u,c){"use strict";function l(e,t){return m.compare(e.julianDate,t.julianDate)}function f(e){v.julianDate=e;var n=m.leapSeconds,r=t(n,v,l);r<0&&(r=~r),r>=n.length&&(r=n.length-1);var i=n[r].offset;if(r>0){m.secondsDifference(n[r].julianDate,e)>i&&(r--,i=n[r].offset)}m.addSeconds(e,i,e)}function d(e,n){v.julianDate=e;var r=m.leapSeconds,i=t(r,v,l);if(i<0&&(i=~i),0===i)return m.addSeconds(e,-r[0].offset,n);if(i>=r.length)return m.addSeconds(e,-r[i-1].offset,n);var a=m.secondsDifference(r[i].julianDate,e);return 0===a?m.addSeconds(e,-r[i].offset,n):a<=1?void 0:m.addSeconds(e,-r[--i].offset,n)}function h(e,t,n){var r=t/u.SECONDS_PER_DAY|0;return e+=r,t-=u.SECONDS_PER_DAY*r,t<0&&(e--,t+=u.SECONDS_PER_DAY),n.dayNumber=e,n.secondsOfDay=t,n}function p(e,t,n,r,i,a,o){var s=(t-14)/12|0,c=e+4800+s,l=(1461*c/4|0)+(367*(t-2-12*s)/12|0)-(3*((c+100)/100|0)/4|0)+n-32075;(r-=12)<0&&(r+=24);var f=a+(r*u.SECONDS_PER_HOUR+i*u.SECONDS_PER_MINUTE+o*u.SECONDS_PER_MILLISECOND);return f>=43200&&(l-=1),[l,f]}function m(e,t,r){this.dayNumber=void 0,this.secondsOfDay=void 0,e=n(e,0),t=n(t,0),r=n(r,c.UTC);var i=0|e;t+=(e-i)*u.SECONDS_PER_DAY,h(i,t,this),r===c.UTC&&f(this)}var _=new a,y=[31,28,31,30,31,30,31,31,30,31,30,31],v=new s,g=/^(\d{4})$/,E=/^(\d{4})-(\d{2})$/,T=/^(\d{4})-?(\d{3})$/,w=/^(\d{4})-?W(\d{2})-?(\d{1})?$/,b=/^(\d{4})-?(\d{2})-?(\d{2})$/,S=/([Z+\-])?(\d{2})?:?(\d{2})?$/,C=/^(\d{2})(\.\d+)?/.source+S.source,O=/^(\d{2}):?(\d{2})(\.\d+)?/.source+S.source,A=/^(\d{2}):?(\d{2}):?(\d{2})(\.\d+)?/.source+S.source,x="Invalid ISO 8601 date.";m.fromGregorianDate=function(e,t){if(!(e instanceof a))throw new i("date must be a valid GregorianDate.");var n=p(e.year,e.month,e.day,e.hour,e.minute,e.second,e.millisecond);return r(t)?(h(n[0],n[1],t),f(t),t):new m(n[0],n[1],c.UTC)},m.fromDate=function(e,t){if(!(e instanceof Date)||isNaN(e.getTime()))throw new i("date must be a valid JavaScript Date.");var n=p(e.getUTCFullYear(),e.getUTCMonth()+1,e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds());return r(t)?(h(n[0],n[1],t),f(t),t):new m(n[0],n[1],c.UTC)},m.fromIso8601=function(e,t){if("string"!=typeof e)throw new i(x);e=e.replace(",",".");var n,a,s,u=e.split("T"),l=1,d=1,_=0,v=0,S=0,R=0,I=u[0],D=u[1];if(!r(I))throw new i(x);var P;if(null!==(u=I.match(b))){if((P=I.split("-").length-1)>0&&2!==P)throw new i(x);n=+u[1],l=+u[2],d=+u[3]}else if(null!==(u=I.match(E)))n=+u[1],l=+u[2];else if(null!==(u=I.match(g)))n=+u[1];else{var N;if(null!==(u=I.match(T))){if(n=+u[1],N=+u[2],s=o(n),N<1||s&&N>366||!s&&N>365)throw new i(x)}else{if(null===(u=I.match(w)))throw new i(x);n=+u[1];var M=+u[2],z=+u[3]||0;if((P=I.split("-").length-1)>0&&(!r(u[3])&&1!==P||r(u[3])&&2!==P))throw new i(x);var F=new Date(Date.UTC(n,0,4));N=7*M+z-F.getUTCDay()-3}a=new Date(Date.UTC(n,0,1)),a.setUTCDate(N),l=a.getUTCMonth()+1,d=a.getUTCDate()}if(s=o(n),l<1||l>12||d<1||(2!==l||!s)&&d>y[l-1]||s&&2===l&&d>29)throw new i(x);var L;if(r(D)){if(null!==(u=D.match(A))){if((P=D.split(":").length-1)>0&&2!==P&&3!==P)throw new i(x);_=+u[1],v=+u[2],S=+u[3],R=1e3*+(u[4]||0),L=5}else if(null!==(u=D.match(O))){if((P=D.split(":").length-1)>2)throw new i(x);_=+u[1],v=+u[2],S=60*+(u[3]||0),L=4}else{if(null===(u=D.match(C)))throw new i(x);_=+u[1],v=60*+(u[2]||0),L=3}if(v>=60||S>=61||_>24||24===_&&(v>0||S>0||R>0))throw new i(x);var B=u[L],U=+u[L+1],q=+(u[L+2]||0);switch(B){case"+":_-=U,v-=q;break;case"-":_+=U,v+=q;break;case"Z":break;default:v+=new Date(Date.UTC(n,l-1,d,_,v)).getTimezoneOffset()}}var G=60===S;for(G&&S--;v>=60;)v-=60,_++;for(;_>=24;)_-=24,d++;for(a=s&&2===l?29:y[l-1];d>a;)d-=a,l++,l>12&&(l-=12,n++),a=s&&2===l?29:y[l-1];for(;v<0;)v+=60,_--;for(;_<0;)_+=24,d--;for(;d<1;)l--,l<1&&(l+=12,n--),a=s&&2===l?29:y[l-1],d+=a;var V=p(n,l,d,_,v,S,R);return r(t)?(h(V[0],V[1],t),f(t)):t=new m(V[0],V[1],c.UTC),G&&m.addSeconds(t,1,t),t},m.now=function(e){return m.fromDate(new Date,e)};var R=new m(0,0,c.TAI);return m.toGregorianDate=function(e,t){if(!r(e))throw new i("julianDate is required.");var n=!1,o=d(e,R);r(o)||(m.addSeconds(e,-1,R),o=d(R,R),n=!0);var s=o.dayNumber,c=o.secondsOfDay;c>=43200&&(s+=1);var l=s+68569|0,f=4*l/146097|0;l=l-((146097*f+3)/4|0)|0;var h=4e3*(l+1)/1461001|0;l=l-(1461*h/4|0)+31|0;var p=80*l/2447|0,_=l-(2447*p/80|0)|0;l=p/11|0;var y=p+2-12*l|0,v=100*(f-49)+h+l|0,g=c/u.SECONDS_PER_HOUR|0,E=c-g*u.SECONDS_PER_HOUR,T=E/u.SECONDS_PER_MINUTE|0;E-=T*u.SECONDS_PER_MINUTE;var w=0|E,b=(E-w)/u.SECONDS_PER_MILLISECOND;return g+=12,g>23&&(g-=24),n&&(w+=1),r(t)?(t.year=v,t.month=y,t.day=_,t.hour=g,t.minute=T,t.second=w,t.millisecond=b,t.isLeapSecond=n,t):new a(v,y,_,g,T,w,b,n)},m.toDate=function(e){if(!r(e))throw new i("julianDate is required.");var t=m.toGregorianDate(e,_),n=t.second;return t.isLeapSecond&&(n-=1),new Date(Date.UTC(t.year,t.month-1,t.day,t.hour,t.minute,n,t.millisecond))},m.toIso8601=function(t,n){if(!r(t))throw new i("julianDate is required.");var a=m.toGregorianDate(t,_),o=a.year,s=a.month,u=a.day,c=a.hour,l=a.minute,f=a.second,d=a.millisecond;1e4===o&&1===s&&1===u&&0===c&&0===l&&0===f&&0===d&&(o=9999,s=12,u=31,c=24);var h;return r(n)||0===d?r(n)&&0!==n?(h=(.01*d).toFixed(n).replace(".","").slice(0,n),e("%04d-%02d-%02dT%02d:%02d:%02d.%sZ",o,s,u,c,l,f,h)):e("%04d-%02d-%02dT%02d:%02d:%02dZ",o,s,u,c,l,f):(h=(.01*d).toString().replace(".",""),e("%04d-%02d-%02dT%02d:%02d:%02d.%sZ",o,s,u,c,l,f,h))},m.clone=function(e,t){if(r(e))return r(t)?(t.dayNumber=e.dayNumber,t.secondsOfDay=e.secondsOfDay,t):new m(e.dayNumber,e.secondsOfDay,c.TAI)},m.compare=function(e,t){if(!r(e))throw new i("left is required.");if(!r(t))throw new i("right is required.");var n=e.dayNumber-t.dayNumber;return 0!==n?n:e.secondsOfDay-t.secondsOfDay},m.equals=function(e,t){return e===t||r(e)&&r(t)&&e.dayNumber===t.dayNumber&&e.secondsOfDay===t.secondsOfDay},m.equalsEpsilon=function(e,t,n){if(!r(n))throw new i("epsilon is required.");return e===t||r(e)&&r(t)&&Math.abs(m.secondsDifference(e,t))<=n},m.totalDays=function(e){if(!r(e))throw new i("julianDate is required.");return e.dayNumber+e.secondsOfDay/u.SECONDS_PER_DAY},m.secondsDifference=function(e,t){if(!r(e))throw new i("left is required.");if(!r(t))throw new i("right is required.");return(e.dayNumber-t.dayNumber)*u.SECONDS_PER_DAY+(e.secondsOfDay-t.secondsOfDay)},m.daysDifference=function(e,t){if(!r(e))throw new i("left is required.");if(!r(t))throw new i("right is required.");return e.dayNumber-t.dayNumber+(e.secondsOfDay-t.secondsOfDay)/u.SECONDS_PER_DAY},m.computeTaiMinusUtc=function(e){v.julianDate=e;var n=m.leapSeconds,r=t(n,v,l);return r<0&&(r=~r,--r<0&&(r=0)),n[r].offset},m.addSeconds=function(e,t,n){if(!r(e))throw new i("julianDate is required.");if(!r(t))throw new i("seconds is required.");if(!r(n))throw new i("result is required.");return h(e.dayNumber,e.secondsOfDay+t,n)},m.addMinutes=function(e,t,n){if(!r(e))throw new i("julianDate is required.");if(!r(t))throw new i("minutes is required.");if(!r(n))throw new i("result is required.");var a=e.secondsOfDay+t*u.SECONDS_PER_MINUTE;return h(e.dayNumber,a,n)},m.addHours=function(e,t,n){if(!r(e))throw new i("julianDate is required.");if(!r(t))throw new i("hours is required.");if(!r(n))throw new i("result is required.");var a=e.secondsOfDay+t*u.SECONDS_PER_HOUR;return h(e.dayNumber,a,n)},m.addDays=function(e,t,n){if(!r(e))throw new i("julianDate is required.");if(!r(t))throw new i("days is required.");if(!r(n))throw new i("result is required.");return h(e.dayNumber+t,e.secondsOfDay,n)},m.lessThan=function(e,t){return m.compare(e,t)<0},m.lessThanOrEquals=function(e,t){return m.compare(e,t)<=0},m.greaterThan=function(e,t){return m.compare(e,t)>0},m.greaterThanOrEquals=function(e,t){return m.compare(e,t)>=0},m.prototype.clone=function(e){return m.clone(this,e)},m.prototype.equals=function(e){return m.equals(this,e)},m.prototype.equalsEpsilon=function(e,t){return m.equalsEpsilon(this,e,t)},m.prototype.toString=function(){return m.toIso8601(this)},m.leapSeconds=[new s(new m(2441317,43210,c.TAI),10),new s(new m(2441499,43211,c.TAI),11),new s(new m(2441683,43212,c.TAI),12),new s(new m(2442048,43213,c.TAI),13),new s(new m(2442413,43214,c.TAI),14),new s(new m(2442778,43215,c.TAI),15),new s(new m(2443144,43216,c.TAI),16),new s(new m(2443509,43217,c.TAI),17),new s(new m(2443874,43218,c.TAI),18),new s(new m(2444239,43219,c.TAI),19),new s(new m(2444786,43220,c.TAI),20),new s(new m(2445151,43221,c.TAI),21),new s(new m(2445516,43222,c.TAI),22),new s(new m(2446247,43223,c.TAI),23),new s(new m(2447161,43224,c.TAI),24),new s(new m(2447892,43225,c.TAI),25),new s(new m(2448257,43226,c.TAI),26),new s(new m(2448804,43227,c.TAI),27),new s(new m(2449169,43228,c.TAI),28),new s(new m(2449534,43229,c.TAI),29),new s(new m(2450083,43230,c.TAI),30),new s(new m(2450630,43231,c.TAI),31),new s(new m(2451179,43232,c.TAI),32),new s(new m(2453736,43233,c.TAI),33),new s(new m(2454832,43234,c.TAI),34),new s(new m(2456109,43235,c.TAI),35),new s(new m(2457204,43236,c.TAI),36),new s(new m(2457754,43237,c.TAI),37)],m}),define("Core/EarthOrientationParameters",["../ThirdParty/when","./binarySearch","./defaultValue","./defined","./EarthOrientationParametersSample","./freezeObject","./JulianDate","./LeapSecond","./Resource","./RuntimeError","./TimeConstants","./TimeStandard"],function(e,t,n,r,i,a,o,s,u,c,l,f){"use strict";function d(t){if(t=n(t,n.EMPTY_OBJECT),this._dates=void 0,this._samples=void 0,this._dateColumn=-1,this._xPoleWanderRadiansColumn=-1,this._yPoleWanderRadiansColumn=-1,this._ut1MinusUtcSecondsColumn=-1,this._xCelestialPoleOffsetRadiansColumn=-1,this._yCelestialPoleOffsetRadiansColumn=-1,this._taiMinusUtcSecondsColumn=-1,this._columnCount=0,this._lastIndex=-1,this._downloadPromise=void 0,this._dataError=void 0,this._addNewLeapSeconds=n(t.addNewLeapSeconds,!0),r(t.data))p(this,t.data);else if(r(t.url)){var i=u.createIfNeeded(t.url),a=this;this._downloadPromise=e(i.fetchJson(),function(e){p(a,e)},function(){a._dataError="An error occurred while retrieving the EOP data from the URL "+i.url+"."})}else p(this,{columnNames:["dateIso8601","modifiedJulianDateUtc","xPoleWanderRadians","yPoleWanderRadians","ut1MinusUtcSeconds","lengthOfDayCorrectionSeconds","xCelestialPoleOffsetRadians","yCelestialPoleOffsetRadians","taiMinusUtcSeconds"],samples:[]})}function h(e,t){return o.compare(e.julianDate,t)}function p(e,n){if(!r(n.columnNames))return void(e._dataError="Error in loaded EOP data: The columnNames property is required.");if(!r(n.samples))return void(e._dataError="Error in loaded EOP data: The samples property is required.");var i=n.columnNames.indexOf("modifiedJulianDateUtc"),a=n.columnNames.indexOf("xPoleWanderRadians"),u=n.columnNames.indexOf("yPoleWanderRadians"),c=n.columnNames.indexOf("ut1MinusUtcSeconds"),d=n.columnNames.indexOf("xCelestialPoleOffsetRadians"),p=n.columnNames.indexOf("yCelestialPoleOffsetRadians"),m=n.columnNames.indexOf("taiMinusUtcSeconds");if(i<0||a<0||u<0||c<0||d<0||p<0||m<0)return void(e._dataError="Error in loaded EOP data: The columnNames property must include modifiedJulianDateUtc, xPoleWanderRadians, yPoleWanderRadians, ut1MinusUtcSeconds, xCelestialPoleOffsetRadians, yCelestialPoleOffsetRadians, and taiMinusUtcSeconds columns");var _=e._samples=n.samples,y=e._dates=[];e._dateColumn=i,e._xPoleWanderRadiansColumn=a,e._yPoleWanderRadiansColumn=u,e._ut1MinusUtcSecondsColumn=c,e._xCelestialPoleOffsetRadiansColumn=d,e._yCelestialPoleOffsetRadiansColumn=p,e._taiMinusUtcSecondsColumn=m,e._columnCount=n.columnNames.length,e._lastIndex=void 0;for(var v,g=e._addNewLeapSeconds,E=0,T=_.length;E<T;E+=e._columnCount){var w=_[E+i],b=_[E+m],S=w+l.MODIFIED_JULIAN_DATE_DIFFERENCE,C=new o(S,b,f.TAI);if(y.push(C),g){if(b!==v&&r(v)){var O=o.leapSeconds,A=t(O,C,h);if(A<0){var x=new s(C,b);O.splice(~A,0,x)}}v=b}}}function m(e,t,n,r,i){var a=n*r;i.xPoleWander=t[a+e._xPoleWanderRadiansColumn],i.yPoleWander=t[a+e._yPoleWanderRadiansColumn],i.xPoleOffset=t[a+e._xCelestialPoleOffsetRadiansColumn],i.yPoleOffset=t[a+e._yCelestialPoleOffsetRadiansColumn],i.ut1MinusUtc=t[a+e._ut1MinusUtcSecondsColumn]}function _(e,t,n){return t+e*(n-t)}function y(e,t,n,r,i,a,s){var u=e._columnCount;if(a>t.length-1)return s.xPoleWander=0,s.yPoleWander=0,s.xPoleOffset=0,s.yPoleOffset=0,s.ut1MinusUtc=0,s;var c=t[i],l=t[a];if(c.equals(l)||r.equals(c))return m(e,n,i,u,s),s;if(r.equals(l))return m(e,n,a,u,s),s;var f=o.secondsDifference(r,c)/o.secondsDifference(l,c),d=i*u,h=a*u,p=n[d+e._ut1MinusUtcSecondsColumn],y=n[h+e._ut1MinusUtcSecondsColumn],v=y-p;if(v>.5||v<-.5){var g=n[d+e._taiMinusUtcSecondsColumn],E=n[h+e._taiMinusUtcSecondsColumn];g!==E&&(l.equals(r)?p=y:y-=E-g)}return s.xPoleWander=_(f,n[d+e._xPoleWanderRadiansColumn],n[h+e._xPoleWanderRadiansColumn]),s.yPoleWander=_(f,n[d+e._yPoleWanderRadiansColumn],n[h+e._yPoleWanderRadiansColumn]),s.xPoleOffset=_(f,n[d+e._xCelestialPoleOffsetRadiansColumn],n[h+e._xCelestialPoleOffsetRadiansColumn]),s.yPoleOffset=_(f,n[d+e._yCelestialPoleOffsetRadiansColumn],n[h+e._yCelestialPoleOffsetRadiansColumn]),s.ut1MinusUtc=_(f,p,y),s}return d.NONE=a({getPromiseToLoad:function(){return e()},compute:function(e,t){return r(t)?(t.xPoleWander=0,t.yPoleWander=0,t.xPoleOffset=0,t.yPoleOffset=0,t.ut1MinusUtc=0):t=new i(0,0,0,0,0),t}}),d.prototype.getPromiseToLoad=function(){return e(this._downloadPromise)},d.prototype.compute=function(e,n){if(r(this._samples)){if(r(n)||(n=new i(0,0,0,0,0)),0===this._samples.length)return n.xPoleWander=0,n.yPoleWander=0,n.xPoleOffset=0,n.yPoleOffset=0,n.ut1MinusUtc=0,n;var a=this._dates,s=this._lastIndex,u=0,l=0;if(r(s)){var f=a[s],d=a[s+1],h=o.lessThanOrEquals(f,e),p=!r(d),m=p||o.greaterThanOrEquals(d,e);if(h&&m)return u=s,!p&&d.equals(e)&&++u,l=u+1,y(this,a,this._samples,e,u,l,n),n}var _=t(a,e,o.compare,this._dateColumn);return _>=0?(_<a.length-1&&a[_+1].equals(e)&&++_,u=_,l=_):(l=~_,(u=l-1)<0&&(u=0)),this._lastIndex=u,y(this,a,this._samples,e,u,l,n),n}if(r(this._dataError))throw new c(this._dataError)},d}),define("Core/Iau2006XysSample",[],function(){"use strict";function e(e,t,n){this.x=e,this.y=t,this.s=n}return e}),define("Core/Iau2006XysData",["../ThirdParty/when","./buildModuleUrl","./defaultValue","./defined","./Iau2006XysSample","./JulianDate","./Resource","./TimeStandard"],function(e,t,n,r,i,a,o,s){"use strict";function u(e){e=n(e,n.EMPTY_OBJECT),this._xysFileUrlTemplate=o.createIfNeeded(e.xysFileUrlTemplate),this._interpolationOrder=n(e.interpolationOrder,9),this._sampleZeroJulianEphemerisDate=n(e.sampleZeroJulianEphemerisDate,2442396.5),this._sampleZeroDateTT=new a(this._sampleZeroJulianEphemerisDate,0,s.TAI),this._stepSizeDays=n(e.stepSizeDays,1),this._samplesPerXysFile=n(e.samplesPerXysFile,1e3),this._totalSamples=n(e.totalSamples,27426),this._samples=new Array(3*this._totalSamples),this._chunkDownloadsInProgress=[];for(var t=this._interpolationOrder,r=this._denominators=new Array(t+1),i=this._xTable=new Array(t+1),u=Math.pow(this._stepSizeDays,t),c=0;c<=t;++c){r[c]=u,i[c]=c*this._stepSizeDays;for(var l=0;l<=t;++l)l!==c&&(r[c]*=c-l);r[c]=1/r[c]}this._work=new Array(t+1),this._coef=new Array(t+1)}function c(e,t,n){var r=f;return r.dayNumber=t,r.secondsOfDay=n,a.daysDifference(r,e._sampleZeroDateTT)}function l(n,i){if(n._chunkDownloadsInProgress[i])return n._chunkDownloadsInProgress[i];var a=e.defer();n._chunkDownloadsInProgress[i]=a;var s,u=n._xysFileUrlTemplate;return s=r(u)?u.getDerivedResource({templateValues:{0:i}}):new o({url:t("Assets/IAU2006_XYS/IAU2006_XYS_"+i+".json")}),e(s.fetchJson(),function(e){n._chunkDownloadsInProgress[i]=!1;for(var t=n._samples,r=e.samples,o=i*n._samplesPerXysFile*3,s=0,u=r.length;s<u;++s)t[o+s]=r[s];a.resolve()}),a.promise}var f=new a(0,0,s.TAI);return u.prototype.preload=function(t,n,r,i){var a=c(this,t,n),o=c(this,r,i),s=a/this._stepSizeDays-this._interpolationOrder/2|0;s<0&&(s=0);var u=o/this._stepSizeDays-this._interpolationOrder/2|0+this._interpolationOrder;u>=this._totalSamples&&(u=this._totalSamples-1);for(var f=s/this._samplesPerXysFile|0,d=u/this._samplesPerXysFile|0,h=[],p=f;p<=d;++p)h.push(l(this,p));return e.all(h)},u.prototype.computeXysRadians=function(e,t,n){var a=c(this,e,t);if(!(a<0)){var o=a/this._stepSizeDays|0;if(!(o>=this._totalSamples)){var s=this._interpolationOrder,u=o-(s/2|0);u<0&&(u=0);var f=u+s;f>=this._totalSamples&&(f=this._totalSamples-1,(u=f-s)<0&&(u=0));var d=!1,h=this._samples;if(r(h[3*u])||(l(this,u/this._samplesPerXysFile|0),d=!0),r(h[3*f])||(l(this,f/this._samplesPerXysFile|0),d=!0),!d){r(n)?(n.x=0,n.y=0,n.s=0):n=new i(0,0,0);var p,m,_=a-u*this._stepSizeDays,y=this._work,v=this._denominators,g=this._coef,E=this._xTable;for(p=0;p<=s;++p)y[p]=_-E[p];for(p=0;p<=s;++p){for(g[p]=1,m=0;m<=s;++m)m!==p&&(g[p]*=y[m]);g[p]*=v[p];var T=3*(u+p);n.x+=g[p]*h[T++],n.y+=g[p]*h[T++],n.s+=g[p]*h[T]}return n}}}},u}),define("Core/Transforms",["../ThirdParty/when","./Cartesian2","./Cartesian3","./Cartesian4","./Cartographic","./Check","./defaultValue","./defined","./DeveloperError","./EarthOrientationParameters","./EarthOrientationParametersSample","./Ellipsoid","./Iau2006XysData","./Iau2006XysSample","./JulianDate","./Math","./Matrix3","./Matrix4","./Quaternion","./TimeConstants"],function(e,t,n,r,i,a,o,s,u,c,l,f,d,h,p,m,_,y,v,g){"use strict";var E={},T={up:{south:"east",north:"west",west:"south",east:"north"},down:{south:"west",north:"east",west:"north",east:"south"},south:{up:"west",down:"east",west:"down",east:"up"},north:{up:"east",down:"west",west:"up",east:"down"},west:{up:"north",down:"south",north:"down",south:"up"},east:{up:"south",down:"north",north:"up",south:"down"}},w={north:[-1,0,0],east:[0,1,0],up:[0,0,1],south:[1,0,0],west:[0,-1,0],down:[0,0,-1]},b={},S={east:new n,north:new n,up:new n,west:new n,south:new n,down:new n},C=new n,O=new n,A=new n;E.localFrameToFixedFrameGenerator=function(e,t){if(!T.hasOwnProperty(e)||!T[e].hasOwnProperty(t))throw new u("firstAxis and secondAxis must be east, north, up, west, south or down.");var r,i=T[e][t],a=e+t;return s(b[a])?r=b[a]:(r=function(r,a,c){if(!s(r))throw new u("origin is required.");if(s(c)||(c=new y),m.equalsEpsilon(r.x,0,m.EPSILON14)&&m.equalsEpsilon(r.y,0,m.EPSILON14)){var l=m.sign(r.z);n.unpack(w[e],0,C),"east"!==e&&"west"!==e&&n.multiplyByScalar(C,l,C),n.unpack(w[t],0,O),"east"!==t&&"west"!==t&&n.multiplyByScalar(O,l,O),n.unpack(w[i],0,A),"east"!==i&&"west"!==i&&n.multiplyByScalar(A,l,A)}else{a=o(a,f.WGS84),a.geodeticSurfaceNormal(r,S.up);var d=S.up,h=S.east;h.x=-r.y,h.y=r.x,h.z=0,n.normalize(h,S.east),n.cross(d,h,S.north),n.multiplyByScalar(S.up,-1,S.down),n.multiplyByScalar(S.east,-1,S.west),n.multiplyByScalar(S.north,-1,S.south),C=S[e],O=S[t],A=S[i]}return c[0]=C.x,c[1]=C.y,c[2]=C.z,c[3]=0,c[4]=O.x,c[5]=O.y,c[6]=O.z,c[7]=0,c[8]=A.x,c[9]=A.y,c[10]=A.z,c[11]=0,c[12]=r.x,c[13]=r.y,c[14]=r.z,c[15]=1,c},b[a]=r),r},E.eastNorthUpToFixedFrame=E.localFrameToFixedFrameGenerator("east","north"),E.northEastDownToFixedFrame=E.localFrameToFixedFrameGenerator("north","east"),E.northUpEastToFixedFrame=E.localFrameToFixedFrameGenerator("north","up"),E.northWestUpToFixedFrame=E.localFrameToFixedFrameGenerator("north","west");var x=new v,R=new n(1,1,1),I=new y;E.headingPitchRollToFixedFrame=function(e,t,r,i,s){a.typeOf.object("HeadingPitchRoll",t),i=o(i,E.eastNorthUpToFixedFrame);var u=v.fromHeadingPitchRoll(t,x),c=y.fromTranslationQuaternionRotationScale(n.ZERO,u,R,I);return s=i(e,r,s),y.multiply(s,c,s)};var D=new y,P=new _;E.headingPitchRollQuaternion=function(e,t,n,r,i){a.typeOf.object("HeadingPitchRoll",t);var o=E.headingPitchRollToFixedFrame(e,t,n,r,D),s=y.getRotation(o,P);return v.fromRotationMatrix(s,i)};var N=m.TWO_PI/86400,M=new p;E.computeTemeToPseudoFixedMatrix=function(e,t){if(!s(e))throw new u("date is required.");M=p.addSeconds(e,-p.computeTaiMinusUtc(e),M);var n,r=M.dayNumber,i=M.secondsOfDay,a=r-2451545;n=i>=43200?(a+.5)/g.DAYS_PER_JULIAN_CENTURY:(a-.5)/g.DAYS_PER_JULIAN_CENTURY;var o=24110.54841+n*(8640184.812866+n*(.093104+-62e-7*n)),c=o*N%m.TWO_PI,l=72921158553e-15+1.1772758384668e-19*(r-2451545.5),f=(i+.5*g.SECONDS_PER_DAY)%g.SECONDS_PER_DAY,d=c+l*f,h=Math.cos(d),y=Math.sin(d);return s(t)?(t[0]=h,t[1]=-y,t[2]=0,t[3]=y,t[4]=h,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t):new _(h,y,0,-y,h,0,0,0,1)},E.iau2006XysData=new d,E.earthOrientationParameters=c.NONE;E.preloadIcrfFixed=function(t){var n=t.start.dayNumber,r=t.start.secondsOfDay+32.184,i=t.stop.dayNumber,a=t.stop.secondsOfDay+32.184,o=E.iau2006XysData.preload(n,r,i,a),s=E.earthOrientationParameters.getPromiseToLoad();return e.all([o,s])},E.computeIcrfToFixedMatrix=function(e,t){if(!s(e))throw new u("date is required.");s(t)||(t=new _);var n=E.computeFixedToIcrfMatrix(e,t);if(s(n))return _.transpose(n,t)};var z=new h(0,0,0),F=new l(0,0,0,0,0,0),L=new _,B=new _;E.computeFixedToIcrfMatrix=function(e,t){if(!s(e))throw new u("date is required.");s(t)||(t=new _);var n=E.earthOrientationParameters.compute(e,F);if(s(n)){var r=e.dayNumber,i=e.secondsOfDay+32.184,a=E.iau2006XysData.computeXysRadians(r,i,z);if(s(a)){var o=a.x+n.xPoleOffset,c=a.y+n.yPoleOffset,l=1/(1+Math.sqrt(1-o*o-c*c)),f=L;f[0]=1-l*o*o,f[3]=-l*o*c,f[6]=o,f[1]=-l*o*c,f[4]=1-l*c*c,f[7]=c,f[2]=-o,f[5]=-c,f[8]=1-l*(o*o+c*c);var d=_.fromRotationZ(-a.s,B),h=_.multiply(f,d,L),y=e.dayNumber,v=e.secondsOfDay-p.computeTaiMinusUtc(e)+n.ut1MinusUtc,T=y-2451545,w=v/g.SECONDS_PER_DAY,b=.779057273264+w+.00273781191135448*(T+w);b=b%1*m.TWO_PI;var S=_.fromRotationZ(b,B),C=_.multiply(h,S,L),O=Math.cos(n.xPoleWander),A=Math.cos(n.yPoleWander),x=Math.sin(n.xPoleWander),R=Math.sin(n.yPoleWander),I=r-2451545+i/g.SECONDS_PER_DAY;I/=36525;var D=-47e-6*I*m.RADIANS_PER_DEGREE/3600,P=Math.cos(D),N=Math.sin(D),M=B;return M[0]=O*P,M[1]=O*N,M[2]=x,M[3]=-A*N+R*x*P,M[4]=A*P+R*x*N,M[5]=-R*O,M[6]=-R*N-A*x*P,M[7]=R*P-A*x*N,M[8]=A*O,_.multiply(C,M,t)}}};var U=new r;E.pointToWindowCoordinates=function(e,t,n,r){return r=E.pointToGLWindowCoordinates(e,t,n,r),r.y=2*t[5]-r.y,r},E.pointToGLWindowCoordinates=function(e,n,i,a){if(!s(e))throw new u("modelViewProjectionMatrix is required.");if(!s(n))throw new u("viewportTransformation is required.");if(!s(i))throw new u("point is required.");s(a)||(a=new t);var o=U;return y.multiplyByVector(e,r.fromElements(i.x,i.y,i.z,1,o),o),r.multiplyByScalar(o,1/o.w,o),y.multiplyByVector(n,o,o),t.fromCartesian4(o,a)};var q=new n,G=new n,V=new n;E.rotationMatrixFromPositionVelocity=function(e,t,r,i){if(!s(e))throw new u("position is required.");if(!s(t))throw new u("velocity is required.");var a=o(r,f.WGS84).geodeticSurfaceNormal(e,q),c=n.cross(t,a,G);n.equalsEpsilon(c,n.ZERO,m.EPSILON6)&&(c=n.clone(n.UNIT_X,c));var l=n.cross(c,t,V);return n.cross(t,l,c),n.negate(c,c),s(i)||(i=new _),i[0]=t.x,i[1]=t.y,i[2]=t.z,i[3]=c.x,i[4]=c.y,i[5]=c.z,i[6]=l.x,i[7]=l.y,i[8]=l.z,i};var j=new y(0,0,1,0,1,0,0,0,0,1,0,0,0,0,0,1),k=new i,H=new n,W=new n,Y=new _,X=new y,Z=new y;return E.basisTo2D=function(e,t,r){if(!s(e))throw new u("projection is required.");if(!s(t))throw new u("matrix is required.");if(!s(r))throw new u("result is required.");var i=y.getTranslation(t,W),a=e.ellipsoid,o=a.cartesianToCartographic(i,k),c=e.project(o,H);n.fromElements(c.z,c.x,c.y,c);var l=E.eastNorthUpToFixedFrame(i,a,X),f=y.inverseTransformation(l,Z),d=y.getRotation(t,Y),h=y.multiplyByMatrix3(f,d,r);return y.multiply(j,h,r),y.setTranslation(r,c,r),r},E.wgs84To2DModelMatrix=function(e,t,r){if(!s(e))throw new u("projection is required.");if(!s(t))throw new u("center is required.");if(!s(r))throw new u("result is required.");var i=e.ellipsoid,a=E.eastNorthUpToFixedFrame(t,i,X),o=y.inverseTransformation(a,Z),c=i.cartesianToCartographic(t,k),l=e.project(c,H);n.fromElements(l.z,l.x,l.y,l);var f=y.fromTranslation(l,X);return y.multiply(j,o,r),y.multiply(f,r,r),r},E}),define("Core/Geometry",["./Cartesian2","./Cartesian3","./Cartographic","./Check","./defaultValue","./defined","./DeveloperError","./GeometryOffsetAttribute","./GeometryType","./Matrix2","./Matrix3","./Matrix4","./PrimitiveType","./Quaternion","./Rectangle","./Transforms"],function(e,t,n,r,i,a,o,s,u,c,l,f,d,h,p,m){"use strict";function _(e){e=i(e,i.EMPTY_OBJECT),r.typeOf.object("options.attributes",e.attributes),this.attributes=e.attributes,this.indices=e.indices,this.primitiveType=i(e.primitiveType,d.TRIANGLES),this.boundingSphere=e.boundingSphere,this.geometryType=i(e.geometryType,u.NONE),this.boundingSphereCV=e.boundingSphereCV,this.offsetAttribute=e.offsetAttribute}_.computeNumberOfVertices=function(e){r.typeOf.object("geometry",e);var t=-1;for(var n in e.attributes)if(e.attributes.hasOwnProperty(n)&&a(e.attributes[n])&&a(e.attributes[n].values)){var i=e.attributes[n],s=i.values.length/i.componentsPerAttribute;if(t!==s&&-1!==t)throw new o("All attribute lists must have the same number of attributes.");t=s}return t};var y=new n,v=new t,g=new f,E=[new n,new n,new n],T=[new e,new e,new e],w=[new e,new e,new e],b=new t,S=new h,C=new f,O=new c;return _._textureCoordinateRotationPoints=function(r,i,a,o){var s,u=p.center(o,y),d=n.toCartesian(u,a,v),_=m.eastNorthUpToFixedFrame(d,a,g),A=f.inverse(_,g),x=T,R=E;R[0].longitude=o.west,R[0].latitude=o.south,R[1].longitude=o.west,R[1].latitude=o.north,R[2].longitude=o.east,R[2].latitude=o.south;var I=b;for(s=0;s<3;s++)n.toCartesian(R[s],a,I),I=f.multiplyByPointAsVector(A,I,I),x[s].x=I.x,x[s].y=I.y;var D=h.fromAxisAngle(t.UNIT_Z,-i,S),P=l.fromQuaternion(D,C),N=r.length,M=Number.POSITIVE_INFINITY,z=Number.POSITIVE_INFINITY,F=Number.NEGATIVE_INFINITY,L=Number.NEGATIVE_INFINITY;for(s=0;s<N;s++)I=f.multiplyByPointAsVector(A,r[s],I),I=l.multiplyByVector(P,I,I),M=Math.min(M,I.x),z=Math.min(z,I.y),F=Math.max(F,I.x),L=Math.max(L,I.y);var B=c.fromRotation(i,O),U=w;U[0].x=M,U[0].y=z,U[1].x=M,U[1].y=L,U[2].x=F,U[2].y=z;var q=x[0],G=x[2].x-q.x,V=x[1].y-q.y;for(s=0;s<3;s++){var j=U[s];c.multiplyByVector(B,j,j),j.x=(j.x-q.x)/G,j.y=(j.y-q.y)/V}var k=U[0],H=U[1],W=U[2],Y=new Array(6);return e.pack(k,Y),e.pack(H,Y,2),e.pack(W,Y,4),Y},_}),define("Core/GeometryAttribute",["./defaultValue","./defined","./DeveloperError"],function(e,t,n){"use strict";function r(r){if(r=e(r,e.EMPTY_OBJECT),!t(r.componentDatatype))throw new n("options.componentDatatype is required.");if(!t(r.componentsPerAttribute))throw new n("options.componentsPerAttribute is required.");if(r.componentsPerAttribute<1||r.componentsPerAttribute>4)throw new n("options.componentsPerAttribute must be between 1 and 4.");if(!t(r.values))throw new n("options.values is required.");this.componentDatatype=r.componentDatatype,this.componentsPerAttribute=r.componentsPerAttribute,this.normalize=e(r.normalize,!1),this.values=r.values}return r}),define("Core/QuadraticRealPolynomial",["./DeveloperError","./Math"],function(e,t){"use strict";function n(e,n,r){var i=e+n;return t.sign(e)!==t.sign(n)&&Math.abs(i/Math.max(Math.abs(e),Math.abs(n)))<r?0:i}var r={};return r.computeDiscriminant=function(t,n,r){if("number"!=typeof t)throw new e("a is a required number.");if("number"!=typeof n)throw new e("b is a required number.");if("number"!=typeof r)throw new e("c is a required number.");return n*n-4*t*r},r.computeRealRoots=function(r,i,a){if("number"!=typeof r)throw new e("a is a required number.");if("number"!=typeof i)throw new e("b is a required number.");if("number"!=typeof a)throw new e("c is a required number.");var o;if(0===r)return 0===i?[]:[-a/i];if(0===i){if(0===a)return[0,0];var s=Math.abs(a),u=Math.abs(r);if(s<u&&s/u<t.EPSILON14)return[0,0];if(s>u&&u/s<t.EPSILON14)return[];if((o=-a/r)<0)return[];var c=Math.sqrt(o);return[-c,c]}if(0===a)return o=-i/r,o<0?[o,0]:[0,o];var l=i*i,f=4*r*a,d=n(l,-f,t.EPSILON14);if(d<0)return[];var h=-.5*n(i,t.sign(i)*Math.sqrt(d),t.EPSILON14);return i>0?[h/r,a/h]:[a/h,h/r]},r}),define("Core/CubicRealPolynomial",["./DeveloperError","./QuadraticRealPolynomial"],function(e,t){"use strict";function n(e,t,n,r){var i,a,o=e,s=t/3,u=n/3,c=r,l=o*u,f=s*c,d=s*s,h=u*u,p=o*u-d,m=o*c-s*u,_=s*c-h,y=4*p*_-m*m;if(y<0){var v,g,E;d*f>=l*h?(v=o,g=p,E=-2*s*p+o*m):(v=c,g=_,E=-c*m+2*u*_);var T=E<0?-1:1,w=-T*Math.abs(v)*Math.sqrt(-y);a=-E+w;var b=a/2,S=b<0?-Math.pow(-b,1/3):Math.pow(b,1/3),C=a===w?-S:-g/S
;return i=g<=0?S+C:-E/(S*S+C*C+g),d*f>=l*h?[(i-s)/o]:[-c/(i+u)]}var O=p,A=-2*s*p+o*m,x=_,R=-c*m+2*u*_,I=Math.sqrt(y),D=Math.sqrt(3)/2,P=Math.abs(Math.atan2(o*I,-A)/3);i=2*Math.sqrt(-O);var N=Math.cos(P);a=i*N;var M=i*(-N/2-D*Math.sin(P)),z=a+M>2*s?a-s:M-s,F=o,L=z/F;P=Math.abs(Math.atan2(c*I,-R)/3),i=2*Math.sqrt(-x),N=Math.cos(P),a=i*N,M=i*(-N/2-D*Math.sin(P));var B=-c,U=a+M<2*u?a+u:M+u,q=B/U,G=F*U,V=-z*U-F*B,j=z*B,k=(u*V-s*j)/(-s*V+u*G);return L<=k?L<=q?k<=q?[L,k,q]:[L,q,k]:[q,L,k]:L<=q?[k,L,q]:k<=q?[k,q,L]:[q,k,L]}var r={};return r.computeDiscriminant=function(t,n,r,i){if("number"!=typeof t)throw new e("a is a required number.");if("number"!=typeof n)throw new e("b is a required number.");if("number"!=typeof r)throw new e("c is a required number.");if("number"!=typeof i)throw new e("d is a required number.");var a=t*t,o=n*n,s=r*r;return 18*t*n*r*i+o*s-27*a*(i*i)-4*(t*s*r+o*n*i)},r.computeRealRoots=function(r,i,a,o){if("number"!=typeof r)throw new e("a is a required number.");if("number"!=typeof i)throw new e("b is a required number.");if("number"!=typeof a)throw new e("c is a required number.");if("number"!=typeof o)throw new e("d is a required number.");var s,u;if(0===r)return t.computeRealRoots(i,a,o);if(0===i){if(0===a){if(0===o)return[0,0,0];u=-o/r;var c=u<0?-Math.pow(-u,1/3):Math.pow(u,1/3);return[c,c,c]}return 0===o?(s=t.computeRealRoots(r,0,a),0===s.Length?[0]:[s[0],0,s[1]]):n(r,0,a,o)}return 0===a?0===o?(u=-i/r,u<0?[u,0,0]:[0,0,u]):n(r,i,0,o):0===o?(s=t.computeRealRoots(r,i,a),0===s.length?[0]:s[1]<=0?[s[0],s[1],0]:s[0]>=0?[0,s[0],s[1]]:[s[0],0,s[1]]):n(r,i,a,o)},r}),define("Core/QuarticRealPolynomial",["./CubicRealPolynomial","./DeveloperError","./Math","./QuadraticRealPolynomial"],function(e,t,n,r){"use strict";function i(t,i,a,o){var s=t*t,u=i-3*s/8,c=a-i*t/2+s*t/8,l=o-a*t/4+i*s/16-3*s*s/256,f=e.computeRealRoots(1,2*u,u*u-4*l,-c*c);if(f.length>0){var d=-t/4,h=f[f.length-1];if(Math.abs(h)<n.EPSILON14){var p=r.computeRealRoots(1,u,l);if(2===p.length){var m,_=p[0],y=p[1];if(_>=0&&y>=0){var v=Math.sqrt(_),g=Math.sqrt(y);return[d-g,d-v,d+v,d+g]}if(_>=0&&y<0)return m=Math.sqrt(_),[d-m,d+m];if(_<0&&y>=0)return m=Math.sqrt(y),[d-m,d+m]}return[]}if(h>0){var E=Math.sqrt(h),T=(u+h-c/E)/2,w=(u+h+c/E)/2,b=r.computeRealRoots(1,E,T),S=r.computeRealRoots(1,-E,w);return 0!==b.length?(b[0]+=d,b[1]+=d,0!==S.length?(S[0]+=d,S[1]+=d,b[1]<=S[0]?[b[0],b[1],S[0],S[1]]:S[1]<=b[0]?[S[0],S[1],b[0],b[1]]:b[0]>=S[0]&&b[1]<=S[1]?[S[0],b[0],b[1],S[1]]:S[0]>=b[0]&&S[1]<=b[1]?[b[0],S[0],S[1],b[1]]:b[0]>S[0]&&b[0]<S[1]?[S[0],b[0],S[1],b[1]]:[b[0],S[0],b[1],S[1]]):b):0!==S.length?(S[0]+=d,S[1]+=d,S):[]}}return[]}function a(t,i,a,o){var s=a*a,u=i*i,c=t*t,l=-2*i,f=a*t+u-4*o,d=c*o-a*i*t+s,h=e.computeRealRoots(1,l,f,d);if(h.length>0){var p,m,_=h[0],y=i-_,v=y*y,g=t/2,E=y/2,T=v-4*o,w=v+4*Math.abs(o),b=c-4*_,S=c+4*Math.abs(_);if(_<0||T*S<b*w){var C=Math.sqrt(b);p=C/2,m=0===C?0:(t*E-a)/C}else{var O=Math.sqrt(T);p=0===O?0:(t*E-a)/O,m=O/2}var A,x;0===g&&0===p?(A=0,x=0):n.sign(g)===n.sign(p)?(A=g+p,x=_/A):(x=g-p,A=_/x);var R,I;0===E&&0===m?(R=0,I=0):n.sign(E)===n.sign(m)?(R=E+m,I=o/R):(I=E-m,R=o/I);var D=r.computeRealRoots(1,A,R),P=r.computeRealRoots(1,x,I);if(0!==D.length)return 0!==P.length?D[1]<=P[0]?[D[0],D[1],P[0],P[1]]:P[1]<=D[0]?[P[0],P[1],D[0],D[1]]:D[0]>=P[0]&&D[1]<=P[1]?[P[0],D[0],D[1],P[1]]:P[0]>=D[0]&&P[1]<=D[1]?[D[0],P[0],P[1],D[1]]:D[0]>P[0]&&D[0]<P[1]?[P[0],D[0],P[1],D[1]]:[D[0],P[0],D[1],P[1]]:D;if(0!==P.length)return P}return[]}var o={};return o.computeDiscriminant=function(e,n,r,i,a){if("number"!=typeof e)throw new t("a is a required number.");if("number"!=typeof n)throw new t("b is a required number.");if("number"!=typeof r)throw new t("c is a required number.");if("number"!=typeof i)throw new t("d is a required number.");if("number"!=typeof a)throw new t("e is a required number.");var o=e*e,s=o*e,u=n*n,c=u*n,l=r*r,f=l*r,d=i*i,h=d*i,p=a*a;return u*l*d-4*c*h-4*e*f*d+18*e*n*r*h-27*o*d*d+256*s*(p*a)+a*(18*c*r*i-4*u*f+16*e*l*l-80*e*n*l*i-6*e*u*d+144*o*r*d)+p*(144*e*u*r-27*u*u-128*o*l-192*o*n*i)},o.computeRealRoots=function(r,o,s,u,c){if("number"!=typeof r)throw new t("a is a required number.");if("number"!=typeof o)throw new t("b is a required number.");if("number"!=typeof s)throw new t("c is a required number.");if("number"!=typeof u)throw new t("d is a required number.");if("number"!=typeof c)throw new t("e is a required number.");if(Math.abs(r)<n.EPSILON15)return e.computeRealRoots(o,s,u,c);var l=o/r,f=s/r,d=u/r,h=c/r,p=l<0?1:0;switch(p+=f<0?p+1:p,p+=d<0?p+1:p,p+=h<0?p+1:p){case 0:return i(l,f,d,h);case 1:case 2:return a(l,f,d,h);case 3:case 4:return i(l,f,d,h);case 5:return a(l,f,d,h);case 6:case 7:return i(l,f,d,h);case 8:return a(l,f,d,h);case 9:case 10:return i(l,f,d,h);case 11:return a(l,f,d,h);case 12:case 13:case 14:case 15:return i(l,f,d,h);default:return}},o}),define("Core/Ray",["./Cartesian3","./defaultValue","./defined","./DeveloperError"],function(e,t,n,r){"use strict";function i(n,r){r=e.clone(t(r,e.ZERO)),e.equals(r,e.ZERO)||e.normalize(r,r),this.origin=e.clone(t(n,e.ZERO)),this.direction=r}return i.getPoint=function(t,i,a){if(!n(t))throw new r("ray is requred");if("number"!=typeof i)throw new r("t is a required number");return n(a)||(a=new e),a=e.multiplyByScalar(t.direction,i,a),e.add(t.origin,a,a)},i}),define("Core/IntersectionTests",["./Cartesian3","./Cartographic","./defaultValue","./defined","./DeveloperError","./Interval","./Math","./Matrix3","./QuadraticRealPolynomial","./QuarticRealPolynomial","./Ray"],function(e,t,n,r,i,a,o,s,u,c,l){"use strict";function f(e,t,n,r){var i=t*t-4*e*n;if(!(i<0)){if(i>0){var a=1/(2*e),o=Math.sqrt(i),s=(-t+o)*a,u=(-t-o)*a;return s<u?(r.root0=s,r.root1=u):(r.root0=u,r.root1=s),r}var c=-t/(2*e);if(0!==c)return r.root0=r.root1=c,r}}function d(t,n,i){r(i)||(i=new a);var o=t.origin,s=t.direction,u=n.center,c=n.radius*n.radius,l=e.subtract(o,u,v),d=e.dot(s,s),h=2*e.dot(s,l),p=e.magnitudeSquared(l)-c,m=f(d,h,p,w);if(r(m))return i.start=m.root0,i.stop=m.root1,i}function h(e,t,n){var r=e+t;return o.sign(e)!==o.sign(t)&&Math.abs(r/Math.max(Math.abs(e),Math.abs(t)))<n?0:r}function p(t,n,r,i,a){var l,f=i*i,d=a*a,p=(t[s.COLUMN1ROW1]-t[s.COLUMN2ROW2])*d,m=a*(i*h(t[s.COLUMN1ROW0],t[s.COLUMN0ROW1],o.EPSILON15)+n.y),_=t[s.COLUMN0ROW0]*f+t[s.COLUMN2ROW2]*d+i*n.x+r,y=d*h(t[s.COLUMN2ROW1],t[s.COLUMN1ROW2],o.EPSILON15),v=a*(i*h(t[s.COLUMN2ROW0],t[s.COLUMN0ROW2])+n.z),g=[];if(0===v&&0===y){if(l=u.computeRealRoots(p,m,_),0===l.length)return g;var E=l[0],T=Math.sqrt(Math.max(1-E*E,0));if(g.push(new e(i,a*E,a*-T)),g.push(new e(i,a*E,a*T)),2===l.length){var w=l[1],b=Math.sqrt(Math.max(1-w*w,0));g.push(new e(i,a*w,a*-b)),g.push(new e(i,a*w,a*b))}return g}var S=v*v,C=y*y,O=p*p,A=v*y,x=O+C,R=2*(m*p+A),I=2*_*p+m*m-C+S,D=2*(_*m-A),P=_*_-S;if(0===x&&0===R&&0===I&&0===D)return g;l=c.computeRealRoots(x,R,I,D,P);var N=l.length;if(0===N)return g;for(var M=0;M<N;++M){var z,F=l[M],L=F*F,B=Math.max(1-L,0),U=Math.sqrt(B);z=o.sign(p)===o.sign(_)?h(p*L+_,m*F,o.EPSILON12):o.sign(_)===o.sign(m*F)?h(p*L,m*F+_,o.EPSILON12):h(p*L+m*F,_,o.EPSILON12);var q=h(y*F,v,o.EPSILON15),G=z*q;G<0?g.push(new e(i,a*F,a*U)):G>0?g.push(new e(i,a*F,a*-U)):0!==U?(g.push(new e(i,a*F,a*-U)),g.push(new e(i,a*F,a*U)),++M):g.push(new e(i,a*F,a*U))}return g}var m={};m.rayPlane=function(t,n,a){if(!r(t))throw new i("ray is required.");if(!r(n))throw new i("plane is required.");r(a)||(a=new e);var s=t.origin,u=t.direction,c=n.normal,l=e.dot(c,u);if(!(Math.abs(l)<o.EPSILON15)){var f=(-n.distance-e.dot(c,s))/l;if(!(f<0))return a=e.multiplyByScalar(u,f,a),e.add(s,a,a)}};var _=new e,y=new e,v=new e,g=new e,E=new e;m.rayTriangleParametric=function(t,a,s,u,c){if(!r(t))throw new i("ray is required.");if(!r(a))throw new i("p0 is required.");if(!r(s))throw new i("p1 is required.");if(!r(u))throw new i("p2 is required.");c=n(c,!1);var l,f,d,h,p,m=t.origin,T=t.direction,w=e.subtract(s,a,_),b=e.subtract(u,a,y),S=e.cross(T,b,v),C=e.dot(w,S);if(c){if(C<o.EPSILON6)return;if(l=e.subtract(m,a,g),(d=e.dot(l,S))<0||d>C)return;if(f=e.cross(l,w,E),(h=e.dot(T,f))<0||d+h>C)return;p=e.dot(b,f)/C}else{if(Math.abs(C)<o.EPSILON6)return;var O=1/C;if(l=e.subtract(m,a,g),(d=e.dot(l,S)*O)<0||d>1)return;if(f=e.cross(l,w,E),(h=e.dot(T,f)*O)<0||d+h>1)return;p=e.dot(b,f)*O}return p},m.rayTriangle=function(t,n,i,a,o,s){var u=m.rayTriangleParametric(t,n,i,a,o);if(r(u)&&!(u<0))return r(s)||(s=new e),e.multiplyByScalar(t.direction,u,s),e.add(t.origin,s,s)};var T=new l;m.lineSegmentTriangle=function(t,n,a,o,s,u,c){if(!r(t))throw new i("v0 is required.");if(!r(n))throw new i("v1 is required.");if(!r(a))throw new i("p0 is required.");if(!r(o))throw new i("p1 is required.");if(!r(s))throw new i("p2 is required.");var l=T;e.clone(t,l.origin),e.subtract(n,t,l.direction),e.normalize(l.direction,l.direction);var f=m.rayTriangleParametric(l,a,o,s,u);if(!(!r(f)||f<0||f>e.distance(t,n)))return r(c)||(c=new e),e.multiplyByScalar(l.direction,f,c),e.add(l.origin,c,c)};var w={root0:0,root1:0};m.raySphere=function(e,t,n){if(!r(e))throw new i("ray is required.");if(!r(t))throw new i("sphere is required.");if(n=d(e,t,n),r(n)&&!(n.stop<0))return n.start=Math.max(n.start,0),n};var b=new l;m.lineSegmentSphere=function(t,n,a,o){if(!r(t))throw new i("p0 is required.");if(!r(n))throw new i("p1 is required.");if(!r(a))throw new i("sphere is required.");var s=b;e.clone(t,s.origin);var u=e.subtract(n,t,s.direction),c=e.magnitude(u);if(e.normalize(u,u),o=d(s,a,o),!(!r(o)||o.stop<0||o.start>c))return o.start=Math.max(o.start,0),o.stop=Math.min(o.stop,c),o};var S=new e,C=new e;m.rayEllipsoid=function(t,n){if(!r(t))throw new i("ray is required.");if(!r(n))throw new i("ellipsoid is required.");var o,s,u,c,l,f=n.oneOverRadii,d=e.multiplyComponents(f,t.origin,S),h=e.multiplyComponents(f,t.direction,C),p=e.magnitudeSquared(d),m=e.dot(d,h);if(p>1){var _=m*m;if(o=p-1,s=e.magnitudeSquared(h),u=s*o,_<u)return;if(_>u)return c=m*m-u,l=-m+Math.sqrt(c),v=l/s,g=o/l,v<g?new a(v,g):{start:g,stop:v};var y=Math.sqrt(o/s);return new a(y,y)}if(p<1){o=p-1,s=e.magnitudeSquared(h),u=s*o,c=m*m-u,l=-m+Math.sqrt(c);var v=l/s,g=o/l;return new a(g,v)}if(m<0)return s=e.magnitudeSquared(h),new a(-m/s,-m/s)};var O=new e,A=new e,x=new e,R=new e,I=new e,D=new s,P=new s,N=new s,M=new s,z=new s,F=new s,L=new s,B=new e,U=new e,q=new t;m.grazingAltitudeLocation=function(t,n){if(!r(t))throw new i("ray is required.");if(!r(n))throw new i("ellipsoid is required.");var a=t.origin,u=t.direction;if(!e.equals(a,e.ZERO)){var c=n.geodeticSurfaceNormal(a,O);if(e.dot(u,c)>=0)return a}var l=r(this.rayEllipsoid(t,n)),f=n.transformPositionToScaledSpace(u,O),d=e.normalize(f,f),h=e.mostOrthogonalAxis(f,R),m=e.normalize(e.cross(h,d,A),A),_=e.normalize(e.cross(d,m,x),x),y=D;y[0]=d.x,y[1]=d.y,y[2]=d.z,y[3]=m.x,y[4]=m.y,y[5]=m.z,y[6]=_.x,y[7]=_.y,y[8]=_.z;var v=s.transpose(y,P),g=s.fromScale(n.radii,N),E=s.fromScale(n.oneOverRadii,M),T=z;T[0]=0,T[1]=-u.z,T[2]=u.y,T[3]=u.z,T[4]=0,T[5]=-u.x,T[6]=-u.y,T[7]=u.x,T[8]=0;var w,b,S=s.multiply(s.multiply(v,E,F),T,F),C=s.multiply(s.multiply(S,g,L),y,L),G=s.multiplyByVector(S,a,I),V=p(C,e.negate(G,O),0,0,1),j=V.length;if(j>0){for(var k=e.clone(e.ZERO,U),H=Number.NEGATIVE_INFINITY,W=0;W<j;++W){w=s.multiplyByVector(g,s.multiplyByVector(y,V[W],B),B);var Y=e.normalize(e.subtract(w,a,R),R),X=e.dot(Y,u);X>H&&(H=X,k=e.clone(w,k))}var Z=n.cartesianToCartographic(k,q);return H=o.clamp(H,0,1),b=e.magnitude(e.subtract(k,a,R))*Math.sqrt(1-H*H),b=l?-b:b,Z.height=b,n.cartographicToCartesian(Z,new e)}};var G=new e;return m.lineSegmentPlane=function(t,n,a,s){if(!r(t))throw new i("endPoint0 is required.");if(!r(n))throw new i("endPoint1 is required.");if(!r(a))throw new i("plane is required.");r(s)||(s=new e);var u=e.subtract(n,t,G),c=a.normal,l=e.dot(c,u);if(!(Math.abs(l)<o.EPSILON6)){var f=e.dot(c,t),d=-(a.distance+f)/l;if(!(d<0||d>1))return e.multiplyByScalar(u,d,s),e.add(t,s,s),s}},m.trianglePlaneIntersection=function(t,n,a,o){if(!(r(t)&&r(n)&&r(a)&&r(o)))throw new i("p0, p1, p2, and plane are required.");var s=o.normal,u=o.distance,c=e.dot(s,t)+u<0,l=e.dot(s,n)+u<0,f=e.dot(s,a)+u<0,d=0;d+=c?1:0,d+=l?1:0,d+=f?1:0;var h,p;if(1!==d&&2!==d||(h=new e,p=new e),1===d){if(c)return m.lineSegmentPlane(t,n,o,h),m.lineSegmentPlane(t,a,o,p),{positions:[t,n,a,h,p],indices:[0,3,4,1,2,4,1,4,3]};if(l)return m.lineSegmentPlane(n,a,o,h),m.lineSegmentPlane(n,t,o,p),{positions:[t,n,a,h,p],indices:[1,3,4,2,0,4,2,4,3]};if(f)return m.lineSegmentPlane(a,t,o,h),m.lineSegmentPlane(a,n,o,p),{positions:[t,n,a,h,p],indices:[2,3,4,0,1,4,0,4,3]}}else if(2===d){if(!c)return m.lineSegmentPlane(n,t,o,h),m.lineSegmentPlane(a,t,o,p),{positions:[t,n,a,h,p],indices:[1,2,4,1,4,3,0,3,4]};if(!l)return m.lineSegmentPlane(a,n,o,h),m.lineSegmentPlane(t,n,o,p),{positions:[t,n,a,h,p],indices:[2,0,4,2,4,3,1,3,4]};if(!f)return m.lineSegmentPlane(t,a,o,h),m.lineSegmentPlane(n,a,o,p),{positions:[t,n,a,h,p],indices:[0,1,4,0,4,3,2,3,4]}}},m}),define("Core/Plane",["./Cartesian3","./Check","./defined","./DeveloperError","./freezeObject","./Math","./Matrix4"],function(e,t,n,r,i,a,o){"use strict";function s(n,i){if(t.typeOf.object("normal",n),!a.equalsEpsilon(e.magnitude(n),1,a.EPSILON6))throw new r("normal must be normalized.");t.typeOf.number("distance",i),this.normal=e.clone(n),this.distance=i}s.fromPointNormal=function(i,o,u){if(t.typeOf.object("point",i),t.typeOf.object("normal",o),!a.equalsEpsilon(e.magnitude(o),1,a.EPSILON6))throw new r("normal must be normalized.");var c=-e.dot(o,i);return n(u)?(e.clone(o,u.normal),u.distance=c,u):new s(o,c)};var u=new e;s.fromCartesian4=function(i,o){t.typeOf.object("coefficients",i);var c=e.fromCartesian4(i,u),l=i.w;if(!a.equalsEpsilon(e.magnitude(c),1,a.EPSILON6))throw new r("normal must be normalized.");return n(o)?(e.clone(c,o.normal),o.distance=l,o):new s(c,l)},s.getPointDistance=function(n,r){return t.typeOf.object("plane",n),t.typeOf.object("point",r),e.dot(n.normal,r)+n.distance};var c=new e;s.projectPointOntoPlane=function(r,i,a){t.typeOf.object("plane",r),t.typeOf.object("point",i),n(a)||(a=new e);var o=s.getPointDistance(r,i),u=e.multiplyByScalar(r.normal,o,c);return e.subtract(i,u,a)};var l=new e;return s.transform=function(n,r,i){return t.typeOf.object("plane",n),t.typeOf.object("transform",r),o.multiplyByPointAsVector(r,n.normal,u),e.normalize(u,u),e.multiplyByScalar(n.normal,-n.distance,l),o.multiplyByPoint(r,l,l),s.fromPointNormal(l,u,i)},s.clone=function(r,i){return t.typeOf.object("plane",r),n(i)?(e.clone(r.normal,i.normal),i.distance=r.distance,i):new s(r.normal,r.distance)},s.equals=function(n,r){return t.typeOf.object("left",n),t.typeOf.object("right",r),n.distance===r.distance&&e.equals(n.normal,r.normal)},s.ORIGIN_XY_PLANE=i(new s(e.UNIT_Z,0)),s.ORIGIN_YZ_PLANE=i(new s(e.UNIT_X,0)),s.ORIGIN_ZX_PLANE=i(new s(e.UNIT_Y,0)),s}),define("Core/WebMercatorProjection",["./Cartesian3","./Cartographic","./defaultValue","./defined","./defineProperties","./DeveloperError","./Ellipsoid","./Math"],function(e,t,n,r,i,a,o,s){"use strict";function u(e){this._ellipsoid=n(e,o.WGS84),this._semimajorAxis=this._ellipsoid.maximumRadius,this._oneOverSemimajorAxis=1/this._semimajorAxis}return i(u.prototype,{ellipsoid:{get:function(){return this._ellipsoid}}}),u.mercatorAngleToGeodeticLatitude=function(e){return s.PI_OVER_TWO-2*Math.atan(Math.exp(-e))},u.geodeticLatitudeToMercatorAngle=function(e){e>u.MaximumLatitude?e=u.MaximumLatitude:e<-u.MaximumLatitude&&(e=-u.MaximumLatitude);var t=Math.sin(e);return.5*Math.log((1+t)/(1-t))},u.MaximumLatitude=u.mercatorAngleToGeodeticLatitude(Math.PI),u.prototype.project=function(t,n){var i=this._semimajorAxis,a=t.longitude*i,o=u.geodeticLatitudeToMercatorAngle(t.latitude)*i,s=t.height;return r(n)?(n.x=a,n.y=o,n.z=s,n):new e(a,o,s)},u.prototype.unproject=function(e,n){if(!r(e))throw new a("cartesian is required");var i=this._oneOverSemimajorAxis,o=e.x*i,s=u.mercatorAngleToGeodeticLatitude(e.y*i),c=e.z;return r(n)?(n.longitude=o,n.latitude=s,n.height=c,n):new t(o,s,c)},u}),define("Core/GroundPolylineGeometry",["./ApproximateTerrainHeights","./arrayRemoveDuplicates","./BoundingSphere","./Cartesian3","./Cartographic","./Check","./ComponentDatatype","./DeveloperError","./Math","./defaultValue","./defined","./defineProperties","./Ellipsoid","./EllipsoidGeodesic","./EncodedCartesian3","./GeographicProjection","./Geometry","./GeometryAttribute","./IntersectionTests","./Matrix3","./Plane","./Quaternion","./Rectangle","./WebMercatorProjection"],function(e,t,n,r,i,a,o,s,u,c,l,f,d,h,p,m,_,y,v,g,E,T,w,b){"use strict";function S(e){e=c(e,c.EMPTY_OBJECT);var t=e.positions;if(!l(t)||t.length<2)throw new s("At least two positions are required.");this.width=c(e.width,1),this._positions=t,this.granularity=c(e.granularity,9999),this.loop=c(e.loop,!1),this._ellipsoid=d.WGS84,this._projectionIndex=0,this._workerName="createGroundPolylineGeometry",this._scene3DOnly=!1}function C(e,t,n,i,a){var o=A(i,e,0,j),s=A(i,e,n,k),u=A(i,t,0,H),c=x(s,o,k),l=x(u,o,H);return r.cross(l,c,a),r.normalize(a,a)}function O(e,t,n,i,a,o,s,u,c,l){if(0!==a){var f=new h(e,t,o),d=f.surfaceDistance;if(!(d<a))for(var p=C(e,t,i,o,Z),m=Math.ceil(d/a),_=d/m,y=_,v=m-1,g=s.length,E=0;E<v;E++){var T=f.interpolateUsingSurfaceDistance(y,W),w=A(o,T,n,Y),b=A(o,T,i,X);r.pack(p,s,g),r.pack(w,u,g),r.pack(b,c,g),l.push(T.latitude),l.push(T.longitude),g+=3,y+=_}}}function A(e,t,n,r){return i.clone(t,K),K.height=n,i.toCartesian(K,e,r)}function x(e,t,n){return r.subtract(e,t,n),r.normalize(n,n),n}function R(e,t,n,i,a){var o=x(n,t,ne),s=x(e,t,Q),c=x(i,t,J),l=r.cross(o,s,ee);l=r.normalize(l,l);var f=E.fromPointNormal(t,l,te),d=E.getPointDistance(f,i);if(u.equalsEpsilon(d,0,u.EPSILON7))return r.clone(l,a),a;a=r.add(c,s,a),a=r.normalize(a,a);var h=r.cross(o,a,$);return r.normalize(h,h),r.cross(h,o,a),r.normalize(a,a),r.dot(c,h)<re&&(a=r.negate(a,a)),a}function I(e,t,n,i){var a=x(n,t,fe),o=r.dot(a,e);if(o>U||o<q){var s=x(i,n,ne),c=o<q?u.PI_OVER_TWO:-u.PI_OVER_TWO,l=T.fromAxisAngle(s,c,he),f=g.fromQuaternion(l,de);return g.multiplyByVector(f,e,e),!0}return!1}function D(e,t,n,a,o){var s=i.toCartesian(t,e._ellipsoid,me),c=r.add(s,n,_e),l=!1,f=e._ellipsoid,d=f.cartesianToCartographic(c,pe);Math.abs(t.longitude-d.longitude)>u.PI_OVER_TWO&&(l=!0,c=r.subtract(s,n,_e),d=f.cartesianToCartographic(c,pe)),d.height=0;var h=e.project(d,o);return o=r.subtract(h,a,o),o.z=0,o=r.normalize(o,o),l&&r.negate(o,o),o}function P(e,t,n,i,a,o){var s=r.subtract(t,e,ye);r.normalize(s,s);var u=n-G,c=r.multiplyByScalar(s,u,ve);r.add(e,c,a);var l=i-V;c=r.multiplyByScalar(s,l,ve),r.add(t,c,o)}function N(e,t){var n=E.getPointDistance(ie,e),i=E.getPointDistance(ie,t),a=ge;u.equalsEpsilon(n,0,u.EPSILON2)?(a=x(t,e,a),r.multiplyByScalar(a,u.EPSILON2,a),r.add(e,a,e)):u.equalsEpsilon(i,0,u.EPSILON2)&&(a=x(e,t,a),r.multiplyByScalar(a,u.EPSILON2,a),r.add(t,a,t))}function M(e,t){var n=Math.abs(e.longitude),r=Math.abs(t.longitude);if(u.equalsEpsilon(n,u.PI,u.EPSILON11)){var i=u.sign(t.longitude);return e.longitude=i*(n-u.EPSILON11),1}if(u.equalsEpsilon(r,u.PI,u.EPSILON11)){var a=u.sign(e.longitude);return t.longitude=a*(r-u.EPSILON11),2}return 0}function z(t,a,s,c,l,f,d){var h,m,v,g,E,T,b=a._ellipsoid,S=s.length/3-1,C=8*S,O=4*C,A=36*S,R=C>65535?new Uint32Array(A):new Uint16Array(A),z=new Float64Array(3*C),L=new Float32Array(O),B=new Float32Array(O),q=new Float32Array(O),G=new Float32Array(O),V=new Float32Array(O);d&&(v=new Float32Array(O),g=new Float32Array(O),E=new Float32Array(O),T=new Float32Array(2*C));var j=f.length/2,k=0,H=Ee;H.height=0;var W=Te;W.height=0;var Y=we,X=be;if(d)for(m=0,h=1;h<j;h++)H.latitude=f[m],H.longitude=f[m+1],W.latitude=f[m+2],W.longitude=f[m+3],Y=a.project(H,Y),X=a.project(W,X),k+=r.distance(Y,X),m+=2;var Z=c.length/3;X=r.unpack(c,0,X);var K=0;for(m=3,h=1;h<Z;h++)Y=r.clone(X,Y),X=r.unpack(c,m,X),K+=r.distance(Y,X),m+=3;var Q;m=3;var J=0,$=0,ee=0,te=0,ne=!1,re=r.unpack(s,0,Ce),ie=r.unpack(c,0,be),ae=r.unpack(l,0,Ae);if(t){I(ae,r.unpack(s,s.length-6,Se),re,ie)&&(ae=r.negate(ae,ae))}var oe=0,se=0,ue=0;for(h=0;h<S;h++){var ce=r.clone(re,Se),le=r.clone(ie,we),fe=r.clone(ae,Oe);ne&&(fe=r.negate(fe,fe)),re=r.unpack(s,m,Ce),ie=r.unpack(c,m,be),ae=r.unpack(l,m,Ae),ne=I(ae,ce,re,ie),H.latitude=f[J],H.longitude=f[J+1],W.latitude=f[J+2],W.longitude=f[J+3];var de,he,pe,me;if(d){var _e=M(H,W);de=a.project(H,Me),he=a.project(W,ze);var ye=x(he,de,We);ye.y=Math.abs(ye.y),pe=Fe,me=Le,0===_e||r.dot(ye,r.UNIT_Y)>U?(pe=D(a,H,fe,de,Fe),me=D(a,W,ae,he,Le)):1===_e?(me=D(a,W,ae,he,Le),pe.x=0,pe.y=u.sign(H.longitude-Math.abs(W.longitude)),pe.z=0):(pe=D(a,H,fe,de,Fe),me.x=0,me.y=u.sign(H.longitude-W.longitude),me.z=0)}var ve=r.distance(le,ie),ge=p.fromCartesian(ce,ke),$e=r.subtract(re,ce,Be),et=r.normalize($e,Ge),tt=r.subtract(le,ce,Ue);tt=r.normalize(tt,tt);var nt=r.cross(et,tt,Ge);nt=r.normalize(nt,nt);var rt=r.cross(tt,fe,Ve);rt=r.normalize(rt,rt);var it=r.subtract(ie,re,qe);it=r.normalize(it,it);var at=r.cross(ae,it,je);at=r.normalize(at,at);var ot,st,ut,ct=ve/K,lt=oe/K,ft=0,dt=0,ht=0;if(d){ft=r.distance(de,he),ot=p.fromCartesian(de,He),st=r.subtract(he,de,We),ut=r.normalize(st,Ye);var pt=ut.x;ut.x=ut.y,ut.y=-pt,dt=ft/k,ht=se/k}for(Q=0;Q<8;Q++){var mt=te+4*Q,_t=$+2*Q,yt=mt+3,vt=Q<4?1:-1,gt=2===Q||3===Q||6===Q||7===Q?1:-1;r.pack(ge.high,L,mt),L[yt]=$e.x,r.pack(ge.low,B,mt),B[yt]=$e.y,r.pack(rt,q,mt),q[yt]=$e.z,r.pack(at,G,mt),G[yt]=ct*vt,r.pack(nt,V,mt);var Et=lt*gt;0===Et&&gt<0&&(Et=Number.POSITIVE_INFINITY),V[yt]=Et,d&&(v[mt]=ot.high.x,v[mt+1]=ot.high.y,v[mt+2]=ot.low.x,v[mt+3]=ot.low.y,E[mt]=-pe.y,E[mt+1]=pe.x,E[mt+2]=me.y,E[mt+3]=-me.x,g[mt]=st.x,g[mt+1]=st.y,g[mt+2]=ut.x,g[mt+3]=ut.y,T[_t]=dt*vt,Et=ht*gt,0===Et&&gt<0&&(Et=Number.POSITIVE_INFINITY),T[_t+1]=Et)}var Tt=Pe,wt=Ne,bt=Ie,St=De,Ct=w.fromCartographicArray(xe,Re),Ot=e.getApproximateTerrainHeights(Ct,b),At=Ot.minimumTerrainHeight,xt=Ot.maximumTerrainHeight;ue+=At,ue+=xt,P(ce,le,At,xt,Tt,bt),P(re,ie,At,xt,wt,St);var Rt=r.multiplyByScalar(nt,u.EPSILON5,Xe);r.add(Tt,Rt,Tt),r.add(wt,Rt,wt),r.add(bt,Rt,bt),r.add(St,Rt,St),N(Tt,wt),N(bt,St),r.pack(Tt,z,ee),r.pack(wt,z,ee+3),r.pack(St,z,ee+6),r.pack(bt,z,ee+9),Rt=r.multiplyByScalar(nt,-2*u.EPSILON5,Xe),r.add(Tt,Rt,Tt),r.add(wt,Rt,wt),r.add(bt,Rt,bt),r.add(St,Rt,St),N(Tt,wt),N(bt,St),r.pack(Tt,z,ee+12),r.pack(wt,z,ee+15),r.pack(St,z,ee+18),r.pack(bt,z,ee+21),J+=2,m+=3,$+=16,ee+=24,te+=32,oe+=ve,se+=ft}m=0;var It=0;for(h=0;h<S;h++){for(Q=0;Q<Je;Q++)R[m+Q]=Qe[Q]+It;It+=8,m+=Je}var Dt=Ze;n.fromVertices(s,r.ZERO,3,Dt[0]),n.fromVertices(c,r.ZERO,3,Dt[1]);var Pt=n.fromBoundingSpheres(Dt),Nt=ue/(2*S),Mt=i.fromCartesian(Pt.center,b,Ke);Mt.height=Nt,Pt.center=i.toCartesian(Mt,b,Pt.center),Pt.radius=Math.max(Pt.radius,Nt);var zt={position:new y({componentDatatype:o.DOUBLE,componentsPerAttribute:3,normalize:!1,values:z}),startHiAndForwardOffsetX:F(L),startLoAndForwardOffsetY:F(B),startNormalAndForwardOffsetZ:F(q),endNormalAndTextureCoordinateNormalizationX:F(G),rightNormalAndTextureCoordinateNormalizationY:F(V)};return d&&(zt.startHiLo2D=F(v),zt.offsetAndRight2D=F(g),zt.startEndNormals2D=F(E),zt.texcoordNormalization2D=new y({componentDatatype:o.FLOAT,componentsPerAttribute:2,normalize:!1,values:T})),new _({attributes:zt,indices:R,boundingSphere:Pt})}function F(e){return new y({componentDatatype:o.FLOAT,componentsPerAttribute:4,normalize:!1,values:e})}var L=[m,b],B=L.length,U=Math.cos(u.toRadians(30)),q=Math.cos(u.toRadians(150)),G=0,V=1e3;f(S.prototype,{packedLength:{get:function(){return 1+3*this._positions.length+1+1+d.packedLength+1+1}}}),S.setProjectionAndEllipsoid=function(e,t){for(var n=0,r=0;r<B;r++)if(t instanceof L[r]){n=r;break}e._projectionIndex=n,e._ellipsoid=t.ellipsoid};var j=new r,k=new r,H=new r,W=new i,Y=new r,X=new r,Z=new r,K=new i;S.pack=function(e,t,n){a.typeOf.object("value",e),a.defined("array",t);var i=c(n,0),o=e._positions,s=o.length;t[i++]=s;for(var u=0;u<s;++u){var l=o[u];r.pack(l,t,i),i+=3}return t[i++]=e.granularity,t[i++]=e.loop?1:0,d.pack(e._ellipsoid,t,i),i+=d.packedLength,t[i++]=e._projectionIndex,t[i++]=e._scene3DOnly?1:0,t},S.unpack=function(e,t,n){a.defined("array",e);for(var i=c(t,0),o=e[i++],s=new Array(o),u=0;u<o;u++)s[u]=r.unpack(e,i),i+=3;var f=e[i++],h=1===e[i++],p=d.unpack(e,i);i+=d.packedLength;var m=e[i++],_=1===e[i++];if(!l(n)){var y=new S({positions:s,granularity:f,loop:h,ellipsoid:p,projection:new L[m](p)});return y._scene3DOnly=_,y}return n._positions=s,n.granularity=f,n.loop=h,n._ellipsoid=p,n._projectionIndex=m,n._scene3DOnly=_,n};var Q=new r,J=new r,$=new r,ee=new r,te=new E(r.UNIT_X,0),ne=new r,re=0,ie=E.fromPointNormal(r.ZERO,r.UNIT_Y),ae=new r,oe=new r,se=new r,ue=new r,ce=new r,le=new r;S.createGeometry=function(e){var n,a,o=!e._scene3DOnly,s=e.loop,c=e._ellipsoid,f=e.granularity,d=new L[e._projectionIndex](c),h=G,p=V,m=e._positions,_=m.length;2===_&&(s=!1);var y,g,E,T=[m[0]];for(a=0;a<_-1;a++)y=m[a],g=m[a+1],E=v.lineSegmentPlane(y,g,ie,le),!l(E)||r.equalsEpsilon(E,y,u.EPSILON7)||r.equalsEpsilon(E,g,u.EPSILON7)||T.push(r.clone(E)),T.push(g);s&&(y=m[_-1],g=m[0],E=v.lineSegmentPlane(y,g,ie,le),!l(E)||r.equalsEpsilon(E,y,u.EPSILON7)||r.equalsEpsilon(E,g,u.EPSILON7)||T.push(r.clone(E)));var w=T.length,b=new Array(w);for(a=0;a<w;a++){var S=i.fromCartesian(T[a],c);S.height=0,b[a]=S}if(b=t(b,i.equalsEpsilon),!((w=b.length)<2)){var x=[],I=[],D=[],P=[],N=ae,M=oe,F=se,B=ue,U=ce,q=b[0],j=b[1],k=b[w-1];for(N=A(c,k,h,N),B=A(c,j,h,B),M=A(c,q,h,M),F=A(c,q,p,F),U=s?R(N,M,F,B,U):C(q,j,p,c,U),r.pack(U,I,0),r.pack(M,D,0),r.pack(F,P,0),x.push(q.latitude),x.push(q.longitude),O(q,j,h,p,f,c,I,D,P,x),a=1;a<w-1;++a){N=r.clone(M,N),M=r.clone(B,M);var H=b[a];A(c,H,p,F),A(c,b[a+1],h,B),R(N,M,F,B,U),n=I.length,r.pack(U,I,n),r.pack(M,D,n),r.pack(F,P,n),x.push(H.latitude),x.push(H.longitude),O(b[a],b[a+1],h,p,f,c,I,D,P,x)}var W=b[w-1],Y=b[w-2];if(M=A(c,W,h,M),F=A(c,W,p,F),s){var X=b[0];N=A(c,Y,h,N),B=A(c,X,h,B),U=R(N,M,F,B,U)}else U=C(Y,W,p,c,U);if(n=I.length,r.pack(U,I,n),r.pack(M,D,n),r.pack(F,P,n),x.push(W.latitude),x.push(W.longitude),s){for(O(W,q,h,p,f,c,I,D,P,x),n=I.length,a=0;a<3;++a)I[n+a]=I[a],D[n+a]=D[a],P[n+a]=P[a];x.push(q.latitude),x.push(q.longitude)}return z(s,d,D,P,I,x,o)}};var fe=new r,de=new g,he=new T,pe=new i,me=new r,_e=new r,ye=new r,ve=new r,ge=new r,Ee=new i,Te=new i,we=new r,be=new r,Se=new r,Ce=new r,Oe=new r,Ae=new r,xe=[Ee,Te],Re=new w,Ie=new r,De=new r,Pe=new r,Ne=new r,Me=new r,ze=new r,Fe=new r,Le=new r,Be=new r,Ue=new r,qe=new r,Ge=new r,Ve=new r,je=new r,ke=new p,He=new p,We=new r,Ye=new r,Xe=new r,Ze=[new n,new n],Ke=new i,Qe=[0,2,1,0,3,2,0,7,3,0,4,7,0,5,4,0,1,5,5,7,4,5,6,7,5,2,6,5,1,2,3,6,2,3,7,6],Je=Qe.length;return S._projectNormal=D,S}),define("Core/destroyObject",["./defaultValue","./DeveloperError"],function(e,t){"use strict";function n(){return!0}function r(r,i){function a(){throw new t(i)}i=e(i,"This object was destroyed, i.e., destroy() was called.");for(var o in r)"function"==typeof r[o]&&(r[o]=a);r.isDestroyed=n}return r}),define("Core/GeometryInstance",["./defaultValue","./defined","./DeveloperError","./Matrix4"],function(e,t,n,r){"use strict";function i(i){if(i=e(i,e.EMPTY_OBJECT),!t(i.geometry))throw new n("options.geometry is required.");this.geometry=i.geometry,this.modelMatrix=r.clone(e(i.modelMatrix,r.IDENTITY)),this.id=i.id,this.pickPrimitive=i.pickPrimitive,this.attributes=e(i.attributes,{}),this.westHemisphereGeometry=void 0,this.eastHemisphereGeometry=void 0}return i}),define("Core/GeometryInstanceAttribute",["./defaultValue","./defined","./DeveloperError"],function(e,t,n){"use strict";function r(r){if(r=e(r,e.EMPTY_OBJECT),!t(r.componentDatatype))throw new n("options.componentDatatype is required.");if(!t(r.componentsPerAttribute))throw new n("options.componentsPerAttribute is required.");if(r.componentsPerAttribute<1||r.componentsPerAttribute>4)throw new n("options.componentsPerAttribute must be between 1 and 4.");if(!t(r.value))throw new n("options.value is required.");this.componentDatatype=r.componentDatatype,this.componentsPerAttribute=r.componentsPerAttribute,this.normalize=e(r.normalize,!1),this.value=r.value}return r}),define("Shaders/PolylineShadowVolumeVS",[],function(){"use strict"
;return"attribute vec3 position3DHigh;\nattribute vec3 position3DLow;\n#ifndef COLUMBUS_VIEW_2D\nattribute vec4 startHiAndForwardOffsetX;\nattribute vec4 startLoAndForwardOffsetY;\nattribute vec4 startNormalAndForwardOffsetZ;\nattribute vec4 endNormalAndTextureCoordinateNormalizationX;\nattribute vec4 rightNormalAndTextureCoordinateNormalizationY;\n#else\nattribute vec4 startHiLo2D;\nattribute vec4 offsetAndRight2D;\nattribute vec4 startEndNormals2D;\nattribute vec2 texcoordNormalization2D;\n#endif\nattribute float batchId;\nvarying vec4 v_startPlaneNormalEcAndHalfWidth;\nvarying vec4 v_endPlaneNormalEcAndBatchId;\nvarying vec4 v_rightPlaneEC;\nvarying vec4 v_endEcAndStartEcX;\nvarying vec4 v_texcoordNormalizationAndStartEcYZ;\n#ifdef WIDTH_VARYING\nvarying float v_width;\n#endif\n#ifdef ANGLE_VARYING\nvarying float v_polylineAngle;\n#endif\n#ifdef PER_INSTANCE_COLOR\nvarying vec4 v_color;\n#endif\nvoid main()\n{\n#ifdef COLUMBUS_VIEW_2D\nvec3 ecStart = (czm_modelViewRelativeToEye * czm_translateRelativeToEye(vec3(0.0, startHiLo2D.xy), vec3(0.0, startHiLo2D.zw))).xyz;\nvec3 forwardDirectionEC = czm_normal * vec3(0.0, offsetAndRight2D.xy);\nvec3 ecEnd = forwardDirectionEC + ecStart;\nforwardDirectionEC = normalize(forwardDirectionEC);\nv_rightPlaneEC.xyz = czm_normal * vec3(0.0, offsetAndRight2D.zw);\nv_rightPlaneEC.w = -dot(v_rightPlaneEC.xyz, ecStart);\nvec4 startPlaneEC;\nstartPlaneEC.xyz =  czm_normal * vec3(0.0, startEndNormals2D.xy);\nstartPlaneEC.w = -dot(startPlaneEC.xyz, ecStart);\nvec4 endPlaneEC;\nendPlaneEC.xyz =  czm_normal * vec3(0.0, startEndNormals2D.zw);\nendPlaneEC.w = -dot(endPlaneEC.xyz, ecEnd);\nv_texcoordNormalizationAndStartEcYZ.x = abs(texcoordNormalization2D.x);\nv_texcoordNormalizationAndStartEcYZ.y = texcoordNormalization2D.y;\n#else // COLUMBUS_VIEW_2D\nvec3 ecStart = (czm_modelViewRelativeToEye * czm_translateRelativeToEye(startHiAndForwardOffsetX.xyz, startLoAndForwardOffsetY.xyz)).xyz;\nvec3 offset = czm_normal * vec3(startHiAndForwardOffsetX.w, startLoAndForwardOffsetY.w, startNormalAndForwardOffsetZ.w);\nvec3 ecEnd = ecStart + offset;\nvec3 forwardDirectionEC = normalize(offset);\nvec4 startPlaneEC;\nstartPlaneEC.xyz = czm_normal * startNormalAndForwardOffsetZ.xyz;\nstartPlaneEC.w = -dot(startPlaneEC.xyz, ecStart);\nvec4 endPlaneEC;\nendPlaneEC.xyz = czm_normal * endNormalAndTextureCoordinateNormalizationX.xyz;\nendPlaneEC.w = -dot(endPlaneEC.xyz, ecEnd);\nv_rightPlaneEC.xyz = czm_normal * rightNormalAndTextureCoordinateNormalizationY.xyz;\nv_rightPlaneEC.w = -dot(v_rightPlaneEC.xyz, ecStart);\nv_texcoordNormalizationAndStartEcYZ.x = abs(endNormalAndTextureCoordinateNormalizationX.w);\nv_texcoordNormalizationAndStartEcYZ.y = rightNormalAndTextureCoordinateNormalizationY.w;\n#endif // COLUMBUS_VIEW_2D\nv_endEcAndStartEcX.xyz = ecEnd;\nv_endEcAndStartEcX.w = ecStart.x;\nv_texcoordNormalizationAndStartEcYZ.zw = ecStart.yz;\n#ifdef PER_INSTANCE_COLOR\nv_color = czm_batchTable_color(batchId);\n#endif // PER_INSTANCE_COLOR\nvec4 positionRelativeToEye = czm_computePosition();\nvec4 positionEC = czm_modelViewRelativeToEye * positionRelativeToEye;\nfloat absStartPlaneDistance = abs(czm_planeDistance(startPlaneEC, positionEC.xyz));\nfloat absEndPlaneDistance = abs(czm_planeDistance(endPlaneEC, positionEC.xyz));\nvec3 planeDirection = czm_branchFreeTernary(absStartPlaneDistance < absEndPlaneDistance, startPlaneEC.xyz, endPlaneEC.xyz);\nvec3 upOrDown = normalize(cross(v_rightPlaneEC.xyz, planeDirection));\nvec3 normalEC = normalize(cross(planeDirection, upOrDown));\nupOrDown = cross(forwardDirectionEC, normalEC);\nupOrDown = float(czm_sceneMode == czm_sceneMode3D) * upOrDown;\nupOrDown = float(v_texcoordNormalizationAndStartEcYZ.y > 1.0 || v_texcoordNormalizationAndStartEcYZ.y < 0.0) * upOrDown;\nupOrDown = min(GLOBE_MINIMUM_ALTITUDE, czm_geometricToleranceOverMeter * length(positionRelativeToEye.xyz)) * upOrDown;\npositionEC.xyz += upOrDown;\nv_texcoordNormalizationAndStartEcYZ.y = czm_branchFreeTernary(v_texcoordNormalizationAndStartEcYZ.y > 1.0, 0.0, abs(v_texcoordNormalizationAndStartEcYZ.y));\nfloat width = czm_batchTable_width(batchId);\n#ifdef WIDTH_VARYING\nv_width = width;\n#endif\nv_startPlaneNormalEcAndHalfWidth.xyz = startPlaneEC.xyz;\nv_startPlaneNormalEcAndHalfWidth.w = width * 0.5;\nv_endPlaneNormalEcAndBatchId.xyz = endPlaneEC.xyz;\nv_endPlaneNormalEcAndBatchId.w = batchId;\nwidth = width * max(0.0, czm_metersPerPixel(positionEC));\nwidth = width / dot(normalEC, v_rightPlaneEC.xyz);\n#ifdef COLUMBUS_VIEW_2D\nnormalEC *= sign(texcoordNormalization2D.x);\n#else\nnormalEC *= sign(endNormalAndTextureCoordinateNormalizationX.w);\n#endif\npositionEC.xyz += width * normalEC;\ngl_Position = czm_depthClampFarPlane(czm_projection * positionEC);\n#ifdef ANGLE_VARYING\nvec2 approxLineDirection = normalize(vec2(forwardDirectionEC.x, -forwardDirectionEC.y));\napproxLineDirection.y = czm_branchFreeTernary(approxLineDirection.x == 0.0 && approxLineDirection.y == 0.0, -1.0, approxLineDirection.y);\nv_polylineAngle = czm_fastApproximateAtan(approxLineDirection.x, approxLineDirection.y);\n#endif\n}\n"}),define("Shaders/PolylineShadowVolumeFS",[],function(){"use strict";return"#ifdef GL_EXT_frag_depth\n#extension GL_EXT_frag_depth : enable\n#endif\nvarying vec4 v_startPlaneNormalEcAndHalfWidth;\nvarying vec4 v_endPlaneNormalEcAndBatchId;\nvarying vec4 v_rightPlaneEC;\nvarying vec4 v_endEcAndStartEcX;\nvarying vec4 v_texcoordNormalizationAndStartEcYZ;\n#ifdef PER_INSTANCE_COLOR\nvarying vec4 v_color;\n#endif\nvoid main(void)\n{\nfloat logDepthOrDepth = czm_branchFreeTernary(czm_sceneMode == czm_sceneMode2D, gl_FragCoord.z, czm_unpackDepth(texture2D(czm_globeDepthTexture, gl_FragCoord.xy / czm_viewport.zw)));\nvec3 ecStart = vec3(v_endEcAndStartEcX.w, v_texcoordNormalizationAndStartEcYZ.zw);\nif (logDepthOrDepth == 0.0) {\n#ifdef DEBUG_SHOW_VOLUME\ngl_FragColor = vec4(1.0, 0.0, 0.0, 0.5);\nreturn;\n#else // DEBUG_SHOW_VOLUME\ndiscard;\n#endif // DEBUG_SHOW_VOLUME\n}\nvec4 eyeCoordinate = czm_windowToEyeCoordinates(gl_FragCoord.xy, logDepthOrDepth);\neyeCoordinate /= eyeCoordinate.w;\nfloat halfMaxWidth = v_startPlaneNormalEcAndHalfWidth.w * czm_metersPerPixel(eyeCoordinate);\nfloat widthwiseDistance = czm_planeDistance(v_rightPlaneEC, eyeCoordinate.xyz);\nfloat distanceFromStart = czm_planeDistance(v_startPlaneNormalEcAndHalfWidth.xyz, -dot(ecStart, v_startPlaneNormalEcAndHalfWidth.xyz), eyeCoordinate.xyz);\nfloat distanceFromEnd = czm_planeDistance(v_endPlaneNormalEcAndBatchId.xyz, -dot(v_endEcAndStartEcX.xyz, v_endPlaneNormalEcAndBatchId.xyz), eyeCoordinate.xyz);\nif (abs(widthwiseDistance) > halfMaxWidth || distanceFromStart < 0.0 || distanceFromEnd < 0.0) {\n#ifdef DEBUG_SHOW_VOLUME\ngl_FragColor = vec4(1.0, 0.0, 0.0, 0.5);\nreturn;\n#else // DEBUG_SHOW_VOLUME\ndiscard;\n#endif // DEBUG_SHOW_VOLUME\n}\nvec3 alignedPlaneNormal;\nalignedPlaneNormal = cross(v_rightPlaneEC.xyz, v_startPlaneNormalEcAndHalfWidth.xyz);\nalignedPlaneNormal = normalize(cross(alignedPlaneNormal, v_rightPlaneEC.xyz));\ndistanceFromStart = czm_planeDistance(alignedPlaneNormal, -dot(alignedPlaneNormal, ecStart), eyeCoordinate.xyz);\nalignedPlaneNormal = cross(v_rightPlaneEC.xyz, v_endPlaneNormalEcAndBatchId.xyz);\nalignedPlaneNormal = normalize(cross(alignedPlaneNormal, v_rightPlaneEC.xyz));\ndistanceFromEnd = czm_planeDistance(alignedPlaneNormal, -dot(alignedPlaneNormal, v_endEcAndStartEcX.xyz), eyeCoordinate.xyz);\n#ifdef PER_INSTANCE_COLOR\ngl_FragColor = v_color;\n#else // PER_INSTANCE_COLOR\nfloat s = clamp(distanceFromStart / (distanceFromStart + distanceFromEnd), 0.0, 1.0);\ns = (s * v_texcoordNormalizationAndStartEcYZ.x) + v_texcoordNormalizationAndStartEcYZ.y;\nfloat t = (widthwiseDistance + halfMaxWidth) / (2.0 * halfMaxWidth);\nczm_materialInput materialInput;\nmaterialInput.s = s;\nmaterialInput.st = vec2(s, t);\nmaterialInput.str = vec3(s, t, 0.0);\nczm_material material = czm_getMaterial(materialInput);\ngl_FragColor = vec4(material.diffuse + material.emission, material.alpha);\n#endif // PER_INSTANCE_COLOR\nczm_writeDepthClampedToFarPlane();\n}\n"}),define("Shaders/PolylineShadowVolumeMorphVS",[],function(){"use strict";return"attribute vec3 position3DHigh;\nattribute vec3 position3DLow;\nattribute vec4 startHiAndForwardOffsetX;\nattribute vec4 startLoAndForwardOffsetY;\nattribute vec4 startNormalAndForwardOffsetZ;\nattribute vec4 endNormalAndTextureCoordinateNormalizationX;\nattribute vec4 rightNormalAndTextureCoordinateNormalizationY;\nattribute vec4 startHiLo2D;\nattribute vec4 offsetAndRight2D;\nattribute vec4 startEndNormals2D;\nattribute vec2 texcoordNormalization2D;\nattribute float batchId;\nvarying vec3 v_forwardDirectionEC;\nvarying vec3 v_texcoordNormalizationAndHalfWidth;\nvarying float v_batchId;\n#ifdef WIDTH_VARYING\nvarying float v_width;\n#endif\n#ifdef ANGLE_VARYING\nvarying float v_polylineAngle;\n#endif\n#ifdef PER_INSTANCE_COLOR\nvarying vec4 v_color;\n#else\nvarying vec2 v_alignedPlaneDistances;\nvarying float v_texcoordT;\n#endif\nvoid main()\n{\nv_batchId = batchId;\nvec4 posRelativeToEye2D = czm_translateRelativeToEye(vec3(0.0, startHiLo2D.xy), vec3(0.0, startHiLo2D.zw));\nvec4 posRelativeToEye3D = czm_translateRelativeToEye(startHiAndForwardOffsetX.xyz, startLoAndForwardOffsetY.xyz);\nvec4 posRelativeToEye = czm_columbusViewMorph(posRelativeToEye2D, posRelativeToEye3D, czm_morphTime);\nvec3 posEc2D = (czm_modelViewRelativeToEye * posRelativeToEye2D).xyz;\nvec3 posEc3D = (czm_modelViewRelativeToEye * posRelativeToEye3D).xyz;\nvec3 startEC = (czm_modelViewRelativeToEye * posRelativeToEye).xyz;\nvec4 startPlane2D;\nvec4 startPlane3D;\nstartPlane2D.xyz = czm_normal * vec3(0.0, startEndNormals2D.xy);\nstartPlane3D.xyz = czm_normal * startNormalAndForwardOffsetZ.xyz;\nstartPlane2D.w = -dot(startPlane2D.xyz, posEc2D);\nstartPlane3D.w = -dot(startPlane3D.xyz, posEc3D);\nvec4 rightPlane2D;\nvec4 rightPlane3D;\nrightPlane2D.xyz = czm_normal * vec3(0.0, offsetAndRight2D.zw);\nrightPlane3D.xyz = czm_normal * rightNormalAndTextureCoordinateNormalizationY.xyz;\nrightPlane2D.w = -dot(rightPlane2D.xyz, posEc2D);\nrightPlane3D.w = -dot(rightPlane3D.xyz, posEc3D);\nposRelativeToEye2D = posRelativeToEye2D + vec4(0.0, offsetAndRight2D.xy, 0.0);\nposRelativeToEye3D = posRelativeToEye3D + vec4(startHiAndForwardOffsetX.w, startLoAndForwardOffsetY.w, startNormalAndForwardOffsetZ.w, 0.0);\nposRelativeToEye = czm_columbusViewMorph(posRelativeToEye2D, posRelativeToEye3D, czm_morphTime);\nposEc2D = (czm_modelViewRelativeToEye * posRelativeToEye2D).xyz;\nposEc3D = (czm_modelViewRelativeToEye * posRelativeToEye3D).xyz;\nvec3 endEC = (czm_modelViewRelativeToEye * posRelativeToEye).xyz;\nvec3 forwardEc3D = czm_normal * normalize(vec3(startHiAndForwardOffsetX.w, startLoAndForwardOffsetY.w, startNormalAndForwardOffsetZ.w));\nvec3 forwardEc2D = czm_normal * normalize(vec3(0.0, offsetAndRight2D.xy));\nvec4 endPlane2D;\nvec4 endPlane3D;\nendPlane2D.xyz = czm_normal * vec3(0.0, startEndNormals2D.zw);\nendPlane3D.xyz = czm_normal * endNormalAndTextureCoordinateNormalizationX.xyz;\nendPlane2D.w = -dot(endPlane2D.xyz, posEc2D);\nendPlane3D.w = -dot(endPlane3D.xyz, posEc3D);\nv_forwardDirectionEC = normalize(endEC - startEC);\nvec2 cleanTexcoordNormalization2D;\ncleanTexcoordNormalization2D.x = abs(texcoordNormalization2D.x);\ncleanTexcoordNormalization2D.y = czm_branchFreeTernary(texcoordNormalization2D.y > 1.0, 0.0, abs(texcoordNormalization2D.y));\nvec2 cleanTexcoordNormalization3D;\ncleanTexcoordNormalization3D.x = abs(endNormalAndTextureCoordinateNormalizationX.w);\ncleanTexcoordNormalization3D.y = rightNormalAndTextureCoordinateNormalizationY.w;\ncleanTexcoordNormalization3D.y = czm_branchFreeTernary(cleanTexcoordNormalization3D.y > 1.0, 0.0, abs(cleanTexcoordNormalization3D.y));\nv_texcoordNormalizationAndHalfWidth.xy = mix(cleanTexcoordNormalization2D, cleanTexcoordNormalization3D, czm_morphTime);\n#ifdef PER_INSTANCE_COLOR\nv_color = czm_batchTable_color(batchId);\n#else // PER_INSTANCE_COLOR\nv_alignedPlaneDistances.x = -dot(v_forwardDirectionEC, startEC);\nv_alignedPlaneDistances.y = -dot(-v_forwardDirectionEC, endEC);\n#endif // PER_INSTANCE_COLOR\n#ifdef WIDTH_VARYING\nfloat width = czm_batchTable_width(batchId);\nfloat halfWidth = width * 0.5;\nv_width = width;\nv_texcoordNormalizationAndHalfWidth.z = halfWidth;\n#else\nfloat halfWidth = 0.5 * czm_batchTable_width(batchId);\nv_texcoordNormalizationAndHalfWidth.z = halfWidth;\n#endif\nvec4 positionEc3D = czm_modelViewRelativeToEye * czm_translateRelativeToEye(position3DHigh, position3DLow);\nfloat absStartPlaneDistance = abs(czm_planeDistance(startPlane3D, positionEc3D.xyz));\nfloat absEndPlaneDistance = abs(czm_planeDistance(endPlane3D, positionEc3D.xyz));\nvec3 planeDirection = czm_branchFreeTernary(absStartPlaneDistance < absEndPlaneDistance, startPlane3D.xyz, endPlane3D.xyz);\nvec3 upOrDown = normalize(cross(rightPlane3D.xyz, planeDirection));\nvec3 normalEC = normalize(cross(planeDirection, upOrDown));\nvec3 geodeticSurfaceNormal = normalize(cross(normalEC, forwardEc3D));\ngeodeticSurfaceNormal *= float(0.0 <= rightNormalAndTextureCoordinateNormalizationY.w && rightNormalAndTextureCoordinateNormalizationY.w <= 1.0);\ngeodeticSurfaceNormal *= MAX_TERRAIN_HEIGHT;\npositionEc3D.xyz += geodeticSurfaceNormal;\nnormalEC *= sign(endNormalAndTextureCoordinateNormalizationX.w);\npositionEc3D.xyz += halfWidth * max(0.0, czm_metersPerPixel(positionEc3D)) * normalEC;\nvec4 positionEc2D = czm_modelViewRelativeToEye * czm_translateRelativeToEye(position2DHigh.zxy, position2DLow.zxy);\nabsStartPlaneDistance = abs(czm_planeDistance(startPlane2D, positionEc2D.xyz));\nabsEndPlaneDistance = abs(czm_planeDistance(endPlane2D, positionEc2D.xyz));\nplaneDirection = czm_branchFreeTernary(absStartPlaneDistance < absEndPlaneDistance, startPlane2D.xyz, endPlane2D.xyz);\nupOrDown = normalize(cross(rightPlane2D.xyz, planeDirection));\nnormalEC = normalize(cross(planeDirection, upOrDown));\ngeodeticSurfaceNormal = normalize(cross(normalEC, forwardEc2D));\ngeodeticSurfaceNormal *= float(0.0 <= texcoordNormalization2D.y && texcoordNormalization2D.y <= 1.0);\ngeodeticSurfaceNormal *= MAX_TERRAIN_HEIGHT;\npositionEc2D.xyz += geodeticSurfaceNormal;\nnormalEC *= sign(texcoordNormalization2D.x);\n#ifndef PER_INSTANCE_COLOR\nv_texcoordT = clamp(sign(texcoordNormalization2D.x), 0.0, 1.0);\n#endif\npositionEc2D.xyz += halfWidth * max(0.0, czm_metersPerPixel(positionEc2D)) * normalEC;\ngl_Position = czm_projection * mix(positionEc2D, positionEc3D, czm_morphTime);\n#ifdef ANGLE_VARYING\nvec2 approxLineDirection = normalize(vec2(v_forwardDirectionEC.x, -v_forwardDirectionEC.y));\napproxLineDirection.y = czm_branchFreeTernary(approxLineDirection.x == 0.0 && approxLineDirection.y == 0.0, -1.0, approxLineDirection.y);\nv_polylineAngle = czm_fastApproximateAtan(approxLineDirection.x, approxLineDirection.y);\n#endif\n}\n"}),define("Shaders/PolylineShadowVolumeMorphFS",[],function(){"use strict";return"varying vec3 v_forwardDirectionEC;\nvarying vec3 v_texcoordNormalizationAndHalfWidth;\nvarying float v_batchId;\n#ifdef PER_INSTANCE_COLOR\nvarying vec4 v_color;\n#else\nvarying vec2 v_alignedPlaneDistances;\nvarying float v_texcoordT;\n#endif\nfloat rayPlaneDistanceUnsafe(vec3 origin, vec3 direction, vec3 planeNormal, float planeDistance) {\nreturn (-planeDistance - dot(planeNormal, origin)) / dot(planeNormal, direction);\n}\nvoid main(void)\n{\nvec4 eyeCoordinate = gl_FragCoord;\neyeCoordinate /= eyeCoordinate.w;\n#ifdef PER_INSTANCE_COLOR\ngl_FragColor = v_color;\n#else // PER_INSTANCE_COLOR\nfloat distanceFromStart = rayPlaneDistanceUnsafe(eyeCoordinate.xyz, -v_forwardDirectionEC, v_forwardDirectionEC.xyz, v_alignedPlaneDistances.x);\nfloat distanceFromEnd = rayPlaneDistanceUnsafe(eyeCoordinate.xyz, v_forwardDirectionEC, -v_forwardDirectionEC.xyz, v_alignedPlaneDistances.y);\ndistanceFromStart = max(0.0, distanceFromStart);\ndistanceFromEnd = max(0.0, distanceFromEnd);\nfloat s = distanceFromStart / (distanceFromStart + distanceFromEnd);\ns = (s * v_texcoordNormalizationAndHalfWidth.x) + v_texcoordNormalizationAndHalfWidth.y;\nczm_materialInput materialInput;\nmaterialInput.s = s;\nmaterialInput.st = vec2(s, v_texcoordT);\nmaterialInput.str = vec3(s, v_texcoordT, 0.0);\nczm_material material = czm_getMaterial(materialInput);\ngl_FragColor = vec4(material.diffuse + material.emission, material.alpha);\n#endif // PER_INSTANCE_COLOR\n}\n"}),define("Renderer/DrawCommand",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/PrimitiveType"],function(e,t,n,r){"use strict";function i(t){t=e(t,e.EMPTY_OBJECT),this._boundingVolume=t.boundingVolume,this._orientedBoundingBox=t.orientedBoundingBox,this._cull=e(t.cull,!0),this._modelMatrix=t.modelMatrix,this._primitiveType=e(t.primitiveType,r.TRIANGLES),this._vertexArray=t.vertexArray,this._count=t.count,this._offset=e(t.offset,0),this._instanceCount=e(t.instanceCount,0),this._shaderProgram=t.shaderProgram,this._uniformMap=t.uniformMap,this._renderState=t.renderState,this._framebuffer=t.framebuffer,this._pass=t.pass,this._executeInClosestFrustum=e(t.executeInClosestFrustum,!1),this._owner=t.owner,this._debugShowBoundingVolume=e(t.debugShowBoundingVolume,!1),this._debugOverlappingFrustums=0,this._castShadows=e(t.castShadows,!1),this._receiveShadows=e(t.receiveShadows,!1),this._pickId=t.pickId,this.dirty=!0,this.lastDirtyTime=0,this.derivedCommands={}}return n(i.prototype,{boundingVolume:{get:function(){return this._boundingVolume},set:function(e){this._boundingVolume!==e&&(this._boundingVolume=e,this.dirty=!0)}},orientedBoundingBox:{get:function(){return this._orientedBoundingBox},set:function(e){this._orientedBoundingBox!==e&&(this._orientedBoundingBox=e,this.dirty=!0)}},cull:{get:function(){return this._cull},set:function(e){this._cull!==e&&(this._cull=e,this.dirty=!0)}},modelMatrix:{get:function(){return this._modelMatrix},set:function(e){this._modelMatrix!==e&&(this._modelMatrix=e,this.dirty=!0)}},primitiveType:{get:function(){return this._primitiveType},set:function(e){this._primitiveType!==e&&(this._primitiveType=e,this.dirty=!0)}},vertexArray:{get:function(){return this._vertexArray},set:function(e){this._vertexArray!==e&&(this._vertexArray=e,this.dirty=!0)}},count:{get:function(){return this._count},set:function(e){this._count!==e&&(this._count=e,this.dirty=!0)}},offset:{get:function(){return this._offset},set:function(e){this._offset!==e&&(this._offset=e,this.dirty=!0)}},instanceCount:{get:function(){return this._instanceCount},set:function(e){this._instanceCount!==e&&(this._instanceCount=e,this.dirty=!0)}},shaderProgram:{get:function(){return this._shaderProgram},set:function(e){this._shaderProgram!==e&&(this._shaderProgram=e,this.dirty=!0)}},castShadows:{get:function(){return this._castShadows},set:function(e){this._castShadows!==e&&(this._castShadows=e,this.dirty=!0)}},receiveShadows:{get:function(){return this._receiveShadows},set:function(e){this._receiveShadows!==e&&(this._receiveShadows=e,this.dirty=!0)}},uniformMap:{get:function(){return this._uniformMap},set:function(e){this._uniformMap!==e&&(this._uniformMap=e,this.dirty=!0)}},renderState:{get:function(){return this._renderState},set:function(e){this._renderState!==e&&(this._renderState=e,this.dirty=!0)}},framebuffer:{get:function(){return this._framebuffer},set:function(e){this._framebuffer!==e&&(this._framebuffer=e,this.dirty=!0)}},pass:{get:function(){return this._pass},set:function(e){this._pass!==e&&(this._pass=e,this.dirty=!0)}},executeInClosestFrustum:{get:function(){return this._executeInClosestFrustum},set:function(e){this._executeInClosestFrustum!==e&&(this._executeInClosestFrustum=e,this.dirty=!0)}},owner:{get:function(){return this._owner},set:function(e){this._owner!==e&&(this._owner=e,this.dirty=!0)}},debugShowBoundingVolume:{get:function(){return this._debugShowBoundingVolume},set:function(e){this._debugShowBoundingVolume!==e&&(this._debugShowBoundingVolume=e,this.dirty=!0)}},debugOverlappingFrustums:{get:function(){return this._debugOverlappingFrustums},set:function(e){this._debugOverlappingFrustums!==e&&(this._debugOverlappingFrustums=e,this.dirty=!0)}},pickId:{get:function(){return this._pickId},set:function(e){this._pickId!==e&&(this._pickId=e,this.dirty=!0)}}}),i.shallowClone=function(e,n){if(t(e))return t(n)||(n=new i),n._boundingVolume=e._boundingVolume,n._orientedBoundingBox=e._orientedBoundingBox,n._cull=e._cull,n._modelMatrix=e._modelMatrix,n._primitiveType=e._primitiveType,n._vertexArray=e._vertexArray,n._count=e._count,n._offset=e._offset,n._instanceCount=e._instanceCount,n._shaderProgram=e._shaderProgram,n._uniformMap=e._uniformMap,n._renderState=e._renderState,n._framebuffer=e._framebuffer,n._pass=e._pass,n._executeInClosestFrustum=e._executeInClosestFrustum,n._owner=e._owner,n._debugShowBoundingVolume=e._debugShowBoundingVolume,n._debugOverlappingFrustums=e._debugOverlappingFrustums,n._castShadows=e._castShadows,n._receiveShadows=e._receiveShadows,n._pickId=e._pickId,n.dirty=!0,n.lastDirtyTime=0,n.level=e.level,n},i.prototype.execute=function(e,n){var r,i=t(this.level);i&&(r=e._gl,r.enable(r.STENCIL_TEST),r.stencilFunc(r.GEQUAL,Math.min(Cesium.maxLevel<<3,this.level<<3),248),r.stencilOp(r.KEEP,r.KEEP,r.REPLACE)),e.draw(this,n),i&&r.disable(r.STENCIL_TEST)},i}),define("Renderer/Pass",["../Core/freezeObject"],function(e){"use strict";return e({ENVIRONMENT:0,COMPUTE:1,GLOBE:2,TERRAIN_CLASSIFICATION:3,CESIUM_3D_TILE:4,CESIUM_3D_TILE_CLASSIFICATION:5,CESIUM_3D_TILE_CLASSIFICATION_IGNORE_SHOW:6,CLASSIFICATION:7,OPAQUE:8,TRANSLUCENT:9,OVERLAY:10,NUMBER_OF_PASSES:11})}),define("Core/BoundingRectangle",["./Cartesian2","./Cartographic","./Check","./defaultValue","./defined","./GeographicProjection","./Intersect","./Rectangle"],function(e,t,n,r,i,a,o,s){"use strict";function u(e,t,n,i){this.x=r(e,0),this.y=r(t,0),this.width=r(n,0),this.height=r(i,0)}u.packedLength=4,u.pack=function(e,t,i){return n.typeOf.object("value",e),n.defined("array",t),i=r(i,0),t[i++]=e.x,t[i++]=e.y,t[i++]=e.width,t[i]=e.height,t},u.unpack=function(e,t,a){return n.defined("array",e),t=r(t,0),i(a)||(a=new u),a.x=e[t++],a.y=e[t++],a.width=e[t++],a.height=e[t],a},u.fromPoints=function(e,t){if(i(t)||(t=new u),!i(e)||0===e.length)return t.x=0,t.y=0,t.width=0,t.height=0,t;for(var n=e.length,r=e[0].x,a=e[0].y,o=e[0].x,s=e[0].y,c=1;c<n;c++){var l=e[c],f=l.x,d=l.y;r=Math.min(f,r),o=Math.max(f,o),a=Math.min(d,a),s=Math.max(d,s)}return t.x=r,t.y=a,t.width=o-r,t.height=s-a,t};var c=new a,l=new t,f=new t;return u.fromRectangle=function(t,n,a){if(i(a)||(a=new u),!i(t))return a.x=0,a.y=0,a.width=0,a.height=0,a;n=r(n,c);var o=n.project(s.southwest(t,l)),d=n.project(s.northeast(t,f));return e.subtract(d,o,d),a.x=o.x,a.y=o.y,a.width=d.x,a.height=d.y,a},u.clone=function(e,t){if(i(e))return i(t)?(t.x=e.x,t.y=e.y,t.width=e.width,t.height=e.height,t):new u(e.x,e.y,e.width,e.height)},u.union=function(e,t,r){n.typeOf.object("left",e),n.typeOf.object("right",t),i(r)||(r=new u);var a=Math.min(e.x,t.x),o=Math.min(e.y,t.y),s=Math.max(e.x+e.width,t.x+t.width),c=Math.max(e.y+e.height,t.y+t.height);return r.x=a,r.y=o,r.width=s-a,r.height=c-o,r},u.expand=function(e,t,r){n.typeOf.object("rectangle",e),n.typeOf.object("point",t),r=u.clone(e,r);var i=t.x-r.x,a=t.y-r.y;return i>r.width?r.width=i:i<0&&(r.width-=i,r.x=t.x),a>r.height?r.height=a:a<0&&(r.height-=a,r.y=t.y),r},u.intersect=function(e,t){n.typeOf.object("left",e),n.typeOf.object("right",t);var r=e.x,i=e.y,a=t.x,s=t.y;return r>a+t.width||r+e.width<a||i+e.height<s||i>s+t.height?o.OUTSIDE:o.INTERSECTING},u.equals=function(e,t){return e===t||i(e)&&i(t)&&e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height},u.prototype.clone=function(e){return u.clone(this,e)},u.prototype.intersect=function(e){return u.intersect(this,e)},u.prototype.equals=function(e){return u.equals(this,e)},u}),define("Core/Color",["./Check","./defaultValue","./defined","./FeatureDetection","./freezeObject","./Math"],function(e,t,n,r,i,a){"use strict";function o(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),6*n<1?e+6*(t-e)*n:2*n<1?t:3*n<2?e+(t-e)*(2/3-n)*6:e}function s(e,n,r,i){this.red=t(e,1),this.green=t(n,1),this.blue=t(r,1),this.alpha=t(i,1)}s.fromCartesian4=function(t,r){return e.typeOf.object("cartesian",t),n(r)?(r.red=t.x,r.green=t.y,r.blue=t.z,r.alpha=t.w,r):new s(t.x,t.y,t.z,t.w)},s.fromBytes=function(e,r,i,a,o){return e=s.byteToFloat(t(e,255)),r=s.byteToFloat(t(r,255)),i=s.byteToFloat(t(i,255)),a=s.byteToFloat(t(a,255)),n(o)?(o.red=e,o.green=r,o.blue=i,o.alpha=a,o):new s(e,r,i,a)},s.fromAlpha=function(t,r,i){return e.typeOf.object("color",t),e.typeOf.number("alpha",r),n(i)?(i.red=t.red,i.green=t.green,i.blue=t.blue,i.alpha=r,i):new s(t.red,t.green,t.blue,r)};var u,c,l;r.supportsTypedArrays()&&(u=new ArrayBuffer(4),c=new Uint32Array(u),l=new Uint8Array(u)),s.fromRgba=function(e,t){return c[0]=e,s.fromBytes(l[0],l[1],l[2],l[3],t)},s.fromHsl=function(e,r,i,a,u){e=t(e,0)%1,r=t(r,0),i=t(i,0),a=t(a,1);var c=i,l=i,f=i;if(0!==r){var d;d=i<.5?i*(1+r):i+r-i*r;var h=2*i-d;c=o(h,d,e+1/3),l=o(h,d,e),f=o(h,d,e-1/3)}return n(u)?(u.red=c,u.green=l,u.blue=f,u.alpha=a,u):new s(c,l,f,a)},s.fromRandom=function(r,i){r=t(r,t.EMPTY_OBJECT);var o=r.red;if(!n(o)){var u=t(r.minimumRed,0),c=t(r.maximumRed,1);e.typeOf.number.lessThanOrEquals("minimumRed",u,c),o=u+a.nextRandomNumber()*(c-u)}var l=r.green;if(!n(l)){var f=t(r.minimumGreen,0),d=t(r.maximumGreen,1);e.typeOf.number.lessThanOrEquals("minimumGreen",f,d),l=f+a.nextRandomNumber()*(d-f)}var h=r.blue;if(!n(h)){var p=t(r.minimumBlue,0),m=t(r.maximumBlue,1);e.typeOf.number.lessThanOrEquals("minimumBlue",p,m),h=p+a.nextRandomNumber()*(m-p)}var _=r.alpha;if(!n(_)){var y=t(r.minimumAlpha,0),v=t(r.maximumAlpha,1);e.typeOf.number.lessThanOrEquals("minumumAlpha",y,v),_=y+a.nextRandomNumber()*(v-y)}return n(i)?(i.red=o,i.green=l,i.blue=h,i.alpha=_,i):new s(o,l,h,_)};var f=/^#([0-9a-f])([0-9a-f])([0-9a-f])$/i,d=/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i,h=/^rgba?\(\s*([0-9.]+%?)\s*,\s*([0-9.]+%?)\s*,\s*([0-9.]+%?)(?:\s*,\s*([0-9.]+))?\s*\)$/i,p=/^hsla?\(\s*([0-9.]+)\s*,\s*([0-9.]+%)\s*,\s*([0-9.]+%)(?:\s*,\s*([0-9.]+))?\s*\)$/i;return s.fromCssColorString=function(r,i){e.typeOf.string("color",r),n(i)||(i=new s);var a=s[r.toUpperCase()];if(n(a))return s.clone(a,i),i;var o=f.exec(r);return null!==o?(i.red=parseInt(o[1],16)/15,i.green=parseInt(o[2],16)/15,i.blue=parseInt(o[3],16)/15,i.alpha=1,i):null!==(o=d.exec(r))?(i.red=parseInt(o[1],16)/255,i.green=parseInt(o[2],16)/255,i.blue=parseInt(o[3],16)/255,i.alpha=1,i):null!==(o=h.exec(r))?(i.red=parseFloat(o[1])/("%"===o[1].substr(-1)?100:255),i.green=parseFloat(o[2])/("%"===o[2].substr(-1)?100:255),i.blue=parseFloat(o[3])/("%"===o[3].substr(-1)?100:255),i.alpha=parseFloat(t(o[4],"1.0")),i):null!==(o=p.exec(r))?s.fromHsl(parseFloat(o[1])/360,parseFloat(o[2])/100,parseFloat(o[3])/100,parseFloat(t(o[4],"1.0")),i):i=void 0},s.packedLength=4,s.pack=function(n,r,i){return e.typeOf.object("value",n),e.defined("array",r),i=t(i,0),r[i++]=n.red,r[i++]=n.green,r[i++]=n.blue,r[i]=n.alpha,r},s.unpack=function(r,i,a){return e.defined("array",r),i=t(i,0),n(a)||(a=new s),a.red=r[i++],a.green=r[i++],a.blue=r[i++],a.alpha=r[i],a},s.byteToFloat=function(e){return e/255},s.floatToByte=function(e){return 1===e?255:256*e|0},s.clone=function(e,t){if(n(e))return n(t)?(t.red=e.red,t.green=e.green,t.blue=e.blue,t.alpha=e.alpha,t):new s(e.red,e.green,e.blue,e.alpha)},s.equals=function(e,t){return e===t||n(e)&&n(t)&&e.red===t.red&&e.green===t.green&&e.blue===t.blue&&e.alpha===t.alpha},s.equalsArray=function(e,t,n){return e.red===t[n]&&e.green===t[n+1]&&e.blue===t[n+2]&&e.alpha===t[n+3]},s.prototype.clone=function(e){return s.clone(this,e)},s.prototype.equals=function(e){return s.equals(this,e)},s.prototype.equalsEpsilon=function(e,t){return this===e||n(e)&&Math.abs(this.red-e.red)<=t&&Math.abs(this.green-e.green)<=t&&Math.abs(this.blue-e.blue)<=t&&Math.abs(this.alpha-e.alpha)<=t},s.prototype.toString=function(){return"("+this.red+", "+this.green+", "+this.blue+", "+this.alpha+")"},s.prototype.toCssColorString=function(){var e=s.floatToByte(this.red),t=s.floatToByte(this.green),n=s.floatToByte(this.blue);return 1===this.alpha?"rgb("+e+","+t+","+n+")":"rgba("+e+","+t+","+n+","+this.alpha+")"},s.prototype.toBytes=function(e){var t=s.floatToByte(this.red),r=s.floatToByte(this.green),i=s.floatToByte(this.blue),a=s.floatToByte(this.alpha);return n(e)?(e[0]=t,e[1]=r,e[2]=i,e[3]=a,e):[t,r,i,a]},s.prototype.toRgba=function(){return l[0]=s.floatToByte(this.red),l[1]=s.floatToByte(this.green),l[2]=s.floatToByte(this.blue),l[3]=s.floatToByte(this.alpha),c[0]},s.prototype.brighten=function(t,n){return e.typeOf.number("magnitude",t),e.typeOf.number.greaterThanOrEquals("magnitude",t,0),e.typeOf.object("result",n),t=1-t,n.red=1-(1-this.red)*t,n.green=1-(1-this.green)*t,n.blue=1-(1-this.blue)*t,n.alpha=this.alpha,n},s.prototype.darken=function(t,n){return e.typeOf.number("magnitude",t),e.typeOf.number.greaterThanOrEquals("magnitude",t,0),e.typeOf.object("result",n),t=1-t,n.red=this.red*t,n.green=this.green*t,n.blue=this.blue*t,n.alpha=this.alpha,n},s.prototype.withAlpha=function(e,t){return s.fromAlpha(this,e,t)},s.add=function(t,n,r){return e.typeOf.object("left",t),e.typeOf.object("right",n),e.typeOf.object("result",r),r.red=t.red+n.red,r.green=t.green+n.green,r.blue=t.blue+n.blue,r.alpha=t.alpha+n.alpha,r},s.subtract=function(t,n,r){return e.typeOf.object("left",t),e.typeOf.object("right",n),e.typeOf.object("result",r),r.red=t.red-n.red,r.green=t.green-n.green,r.blue=t.blue-n.blue,r.alpha=t.alpha-n.alpha,r},s.multiply=function(t,n,r){return e.typeOf.object("left",t),e.typeOf.object("right",n),e.typeOf.object("result",r),r.red=t.red*n.red,r.green=t.green*n.green,r.blue=t.blue*n.blue,r.alpha=t.alpha*n.alpha,r},s.divide=function(t,n,r){return e.typeOf.object("left",t),e.typeOf.object("right",n),e.typeOf.object("result",r),r.red=t.red/n.red,r.green=t.green/n.green,r.blue=t.blue/n.blue,r.alpha=t.alpha/n.alpha,r},s.mod=function(t,n,r){return e.typeOf.object("left",t),e.typeOf.object("right",n),e.typeOf.object("result",r),r.red=t.red%n.red,r.green=t.green%n.green,r.blue=t.blue%n.blue,r.alpha=t.alpha%n.alpha,r},s.multiplyByScalar=function(t,n,r){return e.typeOf.object("color",t),e.typeOf.number("scalar",n),e.typeOf.object("result",r),r.red=t.red*n,r.green=t.green*n,r.blue=t.blue*n,r.alpha=t.alpha*n,r},s.divideByScalar=function(t,n,r){return e.typeOf.object("color",t),e.typeOf.number("scalar",n),e.typeOf.object("result",r),r.red=t.red/n,r.green=t.green/n,r.blue=t.blue/n,r.alpha=t.alpha/n,r},s.ALICEBLUE=i(s.fromCssColorString("#F0F8FF")),s.ANTIQUEWHITE=i(s.fromCssColorString("#FAEBD7")),s.AQUA=i(s.fromCssColorString("#00FFFF")),s.AQUAMARINE=i(s.fromCssColorString("#7FFFD4")),s.AZURE=i(s.fromCssColorString("#F0FFFF")),s.BEIGE=i(s.fromCssColorString("#F5F5DC")),s.BISQUE=i(s.fromCssColorString("#FFE4C4")),s.BLACK=i(s.fromCssColorString("#000000")),s.BLANCHEDALMOND=i(s.fromCssColorString("#FFEBCD")),s.BLUE=i(s.fromCssColorString("#0000FF")),s.BLUEVIOLET=i(s.fromCssColorString("#8A2BE2")),s.BROWN=i(s.fromCssColorString("#A52A2A")),s.BURLYWOOD=i(s.fromCssColorString("#DEB887")),s.CADETBLUE=i(s.fromCssColorString("#5F9EA0")),s.CHARTREUSE=i(s.fromCssColorString("#7FFF00")),s.CHOCOLATE=i(s.fromCssColorString("#D2691E")),s.CORAL=i(s.fromCssColorString("#FF7F50")),s.CORNFLOWERBLUE=i(s.fromCssColorString("#6495ED")),s.CORNSILK=i(s.fromCssColorString("#FFF8DC")),s.CRIMSON=i(s.fromCssColorString("#DC143C")),s.CYAN=i(s.fromCssColorString("#00FFFF")),s.DARKBLUE=i(s.fromCssColorString("#00008B")),s.DARKCYAN=i(s.fromCssColorString("#008B8B")),s.DARKGOLDENROD=i(s.fromCssColorString("#B8860B")),s.DARKGRAY=i(s.fromCssColorString("#A9A9A9")),s.DARKGREEN=i(s.fromCssColorString("#006400")),s.DARKGREY=s.DARKGRAY,s.DARKKHAKI=i(s.fromCssColorString("#BDB76B")),s.DARKMAGENTA=i(s.fromCssColorString("#8B008B")),s.DARKOLIVEGREEN=i(s.fromCssColorString("#556B2F")),
s.DARKORANGE=i(s.fromCssColorString("#FF8C00")),s.DARKORCHID=i(s.fromCssColorString("#9932CC")),s.DARKRED=i(s.fromCssColorString("#8B0000")),s.DARKSALMON=i(s.fromCssColorString("#E9967A")),s.DARKSEAGREEN=i(s.fromCssColorString("#8FBC8F")),s.DARKSLATEBLUE=i(s.fromCssColorString("#483D8B")),s.DARKSLATEGRAY=i(s.fromCssColorString("#2F4F4F")),s.DARKSLATEGREY=s.DARKSLATEGRAY,s.DARKTURQUOISE=i(s.fromCssColorString("#00CED1")),s.DARKVIOLET=i(s.fromCssColorString("#9400D3")),s.DEEPPINK=i(s.fromCssColorString("#FF1493")),s.DEEPSKYBLUE=i(s.fromCssColorString("#00BFFF")),s.DIMGRAY=i(s.fromCssColorString("#696969")),s.DIMGREY=s.DIMGRAY,s.DODGERBLUE=i(s.fromCssColorString("#1E90FF")),s.FIREBRICK=i(s.fromCssColorString("#B22222")),s.FLORALWHITE=i(s.fromCssColorString("#FFFAF0")),s.FORESTGREEN=i(s.fromCssColorString("#228B22")),s.FUCHSIA=i(s.fromCssColorString("#FF00FF")),s.GAINSBORO=i(s.fromCssColorString("#DCDCDC")),s.GHOSTWHITE=i(s.fromCssColorString("#F8F8FF")),s.GOLD=i(s.fromCssColorString("#FFD700")),s.GOLDENROD=i(s.fromCssColorString("#DAA520")),s.GRAY=i(s.fromCssColorString("#808080")),s.GREEN=i(s.fromCssColorString("#008000")),s.GREENYELLOW=i(s.fromCssColorString("#ADFF2F")),s.GREY=s.GRAY,s.HONEYDEW=i(s.fromCssColorString("#F0FFF0")),s.HOTPINK=i(s.fromCssColorString("#FF69B4")),s.INDIANRED=i(s.fromCssColorString("#CD5C5C")),s.INDIGO=i(s.fromCssColorString("#4B0082")),s.IVORY=i(s.fromCssColorString("#FFFFF0")),s.KHAKI=i(s.fromCssColorString("#F0E68C")),s.LAVENDER=i(s.fromCssColorString("#E6E6FA")),s.LAVENDAR_BLUSH=i(s.fromCssColorString("#FFF0F5")),s.LAWNGREEN=i(s.fromCssColorString("#7CFC00")),s.LEMONCHIFFON=i(s.fromCssColorString("#FFFACD")),s.LIGHTBLUE=i(s.fromCssColorString("#ADD8E6")),s.LIGHTCORAL=i(s.fromCssColorString("#F08080")),s.LIGHTCYAN=i(s.fromCssColorString("#E0FFFF")),s.LIGHTGOLDENRODYELLOW=i(s.fromCssColorString("#FAFAD2")),s.LIGHTGRAY=i(s.fromCssColorString("#D3D3D3")),s.LIGHTGREEN=i(s.fromCssColorString("#90EE90")),s.LIGHTGREY=s.LIGHTGRAY,s.LIGHTPINK=i(s.fromCssColorString("#FFB6C1")),s.LIGHTSEAGREEN=i(s.fromCssColorString("#20B2AA")),s.LIGHTSKYBLUE=i(s.fromCssColorString("#87CEFA")),s.LIGHTSLATEGRAY=i(s.fromCssColorString("#778899")),s.LIGHTSLATEGREY=s.LIGHTSLATEGRAY,s.LIGHTSTEELBLUE=i(s.fromCssColorString("#B0C4DE")),s.LIGHTYELLOW=i(s.fromCssColorString("#FFFFE0")),s.LIME=i(s.fromCssColorString("#00FF00")),s.LIMEGREEN=i(s.fromCssColorString("#32CD32")),s.LINEN=i(s.fromCssColorString("#FAF0E6")),s.MAGENTA=i(s.fromCssColorString("#FF00FF")),s.MAROON=i(s.fromCssColorString("#800000")),s.MEDIUMAQUAMARINE=i(s.fromCssColorString("#66CDAA")),s.MEDIUMBLUE=i(s.fromCssColorString("#0000CD")),s.MEDIUMORCHID=i(s.fromCssColorString("#BA55D3")),s.MEDIUMPURPLE=i(s.fromCssColorString("#9370DB")),s.MEDIUMSEAGREEN=i(s.fromCssColorString("#3CB371")),s.MEDIUMSLATEBLUE=i(s.fromCssColorString("#7B68EE")),s.MEDIUMSPRINGGREEN=i(s.fromCssColorString("#00FA9A")),s.MEDIUMTURQUOISE=i(s.fromCssColorString("#48D1CC")),s.MEDIUMVIOLETRED=i(s.fromCssColorString("#C71585")),s.MIDNIGHTBLUE=i(s.fromCssColorString("#191970")),s.MINTCREAM=i(s.fromCssColorString("#F5FFFA")),s.MISTYROSE=i(s.fromCssColorString("#FFE4E1")),s.MOCCASIN=i(s.fromCssColorString("#FFE4B5")),s.NAVAJOWHITE=i(s.fromCssColorString("#FFDEAD")),s.NAVY=i(s.fromCssColorString("#000080")),s.OLDLACE=i(s.fromCssColorString("#FDF5E6")),s.OLIVE=i(s.fromCssColorString("#808000")),s.OLIVEDRAB=i(s.fromCssColorString("#6B8E23")),s.ORANGE=i(s.fromCssColorString("#FFA500")),s.ORANGERED=i(s.fromCssColorString("#FF4500")),s.ORCHID=i(s.fromCssColorString("#DA70D6")),s.PALEGOLDENROD=i(s.fromCssColorString("#EEE8AA")),s.PALEGREEN=i(s.fromCssColorString("#98FB98")),s.PALETURQUOISE=i(s.fromCssColorString("#AFEEEE")),s.PALEVIOLETRED=i(s.fromCssColorString("#DB7093")),s.PAPAYAWHIP=i(s.fromCssColorString("#FFEFD5")),s.PEACHPUFF=i(s.fromCssColorString("#FFDAB9")),s.PERU=i(s.fromCssColorString("#CD853F")),s.PINK=i(s.fromCssColorString("#FFC0CB")),s.PLUM=i(s.fromCssColorString("#DDA0DD")),s.POWDERBLUE=i(s.fromCssColorString("#B0E0E6")),s.PURPLE=i(s.fromCssColorString("#800080")),s.RED=i(s.fromCssColorString("#FF0000")),s.ROSYBROWN=i(s.fromCssColorString("#BC8F8F")),s.ROYALBLUE=i(s.fromCssColorString("#4169E1")),s.SADDLEBROWN=i(s.fromCssColorString("#8B4513")),s.SALMON=i(s.fromCssColorString("#FA8072")),s.SANDYBROWN=i(s.fromCssColorString("#F4A460")),s.SEAGREEN=i(s.fromCssColorString("#2E8B57")),s.SEASHELL=i(s.fromCssColorString("#FFF5EE")),s.SIENNA=i(s.fromCssColorString("#A0522D")),s.SILVER=i(s.fromCssColorString("#C0C0C0")),s.SKYBLUE=i(s.fromCssColorString("#87CEEB")),s.SLATEBLUE=i(s.fromCssColorString("#6A5ACD")),s.SLATEGRAY=i(s.fromCssColorString("#708090")),s.SLATEGREY=s.SLATEGRAY,s.SNOW=i(s.fromCssColorString("#FFFAFA")),s.SPRINGGREEN=i(s.fromCssColorString("#00FF7F")),s.STEELBLUE=i(s.fromCssColorString("#4682B4")),s.TAN=i(s.fromCssColorString("#D2B48C")),s.TEAL=i(s.fromCssColorString("#008080")),s.THISTLE=i(s.fromCssColorString("#D8BFD8")),s.TOMATO=i(s.fromCssColorString("#FF6347")),s.TURQUOISE=i(s.fromCssColorString("#40E0D0")),s.VIOLET=i(s.fromCssColorString("#EE82EE")),s.WHEAT=i(s.fromCssColorString("#F5DEB3")),s.WHITE=i(s.fromCssColorString("#FFFFFF")),s.WHITESMOKE=i(s.fromCssColorString("#F5F5F5")),s.YELLOW=i(s.fromCssColorString("#FFFF00")),s.YELLOWGREEN=i(s.fromCssColorString("#9ACD32")),s.TRANSPARENT=i(new s(0,0,0,0)),s}),define("Core/WindingOrder",["./freezeObject","./WebGLConstants"],function(e,t){"use strict";var n={CLOCKWISE:t.CW,COUNTER_CLOCKWISE:t.CCW,validate:function(e){return e===n.CLOCKWISE||e===n.COUNTER_CLOCKWISE}};return e(n)}),define("Renderer/ContextLimits",["../Core/defineProperties"],function(e){"use strict";var t={_maximumCombinedTextureImageUnits:0,_maximumCubeMapSize:0,_maximumFragmentUniformVectors:0,_maximumTextureImageUnits:0,_maximumRenderbufferSize:0,_maximumTextureSize:0,_maximumVaryingVectors:0,_maximumVertexAttributes:0,_maximumVertexTextureImageUnits:0,_maximumVertexUniformVectors:0,_minimumAliasedLineWidth:0,_maximumAliasedLineWidth:0,_minimumAliasedPointSize:0,_maximumAliasedPointSize:0,_maximumViewportWidth:0,_maximumViewportHeight:0,_maximumTextureFilterAnisotropy:0,_maximumDrawBuffers:0,_maximumColorAttachments:0,_highpFloatSupported:!1,_highpIntSupported:!1};return e(t,{maximumCombinedTextureImageUnits:{get:function(){return t._maximumCombinedTextureImageUnits}},maximumCubeMapSize:{get:function(){return t._maximumCubeMapSize}},maximumFragmentUniformVectors:{get:function(){return t._maximumFragmentUniformVectors}},maximumTextureImageUnits:{get:function(){return t._maximumTextureImageUnits}},maximumRenderbufferSize:{get:function(){return t._maximumRenderbufferSize}},maximumTextureSize:{get:function(){return t._maximumTextureSize}},maximumVaryingVectors:{get:function(){return t._maximumVaryingVectors}},maximumVertexAttributes:{get:function(){return t._maximumVertexAttributes}},maximumVertexTextureImageUnits:{get:function(){return t._maximumVertexTextureImageUnits}},maximumVertexUniformVectors:{get:function(){return t._maximumVertexUniformVectors}},minimumAliasedLineWidth:{get:function(){return t._minimumAliasedLineWidth}},maximumAliasedLineWidth:{get:function(){return t._maximumAliasedLineWidth}},minimumAliasedPointSize:{get:function(){return t._minimumAliasedPointSize}},maximumAliasedPointSize:{get:function(){return t._maximumAliasedPointSize}},maximumViewportWidth:{get:function(){return t._maximumViewportWidth}},maximumViewportHeight:{get:function(){return t._maximumViewportHeight}},maximumTextureFilterAnisotropy:{get:function(){return t._maximumTextureFilterAnisotropy}},maximumDrawBuffers:{get:function(){return t._maximumDrawBuffers}},maximumColorAttachments:{get:function(){return t._maximumColorAttachments}},highpFloatSupported:{get:function(){return t._highpFloatSupported}},highpIntSupported:{get:function(){return t._highpIntSupported}}}),t}),define("Renderer/freezeRenderState",["../Core/freezeObject"],function(e){"use strict";function t(n){if("object"!=typeof n||null===n)return n;for(var r,i=Object.keys(n),a=0;a<i.length;a++)r=i[a],n.hasOwnProperty(r)&&"_applyFunctions"!==r&&(n[r]=t(n[r]));return e(n)}return t}),define("Renderer/RenderState",["../Core/BoundingRectangle","../Core/Color","../Core/defaultValue","../Core/defined","../Core/DeveloperError","../Core/WebGLConstants","../Core/WindingOrder","./ContextLimits","./freezeRenderState"],function(e,t,n,r,i,a,o,s,u){"use strict";function c(e){return e===a.FUNC_ADD||e===a.FUNC_SUBTRACT||e===a.FUNC_REVERSE_SUBTRACT||e===a.MIN||e===a.MAX}function l(e){return e===a.ZERO||e===a.ONE||e===a.SRC_COLOR||e===a.ONE_MINUS_SRC_COLOR||e===a.DST_COLOR||e===a.ONE_MINUS_DST_COLOR||e===a.SRC_ALPHA||e===a.ONE_MINUS_SRC_ALPHA||e===a.DST_ALPHA||e===a.ONE_MINUS_DST_ALPHA||e===a.CONSTANT_COLOR||e===a.ONE_MINUS_CONSTANT_COLOR||e===a.CONSTANT_ALPHA||e===a.ONE_MINUS_CONSTANT_ALPHA||e===a.SRC_ALPHA_SATURATE}function f(e){return e===a.FRONT||e===a.BACK||e===a.FRONT_AND_BACK}function d(e){return e===a.NEVER||e===a.LESS||e===a.EQUAL||e===a.LEQUAL||e===a.GREATER||e===a.NOTEQUAL||e===a.GEQUAL||e===a.ALWAYS}function h(e){return e===a.NEVER||e===a.LESS||e===a.EQUAL||e===a.LEQUAL||e===a.GREATER||e===a.NOTEQUAL||e===a.GEQUAL||e===a.ALWAYS}function p(e){return e===a.ZERO||e===a.KEEP||e===a.REPLACE||e===a.INCR||e===a.DECR||e===a.INVERT||e===a.INCR_WRAP||e===a.DECR_WRAP}function m(u){var m=n(u,{}),_=n(m.cull,{}),y=n(m.polygonOffset,{}),v=n(m.scissorTest,{}),g=n(v.rectangle,{}),E=n(m.depthRange,{}),T=n(m.depthTest,{}),w=n(m.colorMask,{}),b=n(m.blending,{}),S=n(b.color,{}),C=n(m.stencilTest,{}),O=n(C.frontOperation,{}),A=n(C.backOperation,{}),x=n(m.sampleCoverage,{}),R=m.viewport;if(this.frontFace=n(m.frontFace,o.COUNTER_CLOCKWISE),this.cull={enabled:n(_.enabled,!1),face:n(_.face,a.BACK)},this.lineWidth=n(m.lineWidth,1),this.polygonOffset={enabled:n(y.enabled,!1),factor:n(y.factor,0),units:n(y.units,0)},this.scissorTest={enabled:n(v.enabled,!1),rectangle:e.clone(g)},this.depthRange={near:n(E.near,0),far:n(E.far,1)},this.depthTest={enabled:n(T.enabled,!1),func:n(T.func,a.LESS)},this.colorMask={red:n(w.red,!0),green:n(w.green,!0),blue:n(w.blue,!0),alpha:n(w.alpha,!0)},this.depthMask=n(m.depthMask,!0),this.stencilMask=n(m.stencilMask,-1),this.blending={enabled:n(b.enabled,!1),color:new t(n(S.red,0),n(S.green,0),n(S.blue,0),n(S.alpha,0)),equationRgb:n(b.equationRgb,a.FUNC_ADD),equationAlpha:n(b.equationAlpha,a.FUNC_ADD),functionSourceRgb:n(b.functionSourceRgb,a.ONE),functionSourceAlpha:n(b.functionSourceAlpha,a.ONE),functionDestinationRgb:n(b.functionDestinationRgb,a.ZERO),functionDestinationAlpha:n(b.functionDestinationAlpha,a.ZERO)},this.stencilTest={enabled:n(C.enabled,!1),frontFunction:n(C.frontFunction,a.ALWAYS),backFunction:n(C.backFunction,a.ALWAYS),reference:n(C.reference,0),mask:n(C.mask,-1),frontOperation:{fail:n(O.fail,a.KEEP),zFail:n(O.zFail,a.KEEP),zPass:n(O.zPass,a.KEEP)},backOperation:{fail:n(A.fail,a.KEEP),zFail:n(A.zFail,a.KEEP),zPass:n(A.zPass,a.KEEP)}},this.sampleCoverage={enabled:n(x.enabled,!1),value:n(x.value,1),invert:n(x.invert,!1)},this.viewport=r(R)?new e(R.x,R.y,R.width,R.height):void 0,this.lineWidth<s.minimumAliasedLineWidth||this.lineWidth>s.maximumAliasedLineWidth)throw new i("renderState.lineWidth is out of range.  Check minimumAliasedLineWidth and maximumAliasedLineWidth.");if(!o.validate(this.frontFace))throw new i("Invalid renderState.frontFace.");if(!f(this.cull.face))throw new i("Invalid renderState.cull.face.");if(this.scissorTest.rectangle.width<0||this.scissorTest.rectangle.height<0)throw new i("renderState.scissorTest.rectangle.width and renderState.scissorTest.rectangle.height must be greater than or equal to zero.");if(this.depthRange.near>this.depthRange.far)throw new i("renderState.depthRange.near can not be greater than renderState.depthRange.far.");if(this.depthRange.near<0)throw new i("renderState.depthRange.near must be greater than or equal to zero.");if(this.depthRange.far>1)throw new i("renderState.depthRange.far must be less than or equal to one.");if(!d(this.depthTest.func))throw new i("Invalid renderState.depthTest.func.");if(this.blending.color.red<0||this.blending.color.red>1||this.blending.color.green<0||this.blending.color.green>1||this.blending.color.blue<0||this.blending.color.blue>1||this.blending.color.alpha<0||this.blending.color.alpha>1)throw new i("renderState.blending.color components must be greater than or equal to zero and less than or equal to one.");if(!c(this.blending.equationRgb))throw new i("Invalid renderState.blending.equationRgb.");if(!c(this.blending.equationAlpha))throw new i("Invalid renderState.blending.equationAlpha.");if(!l(this.blending.functionSourceRgb))throw new i("Invalid renderState.blending.functionSourceRgb.");if(!l(this.blending.functionSourceAlpha))throw new i("Invalid renderState.blending.functionSourceAlpha.");if(!l(this.blending.functionDestinationRgb))throw new i("Invalid renderState.blending.functionDestinationRgb.");if(!l(this.blending.functionDestinationAlpha))throw new i("Invalid renderState.blending.functionDestinationAlpha.");if(!h(this.stencilTest.frontFunction))throw new i("Invalid renderState.stencilTest.frontFunction.");if(!h(this.stencilTest.backFunction))throw new i("Invalid renderState.stencilTest.backFunction.");if(!p(this.stencilTest.frontOperation.fail))throw new i("Invalid renderState.stencilTest.frontOperation.fail.");if(!p(this.stencilTest.frontOperation.zFail))throw new i("Invalid renderState.stencilTest.frontOperation.zFail.");if(!p(this.stencilTest.frontOperation.zPass))throw new i("Invalid renderState.stencilTest.frontOperation.zPass.");if(!p(this.stencilTest.backOperation.fail))throw new i("Invalid renderState.stencilTest.backOperation.fail.");if(!p(this.stencilTest.backOperation.zFail))throw new i("Invalid renderState.stencilTest.backOperation.zFail.");if(!p(this.stencilTest.backOperation.zPass))throw new i("Invalid renderState.stencilTest.backOperation.zPass.");if(r(this.viewport)){if(this.viewport.width<0)throw new i("renderState.viewport.width must be greater than or equal to zero.");if(this.viewport.height<0)throw new i("renderState.viewport.height must be greater than or equal to zero.");if(this.viewport.width>s.maximumViewportWidth)throw new i("renderState.viewport.width must be less than or equal to the maximum viewport width ("+s.maximumViewportWidth.toString()+").  Check maximumViewportWidth.");if(this.viewport.height>s.maximumViewportHeight)throw new i("renderState.viewport.height must be less than or equal to the maximum viewport height ("+s.maximumViewportHeight.toString()+").  Check maximumViewportHeight.")}this.id=0,this._applyFunctions=[]}function _(e,t,n){n?e.enable(t):e.disable(t)}function y(e,t){e.frontFace(t.frontFace)}function v(e,t){var n=t.cull,r=n.enabled;_(e,e.CULL_FACE,r),r&&e.cullFace(n.face)}function g(e,t){e.lineWidth(t.lineWidth)}function E(e,t){var n=t.polygonOffset,r=n.enabled;_(e,e.POLYGON_OFFSET_FILL,r),r&&e.polygonOffset(n.factor,n.units)}function T(e,t,n){var i=t.scissorTest,a=r(n.scissorTest)?n.scissorTest.enabled:i.enabled;if(_(e,e.SCISSOR_TEST,a),a){var o=r(n.scissorTest)?n.scissorTest.rectangle:i.rectangle;e.scissor(o.x,o.y,o.width,o.height)}}function w(e,t){var n=t.depthRange;e.depthRange(n.near,n.far)}function b(e,t){var n=t.depthTest,r=n.enabled;_(e,e.DEPTH_TEST,r),r&&e.depthFunc(n.func)}function S(e,t){var n=t.colorMask;e.colorMask(n.red,n.green,n.blue,n.alpha)}function C(e,t){e.depthMask(t.depthMask)}function O(e,t){e.stencilMask(t.stencilMask)}function A(e,t){e.blendColor(t.red,t.green,t.blue,t.alpha)}function x(e,t,n){var i=t.blending,a=r(n.blendingEnabled)?n.blendingEnabled:i.enabled;_(e,e.BLEND,a),a&&(A(e,i.color),e.blendEquationSeparate(i.equationRgb,i.equationAlpha),e.blendFuncSeparate(i.functionSourceRgb,i.functionDestinationRgb,i.functionSourceAlpha,i.functionDestinationAlpha))}function R(e,t){var n=t.stencilTest,r=n.enabled;if(_(e,e.STENCIL_TEST,r),r){var i=n.frontFunction,a=n.backFunction,o=n.reference,s=n.mask;e.stencilFunc(i,o,s),e.stencilFuncSeparate(e.BACK,a,o,s),e.stencilFuncSeparate(e.FRONT,i,o,s);var u=n.frontOperation,c=u.fail,l=u.zFail,f=u.zPass;e.stencilOpSeparate(e.FRONT,c,l,f);var d=n.backOperation,h=d.fail,p=d.zFail,m=d.zPass;e.stencilOpSeparate(e.BACK,h,p,m)}}function I(e,t){var n=t.sampleCoverage,r=n.enabled;_(e,e.SAMPLE_COVERAGE,r),r&&e.sampleCoverage(n.value,n.invert)}function D(e,t,i){var a=n(t.viewport,i.viewport);r(a)||(a=z,a.width=i.context.drawingBufferWidth,a.height=i.context.drawingBufferHeight),i.context.uniformState.viewport=a,e.viewport(a.x,a.y,a.width,a.height)}function P(e,t){var n=[];return e.frontFace!==t.frontFace&&n.push(y),e.cull.enabled===t.cull.enabled&&e.cull.face===t.cull.face||n.push(v),e.lineWidth!==t.lineWidth&&n.push(g),e.polygonOffset.enabled===t.polygonOffset.enabled&&e.polygonOffset.factor===t.polygonOffset.factor&&e.polygonOffset.units===t.polygonOffset.units||n.push(E),e.depthRange.near===t.depthRange.near&&e.depthRange.far===t.depthRange.far||n.push(w),e.depthTest.enabled===t.depthTest.enabled&&e.depthTest.func===t.depthTest.func||n.push(b),e.colorMask.red===t.colorMask.red&&e.colorMask.green===t.colorMask.green&&e.colorMask.blue===t.colorMask.blue&&e.colorMask.alpha===t.colorMask.alpha||n.push(S),e.depthMask!==t.depthMask&&n.push(C),e.stencilMask!==t.stencilMask&&n.push(O),e.stencilTest.enabled===t.stencilTest.enabled&&e.stencilTest.frontFunction===t.stencilTest.frontFunction&&e.stencilTest.backFunction===t.stencilTest.backFunction&&e.stencilTest.reference===t.stencilTest.reference&&e.stencilTest.mask===t.stencilTest.mask&&e.stencilTest.frontOperation.fail===t.stencilTest.frontOperation.fail&&e.stencilTest.frontOperation.zFail===t.stencilTest.frontOperation.zFail&&e.stencilTest.backOperation.fail===t.stencilTest.backOperation.fail&&e.stencilTest.backOperation.zFail===t.stencilTest.backOperation.zFail&&e.stencilTest.backOperation.zPass===t.stencilTest.backOperation.zPass||n.push(R),e.sampleCoverage.enabled===t.sampleCoverage.enabled&&e.sampleCoverage.value===t.sampleCoverage.value&&e.sampleCoverage.invert===t.sampleCoverage.invert||n.push(I),n}var N=0,M={};m.fromCache=function(e){var t=JSON.stringify(e),n=M[t];if(r(n))return++n.referenceCount,n.state;var i=new m(e),a=JSON.stringify(i);return n=M[a],r(n)||(i.id=N++,i=u(i),n={referenceCount:0,state:i},M[a]=n),++n.referenceCount,M[t]={referenceCount:1,state:n.state},n.state},m.removeFromCache=function(e){var t=new m(e),n=JSON.stringify(t),i=M[n],a=JSON.stringify(e),o=M[a];r(o)&&0===--o.referenceCount&&(delete M[a],r(i)&&--i.referenceCount),r(i)&&0===i.referenceCount&&delete M[n]},m.getCache=function(){return M},m.clearCache=function(){M={}};var z=new e;return m.apply=function(e,t,n){y(e,t),v(e,t),g(e,t),E(e,t),w(e,t),b(e,t),S(e,t),C(e,t),O(e,t),R(e,t),I(e,t),T(e,t,n),x(e,t,n),D(e,t,n)},m.partialApply=function(e,t,n,i,a,o){if(t!==n){var s=n._applyFunctions[t.id];r(s)||(s=P(t,n),n._applyFunctions[t.id]=s);for(var u=s.length,c=0;c<u;++c)s[c](e,n)}((r(i.scissorTest)?i.scissorTest:t.scissorTest)!==(r(a.scissorTest)?a.scissorTest:n.scissorTest)||o)&&T(e,n,a);var l=r(i.blendingEnabled)?i.blendingEnabled:t.blending.enabled,f=r(a.blendingEnabled)?a.blendingEnabled:n.blending.enabled;(l!==f||f&&t.blending!==n.blending)&&x(e,n,a),t===n&&i===a&&i.context===a.context||D(e,n,a)},m.getState=function(n){if(!r(n))throw new i("renderState is required.");return{frontFace:n.frontFace,cull:{enabled:n.cull.enabled,face:n.cull.face},lineWidth:n.lineWidth,polygonOffset:{enabled:n.polygonOffset.enabled,factor:n.polygonOffset.factor,units:n.polygonOffset.units},scissorTest:{enabled:n.scissorTest.enabled,rectangle:e.clone(n.scissorTest.rectangle)},depthRange:{near:n.depthRange.near,far:n.depthRange.far},depthTest:{enabled:n.depthTest.enabled,func:n.depthTest.func},colorMask:{red:n.colorMask.red,green:n.colorMask.green,blue:n.colorMask.blue,alpha:n.colorMask.alpha},depthMask:n.depthMask,stencilMask:n.stencilMask,blending:{enabled:n.blending.enabled,color:t.clone(n.blending.color),equationRgb:n.blending.equationRgb,equationAlpha:n.blending.equationAlpha,functionSourceRgb:n.blending.functionSourceRgb,functionSourceAlpha:n.blending.functionSourceAlpha,functionDestinationRgb:n.blending.functionDestinationRgb,functionDestinationAlpha:n.blending.functionDestinationAlpha},stencilTest:{enabled:n.stencilTest.enabled,frontFunction:n.stencilTest.frontFunction,backFunction:n.stencilTest.backFunction,reference:n.stencilTest.reference,mask:n.stencilTest.mask,frontOperation:{fail:n.stencilTest.frontOperation.fail,zFail:n.stencilTest.frontOperation.zFail,zPass:n.stencilTest.frontOperation.zPass},backOperation:{fail:n.stencilTest.backOperation.fail,zFail:n.stencilTest.backOperation.zFail,zPass:n.stencilTest.backOperation.zPass}},sampleCoverage:{enabled:n.sampleCoverage.enabled,value:n.sampleCoverage.value,invert:n.sampleCoverage.invert},viewport:r(n.viewport)?e.clone(n.viewport):void 0}},m}),define("Renderer/AutomaticUniforms",["../Core/Cartesian3","../Core/Math","../Core/Matrix4","../Core/WebGLConstants"],function(e,t,n,r){"use strict";function i(e){this._size=e.size,this._datatype=e.datatype,this.getValue=e.getValue}var a=new e;if("undefined"==typeof WebGLRenderingContext)return{};var o={};return o[r.FLOAT]="float",o[r.FLOAT_VEC2]="vec2",o[r.FLOAT_VEC3]="vec3",o[r.FLOAT_VEC4]="vec4",o[r.INT]="int",o[r.INT_VEC2]="ivec2",o[r.INT_VEC3]="ivec3",o[r.INT_VEC4]="ivec4",o[r.BOOL]="bool",o[r.BOOL_VEC2]="bvec2",o[r.BOOL_VEC3]="bvec3",o[r.BOOL_VEC4]="bvec4",o[r.FLOAT_MAT2]="mat2",o[r.FLOAT_MAT3]="mat3",o[r.FLOAT_MAT4]="mat4",o[r.SAMPLER_2D]="sampler2D",o[r.SAMPLER_CUBE]="samplerCube",i.prototype.getDeclaration=function(e){var t="uniform "+o[this._datatype]+" "+e,n=this._size;return t+=1===n?";":"["+n.toString()+"];"},{czm_viewport:new i({size:1,datatype:r.FLOAT_VEC4,getValue:function(e){return e.viewportCartesian4}}),czm_viewportOrthographic:new i({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.viewportOrthographic}}),czm_viewportTransformation:new i({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.viewportTransformation}}),czm_globeDepthTexture:new i({size:1,datatype:r.SAMPLER_2D,getValue:function(e){return e.globeDepthTexture}}),czm_model:new i({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.model}}),czm_inverseModel:new i({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.inverseModel}}),czm_view:new i({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.view}}),czm_view3D:new i({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.view3D}}),czm_viewRotation:new i({size:1,datatype:r.FLOAT_MAT3,getValue:function(e){return e.viewRotation}}),czm_viewRotation3D:new i({size:1,datatype:r.FLOAT_MAT3,getValue:function(e){return e.viewRotation3D}}),czm_inverseView:new i({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.inverseView}}),czm_inverseView3D:new i({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.inverseView3D}}),czm_inverseViewRotation:new i({size:1,datatype:r.FLOAT_MAT3,getValue:function(e){return e.inverseViewRotation}}),czm_inverseViewRotation3D:new i({size:1,datatype:r.FLOAT_MAT3,getValue:function(e){return e.inverseViewRotation3D}}),czm_projection:new i({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.projection}}),czm_inverseProjection:new i({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.inverseProjection}}),czm_infiniteProjection:new i({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.infiniteProjection}}),czm_modelView:new i({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.modelView}}),czm_modelView3D:new i({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.modelView3D}}),czm_modelViewRelativeToEye:new i({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.modelViewRelativeToEye}}),czm_inverseModelView:new i({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.inverseModelView}}),czm_inverseModelView3D:new i({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.inverseModelView3D}}),czm_viewProjection:new i({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.viewProjection}}),czm_inverseViewProjection:new i({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.inverseViewProjection}}),czm_modelViewProjection:new i({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.modelViewProjection}}),czm_inverseModelViewProjection:new i({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.inverseModelViewProjection}}),czm_modelViewProjectionRelativeToEye:new i({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.modelViewProjectionRelativeToEye}}),czm_modelViewInfiniteProjection:new i({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.modelViewInfiniteProjection}}),czm_orthographicIn3D:new i({size:1,datatype:r.FLOAT,getValue:function(e){return e.orthographicIn3D?1:0}}),czm_normal:new i({size:1,datatype:r.FLOAT_MAT3,getValue:function(e){return e.normal}}),czm_normal3D:new i({size:1,datatype:r.FLOAT_MAT3,getValue:function(e){return e.normal3D}}),czm_inverseNormal:new i({size:1,datatype:r.FLOAT_MAT3,getValue:function(e){return e.inverseNormal}}),czm_inverseNormal3D:new i({size:1,datatype:r.FLOAT_MAT3,getValue:function(e){return e.inverseNormal3D}}),czm_eyeHeight2D:new i({size:1,datatype:r.FLOAT_VEC2,getValue:function(e){return e.eyeHeight2D}}),czm_entireFrustum:new i({size:1,datatype:r.FLOAT_VEC2,getValue:function(e){return e.entireFrustum}}),czm_currentFrustum:new i({size:1,datatype:r.FLOAT_VEC2,getValue:function(e){return e.currentFrustum}}),czm_frustumPlanes:new i({size:1,datatype:r.FLOAT_VEC4,getValue:function(e){return e.frustumPlanes}}),czm_log2FarDistance:new i({size:1,datatype:r.FLOAT,getValue:function(e){return e.log2FarDistance}}),czm_log2FarPlusOne:new i({size:1,datatype:r.FLOAT,getValue:function(e){return e.log2FarPlusOne}}),czm_log2NearDistance:new i({size:1,datatype:r.FLOAT,getValue:function(e){return e.log2NearDistance}}),czm_sunPositionWC:new i({size:1,datatype:r.FLOAT_VEC3,getValue:function(e){return e.sunPositionWC}}),czm_sunPositionColumbusView:new i({size:1,datatype:r.FLOAT_VEC3,getValue:function(e){return e.sunPositionColumbusView}}),czm_sunDirectionEC:new i({size:1,datatype:r.FLOAT_VEC3,getValue:function(e){return e.sunDirectionEC}}),czm_sunDirectionWC:new i({size:1,datatype:r.FLOAT_VEC3,getValue:function(e){return e.sunDirectionWC}}),czm_moonDirectionEC:new i({size:1,datatype:r.FLOAT_VEC3,getValue:function(e){return e.moonDirectionEC}}),czm_encodedCameraPositionMCHigh:new i({size:1,datatype:r.FLOAT_VEC3,getValue:function(e){return e.encodedCameraPositionMCHigh}}),czm_encodedCameraPositionMCLow:new i({size:1,datatype:r.FLOAT_VEC3,getValue:function(e){return e.encodedCameraPositionMCLow}}),czm_viewerPositionWC:new i({size:1,datatype:r.FLOAT_VEC3,getValue:function(e){return n.getTranslation(e.inverseView,a)}}),czm_frameNumber:new i({size:1,datatype:r.FLOAT,getValue:function(e){return e.frameState.frameNumber}}),czm_morphTime:new i({size:1,datatype:r.FLOAT,getValue:function(e){return e.frameState.morphTime}}),czm_sceneMode:new i({size:1,datatype:r.FLOAT,getValue:function(e){return e.frameState.mode}}),czm_pass:new i({size:1,datatype:r.FLOAT,getValue:function(e){return e.pass}}),czm_backgroundColor:new i({size:1,datatype:r.FLOAT_VEC4,getValue:function(e){return e.backgroundColor}}),czm_brdfLut:new i({size:1,datatype:r.SAMPLER_2D,getValue:function(e){return e.brdfLut}}),czm_environmentMap:new i({size:1,datatype:r.SAMPLER_CUBE,getValue:function(e){return e.environmentMap}}),czm_temeToPseudoFixed:new i({size:1,datatype:r.FLOAT_MAT3,getValue:function(e){return e.temeToPseudoFixedMatrix}}),czm_resolutionScale:new i({size:1,datatype:r.FLOAT,getValue:function(e){return e.resolutionScale}}),czm_fogDensity:new i({size:1,datatype:r.FLOAT,getValue:function(e){return e.fogDensity}}),czm_imagerySplitPosition:new i({size:1,datatype:r.FLOAT,getValue:function(e){return e.imagerySplitPosition}}),czm_geometricToleranceOverMeter:new i({size:1,datatype:r.FLOAT,getValue:function(e){return e.geometricToleranceOverMeter}}),czm_minimumDisableDepthTestDistance:new i({size:1,datatype:r.FLOAT,getValue:function(e){return e.minimumDisableDepthTestDistance}}),czm_invertClassificationColor:new i({size:1,datatype:r.FLOAT_VEC4,getValue:function(e){return e.invertClassificationColor}})}}),define("Renderer/createUniform",["../Core/Cartesian2","../Core/Cartesian3","../Core/Cartesian4","../Core/Color","../Core/defined","../Core/DeveloperError","../Core/Matrix2","../Core/Matrix3","../Core/Matrix4","../Core/RuntimeError"],function(e,t,n,r,i,a,o,s,u,c){"use strict";function l(e,t,n,r){switch(t.type){case e.FLOAT:return new f(e,t,n,r);case e.FLOAT_VEC2:return new d(e,t,n,r);case e.FLOAT_VEC3:return new h(e,t,n,r);case e.FLOAT_VEC4:return new p(e,t,n,r);case e.SAMPLER_2D:case e.SAMPLER_CUBE:return new m(e,t,n,r);case e.INT:case e.BOOL:return new _(e,t,n,r);case e.INT_VEC2:case e.BOOL_VEC2:return new y(e,t,n,r);case e.INT_VEC3:case e.BOOL_VEC3:return new v(e,t,n,r);case e.INT_VEC4:case e.BOOL_VEC4:return new g(e,t,n,r);case e.FLOAT_MAT2:return new E(e,t,n,r);case e.FLOAT_MAT3:return new T(e,t,n,r);case e.FLOAT_MAT4:return new w(e,t,n,r);default:throw new c("Unrecognized uniform type: "+t.type+' for uniform "'+n+'".')}}function f(e,t,n,r){this.name=n,this.value=void 0,this._value=0,this._gl=e,this._location=r}function d(t,n,r,i){this.name=r,this.value=void 0,this._value=new e,this._gl=t,this._location=i}function h(e,t,n,r){this.name=n,this.value=void 0,this._value=void 0,this._gl=e,this._location=r}function p(e,t,n,r){this.name=n,this.value=void 0,this._value=void 0,this._gl=e,this._location=r}function m(e,t,n,r){this.name=n,this.value=void 0,this._gl=e,this._location=r,this.textureUnitIndex=void 0}function _(e,t,n,r){this.name=n,this.value=void 0,this._value=0,this._gl=e,this._location=r}function y(t,n,r,i){this.name=r,this.value=void 0,this._value=new e,this._gl=t,this._location=i}function v(e,n,r,i){this.name=r,this.value=void 0,this._value=new t,this._gl=e,this._location=i}function g(e,t,r,i){this.name=r,this.value=void 0,this._value=new n,this._gl=e,this._location=i}function E(e,t,n,r){this.name=n,this.value=void 0,this._value=new Float32Array(4),this._gl=e,this._location=r}function T(e,t,n,r){this.name=n,this.value=void 0,this._value=new Float32Array(9),this._gl=e,this._location=r}function w(e,t,n,r){this.name=n,this.value=void 0,this._value=new Float32Array(16),this._gl=e,this._location=r}return f.prototype.set=function(){this.value!==this._value&&(this._value=this.value,this._gl.uniform1f(this._location,this.value))},d.prototype.set=function(){var t=this.value;e.equals(t,this._value)||(e.clone(t,this._value),this._gl.uniform2f(this._location,t.x,t.y))},h.prototype.set=function(){var e=this.value;if(i(e.red))r.equals(e,this._value)||(this._value=r.clone(e,this._value),this._gl.uniform3f(this._location,e.red,e.green,e.blue));else{if(!i(e.x))throw new a('Invalid vec3 value for uniform "'+this._activethis.name+'".');t.equals(e,this._value)||(this._value=t.clone(e,this._value),this._gl.uniform3f(this._location,e.x,e.y,e.z))}},p.prototype.set=function(){var e=this.value;if(i(e.red))r.equals(e,this._value)||(this._value=r.clone(e,this._value),this._gl.uniform4f(this._location,e.red,e.green,e.blue,e.alpha));else{if(!i(e.x))throw new a('Invalid vec4 value for uniform "'+this._activethis.name+'".');n.equals(e,this._value)||(this._value=n.clone(e,this._value),this._gl.uniform4f(this._location,e.x,e.y,e.z,e.w))}},m.prototype.set=function(){var e=this._gl;e.activeTexture(e.TEXTURE0+this.textureUnitIndex);var t=this.value;e.bindTexture(t._target,t._texture)},m.prototype._setSampler=function(e){return this.textureUnitIndex=e,this._gl.uniform1i(this._location,e),e+1},_.prototype.set=function(){this.value!==this._value&&(this._value=this.value,this._gl.uniform1i(this._location,this.value))},y.prototype.set=function(){var t=this.value;e.equals(t,this._value)||(e.clone(t,this._value),this._gl.uniform2i(this._location,t.x,t.y))},
v.prototype.set=function(){var e=this.value;t.equals(e,this._value)||(t.clone(e,this._value),this._gl.uniform3i(this._location,e.x,e.y,e.z))},g.prototype.set=function(){var e=this.value;n.equals(e,this._value)||(n.clone(e,this._value),this._gl.uniform4i(this._location,e.x,e.y,e.z,e.w))},E.prototype.set=function(){o.equalsArray(this.value,this._value,0)||(o.toArray(this.value,this._value),this._gl.uniformMatrix2fv(this._location,!1,this._value))},T.prototype.set=function(){s.equalsArray(this.value,this._value,0)||(s.toArray(this.value,this._value),this._gl.uniformMatrix3fv(this._location,!1,this._value))},w.prototype.set=function(){u.equalsArray(this.value,this._value,0)||(u.toArray(this.value,this._value),this._gl.uniformMatrix4fv(this._location,!1,this._value))},l}),define("Renderer/createUniformArray",["../Core/Cartesian2","../Core/Cartesian3","../Core/Cartesian4","../Core/Color","../Core/defined","../Core/DeveloperError","../Core/Matrix2","../Core/Matrix3","../Core/Matrix4","../Core/RuntimeError"],function(e,t,n,r,i,a,o,s,u,c){"use strict";function l(e,t,n,r){switch(t.type){case e.FLOAT:return new f(e,t,n,r);case e.FLOAT_VEC2:return new d(e,t,n,r);case e.FLOAT_VEC3:return new h(e,t,n,r);case e.FLOAT_VEC4:return new p(e,t,n,r);case e.SAMPLER_2D:case e.SAMPLER_CUBE:return new m(e,t,n,r);case e.INT:case e.BOOL:return new _(e,t,n,r);case e.INT_VEC2:case e.BOOL_VEC2:return new y(e,t,n,r);case e.INT_VEC3:case e.BOOL_VEC3:return new v(e,t,n,r);case e.INT_VEC4:case e.BOOL_VEC4:return new g(e,t,n,r);case e.FLOAT_MAT2:return new E(e,t,n,r);case e.FLOAT_MAT3:return new T(e,t,n,r);case e.FLOAT_MAT4:return new w(e,t,n,r);default:throw new c("Unrecognized uniform type: "+t.type+' for uniform "'+n+'".')}}function f(e,t,n,r){var i=r.length;this.name=n,this.value=new Array(i),this._value=new Float32Array(i),this._gl=e,this._location=r[0]}function d(e,t,n,r){var i=r.length;this.name=n,this.value=new Array(i),this._value=new Float32Array(2*i),this._gl=e,this._location=r[0]}function h(e,t,n,r){var i=r.length;this.name=n,this.value=new Array(i),this._value=new Float32Array(3*i),this._gl=e,this._location=r[0]}function p(e,t,n,r){var i=r.length;this.name=n,this.value=new Array(i),this._value=new Float32Array(4*i),this._gl=e,this._location=r[0]}function m(e,t,n,r){var i=r.length;this.name=n,this.value=new Array(i),this._value=new Float32Array(i),this._gl=e,this._locations=r,this.textureUnitIndex=void 0}function _(e,t,n,r){var i=r.length;this.name=n,this.value=new Array(i),this._value=new Int32Array(i),this._gl=e,this._location=r[0]}function y(e,t,n,r){var i=r.length;this.name=n,this.value=new Array(i),this._value=new Int32Array(2*i),this._gl=e,this._location=r[0]}function v(e,t,n,r){var i=r.length;this.name=n,this.value=new Array(i),this._value=new Int32Array(3*i),this._gl=e,this._location=r[0]}function g(e,t,n,r){var i=r.length;this.name=n,this.value=new Array(i),this._value=new Int32Array(4*i),this._gl=e,this._location=r[0]}function E(e,t,n,r){var i=r.length;this.name=n,this.value=new Array(i),this._value=new Float32Array(4*i),this._gl=e,this._location=r[0]}function T(e,t,n,r){var i=r.length;this.name=n,this.value=new Array(i),this._value=new Float32Array(9*i),this._gl=e,this._location=r[0]}function w(e,t,n,r){var i=r.length;this.name=n,this.value=new Array(i),this._value=new Float32Array(16*i),this._gl=e,this._location=r[0]}return f.prototype.set=function(){for(var e=this.value,t=e.length,n=this._value,r=!1,i=0;i<t;++i){var a=e[i];a!==n[i]&&(n[i]=a,r=!0)}r&&this._gl.uniform1fv(this._location,n)},d.prototype.set=function(){for(var t=this.value,n=t.length,r=this._value,i=!1,a=0,o=0;o<n;++o){var s=t[o];e.equalsArray(s,r,a)||(e.pack(s,r,a),i=!0),a+=2}i&&this._gl.uniform2fv(this._location,r)},h.prototype.set=function(){for(var e=this.value,n=e.length,r=this._value,o=!1,s=0,u=0;u<n;++u){var c=e[u];if(i(c.red))c.red===r[s]&&c.green===r[s+1]&&c.blue===r[s+2]||(r[s]=c.red,r[s+1]=c.green,r[s+2]=c.blue,o=!0);else{if(!i(c.x))throw new a("Invalid vec3 value.");t.equalsArray(c,r,s)||(t.pack(c,r,s),o=!0)}s+=3}o&&this._gl.uniform3fv(this._location,r)},p.prototype.set=function(){for(var e=this.value,t=e.length,o=this._value,s=!1,u=0,c=0;c<t;++c){var l=e[c];if(i(l.red))r.equalsArray(l,o,u)||(r.pack(l,o,u),s=!0);else{if(!i(l.x))throw new a("Invalid vec4 value.");n.equalsArray(l,o,u)||(n.pack(l,o,u),s=!0)}u+=4}s&&this._gl.uniform4fv(this._location,o)},m.prototype.set=function(){for(var e=this._gl,t=e.TEXTURE0+this.textureUnitIndex,n=this.value,r=n.length,i=0;i<r;++i){var a=n[i];e.activeTexture(t+i),e.bindTexture(a._target,a._texture)}},m.prototype._setSampler=function(e){this.textureUnitIndex=e;for(var t=this._locations,n=t.length,r=0;r<n;++r){var i=e+r;this._gl.uniform1i(t[r],i)}return e+n},_.prototype.set=function(){for(var e=this.value,t=e.length,n=this._value,r=!1,i=0;i<t;++i){var a=e[i];a!==n[i]&&(n[i]=a,r=!0)}r&&this._gl.uniform1iv(this._location,n)},y.prototype.set=function(){for(var t=this.value,n=t.length,r=this._value,i=!1,a=0,o=0;o<n;++o){var s=t[o];e.equalsArray(s,r,a)||(e.pack(s,r,a),i=!0),a+=2}i&&this._gl.uniform2iv(this._location,r)},v.prototype.set=function(){for(var e=this.value,n=e.length,r=this._value,i=!1,a=0,o=0;o<n;++o){var s=e[o];t.equalsArray(s,r,a)||(t.pack(s,r,a),i=!0),a+=3}i&&this._gl.uniform3iv(this._location,r)},g.prototype.set=function(){for(var e=this.value,t=e.length,r=this._value,i=!1,a=0,o=0;o<t;++o){var s=e[o];n.equalsArray(s,r,a)||(n.pack(s,r,a),i=!0),a+=4}i&&this._gl.uniform4iv(this._location,r)},E.prototype.set=function(){for(var e=this.value,t=e.length,n=this._value,r=!1,i=0,a=0;a<t;++a){var s=e[a];o.equalsArray(s,n,i)||(o.pack(s,n,i),r=!0),i+=4}r&&this._gl.uniformMatrix2fv(this._location,!1,n)},T.prototype.set=function(){for(var e=this.value,t=e.length,n=this._value,r=!1,i=0,a=0;a<t;++a){var o=e[a];s.equalsArray(o,n,i)||(s.pack(o,n,i),r=!0),i+=9}r&&this._gl.uniformMatrix3fv(this._location,!1,n)},w.prototype.set=function(){for(var e=this.value,t=e.length,n=this._value,r=!1,i=0,a=0;a<t;++a){var o=e[a];u.equalsArray(o,n,i)||(u.pack(o,n,i),r=!0),i+=16}r&&this._gl.uniformMatrix4fv(this._location,!1,n)},l}),define("Renderer/ShaderProgram",["../Core/Check","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/RuntimeError","./AutomaticUniforms","./ContextLimits","./createUniform","./createUniformArray"],function(e,t,n,r,i,a,o,s,u,c,l){"use strict";function f(e){var t=h(e.vertexShaderText,e.fragmentShaderText);this._gl=e.gl,this._logShaderCompilation=e.logShaderCompilation,this._debugShaders=e.debugShaders,this._attributeLocations=e.attributeLocations,this._program=void 0,this._numberOfVertexAttributes=void 0,this._vertexAttributes=void 0,this._uniformsByName=void 0,this._uniforms=void 0,this._automaticUniforms=void 0,this._manualUniforms=void 0,this._duplicateUniformNames=t.duplicateUniformNames,this._cachedShader=void 0,this.maximumTextureUnitIndex=void 0,this._vertexShaderSource=e.vertexShaderSource,this._vertexShaderText=e.vertexShaderText,this._fragmentShaderSource=e.fragmentShaderSource,this._fragmentShaderText=t.fragmentShaderText,this.id=E++}function d(e){var t=[],r=e.match(/uniform.*?(?![^{]*})(?=[=\[;])/g);if(n(r))for(var i=r.length,a=0;a<i;a++){var o=r[a].trim(),s=o.slice(o.lastIndexOf(" ")+1);t.push(s)}return t}function h(e,t){var n={};if(!u.highpFloatSupported||!u.highpIntSupported){var r,i,a,o,s=d(e),c=d(t),l=s.length,f=c.length;for(r=0;r<l;r++)for(i=0;i<f;i++)if(s[r]===c[i]){a=s[r],o="czm_mediump_"+a;var h=new RegExp(a+"\\b","g");t=t.replace(h,o),n[o]=a}}return{fragmentShaderText:t,duplicateUniformNames:n}}function p(e,t){var r=t._vertexShaderText,i=t._fragmentShaderText,a=e.createShader(e.VERTEX_SHADER);e.shaderSource(a,r),e.compileShader(a);var s=e.createShader(e.FRAGMENT_SHADER);e.shaderSource(s,i),e.compileShader(s);var u=e.createProgram();e.attachShader(u,a),e.attachShader(u,s),e.deleteShader(a),e.deleteShader(s);var c=t._attributeLocations;if(n(c))for(var l in c)c.hasOwnProperty(l)&&e.bindAttribLocation(u,c[l],l);e.linkProgram(u);var f;if(!e.getProgramParameter(u,e.LINK_STATUS)){var d=t._debugShaders;if(!e.getShaderParameter(s,e.COMPILE_STATUS)){if(f=e.getShaderInfoLog(s),console.error(T+"Fragment shader compile log: "+f),n(d)){var h=d.getTranslatedShaderSource(s);""!==h?console.error(T+"Translated fragment shader source:\n"+h):console.error(T+"Fragment shader translation failed.")}throw e.deleteProgram(u),new o("Fragment shader failed to compile.  Compile log: "+f)}if(!e.getShaderParameter(a,e.COMPILE_STATUS)){if(f=e.getShaderInfoLog(a),console.error(T+"Vertex shader compile log: "+f),n(d)){var p=d.getTranslatedShaderSource(a);""!==p?console.error(T+"Translated vertex shader source:\n"+p):console.error(T+"Vertex shader translation failed.")}throw e.deleteProgram(u),new o("Vertex shader failed to compile.  Compile log: "+f)}throw f=e.getProgramInfoLog(u),console.error(T+"Shader program link log: "+f),n(d)&&(console.error(T+"Translated vertex shader source:\n"+d.getTranslatedShaderSource(a)),console.error(T+"Translated fragment shader source:\n"+d.getTranslatedShaderSource(s))),e.deleteProgram(u),new o("Program failed to link.  Link log: "+f)}var m=t._logShaderCompilation;return m&&(f=e.getShaderInfoLog(a),n(f)&&f.length>0&&console.log(T+"Vertex shader compile log: "+f)),m&&(f=e.getShaderInfoLog(s),n(f)&&f.length>0&&console.log(T+"Fragment shader compile log: "+f)),m&&(f=e.getProgramInfoLog(u),n(f)&&f.length>0&&console.log(T+"Shader program link log: "+f)),u}function m(e,t,n){for(var r={},i=0;i<n;++i){var a=e.getActiveAttrib(t,i),o=e.getAttribLocation(t,a.name);r[a.name]={name:a.name,type:a.type,index:o}}return r}function _(e,t){for(var r={},i=[],a=[],o=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),s=0;s<o;++s){var u=e.getActiveUniform(t,s),f=-1!==u.name.indexOf("[0]",u.name.length-"[0]".length)?u.name.slice(0,u.name.length-3):u.name;if(0!==f.indexOf("gl_"))if(u.name.indexOf("[")<0){var d=e.getUniformLocation(t,f);if(null!==d){var h=c(e,u,f,d);r[f]=h,i.push(h),h._setSampler&&a.push(h)}}else{var p,m,_,y,v=f.indexOf("[");if(v>=0){if(p=r[f.slice(0,v)],!n(p))continue;m=p._locations,m.length<=1&&(_=p.value,null!==(y=e.getUniformLocation(t,f))&&(m.push(y),_.push(e.getUniform(t,y))))}else{m=[];for(var g=0;g<u.size;++g)null!==(y=e.getUniformLocation(t,f+"["+g+"]"))&&m.push(y);p=l(e,u,f,m),r[f]=p,i.push(p),p._setSampler&&a.push(p)}}}return{uniformsByName:r,uniforms:i,samplerUniforms:a}}function y(e,t){var r=[],i=[];for(var a in t)if(t.hasOwnProperty(a)){var o=t[a],u=a,c=e._duplicateUniformNames[u];n(c)&&(o.name=c,u=c);var l=s[u];n(l)?r.push({uniform:o,automaticUniform:l}):i.push(o)}return{automaticUniforms:r,manualUniforms:i}}function v(e,t,n){e.useProgram(t);for(var r=0,i=n.length,a=0;a<i;++a)r=n[a]._setSampler(r);return e.useProgram(null),r}function g(e){if(!n(e._program)){var t=e._gl,r=p(t,e,e._debugShaders),i=t.getProgramParameter(r,t.ACTIVE_ATTRIBUTES),a=_(t,r),o=y(e,a.uniformsByName);e._program=r,e._numberOfVertexAttributes=i,e._vertexAttributes=m(t,r,i),e._uniformsByName=a.uniformsByName,e._uniforms=a.uniforms,e._automaticUniforms=o.automaticUniforms,e._manualUniforms=o.manualUniforms,e.maximumTextureUnitIndex=v(t,r,a.samplerUniforms)}}var E=0;f.fromCache=function(n){return n=t(n,t.EMPTY_OBJECT),e.defined("options.context",n.context),n.context.shaderCache.getShaderProgram(n)},f.replaceCache=function(n){return n=t(n,t.EMPTY_OBJECT),e.defined("options.context",n.context),n.context.shaderCache.replaceShaderProgram(n)},r(f.prototype,{vertexShaderSource:{get:function(){return this._vertexShaderSource}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},vertexAttributes:{get:function(){return g(this),this._vertexAttributes}},numberOfVertexAttributes:{get:function(){return g(this),this._numberOfVertexAttributes}},allUniforms:{get:function(){return g(this),this._uniformsByName}}});var T="[Cesium WebGL] ";return f.prototype._bind=function(){g(this),this._gl.useProgram(this._program)},f.prototype._setUniforms=function(e,t,r){var i,o;if(n(e)){var s=this._manualUniforms;for(i=s.length,o=0;o<i;++o){var u=s[o];u.value=e[u.name]()}}var c=this._automaticUniforms;for(i=c.length,o=0;o<i;++o){var l=c[o];l.uniform.value=l.automaticUniform.getValue(t)}var f=this._uniforms;for(i=f.length,o=0;o<i;++o)f[o].set();if(r){var d=this._gl,h=this._program;if(d.validateProgram(h),!d.getProgramParameter(h,d.VALIDATE_STATUS))throw new a("Program validation failed.  Program info log: "+d.getProgramInfoLog(h))}},f.prototype.isDestroyed=function(){return!1},f.prototype.destroy=function(){this._cachedShader.cache.releaseShaderProgram(this)},f.prototype.finalDestroy=function(){return this._gl.deleteProgram(this._program),i(this)},f}),define("Renderer/modernizeShader",["../Core/defined","../Core/DeveloperError"],function(e,t){"use strict";function n(e,n){var i=/#define OUTPUT_DECLARATION/,l=e.split("\n");if(/#version 300 es/g.test(e))return e;var f,d,h=-1;for(f=0;f<l.length;++f)if(d=l[f],i.test(d)){h=f;break}if(-1===h)throw new t("Could not find a #define OUTPUT_DECLARATION!");var p=[];for(f=0;f<10;f++){var m="gl_FragData\\["+f+"\\]",_="czm_out"+f;new RegExp(m,"g").test(e)&&(s(_,p),r(m,_,l),l.splice(h,0,"layout(location = "+f+") out vec4 "+_+";"),h+=1)}a("gl_FragColor",l)&&(s("czm_fragColor",p),r("gl_FragColor","czm_fragColor",l),l.splice(h,0,"layout(location = 0) out vec4 czm_fragColor;"),h+=1);var y=u(p,l),v={};for(f=0;f<l.length;f++){d=l[f];for(var g in y)if(y.hasOwnProperty(g)){var E=new RegExp("(layout)[^]+(out)[^]+("+g+")[^]+","g");E.test(d)&&(v[d]=g)}}for(var T in v)if(v.hasOwnProperty(T)){var w,b=v[T],S=l.indexOf(T),C=y[b],O=C.length;for(w=0;w<O;w++)l.splice(S,0,C[w]);for(S+=O+1,w=O-1;w>=0;w--)l.splice(S,0,"#endif //"+C[w])}var A=!1;for(f=0;f<l.length;f++)/#version/.test(l[f])&&(l[f]="#version 300 es",A=!0);return A||l.splice(0,0,"#version 300 es"),c("EXT_draw_buffers",l),c("EXT_frag_depth",l),r("texture2D","texture",l),r("texture3D","texture",l),r("textureCube","texture",l),r("gl_FragDepthEXT","gl_FragDepth",l),n?r("varying","in",l):(r("attribute","in",l),r("varying","out",l)),o(l)}function r(e,t,n){for(var r="(^|[^\\w])("+e+")($|[^\\w])",i=new RegExp(r,"g"),a=n.length,o=0;o<a;++o){var s=n[o];n[o]=s.replace(i,"$1"+t+"$3")}}function i(e,t,n){for(var r=n.length,i=0;i<r;++i){var a=n[i];n[i]=a.replace(e,t)}}function a(e,t){for(var n="(^|[^\\w])("+e+")($|[^\\w])",r=new RegExp(n,"g"),i=t.length,a=0;a<i;++a){var o=t[a];if(r.test(o))return!0}return!1}function o(e){for(var t="",n=e.length,r=0;r<n;++r)t+=e[r]+"\n";return t}function s(e,t){-1===t.indexOf(e)&&t.push(e)}function u(t,n){for(var r={},i=t.length,a=[],o=0;o<n.length;++o){var s=n[o],u=/(#ifdef|#if)/g.test(s),c=/#else/g.test(s),l=/#endif/g.test(s);if(u)a.push(s);else if(c){var f=a[a.length-1],d=f.replace("ifdef","ifndef");/if/g.test(d)&&(d=d.replace(/(#if\s+)(\S*)([^]*)/,"$1!($2)$3")),a.pop(),a.push(d)}else if(l)a.pop();else if(!/layout/g.test(s))for(var h=0;h<i;++h){var p=t[h];-1!==s.indexOf(p)&&(e(r[p])?r[p]=r[p].filter(function(e){return a.indexOf(e)>=0}):r[p]=a.slice())}}return r}function c(e,t){var n="#extension\\s+GL_"+e+"\\s+:\\s+[a-zA-Z0-9]+\\s*$";i(new RegExp(n,"g"),"",t)}return n}),define("Shaders/Builtin/Constants/degreesPerRadian",[],function(){"use strict";return"const float czm_degreesPerRadian = 57.29577951308232;\n"}),define("Shaders/Builtin/Constants/depthRange",[],function(){"use strict";return"const czm_depthRangeStruct czm_depthRange = czm_depthRangeStruct(0.0, 1.0);\n"}),define("Shaders/Builtin/Constants/epsilon1",[],function(){"use strict";return"const float czm_epsilon1 = 0.1;\n"}),define("Shaders/Builtin/Constants/epsilon2",[],function(){"use strict";return"const float czm_epsilon2 = 0.01;\n"}),define("Shaders/Builtin/Constants/epsilon3",[],function(){"use strict";return"const float czm_epsilon3 = 0.001;\n"}),define("Shaders/Builtin/Constants/epsilon4",[],function(){"use strict";return"const float czm_epsilon4 = 0.0001;\n"}),define("Shaders/Builtin/Constants/epsilon5",[],function(){"use strict";return"const float czm_epsilon5 = 0.00001;\n"}),define("Shaders/Builtin/Constants/epsilon6",[],function(){"use strict";return"const float czm_epsilon6 = 0.000001;\n"}),define("Shaders/Builtin/Constants/epsilon7",[],function(){"use strict";return"const float czm_epsilon7 = 0.0000001;\n"}),define("Shaders/Builtin/Constants/infinity",[],function(){"use strict";return"const float czm_infinity = 5906376272000.0;\n"}),define("Shaders/Builtin/Constants/oneOverPi",[],function(){"use strict";return"const float czm_oneOverPi = 0.3183098861837907;\n"}),define("Shaders/Builtin/Constants/oneOverTwoPi",[],function(){"use strict";return"const float czm_oneOverTwoPi = 0.15915494309189535;\n"}),define("Shaders/Builtin/Constants/passCesium3DTile",[],function(){"use strict";return"const float czm_passCesium3DTile = 4.0;\n"}),define("Shaders/Builtin/Constants/passCesium3DTileClassification",[],function(){"use strict";return"const float czm_passCesium3DTileClassification = 5.0;\n"}),define("Shaders/Builtin/Constants/passCesium3DTileClassificationIgnoreShow",[],function(){"use strict";return"const float czm_passCesium3DTileClassificationIgnoreShow = 6.0;\n"}),define("Shaders/Builtin/Constants/passClassification",[],function(){"use strict";return"const float czm_passClassification = 7.0;\n"}),define("Shaders/Builtin/Constants/passCompute",[],function(){"use strict";return"const float czm_passCompute = 1.0;\n"}),define("Shaders/Builtin/Constants/passEnvironment",[],function(){"use strict";return"const float czm_passEnvironment = 0.0;\n"}),define("Shaders/Builtin/Constants/passGlobe",[],function(){"use strict";return"const float czm_passGlobe = 2.0;\n"}),define("Shaders/Builtin/Constants/passOpaque",[],function(){"use strict";return"const float czm_passOpaque = 8.0;\n"}),define("Shaders/Builtin/Constants/passOverlay",[],function(){"use strict";return"const float czm_passOverlay = 10.0;\n"}),define("Shaders/Builtin/Constants/passTerrainClassification",[],function(){"use strict";return"const float czm_passTerrainClassification = 3.0;\n"}),define("Shaders/Builtin/Constants/passTranslucent",[],function(){"use strict";return"const float czm_passTranslucent = 9.0;\n"}),define("Shaders/Builtin/Constants/pi",[],function(){"use strict";return"const float czm_pi = 3.141592653589793;\n"}),define("Shaders/Builtin/Constants/piOverFour",[],function(){"use strict";return"const float czm_piOverFour = 0.7853981633974483;\n"}),define("Shaders/Builtin/Constants/piOverSix",[],function(){"use strict";return"const float czm_piOverSix = 0.5235987755982988;\n"}),define("Shaders/Builtin/Constants/piOverThree",[],function(){"use strict";return"const float czm_piOverThree = 1.0471975511965976;\n"}),define("Shaders/Builtin/Constants/piOverTwo",[],function(){"use strict";return"const float czm_piOverTwo = 1.5707963267948966;\n"}),define("Shaders/Builtin/Constants/radiansPerDegree",[],function(){"use strict";return"const float czm_radiansPerDegree = 0.017453292519943295;\n"}),define("Shaders/Builtin/Constants/sceneMode2D",[],function(){"use strict";return"const float czm_sceneMode2D = 2.0;\n"}),define("Shaders/Builtin/Constants/sceneMode3D",[],function(){"use strict";return"const float czm_sceneMode3D = 3.0;\n"}),define("Shaders/Builtin/Constants/sceneModeColumbusView",[],function(){"use strict";return"const float czm_sceneModeColumbusView = 1.0;\n"}),define("Shaders/Builtin/Constants/sceneModeMorphing",[],function(){"use strict";return"const float czm_sceneModeMorphing = 0.0;\n"}),define("Shaders/Builtin/Constants/solarRadius",[],function(){"use strict";return"const float czm_solarRadius = 695500000.0;\n"}),define("Shaders/Builtin/Constants/threePiOver2",[],function(){"use strict";return"const float czm_threePiOver2 = 4.71238898038469;\n"}),define("Shaders/Builtin/Constants/twoPi",[],function(){"use strict";return"const float czm_twoPi = 6.283185307179586;\n"}),define("Shaders/Builtin/Constants/webMercatorMaxLatitude",[],function(){"use strict";return"const float czm_webMercatorMaxLatitude = 1.4844222297453324;\n"}),define("Shaders/Builtin/Structs/depthRangeStruct",[],function(){"use strict";return"struct czm_depthRangeStruct\n{\nfloat near;\nfloat far;\n};\n"}),define("Shaders/Builtin/Structs/ellipsoid",[],function(){"use strict";return"struct czm_ellipsoid\n{\nvec3 center;\nvec3 radii;\nvec3 inverseRadii;\nvec3 inverseRadiiSquared;\n};\n"}),define("Shaders/Builtin/Structs/material",[],function(){"use strict";return"struct czm_material\n{\nvec3 diffuse;\nfloat specular;\nfloat shininess;\nvec3 normal;\nvec3 emission;\nfloat alpha;\n};\n"}),define("Shaders/Builtin/Structs/materialInput",[],function(){"use strict";return"struct czm_materialInput\n{\nfloat s;\nvec2 st;\nvec3 str;\nvec3 normalEC;\nmat3 tangentToEyeMatrix;\nvec3 positionToEyeEC;\nfloat height;\nfloat slope;\n};\n"}),define("Shaders/Builtin/Structs/ray",[],function(){"use strict";return"struct czm_ray\n{\nvec3 origin;\nvec3 direction;\n};\n"}),define("Shaders/Builtin/Structs/raySegment",[],function(){"use strict";return"struct czm_raySegment\n{\nfloat start;\nfloat stop;\n};\nconst czm_raySegment czm_emptyRaySegment = czm_raySegment(-czm_infinity, -czm_infinity);\nconst czm_raySegment czm_fullRaySegment = czm_raySegment(0.0, czm_infinity);\n"}),define("Shaders/Builtin/Structs/shadowParameters",[],function(){"use strict";return"struct czm_shadowParameters\n{\n#ifdef USE_CUBE_MAP_SHADOW\nvec3 texCoords;\n#else\nvec2 texCoords;\n#endif\nfloat depthBias;\nfloat depth;\nfloat nDotL;\nvec2 texelStepSize;\nfloat normalShadingSmooth;\nfloat darkness;\n};\n"}),define("Shaders/Builtin/Functions/alphaWeight",[],function(){"use strict";return"float czm_alphaWeight(float a)\n{\nfloat z = (gl_FragCoord.z - czm_viewportTransformation[3][2]) / czm_viewportTransformation[2][2];\nreturn pow(a + 0.01, 4.0) + max(1e-2, min(3.0 * 1e3, 0.003 / (1e-5 + pow(abs(z) / 200.0, 4.0))));\n}\n"}),define("Shaders/Builtin/Functions/antialias",[],function(){"use strict";return"vec4 czm_antialias(vec4 color1, vec4 color2, vec4 currentColor, float dist, float fuzzFactor)\n{\nfloat val1 = clamp(dist / fuzzFactor, 0.0, 1.0);\nfloat val2 = clamp((dist - 0.5) / fuzzFactor, 0.0, 1.0);\nval1 = val1 * (1.0 - val2);\nval1 = val1 * val1 * (3.0 - (2.0 * val1));\nval1 = pow(val1, 0.5);\nvec4 midColor = (color1 + color2) * 0.5;\nreturn mix(midColor, currentColor, val1);\n}\nvec4 czm_antialias(vec4 color1, vec4 color2, vec4 currentColor, float dist)\n{\nreturn czm_antialias(color1, color2, currentColor, dist, 0.1);\n}\n"}),define("Shaders/Builtin/Functions/approximateSphericalCoordinates",[],function(){"use strict";return"vec2 czm_approximateSphericalCoordinates(vec3 normal) {\nfloat latitudeApproximation = czm_fastApproximateAtan(sqrt(normal.x * normal.x + normal.y * normal.y), normal.z);\nfloat longitudeApproximation = czm_fastApproximateAtan(normal.x, normal.y);\nreturn vec2(latitudeApproximation, longitudeApproximation);\n}\n"}),define("Shaders/Builtin/Functions/branchFreeTernary",[],function(){"use strict";return"float czm_branchFreeTernary(bool comparison, float a, float b) {\nfloat useA = float(comparison);\nreturn a * useA + b * (1.0 - useA);\n}\nvec2 czm_branchFreeTernary(bool comparison, vec2 a, vec2 b) {\nfloat useA = float(comparison);\nreturn a * useA + b * (1.0 - useA);\n}\nvec3 czm_branchFreeTernary(bool comparison, vec3 a, vec3 b) {\nfloat useA = float(comparison);\nreturn a * useA + b * (1.0 - useA);\n}\nvec4 czm_branchFreeTernary(bool comparison, vec4 a, vec4 b) {\nfloat useA = float(comparison);\nreturn a * useA + b * (1.0 - useA);\n}\n"}),define("Shaders/Builtin/Functions/cascadeColor",[],function(){"use strict";return"vec4 czm_cascadeColor(vec4 weights)\n{\nreturn vec4(1.0, 0.0, 0.0, 1.0) * weights.x +\nvec4(0.0, 1.0, 0.0, 1.0) * weights.y +\nvec4(0.0, 0.0, 1.0, 1.0) * weights.z +\nvec4(1.0, 0.0, 1.0, 1.0) * weights.w;\n}\n"}),define("Shaders/Builtin/Functions/cascadeDistance",[],function(){"use strict";return"uniform vec4 shadowMap_cascadeDistances;\nfloat czm_cascadeDistance(vec4 weights)\n{\nreturn dot(shadowMap_cascadeDistances, weights);\n}\n"}),define("Shaders/Builtin/Functions/cascadeMatrix",[],function(){"use strict";return"uniform mat4 shadowMap_cascadeMatrices[4];\nmat4 czm_cascadeMatrix(vec4 weights)\n{\nreturn shadowMap_cascadeMatrices[0] * weights.x +\nshadowMap_cascadeMatrices[1] * weights.y +\nshadowMap_cascadeMatrices[2] * weights.z +\nshadowMap_cascadeMatrices[3] * weights.w;\n}\n"}),define("Shaders/Builtin/Functions/cascadeWeights",[],function(){"use strict";return"uniform vec4 shadowMap_cascadeSplits[2];\nvec4 czm_cascadeWeights(float depthEye)\n{\nvec4 near = step(shadowMap_cascadeSplits[0], vec4(depthEye));\nvec4 far = step(depthEye, shadowMap_cascadeSplits[1]);\nreturn near * far;\n}\n"}),define("Shaders/Builtin/Functions/columbusViewMorph",[],function(){"use strict";return"vec4 czm_columbusViewMorph(vec4 position2D, vec4 position3D, float time)\n{\nvec3 p = mix(position2D.xyz, position3D.xyz, time);\nreturn vec4(p, 1.0);\n}\n"}),define("Shaders/Builtin/Functions/computePosition",[],function(){"use strict";return"vec4 czm_computePosition();\n"}),define("Shaders/Builtin/Functions/cosineAndSine",[],function(){"use strict";return"vec2 cordic(float angle)\n{\nvec2 vector = vec2(6.0725293500888267e-1, 0.0);\nfloat sense = (angle < 0.0) ? -1.0 : 1.0;\nmat2 rotation = mat2(1.0, sense, -sense, 1.0);\nvector = rotation * vector;\nangle -= sense * 7.8539816339744828e-1;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfloat factor = sense * 5.0e-1;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 4.6364760900080609e-1;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 2.5e-1;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 2.4497866312686414e-1;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 1.25e-1;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 1.2435499454676144e-1;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 6.25e-2;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 6.2418809995957350e-2;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 3.125e-2;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 3.1239833430268277e-2;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 1.5625e-2;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 1.5623728620476831e-2;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 7.8125e-3;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 7.8123410601011111e-3;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 3.90625e-3;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 3.9062301319669718e-3;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 1.953125e-3;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 1.9531225164788188e-3;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 9.765625e-4;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 9.7656218955931946e-4;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 4.8828125e-4;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 4.8828121119489829e-4;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 2.44140625e-4;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 2.4414062014936177e-4;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 1.220703125e-4;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 1.2207031189367021e-4;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 6.103515625e-5;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 6.1035156174208773e-5;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 3.0517578125e-5;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 3.0517578115526096e-5;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 1.52587890625e-5;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 1.5258789061315762e-5;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 7.62939453125e-6;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 7.6293945311019700e-6;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 3.814697265625e-6;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 3.8146972656064961e-6;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 1.9073486328125e-6;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 1.9073486328101870e-6;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 9.5367431640625e-7;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 9.5367431640596084e-7;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 4.76837158203125e-7;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 4.7683715820308884e-7;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 2.384185791015625e-7;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 2.3841857910155797e-7;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 1.1920928955078125e-7;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nreturn vector;\n}\nvec2 czm_cosineAndSine(float angle)\n{\nif (angle < -czm_piOverTwo || angle > czm_piOverTwo)\n{\nif (angle < 0.0)\n{\nreturn -cordic(angle + czm_pi);\n}\nelse\n{\nreturn -cordic(angle - czm_pi);\n}\n}\nelse\n{\nreturn cordic(angle);\n}\n}\n"}),define("Shaders/Builtin/Functions/decompressTextureCoordinates",[],function(){"use strict";return"vec2 czm_decompressTextureCoordinates(float encoded)\n{\nfloat temp = encoded / 4096.0;\nfloat xZeroTo4095 = floor(temp);\nfloat stx = xZeroTo4095 / 4095.0;\nfloat sty = (encoded - xZeroTo4095 * 4096.0) / 4095.0;\nreturn vec2(stx, sty);\n}\n"}),define("Shaders/Builtin/Functions/depthClampFarPlane",[],function(){"use strict";return"#ifndef LOG_DEPTH\nvarying float v_WindowZ;\n#endif\nvec4 czm_depthClampFarPlane(vec4 coords)\n{\n#ifndef LOG_DEPTH\nv_WindowZ = (0.5 * (coords.z / coords.w) + 0.5) * coords.w;\ncoords.z = min(coords.z, coords.w);\n#endif\nreturn coords;\n}\n"}),define("Shaders/Builtin/Functions/eastNorthUpToEyeCoordinates",[],function(){"use strict";return"mat3 czm_eastNorthUpToEyeCoordinates(vec3 positionMC, vec3 normalEC)\n{\nvec3 tangentMC = normalize(vec3(-positionMC.y, positionMC.x, 0.0));\nvec3 tangentEC = normalize(czm_normal3D * tangentMC);\nvec3 bitangentEC = normalize(cross(normalEC, tangentEC));\nreturn mat3(\ntangentEC.x,   tangentEC.y,   tangentEC.z,\nbitangentEC.x, bitangentEC.y, bitangentEC.z,\nnormalEC.x,    normalEC.y,    normalEC.z);\n}\n"}),define("Shaders/Builtin/Functions/ellipsoidContainsPoint",[],function(){"use strict";return"bool czm_ellipsoidContainsPoint(czm_ellipsoid ellipsoid, vec3 point)\n{\nvec3 scaled = ellipsoid.inverseRadii * (czm_inverseModelView * vec4(point, 1.0)).xyz;\nreturn (dot(scaled, scaled) <= 1.0);\n}\n"}),define("Shaders/Builtin/Functions/ellipsoidNew",[],function(){"use strict"
;return"czm_ellipsoid czm_ellipsoidNew(vec3 center, vec3 radii)\n{\nvec3 inverseRadii = vec3(1.0 / radii.x, 1.0 / radii.y, 1.0 / radii.z);\nvec3 inverseRadiiSquared = inverseRadii * inverseRadii;\nczm_ellipsoid temp = czm_ellipsoid(center, radii, inverseRadii, inverseRadiiSquared);\nreturn temp;\n}\n"}),define("Shaders/Builtin/Functions/ellipsoidWgs84TextureCoordinates",[],function(){"use strict";return"vec2 czm_ellipsoidWgs84TextureCoordinates(vec3 normal)\n{\nreturn vec2(atan(normal.y, normal.x) * czm_oneOverTwoPi + 0.5, asin(normal.z) * czm_oneOverPi + 0.5);\n}\n"}),define("Shaders/Builtin/Functions/equalsEpsilon",[],function(){"use strict";return"bool czm_equalsEpsilon(vec4 left, vec4 right, float epsilon) {\nreturn all(lessThanEqual(abs(left - right), vec4(epsilon)));\n}\nbool czm_equalsEpsilon(vec3 left, vec3 right, float epsilon) {\nreturn all(lessThanEqual(abs(left - right), vec3(epsilon)));\n}\nbool czm_equalsEpsilon(vec2 left, vec2 right, float epsilon) {\nreturn all(lessThanEqual(abs(left - right), vec2(epsilon)));\n}\nbool czm_equalsEpsilon(float left, float right, float epsilon) {\nreturn (abs(left - right) <= epsilon);\n}\n"}),define("Shaders/Builtin/Functions/eyeOffset",[],function(){"use strict";return"vec4 czm_eyeOffset(vec4 positionEC, vec3 eyeOffset)\n{\nvec4 p = positionEC;\nvec4 zEyeOffset = normalize(p) * eyeOffset.z;\np.xy += eyeOffset.xy + zEyeOffset.xy;\np.z += zEyeOffset.z;\nreturn p;\n}\n"}),define("Shaders/Builtin/Functions/eyeToWindowCoordinates",[],function(){"use strict";return"vec4 czm_eyeToWindowCoordinates(vec4 positionEC)\n{\nvec4 q = czm_projection * positionEC;\nq.xyz /= q.w;\nq.xyz = (czm_viewportTransformation * vec4(q.xyz, 1.0)).xyz;\nreturn q;\n}\n"}),define("Shaders/Builtin/Functions/fastApproximateAtan",[],function(){"use strict";return"float czm_fastApproximateAtan(float x) {\nreturn x * (-0.1784 * x - 0.0663 * x * x + 1.0301);\n}\nfloat czm_fastApproximateAtan(float x, float y) {\nfloat t = abs(x);\nfloat opposite = abs(y);\nfloat adjacent = max(t, opposite);\nopposite = min(t, opposite);\nt = czm_fastApproximateAtan(opposite / adjacent);\nt = czm_branchFreeTernary(abs(y) > abs(x), czm_piOverTwo - t, t);\nt = czm_branchFreeTernary(x < 0.0, czm_pi - t, t);\nt = czm_branchFreeTernary(y < 0.0, -t, t);\nreturn t;\n}\n"}),define("Shaders/Builtin/Functions/fog",[],function(){"use strict";return"vec3 czm_fog(float distanceToCamera, vec3 color, vec3 fogColor)\n{\nfloat scalar = distanceToCamera * czm_fogDensity;\nfloat fog = 1.0 - exp(-(scalar * scalar));\nreturn mix(color, fogColor, fog);\n}\n"}),define("Shaders/Builtin/Functions/geodeticSurfaceNormal",[],function(){"use strict";return"vec3 czm_geodeticSurfaceNormal(vec3 positionOnEllipsoid, vec3 ellipsoidCenter, vec3 oneOverEllipsoidRadiiSquared)\n{\nreturn normalize((positionOnEllipsoid - ellipsoidCenter) * oneOverEllipsoidRadiiSquared);\n}\n"}),define("Shaders/Builtin/Functions/getDefaultMaterial",[],function(){"use strict";return"czm_material czm_getDefaultMaterial(czm_materialInput materialInput)\n{\nczm_material material;\nmaterial.diffuse = vec3(0.0);\nmaterial.specular = 0.0;\nmaterial.shininess = 1.0;\nmaterial.normal = materialInput.normalEC;\nmaterial.emission = vec3(0.0);\nmaterial.alpha = 1.0;\nreturn material;\n}\n"}),define("Shaders/Builtin/Functions/getLambertDiffuse",[],function(){"use strict";return"float czm_getLambertDiffuse(vec3 lightDirectionEC, vec3 normalEC)\n{\nreturn max(dot(lightDirectionEC, normalEC), 0.0);\n}\n"}),define("Shaders/Builtin/Functions/getSpecular",[],function(){"use strict";return"float czm_getSpecular(vec3 lightDirectionEC, vec3 toEyeEC, vec3 normalEC, float shininess)\n{\nvec3 toReflectedLight = reflect(-lightDirectionEC, normalEC);\nfloat specular = max(dot(toReflectedLight, toEyeEC), 0.0);\nreturn pow(specular, max(shininess, czm_epsilon2));\n}\n"}),define("Shaders/Builtin/Functions/getWaterNoise",[],function(){"use strict";return"vec4 czm_getWaterNoise(sampler2D normalMap, vec2 uv, float time, float angleInRadians)\n{\nfloat cosAngle = cos(angleInRadians);\nfloat sinAngle = sin(angleInRadians);\nvec2 s0 = vec2(1.0/17.0, 0.0);\nvec2 s1 = vec2(-1.0/29.0, 0.0);\nvec2 s2 = vec2(1.0/101.0, 1.0/59.0);\nvec2 s3 = vec2(-1.0/109.0, -1.0/57.0);\ns0 = vec2((cosAngle * s0.x) - (sinAngle * s0.y), (sinAngle * s0.x) + (cosAngle * s0.y));\ns1 = vec2((cosAngle * s1.x) - (sinAngle * s1.y), (sinAngle * s1.x) + (cosAngle * s1.y));\ns2 = vec2((cosAngle * s2.x) - (sinAngle * s2.y), (sinAngle * s2.x) + (cosAngle * s2.y));\ns3 = vec2((cosAngle * s3.x) - (sinAngle * s3.y), (sinAngle * s3.x) + (cosAngle * s3.y));\nvec2 uv0 = (uv/103.0) + (time * s0);\nvec2 uv1 = uv/107.0 + (time * s1) + vec2(0.23);\nvec2 uv2 = uv/vec2(897.0, 983.0) + (time * s2) + vec2(0.51);\nvec2 uv3 = uv/vec2(991.0, 877.0) + (time * s3) + vec2(0.71);\nuv0 = fract(uv0);\nuv1 = fract(uv1);\nuv2 = fract(uv2);\nuv3 = fract(uv3);\nvec4 noise = (texture2D(normalMap, uv0)) +\n(texture2D(normalMap, uv1)) +\n(texture2D(normalMap, uv2)) +\n(texture2D(normalMap, uv3));\nreturn ((noise / 4.0) - 0.5) * 2.0;\n}\n"}),define("Shaders/Builtin/Functions/getWgs84EllipsoidEC",[],function(){"use strict";return"czm_ellipsoid czm_getWgs84EllipsoidEC()\n{\nvec3 radii = vec3(6378137.0, 6378137.0, 6356752.314245);\nvec3 inverseRadii = vec3(1.0 / radii.x, 1.0 / radii.y, 1.0 / radii.z);\nvec3 inverseRadiiSquared = inverseRadii * inverseRadii;\nczm_ellipsoid temp = czm_ellipsoid(czm_view[3].xyz, radii, inverseRadii, inverseRadiiSquared);\nreturn temp;\n}\n"}),define("Shaders/Builtin/Functions/HSBToRGB",[],function(){"use strict";return"const vec4 K_HSB2RGB = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\nvec3 czm_HSBToRGB(vec3 hsb)\n{\nvec3 p = abs(fract(hsb.xxx + K_HSB2RGB.xyz) * 6.0 - K_HSB2RGB.www);\nreturn hsb.z * mix(K_HSB2RGB.xxx, clamp(p - K_HSB2RGB.xxx, 0.0, 1.0), hsb.y);\n}\n"}),define("Shaders/Builtin/Functions/HSLToRGB",[],function(){"use strict";return"vec3 hueToRGB(float hue)\n{\nfloat r = abs(hue * 6.0 - 3.0) - 1.0;\nfloat g = 2.0 - abs(hue * 6.0 - 2.0);\nfloat b = 2.0 - abs(hue * 6.0 - 4.0);\nreturn clamp(vec3(r, g, b), 0.0, 1.0);\n}\nvec3 czm_HSLToRGB(vec3 hsl)\n{\nvec3 rgb = hueToRGB(hsl.x);\nfloat c = (1.0 - abs(2.0 * hsl.z - 1.0)) * hsl.y;\nreturn (rgb - 0.5) * c + hsl.z;\n}\n"}),define("Shaders/Builtin/Functions/hue",[],function(){"use strict";return"vec3 czm_hue(vec3 rgb, float adjustment)\n{\nconst mat3 toYIQ = mat3(0.299,     0.587,     0.114,\n0.595716, -0.274453, -0.321263,\n0.211456, -0.522591,  0.311135);\nconst mat3 toRGB = mat3(1.0,  0.9563,  0.6210,\n1.0, -0.2721, -0.6474,\n1.0, -1.107,   1.7046);\nvec3 yiq = toYIQ * rgb;\nfloat hue = atan(yiq.z, yiq.y) + adjustment;\nfloat chroma = sqrt(yiq.z * yiq.z + yiq.y * yiq.y);\nvec3 color = vec3(yiq.x, chroma * cos(hue), chroma * sin(hue));\nreturn toRGB * color;\n}\n"}),define("Shaders/Builtin/Functions/isEmpty",[],function(){"use strict";return"bool czm_isEmpty(czm_raySegment interval)\n{\nreturn (interval.stop < 0.0);\n}\n"}),define("Shaders/Builtin/Functions/isFull",[],function(){"use strict";return"bool czm_isFull(czm_raySegment interval)\n{\nreturn (interval.start == 0.0 && interval.stop == czm_infinity);\n}\n"}),define("Shaders/Builtin/Functions/latitudeToWebMercatorFraction",[],function(){"use strict";return"float czm_latitudeToWebMercatorFraction(float latitude, float southMercatorY, float oneOverMercatorHeight)\n{\nfloat sinLatitude = sin(latitude);\nfloat mercatorY = 0.5 * log((1.0 + sinLatitude) / (1.0 - sinLatitude));\nreturn (mercatorY - southMercatorY) * oneOverMercatorHeight;\n}\n"}),define("Shaders/Builtin/Functions/lineDistance",[],function(){"use strict";return"float czm_lineDistance(vec2 point1, vec2 point2, vec2 point) {\nreturn abs((point2.y - point1.y) * point.x - (point2.x - point1.x) * point.y + point2.x * point1.y - point2.y * point1.x) / distance(point2, point1);\n}\n"}),define("Shaders/Builtin/Functions/luminance",[],function(){"use strict";return"float czm_luminance(vec3 rgb)\n{\nconst vec3 W = vec3(0.2125, 0.7154, 0.0721);\nreturn dot(rgb, W);\n}\n"}),define("Shaders/Builtin/Functions/metersPerPixel",[],function(){"use strict";return"float czm_metersPerPixel(vec4 positionEC)\n{\nfloat width = czm_viewport.z;\nfloat height = czm_viewport.w;\nfloat pixelWidth;\nfloat pixelHeight;\nfloat top = czm_frustumPlanes.x;\nfloat bottom = czm_frustumPlanes.y;\nfloat left = czm_frustumPlanes.z;\nfloat right = czm_frustumPlanes.w;\nif (czm_sceneMode == czm_sceneMode2D || czm_orthographicIn3D == 1.0)\n{\nfloat frustumWidth = right - left;\nfloat frustumHeight = top - bottom;\npixelWidth = frustumWidth / width;\npixelHeight = frustumHeight / height;\n}\nelse\n{\nfloat distanceToPixel = -positionEC.z;\nfloat inverseNear = 1.0 / czm_currentFrustum.x;\nfloat tanTheta = top * inverseNear;\npixelHeight = 2.0 * distanceToPixel * tanTheta / height;\ntanTheta = right * inverseNear;\npixelWidth = 2.0 * distanceToPixel * tanTheta / width;\n}\nreturn max(pixelWidth, pixelHeight);\n}\n"}),define("Shaders/Builtin/Functions/modelToWindowCoordinates",[],function(){"use strict";return"vec4 czm_modelToWindowCoordinates(vec4 position)\n{\nvec4 q = czm_modelViewProjection * position;\nq.xyz /= q.w;\nq.xyz = (czm_viewportTransformation * vec4(q.xyz, 1.0)).xyz;\nreturn q;\n}\n"}),define("Shaders/Builtin/Functions/multiplyWithColorBalance",[],function(){"use strict";return"vec3 czm_multiplyWithColorBalance(vec3 left, vec3 right)\n{\nconst vec3 W = vec3(0.2125, 0.7154, 0.0721);\nvec3 target = left * right;\nfloat leftLuminance = dot(left, W);\nfloat rightLuminance = dot(right, W);\nfloat targetLuminance = dot(target, W);\nreturn ((leftLuminance + rightLuminance) / (2.0 * targetLuminance)) * target;\n}\n"}),define("Shaders/Builtin/Functions/nearFarScalar",[],function(){"use strict";return"float czm_nearFarScalar(vec4 nearFarScalar, float cameraDistSq)\n{\nfloat valueAtMin = nearFarScalar.y;\nfloat valueAtMax = nearFarScalar.w;\nfloat nearDistanceSq = nearFarScalar.x * nearFarScalar.x;\nfloat farDistanceSq = nearFarScalar.z * nearFarScalar.z;\nfloat t = (cameraDistSq - nearDistanceSq) / (farDistanceSq - nearDistanceSq);\nt = pow(clamp(t, 0.0, 1.0), 0.2);\nreturn mix(valueAtMin, valueAtMax, t);\n}\n"}),define("Shaders/Builtin/Functions/octDecode",[],function(){"use strict";return"vec3 czm_octDecode(vec2 encoded, float range)\n{\nif (encoded.x == 0.0 && encoded.y == 0.0) {\nreturn vec3(0.0, 0.0, 0.0);\n}\nencoded = encoded / range * 2.0 - 1.0;\nvec3 v = vec3(encoded.x, encoded.y, 1.0 - abs(encoded.x) - abs(encoded.y));\nif (v.z < 0.0)\n{\nv.xy = (1.0 - abs(v.yx)) * czm_signNotZero(v.xy);\n}\nreturn normalize(v);\n}\nvec3 czm_octDecode(vec2 encoded)\n{\nreturn czm_octDecode(encoded, 255.0);\n}\nvec3 czm_octDecode(float encoded)\n{\nfloat temp = encoded / 256.0;\nfloat x = floor(temp);\nfloat y = (temp - x) * 256.0;\nreturn czm_octDecode(vec2(x, y));\n}\nvoid czm_octDecode(vec2 encoded, out vec3 vector1, out vec3 vector2, out vec3 vector3)\n{\nfloat temp = encoded.x / 65536.0;\nfloat x = floor(temp);\nfloat encodedFloat1 = (temp - x) * 65536.0;\ntemp = encoded.y / 65536.0;\nfloat y = floor(temp);\nfloat encodedFloat2 = (temp - y) * 65536.0;\nvector1 = czm_octDecode(encodedFloat1);\nvector2 = czm_octDecode(encodedFloat2);\nvector3 = czm_octDecode(vec2(x, y));\n}\n"}),define("Shaders/Builtin/Functions/packDepth",[],function(){"use strict";return"vec4 czm_packDepth(float depth)\n{\nvec4 enc = vec4(1.0, 255.0, 65025.0, 16581375.0) * depth;\nenc = fract(enc);\nenc -= enc.yzww * vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0, 0.0);\nreturn enc;\n}\n"}),define("Shaders/Builtin/Functions/phong",[],function(){"use strict";return"float czm_private_getLambertDiffuseOfMaterial(vec3 lightDirectionEC, czm_material material)\n{\nreturn czm_getLambertDiffuse(lightDirectionEC, material.normal);\n}\nfloat czm_private_getSpecularOfMaterial(vec3 lightDirectionEC, vec3 toEyeEC, czm_material material)\n{\nreturn czm_getSpecular(lightDirectionEC, toEyeEC, material.normal, material.shininess);\n}\nvec4 czm_phong(vec3 toEye, czm_material material)\n{\nfloat diffuse = czm_private_getLambertDiffuseOfMaterial(vec3(0.0, 0.0, 1.0), material);\nif (czm_sceneMode == czm_sceneMode3D) {\ndiffuse += czm_private_getLambertDiffuseOfMaterial(vec3(0.0, 1.0, 0.0), material);\n}\nfloat specular = czm_private_getSpecularOfMaterial(czm_sunDirectionEC, toEye, material) + czm_private_getSpecularOfMaterial(czm_moonDirectionEC, toEye, material);\nvec3 materialDiffuse = material.diffuse * 0.5;\nvec3 ambient = materialDiffuse;\nvec3 color = ambient + material.emission;\ncolor += materialDiffuse * diffuse;\ncolor += material.specular * specular;\nreturn vec4(color, material.alpha);\n}\nvec4 czm_private_phong(vec3 toEye, czm_material material)\n{\nfloat diffuse = czm_private_getLambertDiffuseOfMaterial(czm_sunDirectionEC, material);\nfloat specular = czm_private_getSpecularOfMaterial(czm_sunDirectionEC, toEye, material);\nvec3 ambient = vec3(0.0);\nvec3 color = ambient + material.emission;\ncolor += material.diffuse * diffuse;\ncolor += material.specular * specular;\nreturn vec4(color, material.alpha);\n}\n"}),define("Shaders/Builtin/Functions/planeDistance",[],function(){"use strict";return"float czm_planeDistance(vec4 plane, vec3 point) {\nreturn (dot(plane.xyz, point) + plane.w);\n}\nfloat czm_planeDistance(vec3 planeNormal, float planeDistance, vec3 point) {\nreturn (dot(planeNormal, point) + planeDistance);\n}\n"}),define("Shaders/Builtin/Functions/pointAlongRay",[],function(){"use strict";return"vec3 czm_pointAlongRay(czm_ray ray, float time)\n{\nreturn ray.origin + (time * ray.direction);\n}\n"}),define("Shaders/Builtin/Functions/rayEllipsoidIntersectionInterval",[],function(){"use strict";return"czm_raySegment czm_rayEllipsoidIntersectionInterval(czm_ray ray, czm_ellipsoid ellipsoid)\n{\nvec3 q = ellipsoid.inverseRadii * (czm_inverseModelView * vec4(ray.origin, 1.0)).xyz;\nvec3 w = ellipsoid.inverseRadii * (czm_inverseModelView * vec4(ray.direction, 0.0)).xyz;\nq = q - ellipsoid.inverseRadii * (czm_inverseModelView * vec4(ellipsoid.center, 1.0)).xyz;\nfloat q2 = dot(q, q);\nfloat qw = dot(q, w);\nif (q2 > 1.0)\n{\nif (qw >= 0.0)\n{\nreturn czm_emptyRaySegment;\n}\nelse\n{\nfloat qw2 = qw * qw;\nfloat difference = q2 - 1.0;\nfloat w2 = dot(w, w);\nfloat product = w2 * difference;\nif (qw2 < product)\n{\nreturn czm_emptyRaySegment;\n}\nelse if (qw2 > product)\n{\nfloat discriminant = qw * qw - product;\nfloat temp = -qw + sqrt(discriminant);\nfloat root0 = temp / w2;\nfloat root1 = difference / temp;\nif (root0 < root1)\n{\nczm_raySegment i = czm_raySegment(root0, root1);\nreturn i;\n}\nelse\n{\nczm_raySegment i = czm_raySegment(root1, root0);\nreturn i;\n}\n}\nelse\n{\nfloat root = sqrt(difference / w2);\nczm_raySegment i = czm_raySegment(root, root);\nreturn i;\n}\n}\n}\nelse if (q2 < 1.0)\n{\nfloat difference = q2 - 1.0;\nfloat w2 = dot(w, w);\nfloat product = w2 * difference;\nfloat discriminant = qw * qw - product;\nfloat temp = -qw + sqrt(discriminant);\nczm_raySegment i = czm_raySegment(0.0, temp / w2);\nreturn i;\n}\nelse\n{\nif (qw < 0.0)\n{\nfloat w2 = dot(w, w);\nczm_raySegment i = czm_raySegment(0.0, -qw / w2);\nreturn i;\n}\nelse\n{\nreturn czm_emptyRaySegment;\n}\n}\n}\n"}),define("Shaders/Builtin/Functions/readDepth",[],function(){"use strict";return"float czm_readDepth(sampler2D depthTexture, vec2 texCoords)\n{\nreturn czm_reverseLogDepth(texture2D(depthTexture, texCoords).r);\n}\n"}),define("Shaders/Builtin/Functions/reverseLogDepth",[],function(){"use strict";return"float czm_reverseLogDepth(float logZ)\n{\n#ifdef LOG_DEPTH\nfloat near = czm_currentFrustum.x;\nfloat far = czm_currentFrustum.y;\nlogZ = pow(2.0, logZ * czm_log2FarPlusOne) - 1.0;\nlogZ = far * (1.0 - near / logZ) / (far - near);\n#endif\nreturn logZ;\n}\n"}),define("Shaders/Builtin/Functions/RGBToHSB",[],function(){"use strict";return"const vec4 K_RGB2HSB = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\nvec3 czm_RGBToHSB(vec3 rgb)\n{\nvec4 p = mix(vec4(rgb.bg, K_RGB2HSB.wz), vec4(rgb.gb, K_RGB2HSB.xy), step(rgb.b, rgb.g));\nvec4 q = mix(vec4(p.xyw, rgb.r), vec4(rgb.r, p.yzx), step(p.x, rgb.r));\nfloat d = q.x - min(q.w, q.y);\nreturn vec3(abs(q.z + (q.w - q.y) / (6.0 * d + czm_epsilon7)), d / (q.x + czm_epsilon7), q.x);\n}\n"}),define("Shaders/Builtin/Functions/RGBToHSL",[],function(){"use strict";return"vec3 RGBtoHCV(vec3 rgb)\n{\nvec4 p = (rgb.g < rgb.b) ? vec4(rgb.bg, -1.0, 2.0 / 3.0) : vec4(rgb.gb, 0.0, -1.0 / 3.0);\nvec4 q = (rgb.r < p.x) ? vec4(p.xyw, rgb.r) : vec4(rgb.r, p.yzx);\nfloat c = q.x - min(q.w, q.y);\nfloat h = abs((q.w - q.y) / (6.0 * c + czm_epsilon7) + q.z);\nreturn vec3(h, c, q.x);\n}\nvec3 czm_RGBToHSL(vec3 rgb)\n{\nvec3 hcv = RGBtoHCV(rgb);\nfloat l = hcv.z - hcv.y * 0.5;\nfloat s = hcv.y / (1.0 - abs(l * 2.0 - 1.0) + czm_epsilon7);\nreturn vec3(hcv.x, s, l);\n}\n"});define("Shaders/Builtin/Functions/RGBToXYZ",[],function(){"use strict";return"vec3 czm_RGBToXYZ(vec3 rgb)\n{\nconst mat3 RGB2XYZ = mat3(0.4124, 0.2126, 0.0193,\n0.3576, 0.7152, 0.1192,\n0.1805, 0.0722, 0.9505);\nvec3 xyz = RGB2XYZ * rgb;\nvec3 Yxy;\nYxy.r = xyz.g;\nfloat temp = dot(vec3(1.0), xyz);\nYxy.gb = xyz.rg / temp;\nreturn Yxy;\n}\n"}),define("Shaders/Builtin/Functions/saturation",[],function(){"use strict";return"vec3 czm_saturation(vec3 rgb, float adjustment)\n{\nconst vec3 W = vec3(0.2125, 0.7154, 0.0721);\nvec3 intensity = vec3(dot(rgb, W));\nreturn mix(intensity, rgb, adjustment);\n}\n"}),define("Shaders/Builtin/Functions/shadowDepthCompare",[],function(){"use strict";return"float czm_sampleShadowMap(samplerCube shadowMap, vec3 d)\n{\nreturn czm_unpackDepth(textureCube(shadowMap, d));\n}\nfloat czm_sampleShadowMap(sampler2D shadowMap, vec2 uv)\n{\n#ifdef USE_SHADOW_DEPTH_TEXTURE\nreturn texture2D(shadowMap, uv).r;\n#else\nreturn czm_unpackDepth(texture2D(shadowMap, uv));\n#endif\n}\nfloat czm_shadowDepthCompare(samplerCube shadowMap, vec3 uv, float depth)\n{\nreturn step(depth, czm_sampleShadowMap(shadowMap, uv));\n}\nfloat czm_shadowDepthCompare(sampler2D shadowMap, vec2 uv, float depth)\n{\nreturn step(depth, czm_sampleShadowMap(shadowMap, uv));\n}\n"}),define("Shaders/Builtin/Functions/shadowVisibility",[],function(){"use strict";return"float czm_private_shadowVisibility(float visibility, float nDotL, float normalShadingSmooth, float darkness)\n{\n#ifdef USE_NORMAL_SHADING\n#ifdef USE_NORMAL_SHADING_SMOOTH\nfloat strength = clamp(nDotL / normalShadingSmooth, 0.0, 1.0);\n#else\nfloat strength = step(0.0, nDotL);\n#endif\nvisibility *= strength;\n#endif\nvisibility = max(visibility, darkness);\nreturn visibility;\n}\n#ifdef USE_CUBE_MAP_SHADOW\nfloat czm_shadowVisibility(samplerCube shadowMap, czm_shadowParameters shadowParameters)\n{\nfloat depthBias = shadowParameters.depthBias;\nfloat depth = shadowParameters.depth;\nfloat nDotL = shadowParameters.nDotL;\nfloat normalShadingSmooth = shadowParameters.normalShadingSmooth;\nfloat darkness = shadowParameters.darkness;\nvec3 uvw = shadowParameters.texCoords;\ndepth -= depthBias;\nfloat visibility = czm_shadowDepthCompare(shadowMap, uvw, depth);\nreturn czm_private_shadowVisibility(visibility, nDotL, normalShadingSmooth, darkness);\n}\n#else\nfloat czm_shadowVisibility(sampler2D shadowMap, czm_shadowParameters shadowParameters)\n{\nfloat depthBias = shadowParameters.depthBias;\nfloat depth = shadowParameters.depth;\nfloat nDotL = shadowParameters.nDotL;\nfloat normalShadingSmooth = shadowParameters.normalShadingSmooth;\nfloat darkness = shadowParameters.darkness;\nvec2 uv = shadowParameters.texCoords;\ndepth -= depthBias;\n#ifdef USE_SOFT_SHADOWS\nvec2 texelStepSize = shadowParameters.texelStepSize;\nfloat radius = 1.0;\nfloat dx0 = -texelStepSize.x * radius;\nfloat dy0 = -texelStepSize.y * radius;\nfloat dx1 = texelStepSize.x * radius;\nfloat dy1 = texelStepSize.y * radius;\nfloat visibility = (\nczm_shadowDepthCompare(shadowMap, uv, depth) +\nczm_shadowDepthCompare(shadowMap, uv + vec2(dx0, dy0), depth) +\nczm_shadowDepthCompare(shadowMap, uv + vec2(0.0, dy0), depth) +\nczm_shadowDepthCompare(shadowMap, uv + vec2(dx1, dy0), depth) +\nczm_shadowDepthCompare(shadowMap, uv + vec2(dx0, 0.0), depth) +\nczm_shadowDepthCompare(shadowMap, uv + vec2(dx1, 0.0), depth) +\nczm_shadowDepthCompare(shadowMap, uv + vec2(dx0, dy1), depth) +\nczm_shadowDepthCompare(shadowMap, uv + vec2(0.0, dy1), depth) +\nczm_shadowDepthCompare(shadowMap, uv + vec2(dx1, dy1), depth)\n) * (1.0 / 9.0);\n#else\nfloat visibility = czm_shadowDepthCompare(shadowMap, uv, depth);\n#endif\nreturn czm_private_shadowVisibility(visibility, nDotL, normalShadingSmooth, darkness);\n}\n#endif\n"}),define("Shaders/Builtin/Functions/signNotZero",[],function(){"use strict";return"float czm_signNotZero(float value)\n{\nreturn value >= 0.0 ? 1.0 : -1.0;\n}\nvec2 czm_signNotZero(vec2 value)\n{\nreturn vec2(czm_signNotZero(value.x), czm_signNotZero(value.y));\n}\nvec3 czm_signNotZero(vec3 value)\n{\nreturn vec3(czm_signNotZero(value.x), czm_signNotZero(value.y), czm_signNotZero(value.z));\n}\nvec4 czm_signNotZero(vec4 value)\n{\nreturn vec4(czm_signNotZero(value.x), czm_signNotZero(value.y), czm_signNotZero(value.z), czm_signNotZero(value.w));\n}\n"}),define("Shaders/Builtin/Functions/tangentToEyeSpaceMatrix",[],function(){"use strict";return"mat3 czm_tangentToEyeSpaceMatrix(vec3 normalEC, vec3 tangentEC, vec3 bitangentEC)\n{\nvec3 normal = normalize(normalEC);\nvec3 tangent = normalize(tangentEC);\nvec3 bitangent = normalize(bitangentEC);\nreturn mat3(tangent.x  , tangent.y  , tangent.z,\nbitangent.x, bitangent.y, bitangent.z,\nnormal.x   , normal.y   , normal.z);\n}\n"}),define("Shaders/Builtin/Functions/transformPlane",[],function(){"use strict";return"vec4 czm_transformPlane(vec4 clippingPlane, mat4 transform) {\nvec3 transformedDirection = normalize((transform * vec4(clippingPlane.xyz, 0.0)).xyz);\nvec3 transformedPosition = (transform * vec4(clippingPlane.xyz * -clippingPlane.w, 1.0)).xyz;\nvec4 transformedPlane;\ntransformedPlane.xyz = transformedDirection;\ntransformedPlane.w = -dot(transformedDirection, transformedPosition);\nreturn transformedPlane;\n}\n"}),define("Shaders/Builtin/Functions/translateRelativeToEye",[],function(){"use strict";return"vec4 czm_translateRelativeToEye(vec3 high, vec3 low)\n{\nvec3 highDifference = high - czm_encodedCameraPositionMCHigh;\nvec3 lowDifference = low - czm_encodedCameraPositionMCLow;\nreturn vec4(highDifference + lowDifference, 1.0);\n}\n"}),define("Shaders/Builtin/Functions/translucentPhong",[],function(){"use strict";return"vec4 czm_translucentPhong(vec3 toEye, czm_material material)\n{\nfloat diffuse = czm_getLambertDiffuse(vec3(0.0, 0.0, 1.0), material.normal);\nif (czm_sceneMode == czm_sceneMode3D) {\ndiffuse += czm_getLambertDiffuse(vec3(0.0, 1.0, 0.0), material.normal);\n}\ndiffuse = clamp(diffuse, 0.0, 1.0);\nfloat specular = czm_getSpecular(czm_sunDirectionEC, toEye, material.normal, material.shininess);\nspecular += czm_getSpecular(czm_moonDirectionEC, toEye, material.normal, material.shininess);\nvec3 materialDiffuse = material.diffuse * 0.5;\nvec3 ambient = materialDiffuse;\nvec3 color = ambient + material.emission;\ncolor += materialDiffuse * diffuse;\ncolor += material.specular * specular;\nreturn vec4(color, material.alpha);\n}\n"}),define("Shaders/Builtin/Functions/transpose",[],function(){"use strict";return"mat2 czm_transpose(mat2 matrix)\n{\nreturn mat2(\nmatrix[0][0], matrix[1][0],\nmatrix[0][1], matrix[1][1]);\n}\nmat3 czm_transpose(mat3 matrix)\n{\nreturn mat3(\nmatrix[0][0], matrix[1][0], matrix[2][0],\nmatrix[0][1], matrix[1][1], matrix[2][1],\nmatrix[0][2], matrix[1][2], matrix[2][2]);\n}\nmat4 czm_transpose(mat4 matrix)\n{\nreturn mat4(\nmatrix[0][0], matrix[1][0], matrix[2][0], matrix[3][0],\nmatrix[0][1], matrix[1][1], matrix[2][1], matrix[3][1],\nmatrix[0][2], matrix[1][2], matrix[2][2], matrix[3][2],\nmatrix[0][3], matrix[1][3], matrix[2][3], matrix[3][3]);\n}\n"}),define("Shaders/Builtin/Functions/unpackDepth",[],function(){"use strict";return"float czm_unpackDepth(vec4 packedDepth)\n{\nreturn dot(packedDepth, vec4(1.0, 1.0 / 255.0, 1.0 / 65025.0, 1.0 / 16581375.0));\n}\n"}),define("Shaders/Builtin/Functions/unpackFloat",[],function(){"use strict";return"#define SHIFT_RIGHT_8 0.00390625 //1.0 / 256.0\n#define SHIFT_RIGHT_16 0.00001525878 //1.0 / 65536.0\n#define SHIFT_RIGHT_24 5.960464477539063e-8//1.0 / 16777216.0\n#define BIAS 38.0\nfloat czm_unpackFloat(vec4 packedFloat)\n{\npackedFloat *= 255.0;\nfloat temp = packedFloat.w / 2.0;\nfloat exponent = floor(temp);\nfloat sign = (temp - exponent) * 2.0;\nexponent = exponent - float(BIAS);\nsign = sign * 2.0 - 1.0;\nsign = -sign;\nfloat unpacked = sign * packedFloat.x * float(SHIFT_RIGHT_8);\nunpacked += sign * packedFloat.y * float(SHIFT_RIGHT_16);\nunpacked += sign * packedFloat.z * float(SHIFT_RIGHT_24);\nreturn unpacked * pow(10.0, exponent);\n}\n"}),define("Shaders/Builtin/Functions/vertexLogDepth",[],function(){"use strict";return"#ifdef LOG_DEPTH\nvarying float v_logZ;\nvarying vec3 v_logPositionEC;\n#endif\nvoid czm_updatePositionDepth() {\n#if defined(LOG_DEPTH) && !defined(DISABLE_GL_POSITION_LOG_DEPTH)\nv_logPositionEC = (czm_inverseProjection * gl_Position).xyz;\n#ifdef ENABLE_GL_POSITION_LOG_DEPTH_AT_HEIGHT\nif (length(v_logPositionEC) < 2.0e6)\n{\nreturn;\n}\n#endif\ngl_Position.z = log2(max(1e-6, 1.0 + gl_Position.w)) * czm_log2FarDistance - 1.0;\ngl_Position.z *= gl_Position.w;\n#endif\n}\nvoid czm_vertexLogDepth()\n{\n#ifdef LOG_DEPTH\nv_logZ = 1.0 + gl_Position.w;\nczm_updatePositionDepth();\n#endif\n}\nvoid czm_vertexLogDepth(vec4 clipCoords)\n{\n#ifdef LOG_DEPTH\nv_logZ = 1.0 + clipCoords.w;\nczm_updatePositionDepth();\n#endif\n}\n"}),define("Shaders/Builtin/Functions/windowToEyeCoordinates",[],function(){"use strict";return"vec4 czm_windowToEyeCoordinates(vec4 fragmentCoordinate)\n{\nfloat x = 2.0 * (fragmentCoordinate.x - czm_viewport.x) / czm_viewport.z - 1.0;\nfloat y = 2.0 * (fragmentCoordinate.y - czm_viewport.y) / czm_viewport.w - 1.0;\nfloat z = (fragmentCoordinate.z - czm_viewportTransformation[3][2]) / czm_viewportTransformation[2][2];\nvec4 q = vec4(x, y, z, 1.0);\nq /= fragmentCoordinate.w;\nif (!(czm_inverseProjection == mat4(0.0)))\n{\nq = czm_inverseProjection * q;\n}\nelse\n{\nfloat top = czm_frustumPlanes.x;\nfloat bottom = czm_frustumPlanes.y;\nfloat left = czm_frustumPlanes.z;\nfloat right = czm_frustumPlanes.w;\nfloat near = czm_currentFrustum.x;\nfloat far = czm_currentFrustum.y;\nq.x = (q.x * (right - left) + left + right) * 0.5;\nq.y = (q.y * (top - bottom) + bottom + top) * 0.5;\nq.z = (q.z * (near - far) - near - far) * 0.5;\nq.w = 1.0;\n}\nreturn q;\n}\nvec4 czm_windowToEyeCoordinates(vec2 fragmentCoordinateXY, float depthOrLogDepth)\n{\n#ifdef LOG_DEPTH\nfloat near = czm_currentFrustum.x;\nfloat far = czm_currentFrustum.y;\nfloat unscaledDepth = pow(2.0, depthOrLogDepth * czm_log2FarPlusOne) - 1.0;\nvec4 windowCoord = vec4(fragmentCoordinateXY, far * (1.0 - near / unscaledDepth) / (far - near), 1.0);\nvec4 eyeCoordinate = czm_windowToEyeCoordinates(windowCoord);\neyeCoordinate.w = 1.0 / unscaledDepth;\n#else\nvec4 windowCoord = vec4(fragmentCoordinateXY, depthOrLogDepth, 1.0);\nvec4 eyeCoordinate = czm_windowToEyeCoordinates(windowCoord);\n#endif\nreturn eyeCoordinate;\n}\n"}),define("Shaders/Builtin/Functions/writeDepthClampedToFarPlane",[],function(){"use strict";return"#ifndef LOG_DEPTH\nvarying float v_WindowZ;\n#endif\nvoid czm_writeDepthClampedToFarPlane()\n{\n#if defined(GL_EXT_frag_depth) && !defined(LOG_DEPTH)\ngl_FragDepthEXT = min(v_WindowZ * gl_FragCoord.w, 1.0);\n#endif\n}\n"}),define("Shaders/Builtin/Functions/writeLogDepth",[],function(){"use strict";return"#ifdef LOG_DEPTH\nvarying float v_logZ;\n#endif\nvoid czm_writeLogDepth(float logZ)\n{\n#if defined(GL_EXT_frag_depth) && defined(LOG_DEPTH) && !defined(DISABLE_LOG_DEPTH_FRAGMENT_WRITE)\nfloat halfLogFarDistance = czm_log2FarDistance * 0.5;\nfloat depth = log2(logZ);\nif (depth < czm_log2NearDistance) {\ndiscard;\n}\ngl_FragDepthEXT = depth * halfLogFarDistance;\n#endif\n}\nvoid czm_writeLogDepth() {\n#ifdef LOG_DEPTH\nczm_writeLogDepth(v_logZ);\n#endif\n}\n"}),define("Shaders/Builtin/Functions/XYZToRGB",[],function(){"use strict";return"vec3 czm_XYZToRGB(vec3 Yxy)\n{\nconst mat3 XYZ2RGB = mat3( 3.2405, -0.9693,  0.0556,\n-1.5371,  1.8760, -0.2040,\n-0.4985,  0.0416,  1.0572);\nvec3 xyz;\nxyz.r = Yxy.r * Yxy.g / Yxy.b;\nxyz.g = Yxy.r;\nxyz.b = Yxy.r * (1.0 - Yxy.g - Yxy.b) / Yxy.b;\nreturn XYZ2RGB * xyz;\n}\n"}),
define("Shaders/Builtin/CzmBuiltins",["./Constants/degreesPerRadian","./Constants/depthRange","./Constants/epsilon1","./Constants/epsilon2","./Constants/epsilon3","./Constants/epsilon4","./Constants/epsilon5","./Constants/epsilon6","./Constants/epsilon7","./Constants/infinity","./Constants/oneOverPi","./Constants/oneOverTwoPi","./Constants/passCesium3DTile","./Constants/passCesium3DTileClassification","./Constants/passCesium3DTileClassificationIgnoreShow","./Constants/passClassification","./Constants/passCompute","./Constants/passEnvironment","./Constants/passGlobe","./Constants/passOpaque","./Constants/passOverlay","./Constants/passTerrainClassification","./Constants/passTranslucent","./Constants/pi","./Constants/piOverFour","./Constants/piOverSix","./Constants/piOverThree","./Constants/piOverTwo","./Constants/radiansPerDegree","./Constants/sceneMode2D","./Constants/sceneMode3D","./Constants/sceneModeColumbusView","./Constants/sceneModeMorphing","./Constants/solarRadius","./Constants/threePiOver2","./Constants/twoPi","./Constants/webMercatorMaxLatitude","./Structs/depthRangeStruct","./Structs/ellipsoid","./Structs/material","./Structs/materialInput","./Structs/ray","./Structs/raySegment","./Structs/shadowParameters","./Functions/alphaWeight","./Functions/antialias","./Functions/approximateSphericalCoordinates","./Functions/branchFreeTernary","./Functions/cascadeColor","./Functions/cascadeDistance","./Functions/cascadeMatrix","./Functions/cascadeWeights","./Functions/columbusViewMorph","./Functions/computePosition","./Functions/cosineAndSine","./Functions/decompressTextureCoordinates","./Functions/depthClampFarPlane","./Functions/eastNorthUpToEyeCoordinates","./Functions/ellipsoidContainsPoint","./Functions/ellipsoidNew","./Functions/ellipsoidWgs84TextureCoordinates","./Functions/equalsEpsilon","./Functions/eyeOffset","./Functions/eyeToWindowCoordinates","./Functions/fastApproximateAtan","./Functions/fog","./Functions/geodeticSurfaceNormal","./Functions/getDefaultMaterial","./Functions/getLambertDiffuse","./Functions/getSpecular","./Functions/getWaterNoise","./Functions/getWgs84EllipsoidEC","./Functions/HSBToRGB","./Functions/HSLToRGB","./Functions/hue","./Functions/isEmpty","./Functions/isFull","./Functions/latitudeToWebMercatorFraction","./Functions/lineDistance","./Functions/luminance","./Functions/metersPerPixel","./Functions/modelToWindowCoordinates","./Functions/multiplyWithColorBalance","./Functions/nearFarScalar","./Functions/octDecode","./Functions/packDepth","./Functions/phong","./Functions/planeDistance","./Functions/pointAlongRay","./Functions/rayEllipsoidIntersectionInterval","./Functions/readDepth","./Functions/reverseLogDepth","./Functions/RGBToHSB","./Functions/RGBToHSL","./Functions/RGBToXYZ","./Functions/saturation","./Functions/shadowDepthCompare","./Functions/shadowVisibility","./Functions/signNotZero","./Functions/tangentToEyeSpaceMatrix","./Functions/transformPlane","./Functions/translateRelativeToEye","./Functions/translucentPhong","./Functions/transpose","./Functions/unpackDepth","./Functions/unpackFloat","./Functions/vertexLogDepth","./Functions/windowToEyeCoordinates","./Functions/writeDepthClampedToFarPlane","./Functions/writeLogDepth","./Functions/XYZToRGB"],function(e,t,n,r,i,a,o,s,u,c,l,f,d,h,p,m,_,y,v,g,E,T,w,b,S,C,O,A,x,R,I,D,P,N,M,z,F,L,B,U,q,G,V,j,k,H,W,Y,X,Z,K,Q,J,$,ee,te,ne,re,ie,ae,oe,se,ue,ce,le,fe,de,he,pe,me,_e,ye,ve,ge,Ee,Te,we,be,Se,Ce,Oe,Ae,xe,Re,Ie,De,Pe,Ne,Me,ze,Fe,Le,Be,Ue,qe,Ge,Ve,je,ke,He,We,Ye,Xe,Ze,Ke,Qe,Je,$e,et,tt,nt){"use strict";return{czm_degreesPerRadian:e,czm_depthRange:t,czm_epsilon1:n,czm_epsilon2:r,czm_epsilon3:i,czm_epsilon4:a,czm_epsilon5:o,czm_epsilon6:s,czm_epsilon7:u,czm_infinity:c,czm_oneOverPi:l,czm_oneOverTwoPi:f,czm_passCesium3DTile:d,czm_passCesium3DTileClassification:h,czm_passCesium3DTileClassificationIgnoreShow:p,czm_passClassification:m,czm_passCompute:_,czm_passEnvironment:y,czm_passGlobe:v,czm_passOpaque:g,czm_passOverlay:E,czm_passTerrainClassification:T,czm_passTranslucent:w,czm_pi:b,czm_piOverFour:S,czm_piOverSix:C,czm_piOverThree:O,czm_piOverTwo:A,czm_radiansPerDegree:x,czm_sceneMode2D:R,czm_sceneMode3D:I,czm_sceneModeColumbusView:D,czm_sceneModeMorphing:P,czm_solarRadius:N,czm_threePiOver2:M,czm_twoPi:z,czm_webMercatorMaxLatitude:F,czm_depthRangeStruct:L,czm_ellipsoid:B,czm_material:U,czm_materialInput:q,czm_ray:G,czm_raySegment:V,czm_shadowParameters:j,czm_alphaWeight:k,czm_antialias:H,czm_approximateSphericalCoordinates:W,czm_branchFreeTernary:Y,czm_cascadeColor:X,czm_cascadeDistance:Z,czm_cascadeMatrix:K,czm_cascadeWeights:Q,czm_columbusViewMorph:J,czm_computePosition:$,czm_cosineAndSine:ee,czm_decompressTextureCoordinates:te,czm_depthClampFarPlane:ne,czm_eastNorthUpToEyeCoordinates:re,czm_ellipsoidContainsPoint:ie,czm_ellipsoidNew:ae,czm_ellipsoidWgs84TextureCoordinates:oe,czm_equalsEpsilon:se,czm_eyeOffset:ue,czm_eyeToWindowCoordinates:ce,czm_fastApproximateAtan:le,czm_fog:fe,czm_geodeticSurfaceNormal:de,czm_getDefaultMaterial:he,czm_getLambertDiffuse:pe,czm_getSpecular:me,czm_getWaterNoise:_e,czm_getWgs84EllipsoidEC:ye,czm_HSBToRGB:ve,czm_HSLToRGB:ge,czm_hue:Ee,czm_isEmpty:Te,czm_isFull:we,czm_latitudeToWebMercatorFraction:be,czm_lineDistance:Se,czm_luminance:Ce,czm_metersPerPixel:Oe,czm_modelToWindowCoordinates:Ae,czm_multiplyWithColorBalance:xe,czm_nearFarScalar:Re,czm_octDecode:Ie,czm_packDepth:De,czm_phong:Pe,czm_planeDistance:Ne,czm_pointAlongRay:Me,czm_rayEllipsoidIntersectionInterval:ze,czm_readDepth:Fe,czm_reverseLogDepth:Le,czm_RGBToHSB:Be,czm_RGBToHSL:Ue,czm_RGBToXYZ:qe,czm_saturation:Ge,czm_shadowDepthCompare:Ve,czm_shadowVisibility:je,czm_signNotZero:ke,czm_tangentToEyeSpaceMatrix:He,czm_transformPlane:We,czm_translateRelativeToEye:Ye,czm_translucentPhong:Xe,czm_transpose:Ze,czm_unpackDepth:Ke,czm_unpackFloat:Qe,czm_vertexLogDepth:Je,czm_windowToEyeCoordinates:$e,czm_writeDepthClampedToFarPlane:et,czm_writeLogDepth:tt,czm_XYZToRGB:nt}}),define("Renderer/ShaderSource",["../Core/defaultValue","../Core/defined","../Core/DeveloperError","../Renderer/modernizeShader","../Shaders/Builtin/CzmBuiltins","./AutomaticUniforms"],function(e,t,n,r,i,a){"use strict";function o(e){return e=e.replace(/\/\/.*/g,""),e.replace(/\/\*\*[\s\S]*?\*\//gm,function(e){for(var t=e.match(/\n/gm).length,n="",r=0;r<t;++r)n+="\n";return n})}function s(e,n,r){for(var i,a=0;a<r.length;++a)r[a].name===e&&(i=r[a]);return t(i)||(n=o(n),i={name:e,glslSource:n,dependsOn:[],requiredBy:[],evaluated:!1},r.push(i)),i}function u(e,n){if(!e.evaluated){e.evaluated=!0;var r=e.glslSource.match(/\bczm_[a-zA-Z0-9_]*/g);t(r)&&null!==r&&(r=r.filter(function(e,t){return r.indexOf(e)===t}),r.forEach(function(t){if(t!==e.name&&d._czmBuiltinsAndUniforms.hasOwnProperty(t)){var r=s(t,d._czmBuiltinsAndUniforms[t],n);e.dependsOn.push(r),r.requiredBy.push(e),u(r,n)}}))}}function c(e){for(var t=[],r=[];e.length>0;){var i=e.pop();r.push(i),0===i.requiredBy.length&&t.push(i)}for(;t.length>0;){var a=t.shift();e.push(a);for(var o=0;o<a.dependsOn.length;++o){var s=a.dependsOn[o],u=s.requiredBy.indexOf(a);s.requiredBy.splice(u,1),0===s.requiredBy.length&&t.push(s)}}for(var c=[],l=0;l<r.length;++l)0!==r[l].requiredBy.length&&c.push(r[l]);if(0!==c.length){for(var f="A circular dependency was found in the following built-in functions/structs/constants: \n",d=0;d<c.length;++d)f=f+c[d].name+"\n";throw new n(f)}}function l(e){var t=[],n=s("main",e,t);u(n,t),c(t);for(var r="",i=t.length-1;i>=0;--i)r=r+t[i].glslSource+"\n";return r.replace(n.glslSource,"")}function f(e,i,a){var s,u,c="",f=e.sources;if(t(f))for(s=0,u=f.length;s<u;++s)c+="\n#line 0\n"+f[s];c=o(c);var h;c=c.replace(/#version\s+(.*?)\n/gm,function(e,r){if(t(h)&&h!==r)throw new n("inconsistent versions found: "+h+" and "+r);return h=r,"\n"});var p=[];c=c.replace(/#extension.*\n/gm,function(e){return p.push(e),"\n"}),c=c.replace(/precision\s(lowp|mediump|highp)\s(float|int);/,"");var m=e.pickColorQualifier;t(m)&&(c=d.createPickFragmentShaderSource(c,m));var _="";t(h)&&(_="#version "+h+"\n");var y=p.length;for(s=0;s<y;s++)_+=p[s];i&&(_+="#ifdef GL_FRAGMENT_PRECISION_HIGH\n    precision highp float;\n#else\n    precision mediump float;\n#endif\n\n");var v=e.defines;if(t(v))for(s=0,u=v.length;s<u;++s){var g=v[s];0!==g.length&&(_+="#define "+g+"\n")}return a.webgl2&&(_+="#define OUTPUT_DECLARATION\n\n"),e.includeBuiltIns&&(_+=l(c)),_+="\n#line 0\n",_+=c,a.webgl2&&(_=r(_,i,!0)),_}function d(r){r=e(r,e.EMPTY_OBJECT);var i=r.pickColorQualifier;if(t(i)&&"uniform"!==i&&"varying"!==i)throw new n("options.pickColorQualifier must be 'uniform' or 'varying'.");this.defines=t(r.defines)?r.defines.slice(0):[],this.sources=t(r.sources)?r.sources.slice(0):[],this.pickColorQualifier=i,this.includeBuiltIns=e(r.includeBuiltIns,!0)}d.prototype.clone=function(){return new d({sources:this.sources,defines:this.defines,pickColorQualifier:this.pickColorQualifier,includeBuiltIns:this.includeBuiltIns})},d.replaceMain=function(e,t){return t="void "+t+"()",e.replace(/void\s+main\s*\(\s*(?:void)?\s*\)/g,t)},d.prototype.createCombinedVertexShader=function(e){return f(this,!1,e)},d.prototype.createCombinedFragmentShader=function(e){return f(this,!0,e)},d._czmBuiltinsAndUniforms={};for(var h in i)i.hasOwnProperty(h)&&(d._czmBuiltinsAndUniforms[h]=i[h]);for(var p in a)if(a.hasOwnProperty(p)){var m=a[p];"function"==typeof m.getDeclaration&&(d._czmBuiltinsAndUniforms[p]=m.getDeclaration(p))}d.createPickVertexShaderSource=function(e){return d.replaceMain(e,"czm_old_main")+"\nattribute vec4 pickColor; \nvarying vec4 czm_pickColor; \nvoid main() \n{ \n    czm_old_main(); \n    czm_pickColor = pickColor; \n}"},d.createPickFragmentShaderSource=function(e,t){return d.replaceMain(e,"czm_old_main")+"\n"+t+" vec4 czm_pickColor; \nvoid main() \n{ \n    czm_old_main(); \n    if (gl_FragColor.a == 0.0) { \n       discard; \n    } \n    gl_FragColor = czm_pickColor; \n}"},d.findVarying=function(e,t){for(var n=e.sources,r=t.length,i=0;i<r;++i)for(var a=t[i],o=n.length,s=0;s<o;++s)if(-1!==n[s].indexOf(a))return a};var _=["v_normalEC","v_normal"];d.findNormalVarying=function(e){return d.findVarying(e,_)};var y=["v_positionEC"];return d.findPositionVarying=function(e){return d.findVarying(e,y)},d}),define("Scene/BlendEquation",["../Core/freezeObject","../Core/WebGLConstants"],function(e,t){"use strict";return e({ADD:t.FUNC_ADD,SUBTRACT:t.FUNC_SUBTRACT,REVERSE_SUBTRACT:t.FUNC_REVERSE_SUBTRACT,MIN:t.MIN,MAX:t.MAX})}),define("Scene/BlendFunction",["../Core/freezeObject","../Core/WebGLConstants"],function(e,t){"use strict";return e({ZERO:t.ZERO,ONE:t.ONE,SOURCE_COLOR:t.SRC_COLOR,ONE_MINUS_SOURCE_COLOR:t.ONE_MINUS_SRC_COLOR,DESTINATION_COLOR:t.DST_COLOR,ONE_MINUS_DESTINATION_COLOR:t.ONE_MINUS_DST_COLOR,SOURCE_ALPHA:t.SRC_ALPHA,ONE_MINUS_SOURCE_ALPHA:t.ONE_MINUS_SRC_ALPHA,DESTINATION_ALPHA:t.DST_ALPHA,ONE_MINUS_DESTINATION_ALPHA:t.ONE_MINUS_DST_ALPHA,CONSTANT_COLOR:t.CONSTANT_COLOR,ONE_MINUS_CONSTANT_COLOR:t.ONE_MINUS_CONSTANT_ALPHA,CONSTANT_ALPHA:t.CONSTANT_ALPHA,ONE_MINUS_CONSTANT_ALPHA:t.ONE_MINUS_CONSTANT_ALPHA,SOURCE_ALPHA_SATURATE:t.SRC_ALPHA_SATURATE})}),define("Scene/BlendingState",["../Core/freezeObject","./BlendEquation","./BlendFunction"],function(e,t,n){"use strict";return e({DISABLED:e({enabled:!1}),ALPHA_BLEND:e({enabled:!0,equationRgb:t.ADD,equationAlpha:t.ADD,functionSourceRgb:n.SOURCE_ALPHA,functionSourceAlpha:n.SOURCE_ALPHA,functionDestinationRgb:n.ONE_MINUS_SOURCE_ALPHA,functionDestinationAlpha:n.ONE_MINUS_SOURCE_ALPHA}),PRE_MULTIPLIED_ALPHA_BLEND:e({enabled:!0,equationRgb:t.ADD,equationAlpha:t.ADD,functionSourceRgb:n.ONE,functionSourceAlpha:n.ONE,functionDestinationRgb:n.ONE_MINUS_SOURCE_ALPHA,functionDestinationAlpha:n.ONE_MINUS_SOURCE_ALPHA}),ADDITIVE_BLEND:e({enabled:!0,equationRgb:t.ADD,equationAlpha:t.ADD,functionSourceRgb:n.SOURCE_ALPHA,functionSourceAlpha:n.SOURCE_ALPHA,functionDestinationRgb:n.ONE,functionDestinationAlpha:n.ONE})})}),define("Scene/CullFace",["../Core/freezeObject","../Core/WebGLConstants"],function(e,t){"use strict";return e({FRONT:t.FRONT,BACK:t.BACK,FRONT_AND_BACK:t.FRONT_AND_BACK})}),define("Core/VertexFormat",["./defaultValue","./defined","./DeveloperError","./freezeObject"],function(e,t,n,r){"use strict";function i(t){t=e(t,e.EMPTY_OBJECT),this.position=e(t.position,!1),this.normal=e(t.normal,!1),this.st=e(t.st,!1),this.bitangent=e(t.bitangent,!1),this.tangent=e(t.tangent,!1),this.color=e(t.color,!1)}return i.POSITION_ONLY=r(new i({position:!0})),i.POSITION_AND_NORMAL=r(new i({position:!0,normal:!0})),i.POSITION_NORMAL_AND_ST=r(new i({position:!0,normal:!0,st:!0})),i.POSITION_AND_ST=r(new i({position:!0,st:!0})),i.POSITION_AND_COLOR=r(new i({position:!0,color:!0})),i.ALL=r(new i({position:!0,normal:!0,st:!0,tangent:!0,bitangent:!0})),i.DEFAULT=i.POSITION_NORMAL_AND_ST,i.packedLength=6,i.pack=function(r,i,a){if(!t(r))throw new n("value is required");if(!t(i))throw new n("array is required");return a=e(a,0),i[a++]=r.position?1:0,i[a++]=r.normal?1:0,i[a++]=r.st?1:0,i[a++]=r.tangent?1:0,i[a++]=r.bitangent?1:0,i[a]=r.color?1:0,i},i.unpack=function(r,a,o){if(!t(r))throw new n("array is required");return a=e(a,0),t(o)||(o=new i),o.position=1===r[a++],o.normal=1===r[a++],o.st=1===r[a++],o.tangent=1===r[a++],o.bitangent=1===r[a++],o.color=1===r[a],o},i.clone=function(e,n){if(t(e))return t(n)||(n=new i),n.position=e.position,n.normal=e.normal,n.st=e.st,n.tangent=e.tangent,n.bitangent=e.bitangent,n.color=e.color,n},i}),define("Shaders/Appearances/PerInstanceFlatColorAppearanceFS",[],function(){"use strict";return"varying vec4 v_color;\nvoid main()\n{\ngl_FragColor = v_color;\n}\n"}),define("Shaders/Appearances/PolylineColorAppearanceVS",[],function(){"use strict";return"attribute vec3 position3DHigh;\nattribute vec3 position3DLow;\nattribute vec3 prevPosition3DHigh;\nattribute vec3 prevPosition3DLow;\nattribute vec3 nextPosition3DHigh;\nattribute vec3 nextPosition3DLow;\nattribute vec2 expandAndWidth;\nattribute vec4 color;\nattribute float batchId;\nvarying vec4 v_color;\nvoid main()\n{\nfloat expandDir = expandAndWidth.x;\nfloat width = abs(expandAndWidth.y) + 0.5;\nbool usePrev = expandAndWidth.y < 0.0;\nvec4 p = czm_computePosition();\nvec4 prev = czm_computePrevPosition();\nvec4 next = czm_computeNextPosition();\nv_color = color;\nfloat angle;\nvec4 positionWC = getPolylineWindowCoordinates(p, prev, next, expandDir, width, usePrev, angle);\ngl_Position = czm_viewportOrthographic * positionWC;\n#ifdef LOG_DEPTH\nczm_vertexLogDepth(czm_modelViewProjectionRelativeToEye * p);\n#endif\n}\n"}),define("Shaders/PolylineCommon",[],function(){"use strict";return"void clipLineSegmentToNearPlane(\nvec3 p0,\nvec3 p1,\nout vec4 positionWC,\nout bool clipped,\nout bool culledByNearPlane)\n{\nculledByNearPlane = false;\nclipped = false;\nvec3 p1ToP0 = p1 - p0;\nfloat magnitude = length(p1ToP0);\nvec3 direction = normalize(p1ToP0);\nfloat endPoint0Distance =  -(czm_currentFrustum.x + p0.z);\nfloat denominator = -direction.z;\nif (endPoint0Distance < 0.0 && abs(denominator) < czm_epsilon7)\n{\nculledByNearPlane = true;\n}\nelse if (endPoint0Distance < 0.0 && abs(denominator) > czm_epsilon7)\n{\nfloat t = (czm_currentFrustum.x + p0.z) / denominator;\nif (t < 0.0 || t > magnitude)\n{\nculledByNearPlane = true;\n}\nelse\n{\np0 = p0 + t * direction;\nclipped = true;\n}\n}\npositionWC = czm_eyeToWindowCoordinates(vec4(p0, 1.0));\n}\nvec4 getPolylineWindowCoordinatesEC(vec4 positionEC, vec4 prevEC, vec4 nextEC, float expandDirection, float width, bool usePrevious, out float angle)\n{\nvec4 endPointWC, p0, p1;\nbool culledByNearPlane, clipped;\n#ifdef POLYLINE_DASH\nvec4 positionWindow = czm_eyeToWindowCoordinates(positionEC);\nvec4 previousWindow = czm_eyeToWindowCoordinates(prevEC);\nvec4 nextWindow = czm_eyeToWindowCoordinates(nextEC);\nvec2 lineDir;\nif (usePrevious) {\nlineDir = normalize(positionWindow.xy - previousWindow.xy);\n}\nelse {\nlineDir = normalize(nextWindow.xy - positionWindow.xy);\n}\nangle = atan(lineDir.x, lineDir.y) - 1.570796327;\nangle = floor(angle / czm_piOverFour + 0.5) * czm_piOverFour;\n#endif\nclipLineSegmentToNearPlane(prevEC.xyz, positionEC.xyz, p0, clipped, culledByNearPlane);\nclipLineSegmentToNearPlane(nextEC.xyz, positionEC.xyz, p1, clipped, culledByNearPlane);\nclipLineSegmentToNearPlane(positionEC.xyz, usePrevious ? prevEC.xyz : nextEC.xyz, endPointWC, clipped, culledByNearPlane);\nif (culledByNearPlane)\n{\nreturn vec4(0.0, 0.0, 0.0, 1.0);\n}\nvec2 prevWC = normalize(p0.xy - endPointWC.xy);\nvec2 nextWC = normalize(p1.xy - endPointWC.xy);\nfloat expandWidth = width * 0.5;\nvec2 direction;\nif (czm_equalsEpsilon(prevEC.xyz - positionEC.xyz, vec3(0.0), czm_epsilon1) || czm_equalsEpsilon(prevWC, -nextWC, czm_epsilon1))\n{\ndirection = vec2(-nextWC.y, nextWC.x);\n}\nelse if (czm_equalsEpsilon(nextEC.xyz - positionEC.xyz, vec3(0.0), czm_epsilon1) || clipped)\n{\ndirection = vec2(prevWC.y, -prevWC.x);\n}\nelse\n{\nvec2 normal = vec2(-nextWC.y, nextWC.x);\ndirection = normalize((nextWC + prevWC) * 0.5);\nif (dot(direction, normal) < 0.0)\n{\ndirection = -direction;\n}\nfloat sinAngle = abs(direction.x * nextWC.y - direction.y * nextWC.x);\nexpandWidth = clamp(expandWidth / sinAngle, 0.0, width * 2.0);\n}\nvec2 offset = direction * expandDirection * expandWidth * czm_resolutionScale;\nreturn vec4(endPointWC.xy + offset, -endPointWC.z, 1.0);\n}\nvec4 getPolylineWindowCoordinates(vec4 position, vec4 previous, vec4 next, float expandDirection, float width, bool usePrevious, out float angle)\n{\nvec4 positionEC = czm_modelViewRelativeToEye * position;\nvec4 prevEC = czm_modelViewRelativeToEye * previous;\nvec4 nextEC = czm_modelViewRelativeToEye * next;\nreturn getPolylineWindowCoordinatesEC(positionEC, prevEC, nextEC, expandDirection, width, usePrevious, angle);\n}\n"}),define("Scene/Appearance",["../Core/clone","../Core/combine","../Core/defaultValue","../Core/defined","../Core/defineProperties","./BlendingState","./CullFace"],function(e,t,n,r,i,a,o){"use strict";function s(e){e=n(e,n.EMPTY_OBJECT),this.material=e.material,this.translucent=n(e.translucent,!0),this._vertexShaderSource=e.vertexShaderSource,this._fragmentShaderSource=e.fragmentShaderSource,this._renderState=e.renderState,this._closed=n(e.closed,!1)}return i(s.prototype,{vertexShaderSource:{get:function(){return this._vertexShaderSource}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},renderState:{get:function(){return this._renderState}},closed:{get:function(){return this._closed}}}),s.prototype.getFragmentShaderSource=function(){var e=[];return this.flat&&e.push("#define FLAT"),this.faceForward&&e.push("#define FACE_FORWARD"),r(this.material)&&e.push(this.material.shaderSource),e.push(this.fragmentShaderSource),e.join("\n")},s.prototype.isTranslucent=function(){return r(this.material)&&this.material.isTranslucent()||!r(this.material)&&this.translucent},s.prototype.getRenderState=function(){var t=this.isTranslucent(),n=e(this.renderState,!1);return t?(n.depthMask=!1,n.blending=a.ALPHA_BLEND):n.depthMask=!0,n},s.getDefaultRenderState=function(e,n,i){var s={depthTest:{enabled:!0}};return e&&(s.depthMask=!1,s.blending=a.ALPHA_BLEND),n&&(s.cull={enabled:!0,face:o.BACK}),r(i)&&(s=t(i,s,!0)),s},s}),define("Scene/PolylineColorAppearance",["../Core/defaultValue","../Core/defineProperties","../Core/VertexFormat","../Shaders/Appearances/PerInstanceFlatColorAppearanceFS","../Shaders/Appearances/PolylineColorAppearanceVS","../Shaders/PolylineCommon","./Appearance"],function(e,t,n,r,i,a,o){"use strict";function s(t){t=e(t,e.EMPTY_OBJECT);var n=e(t.translucent,!0),r=s.VERTEX_FORMAT;this.material=void 0,this.translucent=n,this._vertexShaderSource=e(t.vertexShaderSource,u),this._fragmentShaderSource=e(t.fragmentShaderSource,c),this._renderState=o.getDefaultRenderState(n,!1,t.renderState),this._closed=!1,this._vertexFormat=r}var u=a+"\n"+i,c=r;return t(s.prototype,{vertexShaderSource:{get:function(){return this._vertexShaderSource}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},renderState:{get:function(){return this._renderState}},closed:{get:function(){return this._closed}},vertexFormat:{get:function(){return this._vertexFormat}}}),s.VERTEX_FORMAT=n.POSITION_ONLY,s.prototype.getFragmentShaderSource=o.prototype.getFragmentShaderSource,s.prototype.isTranslucent=o.prototype.isTranslucent,s.prototype.getRenderState=o.prototype.getRenderState,s}),define("Shaders/Appearances/PolylineMaterialAppearanceVS",[],function(){"use strict";return"attribute vec3 position3DHigh;\nattribute vec3 position3DLow;\nattribute vec3 prevPosition3DHigh;\nattribute vec3 prevPosition3DLow;\nattribute vec3 nextPosition3DHigh;\nattribute vec3 nextPosition3DLow;\nattribute vec2 expandAndWidth;\nattribute vec2 st;\nattribute float batchId;\nvarying float v_width;\nvarying vec2 v_st;\nvarying float v_polylineAngle;\nvoid main()\n{\nfloat expandDir = expandAndWidth.x;\nfloat width = abs(expandAndWidth.y) + 0.5;\nbool usePrev = expandAndWidth.y < 0.0;\nvec4 p = czm_computePosition();\nvec4 prev = czm_computePrevPosition();\nvec4 next = czm_computeNextPosition();\nv_width = width;\nv_st = st;\nvec4 positionWC = getPolylineWindowCoordinates(p, prev, next, expandDir, width, usePrev, v_polylineAngle);\ngl_Position = czm_viewportOrthographic * positionWC;\n#ifdef LOG_DEPTH\nczm_vertexLogDepth(czm_modelViewProjectionRelativeToEye * p);\n#endif\n}\n"}),define("Shaders/PolylineFS",[],function(){"use strict";return"#ifdef VECTOR_TILE\nuniform vec4 u_highlightColor;\n#endif\nvarying vec2 v_st;\nvoid main()\n{\nczm_materialInput materialInput;\nmaterialInput.s = v_st.s;\nmaterialInput.st = v_st;\nmaterialInput.str = vec3(v_st, 0.0);\nczm_material material = czm_getMaterial(materialInput);\ngl_FragColor = vec4(material.diffuse + material.emission, material.alpha);\n#ifdef VECTOR_TILE\ngl_FragColor *= u_highlightColor;\n#endif\nczm_writeLogDepth();\n}\n"}),define("Core/createGuid",[],function(){"use strict";function e(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})}return e}),define("Core/CompressedTextureBuffer",["./defined","./defineProperties"],function(e,t){"use strict";function n(e,t,n,r){this._format=e,this._width=t,this._height=n,this._buffer=r}return t(n.prototype,{internalFormat:{get:function(){return this._format}},width:{get:function(){return this._width}},height:{get:function(){return this._height}},bufferView:{get:function(){return this._buffer}}}),n.clone=function(t){if(e(t))return new n(t._format,t._width,t._height,t._buffer)},n.prototype.clone=function(){return n.clone(this)},n}),define("Core/TaskProcessor",["../ThirdParty/when","./buildModuleUrl","./defaultValue","./defined","./destroyObject","./DeveloperError","./Event","./FeatureDetection","./getAbsoluteUri","./isCrossOriginUrl","./Resource","./RuntimeError","require"],function(e,t,n,r,i,a,o,s,u,c,l,f,d){"use strict";function h(){if(!r(g._canTransferArrayBuffer)){var t=new Worker(m("Workers/transferTypedArrayTest.js"));t.postMessage=n(t.webkitPostMessage,t.postMessage);var i=new Int8Array([99]);try{t.postMessage({array:i},[i.buffer])}catch(e){return g._canTransferArrayBuffer=!1,g._canTransferArrayBuffer}var a=e.defer();t.onmessage=function(e){var n=e.data.array,i=r(n)&&99===n[0];a.resolve(i),t.terminate(),g._canTransferArrayBuffer=i},g._canTransferArrayBuffer=a.promise}return g._canTransferArrayBuffer}function p(e,t){--e._activeTasks;var n=t.id;if(r(n)){var i=e._deferreds,o=i[n];if(r(t.error)){var s=t.error;"RuntimeError"===s.name?(s=new f(t.error.message),s.stack=t.error.stack):"DeveloperError"===s.name&&(s=new a(t.error.message),s.stack=t.error.stack),T.raiseEvent(s),o.reject(s)}else T.raiseEvent(),o.resolve(t.result);delete i[n]}}function m(e){var n=t(e);if(c(n)){var r,i='importScripts("'+n+'");';try{r=new Blob([i],{type:"application/javascript"})}catch(e){var a=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder,o=new a;o.append(i),r=o.getBlob("application/javascript")}n=(window.URL||window.webkitURL).createObjectURL(r)}return n}function _(){return r(E)||(E=m("Workers/cesiumWorkerBootstrapper.js")),E}function y(e){var i=new Worker(_());i.postMessage=n(i.webkitPostMessage,i.postMessage);var a={loaderConfig:{},workerModule:g._workerModulePrefix+e._workerName};return r(g._loaderConfig)?a.loaderConfig=g._loaderConfig:(r(define.amd)&&!define.amd.toUrlUndefined&&r(d.toUrl)||(a.loaderConfig.paths={Workers:t("Workers")}),a.loaderConfig.baseUrl=t.getCesiumBaseUrl().url),i.postMessage(a),i.onmessage=function(t){p(e,t.data)},i}function v(n,i){var a={modulePath:void 0,wasmBinaryFile:void 0,wasmBinary:void 0};if(!s.supportsWebAssembly()){if(!r(i.fallbackModulePath))throw new f("This browser does not support Web Assembly, and no backup module was provided for "+n._workerName);return a.modulePath=t(i.fallbackModulePath),e.resolve(a)}return a.modulePath=t(i.modulePath),a.wasmBinaryFile=t(i.wasmBinaryFile),l.fetchArrayBuffer({url:a.wasmBinaryFile}).then(function(e){return a.wasmBinary=e,a})}function g(e,t){this._workerName=e,this._maximumActiveTasks=n(t,5),this._activeTasks=0,this._deferreds={},this._nextID=0}var E,T=new o,w=[];return g.prototype.scheduleTask=function(t,n){if(r(this._worker)||(this._worker=y(this)),!(this._activeTasks>=this._maximumActiveTasks)){++this._activeTasks;var i=this;return e(h(),function(a){r(n)?a||(n.length=0):n=w;var o=i._nextID++,s=e.defer();return i._deferreds[o]=s,i._worker.postMessage({id:o,parameters:t,canTransferArrayBuffer:a},n),s.promise})}},g.prototype.initWebAssemblyModule=function(t){r(this._worker)||(this._worker=y(this));var n=e.defer(),i=this,a=this._worker;return v(this,t).then(function(t){return e(h(),function(e){var o,s=t.wasmBinary;r(s)&&e&&(o=[s]),a.onmessage=function(e){a.onmessage=function(e){p(i,e.data)},n.resolve(e.data)},a.postMessage({webAssemblyConfig:t},o)})}),n},g.prototype.isDestroyed=function(){return!1},g.prototype.destroy=function(){return r(this._worker)&&this._worker.terminate(),i(this)},g.taskCompletedEvent=T,g._defaultWorkerModulePrefix="Workers/",g._workerModulePrefix=g._defaultWorkerModulePrefix,g._loaderConfig=void 0,g._canTransferArrayBuffer=void 0,g}),define("Core/loadCRN",["../ThirdParty/when","./CompressedTextureBuffer","./defined","./DeveloperError","./Resource","./TaskProcessor"],function(e,t,n,r,i,a){"use strict";function o(a){if(!n(a))throw new r("resourceOrUrlOrBuffer is required.");var o;if(a instanceof ArrayBuffer||ArrayBuffer.isView(a))o=e.resolve(a);else{o=i.createIfNeeded(a).fetchArrayBuffer()}if(n(o))return o.then(function(e){if(n(e)){var t=[];return e instanceof ArrayBuffer?t.push(e):0===e.byteOffset&&e.byteLength===e.buffer.byteLength?t.push(e.buffer):(e=e.slice(0,e.length),t.push(e.buffer)),s.scheduleTask(e,t)}}).then(function(e){return t.clone(e)})}var s=new a("transcodeCRNToDXT",Number.POSITIVE_INFINITY);return o}),define("Renderer/PixelDatatype",["../Core/freezeObject","../Core/WebGLConstants"],function(e,t){"use strict";var n={UNSIGNED_BYTE:t.UNSIGNED_BYTE,UNSIGNED_SHORT:t.UNSIGNED_SHORT,UNSIGNED_INT:t.UNSIGNED_INT,FLOAT:t.FLOAT,HALF_FLOAT:t.HALF_FLOAT_OES,UNSIGNED_INT_24_8:t.UNSIGNED_INT_24_8,UNSIGNED_SHORT_4_4_4_4:t.UNSIGNED_SHORT_4_4_4_4,UNSIGNED_SHORT_5_5_5_1:t.UNSIGNED_SHORT_5_5_5_1,UNSIGNED_SHORT_5_6_5:t.UNSIGNED_SHORT_5_6_5,isPacked:function(e){return e===n.UNSIGNED_INT_24_8||e===n.UNSIGNED_SHORT_4_4_4_4||e===n.UNSIGNED_SHORT_5_5_5_1||e===n.UNSIGNED_SHORT_5_6_5},sizeInBytes:function(e){switch(e){case n.UNSIGNED_BYTE:return 1;case n.UNSIGNED_SHORT:case n.UNSIGNED_SHORT_4_4_4_4:case n.UNSIGNED_SHORT_5_5_5_1:case n.UNSIGNED_SHORT_5_6_5:case n.HALF_FLOAT:return 2;case n.UNSIGNED_INT:case n.FLOAT:case n.UNSIGNED_INT_24_8:return 4}},validate:function(e){return e===n.UNSIGNED_BYTE||e===n.UNSIGNED_SHORT||e===n.UNSIGNED_INT||e===n.FLOAT||e===n.HALF_FLOAT||e===n.UNSIGNED_INT_24_8||e===n.UNSIGNED_SHORT_4_4_4_4||e===n.UNSIGNED_SHORT_5_5_5_1||e===n.UNSIGNED_SHORT_5_6_5}};return e(n)}),define("Core/PixelFormat",["../Renderer/PixelDatatype","./freezeObject","./WebGLConstants"],function(e,t,n){"use strict";var r={DEPTH_COMPONENT:n.DEPTH_COMPONENT,DEPTH_STENCIL:n.DEPTH_STENCIL,ALPHA:n.ALPHA,RGB:n.RGB,RGBA:n.RGBA,LUMINANCE:n.LUMINANCE,LUMINANCE_ALPHA:n.LUMINANCE_ALPHA,RGB_DXT1:n.COMPRESSED_RGB_S3TC_DXT1_EXT,RGBA_DXT1:n.COMPRESSED_RGBA_S3TC_DXT1_EXT,RGBA_DXT3:n.COMPRESSED_RGBA_S3TC_DXT3_EXT,RGBA_DXT5:n.COMPRESSED_RGBA_S3TC_DXT5_EXT,RGB_PVRTC_4BPPV1:n.COMPRESSED_RGB_PVRTC_4BPPV1_IMG,RGB_PVRTC_2BPPV1:n.COMPRESSED_RGB_PVRTC_2BPPV1_IMG,RGBA_PVRTC_4BPPV1:n.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG,RGBA_PVRTC_2BPPV1:n.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG,RGB_ETC1:n.COMPRESSED_RGB_ETC1_WEBGL,componentsLength:function(e){switch(e){case r.RGB:return 3;case r.RGBA:return 4;case r.LUMINANCE_ALPHA:return 2;case r.ALPHA:case r.LUMINANCE:default:return 1}},validate:function(e){return e===r.DEPTH_COMPONENT||e===r.DEPTH_STENCIL||e===r.ALPHA||e===r.RGB||e===r.RGBA||e===r.LUMINANCE||e===r.LUMINANCE_ALPHA||e===r.RGB_DXT1||e===r.RGBA_DXT1||e===r.RGBA_DXT3||e===r.RGBA_DXT5||e===r.RGB_PVRTC_4BPPV1||e===r.RGB_PVRTC_2BPPV1||e===r.RGBA_PVRTC_4BPPV1||e===r.RGBA_PVRTC_2BPPV1||e===r.RGB_ETC1},isColorFormat:function(e){return e===r.ALPHA||e===r.RGB||e===r.RGBA||e===r.LUMINANCE||e===r.LUMINANCE_ALPHA},isDepthFormat:function(e){return e===r.DEPTH_COMPONENT||e===r.DEPTH_STENCIL},isCompressedFormat:function(e){return e===r.RGB_DXT1||e===r.RGBA_DXT1||e===r.RGBA_DXT3||e===r.RGBA_DXT5||e===r.RGB_PVRTC_4BPPV1||e===r.RGB_PVRTC_2BPPV1||e===r.RGBA_PVRTC_4BPPV1||e===r.RGBA_PVRTC_2BPPV1||e===r.RGB_ETC1},isDXTFormat:function(e){return e===r.RGB_DXT1||e===r.RGBA_DXT1||e===r.RGBA_DXT3||e===r.RGBA_DXT5},isPVRTCFormat:function(e){return e===r.RGB_PVRTC_4BPPV1||e===r.RGB_PVRTC_2BPPV1||e===r.RGBA_PVRTC_4BPPV1||e===r.RGBA_PVRTC_2BPPV1},isETC1Format:function(e){return e===r.RGB_ETC1},compressedTextureSizeInBytes:function(e,t,n){switch(e){case r.RGB_DXT1:case r.RGBA_DXT1:case r.RGB_ETC1:return Math.floor((t+3)/4)*Math.floor((n+3)/4)*8;case r.RGBA_DXT3:case r.RGBA_DXT5:return Math.floor((t+3)/4)*Math.floor((n+3)/4)*16;case r.RGB_PVRTC_4BPPV1:case r.RGBA_PVRTC_4BPPV1:return Math.floor((Math.max(t,8)*Math.max(n,8)*4+7)/8);case r.RGB_PVRTC_2BPPV1:case r.RGBA_PVRTC_2BPPV1:return Math.floor((Math.max(t,16)*Math.max(n,8)*2+7)/8);default:return 0}},textureSizeInBytes:function(t,n,i,a){var o=r.componentsLength(t);return e.isPacked(n)&&(o=1),o*e.sizeInBytes(n)*i*a},createTypedArray:function(t,n,i,a){var o=e.sizeInBytes(n);return new(o===Uint8Array.BYTES_PER_ELEMENT?Uint8Array:o===Uint16Array.BYTES_PER_ELEMENT?Uint16Array:o===Float32Array.BYTES_PER_ELEMENT&&n===e.FLOAT?Float32Array:Uint32Array)(r.componentsLength(t)*i*a)},flipY:function(e,t,n,i,a){if(1===a)return e;for(var o=r.createTypedArray(t,n,i,a),s=r.componentsLength(t),u=i*s,c=0;c<a;++c)for(var l=c*a*s,f=(a-c-1)*a*s,d=0;d<u;++d)o[f+d]=e[l+d];return o}};return t(r)}),define("Core/loadKTX",["../ThirdParty/when","./Check","./CompressedTextureBuffer","./defined","./PixelFormat","./Resource","./RuntimeError"],function(e,t,n,r,i,a,o){"use strict";function s(n){t.defined("resourceOrUrlOrBuffer",n);var i;if(n instanceof ArrayBuffer||ArrayBuffer.isView(n))i=e.resolve(n);else{i=a.createIfNeeded(n).fetchArrayBuffer()}if(r(i))return i.then(function(e){if(r(e))return u(e)})}function u(e){for(var t=new Uint8Array(e),a=!0,s=0;s<c.length;++s)if(c[s]!==t[s]){a=!1;break}if(!a)throw new o("Invalid KTX file.");var u,d;r(e.buffer)?(u=new DataView(e.buffer),d=e.byteOffset):(u=new DataView(e),d=0),d+=12;var h=u.getUint32(d,!0);if(d+=f,h!==l)throw new o("File is the wrong endianness.");var p=u.getUint32(d,!0);d+=f;var m=u.getUint32(d,!0);d+=f;var _=u.getUint32(d,!0);d+=f;var y=u.getUint32(d,!0);d+=f;var v=u.getUint32(d,!0);d+=f;var g=u.getUint32(d,!0);d+=f;var E=u.getUint32(d,!0);d+=f;var T=u.getUint32(d,!0);d+=f;var w=u.getUint32(d,!0);d+=f;var b=u.getUint32(d,!0);d+=f;var S=u.getUint32(d,!0);d+=f;var C=u.getUint32(d,!0);d+=f,d+=C
;var O=u.getUint32(d,!0);d+=f;var A;if(A=r(e.buffer)?new Uint8Array(e.buffer,d,O):new Uint8Array(e,d,O),32849===y?y=i.RGB:32856===y&&(y=i.RGBA),!i.validate(y))throw new o("glInternalFormat is not a valid format.");if(i.isCompressedFormat(y)){if(0!==p)throw new o("glType must be zero when the texture is compressed.");if(1!==m)throw new o("The type size for compressed textures must be 1.");if(0!==_)throw new o("glFormat must be zero when the texture is compressed.")}else if(v!==_)throw new o("The base internal format must be the same as the format for uncompressed textures.");if(0!==T)throw new o("3D textures are unsupported.");if(0!==w)throw new o("Texture arrays are unsupported.");if(1!==b)throw new o("Cubemaps are unsupported.");if(S>1){var x=i.isCompressedFormat(y)?i.compressedTextureSizeInBytes(y,g,E):i.textureSizeInBytes(y,g,E);A=new Uint8Array(A.buffer,A.byteOffset,x)}return new n(y,g,E,A)}var c=[171,75,84,88,32,49,49,187,13,10,26,10],l=67305985,f=4;return s}),define("Renderer/CubeMapFace",["../Core/Check","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/PixelFormat","./PixelDatatype"],function(e,t,n,r,i,a,o){"use strict";function s(e,t,n,r,i,a,o,s,u,c){this._gl=e,this._texture=t,this._textureTarget=n,this._targetFace=r,this._pixelFormat=i,this._pixelDatatype=a,this._size=o,this._preMultiplyAlpha=s,this._flipY=u,this._initialized=c}return r(s.prototype,{pixelFormat:{get:function(){return this._pixelFormat}},pixelDatatype:{get:function(){return this._pixelDatatype}},_target:{get:function(){return this._targetFace}}}),s.prototype.copyFrom=function(r,o,s){if(o=t(o,0),s=t(s,0),e.defined("source",r),e.typeOf.number.greaterThanOrEquals("xOffset",o,0),e.typeOf.number.greaterThanOrEquals("yOffset",s,0),o+r.width>this._size)throw new i("xOffset + source.width must be less than or equal to width.");if(s+r.height>this._size)throw new i("yOffset + source.height must be less than or equal to height.");var u=this._gl,c=this._textureTarget,l=this._targetFace;u.activeTexture(u.TEXTURE0),u.bindTexture(c,this._texture);var f=r.width,d=r.height,h=r.arrayBufferView,p=this._size,m=this._pixelFormat,_=this._pixelDatatype,y=this._preMultiplyAlpha,v=this._flipY,g=!1;if(!this._initialized){if(0===o&&0===s&&f===p&&d===p)n(h)?(u.pixelStorei(u.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),u.pixelStorei(u.UNPACK_FLIP_Y_WEBGL,!1),v&&(h=a.flipY(h,m,_,p,p)),u.texImage2D(l,0,m,p,p,0,m,_,h)):(u.pixelStorei(u.UNPACK_PREMULTIPLY_ALPHA_WEBGL,y),u.pixelStorei(u.UNPACK_FLIP_Y_WEBGL,v),u.texImage2D(l,0,m,m,_,r)),g=!0;else{u.pixelStorei(u.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),u.pixelStorei(u.UNPACK_FLIP_Y_WEBGL,!1);var E=a.createTypedArray(m,_,p,p);u.texImage2D(l,0,m,p,p,0,m,_,E)}this._initialized=!0}g||(h?(u.pixelStorei(u.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),u.pixelStorei(u.UNPACK_FLIP_Y_WEBGL,!1),v&&(h=a.flipY(h,m,_,f,d)),u.texSubImage2D(l,0,o,s,f,d,m,_,h)):(u.pixelStorei(u.UNPACK_PREMULTIPLY_ALPHA_WEBGL,y),u.pixelStorei(u.UNPACK_FLIP_Y_WEBGL,v),u.texSubImage2D(l,0,o,s,m,_,r))),u.bindTexture(c,null)},s.prototype.copyFromFramebuffer=function(n,r,a,s,u,c){if(n=t(n,0),r=t(r,0),a=t(a,0),s=t(s,0),u=t(u,this._size),c=t(c,this._size),e.typeOf.number.greaterThanOrEquals("xOffset",n,0),e.typeOf.number.greaterThanOrEquals("yOffset",r,0),e.typeOf.number.greaterThanOrEquals("framebufferXOffset",a,0),e.typeOf.number.greaterThanOrEquals("framebufferYOffset",s,0),n+u>this._size)throw new i("xOffset + source.width must be less than or equal to width.");if(r+c>this._size)throw new i("yOffset + source.height must be less than or equal to height.");if(this._pixelDatatype===o.FLOAT)throw new i("Cannot call copyFromFramebuffer when the texture pixel data type is FLOAT.");if(this._pixelDatatype===o.HALF_FLOAT)throw new i("Cannot call copyFromFramebuffer when the texture pixel data type is HALF_FLOAT.");var l=this._gl,f=this._textureTarget;l.activeTexture(l.TEXTURE0),l.bindTexture(f,this._texture),l.copyTexSubImage2D(this._targetFace,0,n,r,a,s,u,c),l.bindTexture(f,null),this._initialized=!0},s}),define("Renderer/MipmapHint",["../Core/freezeObject","../Core/WebGLConstants"],function(e,t){"use strict";var n={DONT_CARE:t.DONT_CARE,FASTEST:t.FASTEST,NICEST:t.NICEST,validate:function(e){return e===n.DONT_CARE||e===n.FASTEST||e===n.NICEST}};return e(n)}),define("Renderer/TextureMagnificationFilter",["../Core/freezeObject","../Core/WebGLConstants"],function(e,t){"use strict";var n={NEAREST:t.NEAREST,LINEAR:t.LINEAR,validate:function(e){return e===n.NEAREST||e===n.LINEAR}};return e(n)}),define("Renderer/TextureMinificationFilter",["../Core/freezeObject","../Core/WebGLConstants"],function(e,t){"use strict";var n={NEAREST:t.NEAREST,LINEAR:t.LINEAR,NEAREST_MIPMAP_NEAREST:t.NEAREST_MIPMAP_NEAREST,LINEAR_MIPMAP_NEAREST:t.LINEAR_MIPMAP_NEAREST,NEAREST_MIPMAP_LINEAR:t.NEAREST_MIPMAP_LINEAR,LINEAR_MIPMAP_LINEAR:t.LINEAR_MIPMAP_LINEAR,validate:function(e){return e===n.NEAREST||e===n.LINEAR||e===n.NEAREST_MIPMAP_NEAREST||e===n.LINEAR_MIPMAP_NEAREST||e===n.NEAREST_MIPMAP_LINEAR||e===n.LINEAR_MIPMAP_LINEAR}};return e(n)}),define("Renderer/TextureWrap",["../Core/freezeObject","../Core/WebGLConstants"],function(e,t){"use strict";var n={CLAMP_TO_EDGE:t.CLAMP_TO_EDGE,REPEAT:t.REPEAT,MIRRORED_REPEAT:t.MIRRORED_REPEAT,validate:function(e){return e===n.CLAMP_TO_EDGE||e===n.REPEAT||e===n.MIRRORED_REPEAT}};return e(n)}),define("Renderer/Sampler",["../Core/Check","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","./TextureMagnificationFilter","./TextureMinificationFilter","./TextureWrap"],function(e,t,n,r,i,a,o,s){"use strict";function u(r){r=t(r,t.EMPTY_OBJECT);var u=t(r.wrapS,s.CLAMP_TO_EDGE),c=t(r.wrapT,s.CLAMP_TO_EDGE),l=t(r.minificationFilter,o.LINEAR),f=t(r.magnificationFilter,a.LINEAR),d=n(r.maximumAnisotropy)?r.maximumAnisotropy:1;if(!s.validate(u))throw new i("Invalid sampler.wrapS.");if(!s.validate(c))throw new i("Invalid sampler.wrapT.");if(!o.validate(l))throw new i("Invalid sampler.minificationFilter.");if(!a.validate(f))throw new i("Invalid sampler.magnificationFilter.");e.typeOf.number.greaterThanOrEquals("maximumAnisotropy",d,1),this._wrapS=u,this._wrapT=c,this._minificationFilter=l,this._magnificationFilter=f,this._maximumAnisotropy=d}return r(u.prototype,{wrapS:{get:function(){return this._wrapS}},wrapT:{get:function(){return this._wrapT}},minificationFilter:{get:function(){return this._minificationFilter}},magnificationFilter:{get:function(){return this._magnificationFilter}},maximumAnisotropy:{get:function(){return this._maximumAnisotropy}}}),u.equals=function(e,t){return e===t||n(e)&&n(t)&&e._wrapS===t._wrapS&&e._wrapT===t._wrapT&&e._minificationFilter===t._minificationFilter&&e._magnificationFilter===t._magnificationFilter&&e._maximumAnisotropy===t._maximumAnisotropy},u}),define("Renderer/CubeMap",["../Core/Check","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/Math","../Core/PixelFormat","./ContextLimits","./CubeMapFace","./MipmapHint","./PixelDatatype","./Sampler","./TextureMagnificationFilter","./TextureMinificationFilter"],function(e,t,n,r,i,a,o,s,u,c,l,f,d,h,p){"use strict";function m(r){function i(e,t,n,r){var i=t.arrayBufferView;i?(b.pixelStorei(b.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,!1),r&&(i=s.flipY(i,v,g,y,y)),b.texImage2D(e,0,v,y,y,0,v,g,i)):(b.pixelStorei(b.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n),b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,r),b.texImage2D(e,0,v,v,g,t))}r=t(r,t.EMPTY_OBJECT),e.defined("options.context",r.context);var o,l,h=r.context,p=r.source;if(n(p)){var m=[p.positiveX,p.negativeX,p.positiveY,p.negativeY,p.positiveZ,p.negativeZ];if(!(m[0]&&m[1]&&m[2]&&m[3]&&m[4]&&m[5]))throw new a("options.source requires positiveX, negativeX, positiveY, negativeY, positiveZ, and negativeZ faces.");o=m[0].width,l=m[0].height;for(var _=1;_<6;++_)if(Number(m[_].width)!==o||Number(m[_].height)!==l)throw new a("Each face in options.source must have the same width and height.")}else o=r.width,l=r.height;var y=o,v=t(r.pixelFormat,s.RGBA),g=t(r.pixelDatatype,f.UNSIGNED_BYTE);if(!n(o)||!n(l))throw new a("options requires a source field to create an initialized cube map or width and height fields to create a blank cube map.");if(o!==l)throw new a("Width must equal height.");if(y<=0)throw new a("Width and height must be greater than zero.");if(y>u.maximumCubeMapSize)throw new a("Width and height must be less than or equal to the maximum cube map size ("+u.maximumCubeMapSize+").  Check maximumCubeMapSize.");if(!s.validate(v))throw new a("Invalid options.pixelFormat.");if(s.isDepthFormat(v))throw new a("options.pixelFormat cannot be DEPTH_COMPONENT or DEPTH_STENCIL.");if(!f.validate(g))throw new a("Invalid options.pixelDatatype.");if(g===f.FLOAT&&!h.floatingPointTexture)throw new a("When options.pixelDatatype is FLOAT, this WebGL implementation must support the OES_texture_float extension.");if(g===f.HALF_FLOAT&&!h.halfFloatingPointTexture)throw new a("When options.pixelDatatype is HALF_FLOAT, this WebGL implementation must support the OES_texture_half_float extension.");var E=6*s.textureSizeInBytes(v,g,y,y),T=r.preMultiplyAlpha||v===s.RGB||v===s.LUMINANCE,w=t(r.flipY,!0),b=h._gl,S=b.TEXTURE_CUBE_MAP,C=b.createTexture();b.activeTexture(b.TEXTURE0),b.bindTexture(S,C),n(p)?(i(b.TEXTURE_CUBE_MAP_POSITIVE_X,p.positiveX,T,w),i(b.TEXTURE_CUBE_MAP_NEGATIVE_X,p.negativeX,T,w),i(b.TEXTURE_CUBE_MAP_POSITIVE_Y,p.positiveY,T,w),i(b.TEXTURE_CUBE_MAP_NEGATIVE_Y,p.negativeY,T,w),i(b.TEXTURE_CUBE_MAP_POSITIVE_Z,p.positiveZ,T,w),i(b.TEXTURE_CUBE_MAP_NEGATIVE_Z,p.negativeZ,T,w)):(b.texImage2D(b.TEXTURE_CUBE_MAP_POSITIVE_X,0,v,y,y,0,v,g,null),b.texImage2D(b.TEXTURE_CUBE_MAP_NEGATIVE_X,0,v,y,y,0,v,g,null),b.texImage2D(b.TEXTURE_CUBE_MAP_POSITIVE_Y,0,v,y,y,0,v,g,null),b.texImage2D(b.TEXTURE_CUBE_MAP_NEGATIVE_Y,0,v,y,y,0,v,g,null),b.texImage2D(b.TEXTURE_CUBE_MAP_POSITIVE_Z,0,v,y,y,0,v,g,null),b.texImage2D(b.TEXTURE_CUBE_MAP_NEGATIVE_Z,0,v,y,y,0,v,g,null)),b.bindTexture(S,null),this._gl=b,this._textureFilterAnisotropic=h._textureFilterAnisotropic,this._textureTarget=S,this._texture=C,this._pixelFormat=v,this._pixelDatatype=g,this._size=y,this._hasMipmap=!1,this._sizeInBytes=E,this._preMultiplyAlpha=T,this._flipY=w,this._sampler=void 0;var O=n(p);this._positiveX=new c(b,C,S,b.TEXTURE_CUBE_MAP_POSITIVE_X,v,g,y,T,w,O),this._negativeX=new c(b,C,S,b.TEXTURE_CUBE_MAP_NEGATIVE_X,v,g,y,T,w,O),this._positiveY=new c(b,C,S,b.TEXTURE_CUBE_MAP_POSITIVE_Y,v,g,y,T,w,O),this._negativeY=new c(b,C,S,b.TEXTURE_CUBE_MAP_NEGATIVE_Y,v,g,y,T,w,O),this._positiveZ=new c(b,C,S,b.TEXTURE_CUBE_MAP_POSITIVE_Z,v,g,y,T,w,O),this._negativeZ=new c(b,C,S,b.TEXTURE_CUBE_MAP_NEGATIVE_Z,v,g,y,T,w,O),this.sampler=n(r.sampler)?r.sampler:new d}return r(m.prototype,{positiveX:{get:function(){return this._positiveX}},negativeX:{get:function(){return this._negativeX}},positiveY:{get:function(){return this._positiveY}},negativeY:{get:function(){return this._negativeY}},positiveZ:{get:function(){return this._positiveZ}},negativeZ:{get:function(){return this._negativeZ}},sampler:{get:function(){return this._sampler},set:function(e){var t=e.minificationFilter,r=e.magnificationFilter,i=t===p.NEAREST_MIPMAP_NEAREST||t===p.NEAREST_MIPMAP_LINEAR||t===p.LINEAR_MIPMAP_NEAREST||t===p.LINEAR_MIPMAP_LINEAR;this._pixelDatatype!==f.FLOAT&&this._pixelDatatype!==f.HALF_FLOAT||(t=i?p.NEAREST_MIPMAP_NEAREST:p.NEAREST,r=h.NEAREST);var a=this._gl,o=this._textureTarget;a.activeTexture(a.TEXTURE0),a.bindTexture(o,this._texture),a.texParameteri(o,a.TEXTURE_MIN_FILTER,t),a.texParameteri(o,a.TEXTURE_MAG_FILTER,r),a.texParameteri(o,a.TEXTURE_WRAP_S,e.wrapS),a.texParameteri(o,a.TEXTURE_WRAP_T,e.wrapT),n(this._textureFilterAnisotropic)&&a.texParameteri(o,this._textureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,e.maximumAnisotropy),a.bindTexture(o,null),this._sampler=e}},pixelFormat:{get:function(){return this._pixelFormat}},pixelDatatype:{get:function(){return this._pixelDatatype}},width:{get:function(){return this._size}},height:{get:function(){return this._size}},sizeInBytes:{get:function(){return this._hasMipmap?Math.floor(4*this._sizeInBytes/3):this._sizeInBytes}},preMultiplyAlpha:{get:function(){return this._preMultiplyAlpha}},flipY:{get:function(){return this._flipY}},_target:{get:function(){return this._textureTarget}}}),m.prototype.generateMipmap=function(e){if(e=t(e,l.DONT_CARE),this._size>1&&!o.isPowerOfTwo(this._size))throw new a("width and height must be a power of two to call generateMipmap().");if(!l.validate(e))throw new a("hint is invalid.");this._hasMipmap=!0;var n=this._gl,r=this._textureTarget;n.hint(n.GENERATE_MIPMAP_HINT,e),n.activeTexture(n.TEXTURE0),n.bindTexture(r,this._texture),n.generateMipmap(r),n.bindTexture(r,null)},m.prototype.isDestroyed=function(){return!1},m.prototype.destroy=function(){return this._gl.deleteTexture(this._texture),this._positiveX=i(this._positiveX),this._negativeX=i(this._negativeX),this._positiveY=i(this._positiveY),this._negativeY=i(this._negativeY),this._positiveZ=i(this._positiveZ),this._negativeZ=i(this._negativeZ),i(this)},m}),define("Renderer/Texture",["../Core/Cartesian2","../Core/Check","../Core/createGuid","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/Math","../Core/PixelFormat","../Core/WebGLConstants","./ContextLimits","./MipmapHint","./PixelDatatype","./Sampler","./TextureMagnificationFilter","./TextureMinificationFilter"],function(e,t,n,r,i,a,o,s,u,c,l,f,d,h,p,m,_){"use strict";function y(a){a=r(a,r.EMPTY_OBJECT),t.defined("options.context",a.context);var o=a.context,u=a.width,d=a.height,m=a.source;i(m)&&(i(u)||(u=r(m.videoWidth,m.width)),i(d)||(d=r(m.videoHeight,m.height)));var _=r(a.pixelFormat,c.RGBA),y=r(a.pixelDatatype,h.UNSIGNED_BYTE),v=_,g=c.isCompressedFormat(v);if(o.webgl2)if(_===c.DEPTH_STENCIL?v=l.DEPTH24_STENCIL8:_===c.DEPTH_COMPONENT&&(y===h.UNSIGNED_SHORT?v=l.DEPTH_COMPONENT16:y===h.UNSIGNED_INT&&(v=l.DEPTH_COMPONENT24)),y===h.FLOAT)switch(_){case c.RGBA:v=l.RGBA32F;break;case c.RGB:v=l.RGB32F;break;case c.RG:v=l.RG32F;break;case c.R:v=l.R32F}else if(y===h.HALF_FLOAT)switch(_){case c.RGBA:v=l.RGBA16F;break;case c.RGB:v=l.RGB16F;break;case c.RG:v=l.RG16F;break;case c.R:v=l.R16F}if(!i(u)||!i(d))throw new s("options requires a source field to create an initialized texture or width and height fields to create a blank texture.");if(t.typeOf.number.greaterThan("width",u,0),u>f.maximumTextureSize)throw new s("Width must be less than or equal to the maximum texture size ("+f.maximumTextureSize+").  Check maximumTextureSize.");if(t.typeOf.number.greaterThan("height",d,0),d>f.maximumTextureSize)throw new s("Height must be less than or equal to the maximum texture size ("+f.maximumTextureSize+").  Check maximumTextureSize.");if(!c.validate(_))throw new s("Invalid options.pixelFormat.");if(!g&&!h.validate(y))throw new s("Invalid options.pixelDatatype.");if(_===c.DEPTH_COMPONENT&&y!==h.UNSIGNED_SHORT&&y!==h.UNSIGNED_INT)throw new s("When options.pixelFormat is DEPTH_COMPONENT, options.pixelDatatype must be UNSIGNED_SHORT or UNSIGNED_INT.");if(_===c.DEPTH_STENCIL&&y!==h.UNSIGNED_INT_24_8)throw new s("When options.pixelFormat is DEPTH_STENCIL, options.pixelDatatype must be UNSIGNED_INT_24_8.");if(y===h.FLOAT&&!o.floatingPointTexture)throw new s("When options.pixelDatatype is FLOAT, this WebGL implementation must support the OES_texture_float extension.  Check context.floatingPointTexture.");if(y===h.HALF_FLOAT&&!o.halfFloatingPointTexture)throw new s("When options.pixelDatatype is HALF_FLOAT, this WebGL implementation must support the OES_texture_half_float extension. Check context.halfFloatingPointTexture.");if(c.isDepthFormat(_)){if(i(m))throw new s("When options.pixelFormat is DEPTH_COMPONENT or DEPTH_STENCIL, source cannot be provided.");if(!o.depthTexture)throw new s("When options.pixelFormat is DEPTH_COMPONENT or DEPTH_STENCIL, this WebGL implementation must support WEBGL_depth_texture.  Check context.depthTexture.")}if(g){if(!i(m)||!i(m.arrayBufferView))throw new s("When options.pixelFormat is compressed, options.source.arrayBufferView must be defined.");if(c.isDXTFormat(v)&&!o.s3tc)throw new s("When options.pixelFormat is S3TC compressed, this WebGL implementation must support the WEBGL_texture_compression_s3tc extension. Check context.s3tc.");if(c.isPVRTCFormat(v)&&!o.pvrtc)throw new s("When options.pixelFormat is PVRTC compressed, this WebGL implementation must support the WEBGL_texture_compression_pvrtc extension. Check context.pvrtc.");if(c.isETC1Format(v)&&!o.etc1)throw new s("When options.pixelFormat is ETC1 compressed, this WebGL implementation must support the WEBGL_texture_compression_etc1 extension. Check context.etc1.");if(c.compressedTextureSizeInBytes(v,u,d)!==m.arrayBufferView.byteLength)throw new s("The byte length of the array buffer is invalid for the compressed texture with the given width and height.")}var E=a.preMultiplyAlpha||_===c.RGB||_===c.LUMINANCE,T=r(a.flipY,!0),w=!0,b=o._gl,S=b.TEXTURE_2D,C=b.createTexture();if(b.activeTexture(b.TEXTURE0),b.bindTexture(S,C),i(m))if(i(m.arrayBufferView)){b.pixelStorei(b.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,!1);var O=m.arrayBufferView;g?b.compressedTexImage2D(S,0,v,u,d,0,O):(T&&(O=c.flipY(O,_,y,u,d)),b.texImage2D(S,0,v,u,d,0,_,y,O))}else i(m.framebuffer)?(b.pixelStorei(b.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,!1),m.framebuffer!==o.defaultFramebuffer&&m.framebuffer._bind(),b.copyTexImage2D(S,0,v,m.xOffset,m.yOffset,u,d,0),m.framebuffer!==o.defaultFramebuffer&&m.framebuffer._unBind()):(b.pixelStorei(b.UNPACK_PREMULTIPLY_ALPHA_WEBGL,E),b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,T),b.texImage2D(S,0,v,_,y,m));else b.texImage2D(S,0,v,u,d,0,_,y,null),w=!1;b.bindTexture(S,null);var A;A=g?c.compressedTextureSizeInBytes(_,u,d):c.textureSizeInBytes(_,y,u,d),this._id=n(),this._context=o,this._textureFilterAnisotropic=o._textureFilterAnisotropic,this._textureTarget=S,this._texture=C,this._pixelFormat=_,this._pixelDatatype=y,this._width=u,this._height=d,this._dimensions=new e(u,d),this._hasMipmap=!1,this._sizeInBytes=A,this._preMultiplyAlpha=E,this._flipY=T,this._initialized=w,this._sampler=void 0,this.sampler=i(a.sampler)?a.sampler:new p}return y.fromFramebuffer=function(e){e=r(e,r.EMPTY_OBJECT),t.defined("options.context",e.context);var n=e.context,a=n._gl,o=r(e.pixelFormat,c.RGB),u=r(e.framebufferXOffset,0),l=r(e.framebufferYOffset,0),f=r(e.width,a.drawingBufferWidth),d=r(e.height,a.drawingBufferHeight),h=e.framebuffer;if(!c.validate(o))throw new s("Invalid pixelFormat.");if(c.isDepthFormat(o)||c.isCompressedFormat(o))throw new s("pixelFormat cannot be DEPTH_COMPONENT, DEPTH_STENCIL or a compressed format.");if(t.defined("options.context",e.context),t.typeOf.number.greaterThanOrEquals("framebufferXOffset",u,0),t.typeOf.number.greaterThanOrEquals("framebufferYOffset",l,0),u+f>a.drawingBufferWidth)throw new s("framebufferXOffset + width must be less than or equal to drawingBufferWidth");if(l+d>a.drawingBufferHeight)throw new s("framebufferYOffset + height must be less than or equal to drawingBufferHeight.");return new y({context:n,width:f,height:d,pixelFormat:o,source:{framebuffer:i(h)?h:n.defaultFramebuffer,xOffset:u,yOffset:l,width:f,height:d}})},a(y.prototype,{id:{get:function(){return this._id}},sampler:{get:function(){return this._sampler},set:function(e){var t=e.minificationFilter,n=e.magnificationFilter,r=t===_.NEAREST_MIPMAP_NEAREST||t===_.NEAREST_MIPMAP_LINEAR||t===_.LINEAR_MIPMAP_NEAREST||t===_.LINEAR_MIPMAP_LINEAR;this._pixelDatatype!==h.FLOAT&&this._pixelDatatype!==h.HALF_FLOAT||(t=r?_.NEAREST_MIPMAP_NEAREST:_.NEAREST,n=m.NEAREST);var a=this._context._gl,o=this._textureTarget;a.activeTexture(a.TEXTURE0),a.bindTexture(o,this._texture),a.texParameteri(o,a.TEXTURE_MIN_FILTER,t),a.texParameteri(o,a.TEXTURE_MAG_FILTER,n),a.texParameteri(o,a.TEXTURE_WRAP_S,e.wrapS),a.texParameteri(o,a.TEXTURE_WRAP_T,e.wrapT),i(this._textureFilterAnisotropic)&&a.texParameteri(o,this._textureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,e.maximumAnisotropy),a.bindTexture(o,null),this._sampler=e}},pixelFormat:{get:function(){return this._pixelFormat}},pixelDatatype:{get:function(){return this._pixelDatatype}},dimensions:{get:function(){return this._dimensions}},preMultiplyAlpha:{get:function(){return this._preMultiplyAlpha}},flipY:{get:function(){return this._flipY}},width:{get:function(){return this._width}},height:{get:function(){return this._height}},sizeInBytes:{get:function(){return this._hasMipmap?Math.floor(4*this._sizeInBytes/3):this._sizeInBytes}},_target:{get:function(){return this._textureTarget}}}),y.prototype.copyFrom=function(e,n,a){if(n=r(n,0),a=r(a,0),t.defined("source",e),c.isDepthFormat(this._pixelFormat))throw new s("Cannot call copyFrom when the texture pixel format is DEPTH_COMPONENT or DEPTH_STENCIL.");if(c.isCompressedFormat(this._pixelFormat))throw new s("Cannot call copyFrom with a compressed texture pixel format.");t.typeOf.number.greaterThanOrEquals("xOffset",n,0),t.typeOf.number.greaterThanOrEquals("yOffset",a,0),t.typeOf.number.lessThanOrEquals("xOffset + source.width",n+e.width,this._width),t.typeOf.number.lessThanOrEquals("yOffset + source.height",a+e.height,this._height);var o=this._context._gl,u=this._textureTarget;o.activeTexture(o.TEXTURE0),o.bindTexture(u,this._texture);var l=e.width,f=e.height,d=e.arrayBufferView,h=this._width,p=this._height,m=this._pixelFormat,_=this._pixelDatatype,y=this._preMultiplyAlpha,v=this._flipY,g=!1;if(!this._initialized){if(0===n&&0===a&&l===h&&f===p)i(d)?(o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,!1),v&&(d=c.flipY(d,m,_,h,p)),o.texImage2D(u,0,m,h,p,0,m,_,d)):(o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,y),o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,v),o.texImage2D(u,0,m,m,_,e)),g=!0;else{o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,!1);var E=c.createTypedArray(m,_,h,p);o.texImage2D(u,0,m,h,p,0,m,_,E)}this._initialized=!0}g||(d?(o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,!1),v&&(d=c.flipY(d,m,_,l,f)),o.texSubImage2D(u,0,n,a,l,f,m,_,d)):(o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,y),o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,v),o.texSubImage2D(u,0,n,a,m,_,e))),o.bindTexture(u,null)},y.prototype.copyFromFramebuffer=function(e,n,i,a,o,u){if(e=r(e,0),n=r(n,0),i=r(i,0),a=r(a,0),o=r(o,this._width),u=r(u,this._height),c.isDepthFormat(this._pixelFormat))throw new s("Cannot call copyFromFramebuffer when the texture pixel format is DEPTH_COMPONENT or DEPTH_STENCIL.");if(this._pixelDatatype===h.FLOAT)throw new s("Cannot call copyFromFramebuffer when the texture pixel data type is FLOAT.");if(this._pixelDatatype===h.HALF_FLOAT)throw new s("Cannot call copyFromFramebuffer when the texture pixel data type is HALF_FLOAT.");if(c.isCompressedFormat(this._pixelFormat))throw new s("Cannot call copyFrom with a compressed texture pixel format.");t.typeOf.number.greaterThanOrEquals("xOffset",e,0),t.typeOf.number.greaterThanOrEquals("yOffset",n,0),t.typeOf.number.greaterThanOrEquals("framebufferXOffset",i,0),t.typeOf.number.greaterThanOrEquals("framebufferYOffset",a,0),t.typeOf.number.lessThanOrEquals("xOffset + width",e+o,this._width),t.typeOf.number.lessThanOrEquals("yOffset + height",n+u,this._height);var l=this._context._gl,f=this._textureTarget;l.activeTexture(l.TEXTURE0),l.bindTexture(f,this._texture),l.copyTexSubImage2D(f,0,e,n,i,a,o,u),l.bindTexture(f,null),this._initialized=!0},y.prototype.generateMipmap=function(e){if(e=r(e,d.DONT_CARE),c.isDepthFormat(this._pixelFormat))throw new s("Cannot call generateMipmap when the texture pixel format is DEPTH_COMPONENT or DEPTH_STENCIL.");if(c.isCompressedFormat(this._pixelFormat))throw new s("Cannot call generateMipmap with a compressed pixel format.");if(this._width>1&&!u.isPowerOfTwo(this._width))throw new s("width must be a power of two to call generateMipmap().");if(this._height>1&&!u.isPowerOfTwo(this._height))throw new s("height must be a power of two to call generateMipmap().");if(!d.validate(e))throw new s("hint is invalid.");this._hasMipmap=!0;var t=this._context._gl,n=this._textureTarget;t.hint(t.GENERATE_MIPMAP_HINT,e),t.activeTexture(t.TEXTURE0),t.bindTexture(n,this._texture),t.generateMipmap(n),t.bindTexture(n,null)},y.prototype.isDestroyed=function(){return!1},y.prototype.destroy=function(){return this._context._gl.deleteTexture(this._texture),o(this)},y}),define("Shaders/Materials/BumpMapMaterial",[],function(){"use strict";return"uniform sampler2D image;\nuniform float strength;\nuniform vec2 repeat;\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nvec2 st = materialInput.st;\nvec2 centerPixel = fract(repeat * st);\nfloat centerBump = texture2D(image, centerPixel).channel;\nfloat imageWidth = float(imageDimensions.x);\nvec2 rightPixel = fract(repeat * (st + vec2(1.0 / imageWidth, 0.0)));\nfloat rightBump = texture2D(image, rightPixel).channel;\nfloat imageHeight = float(imageDimensions.y);\nvec2 leftPixel = fract(repeat * (st + vec2(0.0, 1.0 / imageHeight)));\nfloat topBump = texture2D(image, leftPixel).channel;\nvec3 normalTangentSpace = normalize(vec3(centerBump - rightBump, centerBump - topBump, clamp(1.0 - strength, 0.1, 1.0)));\nvec3 normalEC = materialInput.tangentToEyeMatrix * normalTangentSpace;\nmaterial.normal = normalEC;\nmaterial.diffuse = vec3(0.01);\nreturn material;\n}\n"}),define("Shaders/Materials/CheckerboardMaterial",[],function(){"use strict";return"uniform vec4 lightColor;\nuniform vec4 darkColor;\nuniform vec2 repeat;\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nvec2 st = materialInput.st;\nfloat b = mod(floor(repeat.s * st.s) + floor(repeat.t * st.t), 2.0);\nfloat scaledWidth = fract(repeat.s * st.s);\nscaledWidth = abs(scaledWidth - floor(scaledWidth + 0.5));\nfloat scaledHeight = fract(repeat.t * st.t);\nscaledHeight = abs(scaledHeight - floor(scaledHeight + 0.5));\nfloat value = min(scaledWidth, scaledHeight);\nvec4 currentColor = mix(lightColor, darkColor, b);\nvec4 color = czm_antialias(lightColor, darkColor, currentColor, value, 0.03);\nmaterial.diffuse = color.rgb;\nmaterial.alpha = color.a;\nreturn material;\n}\n"}),define("Shaders/Materials/DotMaterial",[],function(){"use strict";return"uniform vec4 lightColor;\nuniform vec4 darkColor;\nuniform vec2 repeat;\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nfloat b = smoothstep(0.3, 0.32, length(fract(repeat * materialInput.st) - 0.5));\nvec4 color = mix(lightColor, darkColor, b);\nmaterial.diffuse = color.rgb;\nmaterial.alpha = color.a;\nreturn material;\n}\n"}),define("Shaders/Materials/ElevationContourMaterial",[],function(){"use strict";return"#ifdef GL_OES_standard_derivatives\n#extension GL_OES_standard_derivatives : enable\n#endif\nuniform vec4 color;\nuniform float spacing;\nuniform float width;\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nfloat distanceToContour = mod(materialInput.height, spacing);\n#ifdef GL_OES_standard_derivatives\nfloat dxc = abs(dFdx(materialInput.height));\nfloat dyc = abs(dFdy(materialInput.height));\nfloat dF = max(dxc, dyc) * width;\nmaterial.alpha = (distanceToContour < dF) ? 1.0 : 0.0;\n#else\nmaterial.alpha = (distanceToContour < (czm_resolutionScale * width)) ? 1.0 : 0.0;\n#endif\nmaterial.diffuse = color.rgb;\nreturn material;\n}\n"}),define("Shaders/Materials/ElevationRampMaterial",[],function(){"use strict";return"uniform sampler2D image;\nuniform float minimumHeight;\nuniform float maximumHeight;\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nfloat scaledHeight = clamp((materialInput.height - minimumHeight) / (maximumHeight - minimumHeight), 0.0, 1.0);\nvec4 rampColor = texture2D(image, vec2(scaledHeight, 0.5));\nmaterial.diffuse = rampColor.rgb;\nmaterial.alpha = rampColor.a;\nreturn material;\n}\n"}),define("Shaders/Materials/FadeMaterial",[],function(){"use strict";return"uniform vec4 fadeInColor;\nuniform vec4 fadeOutColor;\nuniform float maximumDistance;\nuniform bool repeat;\nuniform vec2 fadeDirection;\nuniform vec2 time;\nfloat getTime(float t, float coord)\n{\nfloat scalar = 1.0 / maximumDistance;\nfloat q  = distance(t, coord) * scalar;\nif (repeat)\n{\nfloat r = distance(t, coord + 1.0) * scalar;\nfloat s = distance(t, coord - 1.0) * scalar;\nq = min(min(r, s), q);\n}\nreturn clamp(q, 0.0, 1.0);\n}\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nvec2 st = materialInput.st;\nfloat s = getTime(time.x, st.s) * fadeDirection.s;\nfloat t = getTime(time.y, st.t) * fadeDirection.t;\nfloat u = length(vec2(s, t));\nvec4 color = mix(fadeInColor, fadeOutColor, u);\nmaterial.emission = color.rgb;\nmaterial.alpha = color.a;\nreturn material;\n}\n"}),define("Shaders/Materials/GridMaterial",[],function(){"use strict";return"#ifdef GL_OES_standard_derivatives\n#extension GL_OES_standard_derivatives : enable\n#endif\nuniform vec4 color;\nuniform float cellAlpha;\nuniform vec2 lineCount;\nuniform vec2 lineThickness;\nuniform vec2 lineOffset;\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nvec2 st = materialInput.st;\nfloat scaledWidth = fract(lineCount.s * st.s - lineOffset.s);\nscaledWidth = abs(scaledWidth - floor(scaledWidth + 0.5));\nfloat scaledHeight = fract(lineCount.t * st.t - lineOffset.t);\nscaledHeight = abs(scaledHeight - floor(scaledHeight + 0.5));\nfloat value;\n#ifdef GL_OES_standard_derivatives\nconst float fuzz = 1.2;\nvec2 thickness = (lineThickness * czm_resolutionScale) - 1.0;\nvec2 dx = abs(dFdx(st));\nvec2 dy = abs(dFdy(st));\nvec2 dF = vec2(max(dx.s, dy.s), max(dx.t, dy.t)) * lineCount;\nvalue = min(\nsmoothstep(dF.s * thickness.s, dF.s * (fuzz + thickness.s), scaledWidth),\nsmoothstep(dF.t * thickness.t, dF.t * (fuzz + thickness.t), scaledHeight));\n#else\nconst float fuzz = 0.05;\nvec2 range = 0.5 - (lineThickness * 0.05);\nvalue = min(\n1.0 - smoothstep(range.s, range.s + fuzz, scaledWidth),\n1.0 - smoothstep(range.t, range.t + fuzz, scaledHeight));\n#endif\nfloat dRim = 1.0 - abs(dot(materialInput.normalEC, normalize(materialInput.positionToEyeEC)));\nfloat sRim = smoothstep(0.8, 1.0, dRim);\nvalue *= (1.0 - sRim);\nvec3 halfColor = color.rgb * 0.5;\nmaterial.diffuse = halfColor;\nmaterial.emission = halfColor;\nmaterial.alpha = color.a * (1.0 - ((1.0 - cellAlpha) * value));\nreturn material;\n}\n"}),define("Shaders/Materials/NormalMapMaterial",[],function(){"use strict";return"uniform sampler2D image;\nuniform float strength;\nuniform vec2 repeat;\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nvec4 textureValue = texture2D(image, fract(repeat * materialInput.st));\nvec3 normalTangentSpace = textureValue.channels;\nnormalTangentSpace.xy = normalTangentSpace.xy * 2.0 - 1.0;\nnormalTangentSpace.z = clamp(1.0 - strength, 0.1, 1.0);\nnormalTangentSpace = normalize(normalTangentSpace);\nvec3 normalEC = materialInput.tangentToEyeMatrix * normalTangentSpace;\nmaterial.normal = normalEC;\nreturn material;\n}\n"}),define("Shaders/Materials/PolylineArrowMaterial",[],function(){"use strict"
;return"#ifdef GL_OES_standard_derivatives\n#extension GL_OES_standard_derivatives : enable\n#endif\nuniform vec4 color;\nvarying float v_width;\nfloat getPointOnLine(vec2 p0, vec2 p1, float x)\n{\nfloat slope = (p0.y - p1.y) / (p0.x - p1.x);\nreturn slope * (x - p0.x) + p0.y;\n}\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nvec2 st = materialInput.st;\n#ifdef GL_OES_standard_derivatives\nfloat base = 1.0 - abs(fwidth(st.s)) * 10.0;\n#else\nfloat base = 0.99;\n#endif\nvec2 center = vec2(1.0, 0.5);\nfloat ptOnUpperLine = getPointOnLine(vec2(base, 1.0), center, st.s);\nfloat ptOnLowerLine = getPointOnLine(vec2(base, 0.0), center, st.s);\nfloat halfWidth = 0.15;\nfloat s = step(0.5 - halfWidth, st.t);\ns *= 1.0 - step(0.5 + halfWidth, st.t);\ns *= 1.0 - step(base, st.s);\nfloat t = step(base, materialInput.st.s);\nt *= 1.0 - step(ptOnUpperLine, st.t);\nt *= step(ptOnLowerLine, st.t);\nfloat dist;\nif (st.s < base)\n{\nfloat d1 = abs(st.t - (0.5 - halfWidth));\nfloat d2 = abs(st.t - (0.5 + halfWidth));\ndist = min(d1, d2);\n}\nelse\n{\nfloat d1 = czm_infinity;\nif (st.t < 0.5 - halfWidth && st.t > 0.5 + halfWidth)\n{\nd1 = abs(st.s - base);\n}\nfloat d2 = abs(st.t - ptOnUpperLine);\nfloat d3 = abs(st.t - ptOnLowerLine);\ndist = min(min(d1, d2), d3);\n}\nvec4 outsideColor = vec4(0.0);\nvec4 currentColor = mix(outsideColor, color, clamp(s + t, 0.0, 1.0));\nvec4 outColor = czm_antialias(outsideColor, color, currentColor, dist);\nmaterial.diffuse = outColor.rgb;\nmaterial.alpha = outColor.a;\nreturn material;\n}\n"}),define("Shaders/Materials/PolylineDashMaterial",[],function(){"use strict";return"uniform vec4 color;\nuniform vec4 gapColor;\nuniform float dashLength;\nuniform float dashPattern;\nvarying float v_polylineAngle;\nconst float maskLength = 16.0;\nmat2 rotate(float rad) {\nfloat c = cos(rad);\nfloat s = sin(rad);\nreturn mat2(\nc, s,\n-s, c\n);\n}\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nvec2 pos = rotate(v_polylineAngle) * gl_FragCoord.xy;\nfloat dashPosition = fract(pos.x / dashLength);\nfloat maskIndex = floor(dashPosition * maskLength);\nfloat maskTest = floor(dashPattern / pow(2.0, maskIndex));\nvec4 fragColor = (mod(maskTest, 2.0) < 1.0) ? gapColor : color;\nif (fragColor.a < 0.005) {\ndiscard;\n}\nmaterial.emission = fragColor.rgb;\nmaterial.alpha = fragColor.a;\nreturn material;\n}\n"}),define("Shaders/Materials/PolylineGlowMaterial",[],function(){"use strict";return"uniform vec4 color;\nuniform float glowPower;\nvarying float v_width;\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nvec2 st = materialInput.st;\nfloat glow = glowPower / abs(st.t - 0.5) - (glowPower / 0.5);\nmaterial.emission = max(vec3(glow - 1.0 + color.rgb), color.rgb);\nmaterial.alpha = clamp(0.0, 1.0, glow) * color.a;\nreturn material;\n}\n"}),define("Shaders/Materials/PolylineOutlineMaterial",[],function(){"use strict";return"uniform vec4 color;\nuniform vec4 outlineColor;\nuniform float outlineWidth;\nvarying float v_width;\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nvec2 st = materialInput.st;\nfloat halfInteriorWidth =  0.5 * (v_width - outlineWidth) / v_width;\nfloat b = step(0.5 - halfInteriorWidth, st.t);\nb *= 1.0 - step(0.5 + halfInteriorWidth, st.t);\nfloat d1 = abs(st.t - (0.5 - halfInteriorWidth));\nfloat d2 = abs(st.t - (0.5 + halfInteriorWidth));\nfloat dist = min(d1, d2);\nvec4 currentColor = mix(outlineColor, color, b);\nvec4 outColor = czm_antialias(outlineColor, color, currentColor, dist);\nmaterial.diffuse = outColor.rgb;\nmaterial.alpha = outColor.a;\nreturn material;\n}\n"}),define("Shaders/Materials/RimLightingMaterial",[],function(){"use strict";return"uniform vec4 color;\nuniform vec4 rimColor;\nuniform float width;\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nfloat d = 1.0 - dot(materialInput.normalEC, normalize(materialInput.positionToEyeEC));\nfloat s = smoothstep(1.0 - width, 1.0, d);\nmaterial.diffuse = color.rgb;\nmaterial.emission = rimColor.rgb * s;\nmaterial.alpha = mix(color.a, rimColor.a, s);\nreturn material;\n}\n"}),define("Shaders/Materials/SlopeRampMaterial",[],function(){"use strict";return"uniform sampler2D image;\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nvec4 rampColor = texture2D(image, vec2(materialInput.slope, 0.5));\nmaterial.diffuse = rampColor.rgb;\nmaterial.alpha = rampColor.a;\nreturn material;\n}\n"}),define("Shaders/Materials/StripeMaterial",[],function(){"use strict";return"uniform vec4 evenColor;\nuniform vec4 oddColor;\nuniform float offset;\nuniform float repeat;\nuniform bool horizontal;\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nfloat coord = mix(materialInput.st.s, materialInput.st.t, float(horizontal));\nfloat value = fract((coord - offset) * (repeat * 0.5));\nfloat dist = min(value, min(abs(value - 0.5), 1.0 - value));\nvec4 currentColor = mix(evenColor, oddColor, step(0.5, value));\nvec4 color = czm_antialias(evenColor, oddColor, currentColor, dist);\nmaterial.diffuse = color.rgb;\nmaterial.alpha = color.a;\nreturn material;\n}\n"}),define("Shaders/Materials/Water",[],function(){"use strict";return"uniform sampler2D specularMap;\nuniform sampler2D normalMap;\nuniform vec4 baseWaterColor;\nuniform vec4 blendColor;\nuniform float frequency;\nuniform float animationSpeed;\nuniform float amplitude;\nuniform float specularIntensity;\nuniform float fadeFactor;\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nfloat time = czm_frameNumber * animationSpeed;\nfloat fade = max(1.0, (length(materialInput.positionToEyeEC) / 10000000000.0) * frequency * fadeFactor);\nfloat specularMapValue = texture2D(specularMap, materialInput.st).r;\nvec4 noise = czm_getWaterNoise(normalMap, materialInput.st * frequency, time, 0.0);\nvec3 normalTangentSpace = noise.xyz * vec3(1.0, 1.0, (1.0 / amplitude));\nnormalTangentSpace.xy /= fade;\nnormalTangentSpace = mix(vec3(0.0, 0.0, 50.0), normalTangentSpace, specularMapValue);\nnormalTangentSpace = normalize(normalTangentSpace);\nfloat tsPerturbationRatio = clamp(dot(normalTangentSpace, vec3(0.0, 0.0, 1.0)), 0.0, 1.0);\nmaterial.alpha = specularMapValue;\nmaterial.diffuse = mix(blendColor.rgb, baseWaterColor.rgb, specularMapValue);\nmaterial.diffuse += (0.1 * tsPerturbationRatio);\nmaterial.normal = normalize(materialInput.tangentToEyeMatrix * normalTangentSpace);\nmaterial.specular = specularIntensity;\nmaterial.shininess = 10.0;\nreturn material;\n}\n"}),define("Scene/Material",["../Core/Cartesian2","../Core/clone","../Core/Color","../Core/combine","../Core/createGuid","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/isArray","../Core/loadCRN","../Core/loadKTX","../Core/Matrix2","../Core/Matrix3","../Core/Matrix4","../Core/Resource","../Renderer/CubeMap","../Renderer/Texture","../Shaders/Materials/BumpMapMaterial","../Shaders/Materials/CheckerboardMaterial","../Shaders/Materials/DotMaterial","../Shaders/Materials/ElevationContourMaterial","../Shaders/Materials/ElevationRampMaterial","../Shaders/Materials/FadeMaterial","../Shaders/Materials/GridMaterial","../Shaders/Materials/NormalMapMaterial","../Shaders/Materials/PolylineArrowMaterial","../Shaders/Materials/PolylineDashMaterial","../Shaders/Materials/PolylineGlowMaterial","../Shaders/Materials/PolylineOutlineMaterial","../Shaders/Materials/RimLightingMaterial","../Shaders/Materials/SlopeRampMaterial","../Shaders/Materials/StripeMaterial","../Shaders/Materials/Water","../ThirdParty/when"],function(e,t,n,r,i,a,o,s,u,c,l,f,d,h,p,m,_,y,v,g,E,T,w,b,S,C,O,A,x,R,I,D,P,N,M,z){"use strict";function F(e){this.type=void 0,this.shaderSource=void 0,this.materials=void 0,this.uniforms=void 0,this._uniforms=void 0,this.translucent=void 0,this._strict=void 0,this._template=void 0,this._count=void 0,this._texturePaths={},this._loadedImages=[],this._loadedCubeMaps=[],this._textures={},this._updateFunctions=[],this._defaultTexture=void 0,L(e,this),s(this,{type:{value:this.type,writable:!1}}),o(F._uniformList[this.type])||(F._uniformList[this.type]=Object.keys(this._uniforms))}function L(e,n){e=a(e,a.EMPTY_OBJECT),n._strict=a(e.strict,!1),n._count=a(e.count,0),n._template=t(a(e.fabric,a.EMPTY_OBJECT)),n._template.uniforms=t(a(n._template.uniforms,a.EMPTY_OBJECT)),n._template.materials=t(a(n._template.materials,a.EMPTY_OBJECT)),n.type=o(n._template.type)?n._template.type:i(),n.shaderSource="",n.materials={},n.uniforms={},n._uniforms={},n._translucentFunctions=[];var s,u=F._materialCache.getMaterial(n.type);if(o(u)){var c=t(u.fabric,!0);n._template=r(n._template,c,!0),s=u.translucent}G(n),o(u)||F._materialCache.addMaterial(n.type,n),V(n),H(n),X(n);var l=0===n._translucentFunctions.length||void 0;if(s=a(s,l),s=a(e.translucent,s),o(s))if("function"==typeof s){var f=function(){return s(n)};n._translucentFunctions.push(f)}else n._translucentFunctions.push(s)}function B(e,t,n,r){if(o(e))for(var i in e)if(e.hasOwnProperty(i)){var a=-1!==t.indexOf(i);(r&&!a||!r&&a)&&n(i,t)}}function U(e,t){for(var n="fabric: property name '"+e+"' is not valid. It should be ",r=0;r<t.length;r++){var i="'"+t[r]+"'";n+=r===t.length-1?"or "+i+".":i+", "}throw new c(n)}function q(e,t){throw new c("fabric: uniforms and materials cannot share the same property '"+e+"'")}function G(e){var t=e._template,n=t.uniforms,r=t.materials,i=t.components;if(o(i)&&o(t.source))throw new c("fabric: cannot have source and components in the same template.");B(t,Q,U,!0),B(i,J,U,!0);var a=[];for(var s in r)r.hasOwnProperty(s)&&a.push(s);B(n,a,q,!1)}function V(e){var t=e._template.components,n=e._template.source;if(o(n))e.shaderSource+=n+"\n";else{if(e.shaderSource+="czm_material czm_getMaterial(czm_materialInput materialInput)\n{\n",e.shaderSource+="czm_material material = czm_getDefaultMaterial(materialInput);\n",o(t))for(var r in t)t.hasOwnProperty(r)&&(e.shaderSource+="material."+r+" = "+t[r]+";\n");e.shaderSource+="return material;\n}\n"}}function j(e){var t;return function(n,r){var i=n.uniforms,a=i[e],s=t!==a;t=a;var u,c,l=n._textures[e];if(a instanceof HTMLVideoElement)if(a.readyState>=2){if(s&&o(l)&&(l!==r.defaultTexture&&l.destroy(),l=void 0),!o(l)||l===r.defaultTexture)return l=new v({context:r,source:a}),void(n._textures[e]=l);l.copyFrom(a)}else o(l)||(n._textures[e]=r.defaultTexture);else{if(a instanceof v&&a!==l){n._texturePaths[e]=void 0;var h=n._textures[e];return h!==n._defaultTexture&&h.destroy(),n._textures[e]=a,u=e+"Dimensions",void(i.hasOwnProperty(u)&&(c=i[u],c.x=a._width,c.y=a._height))}if(o(l)||(n._texturePaths[e]=void 0,o(n._defaultTexture)||(n._defaultTexture=r.defaultTexture),l=n._textures[e]=n._defaultTexture,u=e+"Dimensions",i.hasOwnProperty(u)&&(c=i[u],c.x=l._width,c.y=l._height)),a!==F.DefaultImageId){var p=a instanceof _;if(!o(n._texturePaths[e])||p&&a.url!==n._texturePaths[e].url||!p&&a!==n._texturePaths[e]){if("string"==typeof a||p){var m,y=p?a:_.createIfNeeded(a);m=ee.test(a)?d(y):te.test(a)?f(y):y.fetchImage(),z(m,function(t){n._loadedImages.push({id:e,image:t})})}else(a instanceof HTMLCanvasElement||a instanceof HTMLImageElement)&&n._loadedImages.push({id:e,image:a});n._texturePaths[e]=a}}}}}function k(e){return function(t,n){var r=t.uniforms[e];if(r instanceof y){var i=t._textures[e];return i!==t._defaultTexture&&i.destroy(),t._texturePaths[e]=void 0,void(t._textures[e]=r)}if(o(t._textures[e])||(t._texturePaths[e]=void 0,t._textures[e]=n.defaultCubeMap),r!==F.DefaultCubeMapId){var a=r.positiveX+r.negativeX+r.positiveY+r.negativeY+r.positiveZ+r.negativeZ;if(a!==t._texturePaths[e]){var s=[_.createIfNeeded(r.positiveX).fetchImage(),_.createIfNeeded(r.negativeX).fetchImage(),_.createIfNeeded(r.positiveY).fetchImage(),_.createIfNeeded(r.negativeY).fetchImage(),_.createIfNeeded(r.positiveZ).fetchImage(),_.createIfNeeded(r.negativeZ).fetchImage()];z.all(s).then(function(n){t._loadedCubeMaps.push({id:e,images:n})}),t._texturePaths[e]=a}}}}function H(e){var t=e._template.uniforms;for(var n in t)t.hasOwnProperty(n)&&W(e,n)}function W(e,t){var n=e._strict,r=e._template.uniforms,i=r[t],a=Y(i);if(!o(a))throw new c("fabric: uniform '"+t+"' has invalid type.");if("channels"===a){if(0===Z(e,t,i,!1)&&n)throw new c("strict: shader source does not use channels '"+t+"'.")}else{if("sampler2D"===a){var s=t+"Dimensions";K(e,s)>0&&(r[s]={type:"ivec3",x:1,y:1},W(e,s))}if(!new RegExp("uniform\\s+"+a+"\\s+"+t+"\\s*;").test(e.shaderSource)){var u="uniform "+a+" "+t+";";e.shaderSource=u+e.shaderSource}var l=t+"_"+e._count++;if(1===Z(e,t,l)&&n)throw new c("strict: shader source does not use uniform '"+t+"'.");if(e.uniforms[t]=i,"sampler2D"===a)e._uniforms[l]=function(){return e._textures[t]},e._updateFunctions.push(j(t));else if("samplerCube"===a)e._uniforms[l]=function(){return e._textures[t]},e._updateFunctions.push(k(t));else if(-1!==a.indexOf("mat")){var f=new $[a];e._uniforms[l]=function(){return $[a].fromColumnMajorArray(e.uniforms[t],f)}}else e._uniforms[l]=function(){return e.uniforms[t]}}}function Y(e){var t=e.type;if(!o(t)){var n=typeof e;if("number"===n)t="float";else if("boolean"===n)t="bool";else if("string"===n||e instanceof _||e instanceof HTMLCanvasElement||e instanceof HTMLImageElement)t=/^([rgba]){1,4}$/i.test(e)?"channels":e===F.DefaultCubeMapId?"samplerCube":"sampler2D";else if("object"===n)if(l(e))4!==e.length&&9!==e.length&&16!==e.length||(t="mat"+Math.sqrt(e.length));else{var r=0;for(var i in e)e.hasOwnProperty(i)&&(r+=1);r>=2&&r<=4?t="vec"+r:6===r&&(t="samplerCube")}}return t}function X(e){var t=e._strict,n=e._template.materials;for(var i in n)if(n.hasOwnProperty(i)){var a=new F({strict:t,fabric:n[i],count:e._count});e._count=a._count,e._uniforms=r(e._uniforms,a._uniforms,!0),e.materials[i]=a,e._translucentFunctions=e._translucentFunctions.concat(a._translucentFunctions);var o="czm_getMaterial_"+e._count++;Z(a,"czm_getMaterial",o),e.shaderSource=a.shaderSource+e.shaderSource;var s=o+"(materialInput)",u=Z(e,i,s);if(0===u&&t)throw new c("strict: shader source does not use material '"+i+"'.")}}function Z(e,t,n,r){r=a(r,!0);var i=0,o="([\\w"+(r?".":"")+"])?",s=new RegExp(o+t+"([\\w])?","g");return e.shaderSource=e.shaderSource.replace(s,function(e,t,r){return t||r?e:(i+=1,n)}),i}function K(e,t,n){return Z(e,t,t,n)}F._uniformList={},F.fromType=function(e,t){if(!o(F._materialCache.getMaterial(e)))throw new c("material with type '"+e+"' does not exist.");var n=new F({fabric:{type:e}});if(o(t))for(var r in t)t.hasOwnProperty(r)&&(n.uniforms[r]=t[r]);return n},F.prototype.isTranslucent=function(){if(o(this.translucent))return"function"==typeof this.translucent?this.translucent():this.translucent;for(var e=!0,t=this._translucentFunctions,n=t.length,r=0;r<n;++r){var i=t[r];if(!(e="function"==typeof i?e&&i():e&&i))break}return e},F.prototype.update=function(e){var t,n,r=this._loadedImages,i=r.length;for(t=0;t<i;++t){var a=r[t];n=a.id;var s,u=a.image;s=new v(o(u.internalFormat)?{context:e,pixelFormat:u.internalFormat,width:u.width,height:u.height,source:{arrayBufferView:u.bufferView}}:{context:e,source:u}),this._textures[n]=s;var c=n+"Dimensions";if(this.uniforms.hasOwnProperty(c)){var l=this.uniforms[c];l.x=s._width,l.y=s._height}}r.length=0;var f=this._loadedCubeMaps;for(i=f.length,t=0;t<i;++t){var d=f[t];n=d.id;var h=d.images,p=new y({context:e,source:{positiveX:h[0],negativeX:h[1],positiveY:h[2],negativeY:h[3],positiveZ:h[4],negativeZ:h[5]}});this._textures[n]=p}f.length=0;var m=this._updateFunctions;for(i=m.length,t=0;t<i;++t)m[t](this,e);var _=this.materials;for(var g in _)_.hasOwnProperty(g)&&_[g].update(e)},F.prototype.isDestroyed=function(){return!1},F.prototype.destroy=function(){var e=this._textures;for(var t in e)if(e.hasOwnProperty(t)){var n=e[t];n!==this._defaultTexture&&n.destroy()}var r=this.materials;for(var i in r)r.hasOwnProperty(i)&&r[i].destroy();return u(this)};var Q=["type","materials","uniforms","components","source"],J=["diffuse","specular","shininess","normal","emission","alpha"],$={mat2:h,mat3:p,mat4:m},ee=/\.ktx$/i,te=/\.crn$/i;return F._materialCache={_materials:{},addMaterial:function(e,t){this._materials[e]=t},getMaterial:function(e){return this._materials[e]}},F.DefaultImageId="czm_defaultImage",F.DefaultCubeMapId="czm_defaultCubeMap",F.ColorType="Color",F._materialCache.addMaterial(F.ColorType,{fabric:{type:F.ColorType,uniforms:{color:new n(1,0,0,.5)},components:{diffuse:"color.rgb",alpha:"color.a"}},translucent:function(e){return e.uniforms.color.alpha<1}}),F.ImageType="Image",F._materialCache.addMaterial(F.ImageType,{fabric:{type:F.ImageType,uniforms:{image:F.DefaultImageId,repeat:new e(1,1),color:new n(1,1,1,1)},components:{diffuse:"texture2D(image, fract(repeat * materialInput.st)).rgb * color.rgb",alpha:"texture2D(image, fract(repeat * materialInput.st)).a * color.a"}},translucent:function(e){return e.uniforms.color.alpha<1}}),F.DiffuseMapType="DiffuseMap",F._materialCache.addMaterial(F.DiffuseMapType,{fabric:{type:F.DiffuseMapType,uniforms:{image:F.DefaultImageId,channels:"rgb",repeat:new e(1,1)},components:{diffuse:"texture2D(image, fract(repeat * materialInput.st)).channels"}},translucent:!1}),F.AlphaMapType="AlphaMap",F._materialCache.addMaterial(F.AlphaMapType,{fabric:{type:F.AlphaMapType,uniforms:{image:F.DefaultImageId,channel:"a",repeat:new e(1,1)},components:{alpha:"texture2D(image, fract(repeat * materialInput.st)).channel"}},translucent:!0}),F.SpecularMapType="SpecularMap",F._materialCache.addMaterial(F.SpecularMapType,{fabric:{type:F.SpecularMapType,uniforms:{image:F.DefaultImageId,channel:"r",repeat:new e(1,1)},components:{specular:"texture2D(image, fract(repeat * materialInput.st)).channel"}},translucent:!1}),F.EmissionMapType="EmissionMap",F._materialCache.addMaterial(F.EmissionMapType,{fabric:{type:F.EmissionMapType,uniforms:{image:F.DefaultImageId,channels:"rgb",repeat:new e(1,1)},components:{emission:"texture2D(image, fract(repeat * materialInput.st)).channels"}},translucent:!1}),F.BumpMapType="BumpMap",F._materialCache.addMaterial(F.BumpMapType,{fabric:{type:F.BumpMapType,uniforms:{image:F.DefaultImageId,channel:"r",strength:.8,repeat:new e(1,1)},source:g},translucent:!1}),F.NormalMapType="NormalMap",F._materialCache.addMaterial(F.NormalMapType,{fabric:{type:F.NormalMapType,uniforms:{image:F.DefaultImageId,channels:"rgb",strength:.8,repeat:new e(1,1)},source:O},translucent:!1}),F.GridType="Grid",F._materialCache.addMaterial(F.GridType,{fabric:{type:F.GridType,uniforms:{color:new n(0,1,0,1),cellAlpha:.1,lineCount:new e(8,8),lineThickness:new e(1,1),lineOffset:new e(0,0)},source:C},translucent:function(e){var t=e.uniforms;return t.color.alpha<1||t.cellAlpha<1}}),F.StripeType="Stripe",F._materialCache.addMaterial(F.StripeType,{fabric:{type:F.StripeType,uniforms:{horizontal:!0,evenColor:new n(1,1,1,.5),oddColor:new n(0,0,1,.5),offset:0,repeat:5},source:N},translucent:function(e){var t=e.uniforms;return t.evenColor.alpha<1||t.oddColor.alpha<1}}),F.CheckerboardType="Checkerboard",F._materialCache.addMaterial(F.CheckerboardType,{fabric:{type:F.CheckerboardType,uniforms:{lightColor:new n(1,1,1,.5),darkColor:new n(0,0,0,.5),repeat:new e(5,5)},source:E},translucent:function(e){var t=e.uniforms;return t.lightColor.alpha<1||t.darkColor.alpha<1}}),F.DotType="Dot",F._materialCache.addMaterial(F.DotType,{fabric:{type:F.DotType,uniforms:{lightColor:new n(1,1,0,.75),darkColor:new n(0,1,1,.75),repeat:new e(5,5)},source:T},translucent:function(e){var t=e.uniforms;return t.lightColor.alpha<1||t.darkColor.alpha<1}}),F.WaterType="Water",F._materialCache.addMaterial(F.WaterType,{fabric:{type:F.WaterType,uniforms:{baseWaterColor:new n(.2,.3,.6,1),blendColor:new n(0,1,.699,1),specularMap:F.DefaultImageId,normalMap:F.DefaultImageId,frequency:10,animationSpeed:.01,amplitude:1,specularIntensity:.5,fadeFactor:1},source:M},translucent:function(e){var t=e.uniforms;return t.baseWaterColor.alpha<1||t.blendColor.alpha<1}}),F.RimLightingType="RimLighting",F._materialCache.addMaterial(F.RimLightingType,{fabric:{type:F.RimLightingType,uniforms:{color:new n(1,0,0,.7),rimColor:new n(1,1,1,.4),width:.3},source:D},translucent:function(e){var t=e.uniforms;return t.color.alpha<1||t.rimColor.alpha<1}}),F.FadeType="Fade",F._materialCache.addMaterial(F.FadeType,{fabric:{type:F.FadeType,uniforms:{fadeInColor:new n(1,0,0,1),fadeOutColor:new n(0,0,0,0),maximumDistance:.5,repeat:!0,fadeDirection:{x:!0,y:!0},time:new e(.5,.5)},source:S},translucent:function(e){var t=e.uniforms;return t.fadeInColor.alpha<1||t.fadeOutColor.alpha<1}}),F.PolylineArrowType="PolylineArrow",F._materialCache.addMaterial(F.PolylineArrowType,{fabric:{type:F.PolylineArrowType,uniforms:{color:new n(1,1,1,1)},source:A},translucent:!0}),F.PolylineDashType="PolylineDash",F._materialCache.addMaterial(F.PolylineDashType,{fabric:{type:F.PolylineDashType,uniforms:{color:new n(1,0,1,1),gapColor:new n(0,0,0,0),dashLength:16,dashPattern:255},source:x},translucent:!0}),F.PolylineGlowType="PolylineGlow",F._materialCache.addMaterial(F.PolylineGlowType,{fabric:{type:F.PolylineGlowType,uniforms:{color:new n(0,.5,1,1),glowPower:.25},source:R},translucent:!0}),F.PolylineOutlineType="PolylineOutline",F._materialCache.addMaterial(F.PolylineOutlineType,{fabric:{type:F.PolylineOutlineType,uniforms:{color:new n(1,1,1,1),outlineColor:new n(1,0,0,1),outlineWidth:1},source:I},translucent:function(e){var t=e.uniforms;return t.color.alpha<1||t.outlineColor.alpha<1}}),F.ElevationContourType="ElevationContour",F._materialCache.addMaterial(F.ElevationContourType,{fabric:{type:F.ElevationContourType,uniforms:{spacing:100,color:new n(1,0,0,1),width:1},source:w},translucent:!1}),F.ElevationRampType="ElevationRamp",F._materialCache.addMaterial(F.ElevationRampType,{fabric:{type:F.ElevationRampType,uniforms:{image:F.DefaultImageId,minimumHeight:0,maximumHeight:1e4},source:b},translucent:!1}),F.SlopeRampMaterialType="SlopeRamp",F._materialCache.addMaterial(F.SlopeRampMaterialType,{fabric:{type:F.SlopeRampMaterialType,uniforms:{image:F.DefaultImageId},source:P},translucent:!1}),F}),define("Scene/PolylineMaterialAppearance",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/VertexFormat","../Shaders/Appearances/PolylineMaterialAppearanceVS","../Shaders/PolylineCommon","../Shaders/PolylineFS","./Appearance","./Material"],function(e,t,n,r,i,a,o,s,u){"use strict";function c(n){n=e(n,e.EMPTY_OBJECT);var r=e(n.translucent,!0),i=c.VERTEX_FORMAT;this.material=t(n.material)?n.material:u.fromType(u.ColorType),this.translucent=r,this._vertexShaderSource=e(n.vertexShaderSource,l),this._fragmentShaderSource=e(n.fragmentShaderSource,f),this._renderState=s.getDefaultRenderState(r,!1,n.renderState),this._closed=!1,this._vertexFormat=i}var l=a+"\n"+i,f=o;return n(c.prototype,{vertexShaderSource:{get:function(){var e=this._vertexShaderSource;return-1!==this.material.shaderSource.search(/varying\s+float\s+v_polylineAngle;/g)&&(e="#define POLYLINE_DASH\n"+e),e}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},renderState:{get:function(){return this._renderState}},closed:{get:function(){return this._closed}},vertexFormat:{get:function(){return this._vertexFormat}}}),c.VERTEX_FORMAT=r.POSITION_AND_ST,c.prototype.getFragmentShaderSource=s.prototype.getFragmentShaderSource,c.prototype.isTranslucent=s.prototype.isTranslucent,c.prototype.getRenderState=s.prototype.getRenderState,c}),define("Core/GeometryAttributes",["./defaultValue"],function(e){"use strict";function t(t){t=e(t,e.EMPTY_OBJECT),this.position=t.position,this.normal=t.normal,this.st=t.st,this.bitangent=t.bitangent,this.tangent=t.tangent,this.color=t.color}return t}),define("Core/subdivideArray",["./defined","./DeveloperError"],function(e,t){"use strict";function n(n,r){if(!e(n))throw new t("array is required.");if(!e(r)||r<1)throw new t("numberOfArrays must be greater than 0.");for(var i=[],a=n.length,o=0;o<a;){var s=Math.ceil((a-o)/r--);i.push(n.slice(o,o+s)),o+=s}return i}return n}),define("Renderer/BufferUsage",["../Core/freezeObject","../Core/WebGLConstants"],function(e,t){"use strict";var n={STREAM_DRAW:t.STREAM_DRAW,STATIC_DRAW:t.STATIC_DRAW,DYNAMIC_DRAW:t.DYNAMIC_DRAW,validate:function(e){return e===n.STREAM_DRAW||e===n.STATIC_DRAW||e===n.DYNAMIC_DRAW}};return e(n)}),define("Core/IndexDatatype",["./defined","./DeveloperError","./freezeObject","./Math","./WebGLConstants"],function(e,t,n,r,i){"use strict";var a={UNSIGNED_BYTE:i.UNSIGNED_BYTE,UNSIGNED_SHORT:i.UNSIGNED_SHORT,UNSIGNED_INT:i.UNSIGNED_INT};return a.getSizeInBytes=function(e){switch(e){case a.UNSIGNED_BYTE:return Uint8Array.BYTES_PER_ELEMENT;case a.UNSIGNED_SHORT:return Uint16Array.BYTES_PER_ELEMENT;case a.UNSIGNED_INT:return Uint32Array.BYTES_PER_ELEMENT}throw new t("indexDatatype is required and must be a valid IndexDatatype constant.")},a.validate=function(t){return e(t)&&(t===a.UNSIGNED_BYTE||t===a.UNSIGNED_SHORT||t===a.UNSIGNED_INT)},a.createTypedArray=function(n,i){if(!e(n))throw new t("numberOfVertices is required.");return n>=r.SIXTY_FOUR_KILOBYTES?new Uint32Array(i):new Uint16Array(i)},a.createTypedArrayFromArrayBuffer=function(n,i,a,o){if(!e(n))throw new t("numberOfVertices is required.");if(!e(i))throw new t("sourceArray is required.");if(!e(a))throw new t("byteOffset is required.");return n>=r.SIXTY_FOUR_KILOBYTES?new Uint32Array(i,a,o):new Uint16Array(i,a,o)},n(a)}),define("Renderer/Buffer",["../Core/Check","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/IndexDatatype","../Core/WebGLConstants","./BufferUsage"],function(e,t,n,r,i,a,o,s,u){"use strict";function c(r){if(r=t(r,t.EMPTY_OBJECT),e.defined("options.context",r.context),!n(r.typedArray)&&!n(r.sizeInBytes))throw new a("Either options.sizeInBytes or options.typedArray is required.");if(n(r.typedArray)&&n(r.sizeInBytes))throw new a("Cannot pass in both options.sizeInBytes and options.typedArray.");if(n(r.typedArray)&&(e.typeOf.object("options.typedArray",r.typedArray),e.typeOf.number("options.typedArray.byteLength",r.typedArray.byteLength)),!u.validate(r.usage))throw new a("usage is invalid.");var i=r.context._gl,o=r.bufferTarget,s=r.typedArray,c=r.sizeInBytes,l=r.usage,f=n(s);f&&(c=s.byteLength),e.typeOf.number.greaterThan("sizeInBytes",c,0);var d=i.createBuffer();i.bindBuffer(o,d),i.bufferData(o,f?s:c,l),i.bindBuffer(o,null),this._gl=i,this._webgl2=r.context._webgl2,this._bufferTarget=o,this._sizeInBytes=c,this._usage=l,this._buffer=d,this.vertexArrayDestroyable=!0}return c.createVertexBuffer=function(t){return e.defined("options.context",t.context),new c({context:t.context,bufferTarget:s.ARRAY_BUFFER,typedArray:t.typedArray,sizeInBytes:t.sizeInBytes,usage:t.usage})},c.createIndexBuffer=function(t){if(e.defined("options.context",t.context),!o.validate(t.indexDatatype))throw new a("Invalid indexDatatype.");if(t.indexDatatype===o.UNSIGNED_INT&&!t.context.elementIndexUint)throw new a("IndexDatatype.UNSIGNED_INT requires OES_element_index_uint, which is not supported on this system.  Check context.elementIndexUint.");var n=t.context,i=t.indexDatatype,u=o.getSizeInBytes(i),l=new c({context:n,bufferTarget:s.ELEMENT_ARRAY_BUFFER,typedArray:t.typedArray,sizeInBytes:t.sizeInBytes,usage:t.usage}),f=l.sizeInBytes/u;return r(l,{indexDatatype:{get:function(){return i}},bytesPerIndex:{get:function(){return u}},numberOfIndices:{get:function(){return f}}}),l},r(c.prototype,{sizeInBytes:{get:function(){return this._sizeInBytes}},usage:{get:function(){return this._usage}}}),c.prototype._getBuffer=function(){return this._buffer},c.prototype.copyFromArrayView=function(n,r){r=t(r,0),e.defined("arrayView",n),e.typeOf.number.lessThanOrEquals("offsetInBytes + arrayView.byteLength",r+n.byteLength,this._sizeInBytes);var i=this._gl,a=this._bufferTarget;i.bindBuffer(a,this._buffer),i.bufferSubData(a,r,n),i.bindBuffer(a,null)},c.prototype.copyFromBuffer=function(e,t,r,i){if(!this._webgl2)throw new a("A WebGL 2 context is required.");if(!n(e))throw new a("readBuffer must be defined.");if(!n(i)||i<=0)throw new a("sizeInBytes must be defined and be greater than zero.");if(!n(t)||t<0||t+i>e._sizeInBytes)throw new a("readOffset must be greater than or equal to zero and readOffset + sizeInBytes must be less than of equal to readBuffer.sizeInBytes.");if(!n(r)||r<0||r+i>this._sizeInBytes)throw new a("writeOffset must be greater than or equal to zero and writeOffset + sizeInBytes must be less than of equal to this.sizeInBytes.");if(this._buffer===e._buffer&&(r>=t&&r<t+i||t>r&&t<r+i))throw new a("When readBuffer is equal to this, the ranges [readOffset + sizeInBytes) and [writeOffset, writeOffset + sizeInBytes) must not overlap.");if(this._bufferTarget===s.ELEMENT_ARRAY_BUFFER&&e._bufferTarget!==s.ELEMENT_ARRAY_BUFFER||this._bufferTarget!==s.ELEMENT_ARRAY_BUFFER&&e._bufferTarget===s.ELEMENT_ARRAY_BUFFER)throw new a("Can not copy an index buffer into another buffer type.");var o=s.COPY_READ_BUFFER,u=s.COPY_WRITE_BUFFER,c=this._gl;c.bindBuffer(u,this._buffer),c.bindBuffer(o,e._buffer),c.copyBufferSubData(o,u,t,r,i),c.bindBuffer(u,null),c.bindBuffer(o,null)},c.prototype.getBufferData=function(e,r,i,o){if(r=t(r,0),i=t(i,0),!this._webgl2)throw new a("A WebGL 2 context is required.");if(!n(e))throw new a("arrayView is required.");var u,c,l=e.byteLength;if(n(o)?(u=o,n(l)?c=1:(l=e.length,c=e.BYTES_PER_ELEMENT)):n(l)?(u=l-i,c=1):(l=e.length,u=l-i,c=e.BYTES_PER_ELEMENT),i<0||i>l)throw new a("destinationOffset must be greater than zero and less than the arrayView length.");if(i+u>l)throw new a("destinationOffset + length must be less than or equal to the arrayViewLength.");if(r<0||r>this._sizeInBytes)throw new a("sourceOffset must be greater than zero and less than the buffers size.");if(r+u*c>this._sizeInBytes)throw new a("sourceOffset + length must be less than the buffers size.");var f=this._gl,d=s.COPY_READ_BUFFER;f.bindBuffer(d,this._buffer),f.getBufferSubData(d,r,e,i,o),f.bindBuffer(d,null)},c.prototype.isDestroyed=function(){return!1},c.prototype.destroy=function(){return this._gl.deleteBuffer(this._buffer),i(this)},c}),define("Renderer/VertexArray",["../Core/Check","../Core/ComponentDatatype","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/Geometry","../Core/IndexDatatype","../Core/Math","../Core/RuntimeError","./Buffer","./BufferUsage","./ContextLimits"],function(e,t,n,r,i,a,o,s,u,c,l,f,d,h){"use strict";function p(e,i,a,s){var u=r(i.vertexBuffer),c=r(i.value),l=i.value?i.value.length:i.componentsPerAttribute;if(!u&&!c)throw new o("attribute must have a vertexBuffer or a value.");if(u&&c)throw new o("attribute cannot have both a vertexBuffer and a value.  It must have either a vertexBuffer property defining per-vertex data or a value property defining data for all vertices.");if(1!==l&&2!==l&&3!==l&&4!==l){if(c)throw new o("attribute.value.length must be in the range [1, 4].");throw new o("attribute.componentsPerAttribute must be in the range [1, 4].")}if(r(i.componentDatatype)&&!t.validate(i.componentDatatype))throw new o("attribute must have a valid componentDatatype or not specify it.");if(r(i.strideInBytes)&&i.strideInBytes>255)throw new o("attribute must have a strideInBytes less than or equal to 255 or not specify it.");if(r(i.instanceDivisor)&&i.instanceDivisor>0&&!s.instancedArrays)throw new o("instanced arrays is not supported")
;if(r(i.instanceDivisor)&&i.instanceDivisor<0)throw new o("attribute must have an instanceDivisor greater than or equal to zero");if(r(i.instanceDivisor)&&c)throw new o("attribute cannot have have an instanceDivisor if it is not backed by a buffer");if(r(i.instanceDivisor)&&i.instanceDivisor>0&&0===i.index)throw new o("attribute zero cannot have an instanceDivisor greater than 0");var f={index:n(i.index,a),enabled:n(i.enabled,!0),vertexBuffer:i.vertexBuffer,value:c?i.value.slice(0):void 0,componentsPerAttribute:l,componentDatatype:n(i.componentDatatype,t.FLOAT),normalize:n(i.normalize,!1),offsetInBytes:n(i.offsetInBytes,0),strideInBytes:n(i.strideInBytes,0),instanceDivisor:n(i.instanceDivisor,0)};if(u)f.vertexAttrib=function(e){var t=this.index;e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer._getBuffer()),e.vertexAttribPointer(t,this.componentsPerAttribute,this.componentDatatype,this.normalize,this.strideInBytes,this.offsetInBytes),e.enableVertexAttribArray(t),this.instanceDivisor>0&&(s.glVertexAttribDivisor(t,this.instanceDivisor),s._vertexAttribDivisors[t]=this.instanceDivisor,s._previousDrawInstanced=!0)},f.disableVertexAttribArray=function(e){e.disableVertexAttribArray(this.index),this.instanceDivisor>0&&s.glVertexAttribDivisor(a,0)};else{switch(f.componentsPerAttribute){case 1:f.vertexAttrib=function(e){e.vertexAttrib1fv(this.index,this.value)};break;case 2:f.vertexAttrib=function(e){e.vertexAttrib2fv(this.index,this.value)};break;case 3:f.vertexAttrib=function(e){e.vertexAttrib3fv(this.index,this.value)};break;case 4:f.vertexAttrib=function(e){e.vertexAttrib4fv(this.index,this.value)}}f.disableVertexAttribArray=function(e){}}e.push(f)}function m(e,t,n){for(var i=0;i<t.length;++i){var a=t[i];a.enabled&&a.vertexAttrib(e)}r(n)&&e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,n._getBuffer())}function _(i){i=n(i,n.EMPTY_OBJECT),e.defined("options.context",i.context),e.defined("options.attributes",i.attributes);var a,s=i.context,u=s._gl,c=i.attributes,l=i.indexBuffer,f=[],d=1,h=!1,_=!1,y=c.length;for(a=0;a<y;++a)p(f,c[a],a,s);for(y=f.length,a=0;a<y;++a){var v=f[a];if(r(v.vertexBuffer)&&0===v.instanceDivisor){var g=v.strideInBytes||v.componentsPerAttribute*t.getSizeInBytes(v.componentDatatype);d=v.vertexBuffer.sizeInBytes/g;break}}for(a=0;a<y;++a)f[a].instanceDivisor>0&&(h=!0),r(f[a].value)&&(_=!0);var E={};for(a=0;a<y;++a){var T=f[a].index;if(E[T])throw new o("Index "+T+" is used by more than one attribute.");E[T]=!0}var w;s.vertexArrayObject&&(w=s.glCreateVertexArray(),s.glBindVertexArray(w),m(u,f,l),s.glBindVertexArray(null)),this._numberOfVertices=d,this._hasInstancedAttributes=h,this._hasConstantAttributes=_,this._context=s,this._gl=u,this._vao=w,this._attributes=f,this._indexBuffer=l}function y(e){return e.values.length/e.componentsPerAttribute}function v(e){return t.getSizeInBytes(e.componentDatatype)*e.componentsPerAttribute}function g(e){var n,i,a,o=[];for(i in e)e.hasOwnProperty(i)&&r(e[i])&&r(e[i].values)&&(o.push(i),e[i].componentDatatype===t.DOUBLE&&(e[i].componentDatatype=t.FLOAT,e[i].values=t.createTypedArray(t.FLOAT,e[i].values)));var s,u=o.length;if(u>0)for(s=y(e[o[0]]),n=1;n<u;++n){var c=y(e[o[n]]);if(c!==s)throw new l("Each attribute list must have the same number of vertices.  Attribute "+o[n]+" has a different number of vertices ("+c.toString()+") than attribute "+o[0]+" ("+s.toString()+").")}o.sort(function(n,r){return t.getSizeInBytes(e[r].componentDatatype)-t.getSizeInBytes(e[n].componentDatatype)});var f=0,d={};for(n=0;n<u;++n)i=o[n],a=e[i],d[i]=f,f+=v(a);if(f>0){var h=t.getSizeInBytes(e[o[0]].componentDatatype),p=f%h;0!==p&&(f+=h-p);var m=s*f,_=new ArrayBuffer(m),g={};for(n=0;n<u;++n){i=o[n];var E=t.getSizeInBytes(e[i].componentDatatype);g[i]={pointer:t.createTypedArray(e[i].componentDatatype,_),index:d[i]/E,strideInComponentType:f/E}}for(n=0;n<s;++n)for(var T=0;T<u;++T){i=o[T],a=e[i];for(var w=a.values,b=g[i],S=b.pointer,C=a.componentsPerAttribute,O=0;O<C;++O)S[b.index+O]=w[n*C+O];b.index+=b.strideInComponentType}return{buffer:_,offsetsInBytes:d,vertexSizeInBytes:f}}}function E(e){var t=e._context,n=e._hasInstancedAttributes;if(n||t._previousDrawInstanced){t._previousDrawInstanced=n;var r,i=t._vertexAttribDivisors,a=e._attributes,o=h.maximumVertexAttributes;if(n){var s=a.length;for(r=0;r<s;++r){var u=a[r];if(u.enabled){var c=u.instanceDivisor,l=u.index;c!==i[l]&&(t.glVertexAttribDivisor(l,c),i[l]=c)}}}else for(r=0;r<o;++r)i[r]>0&&(t.glVertexAttribDivisor(r,0),i[r]=0)}}function T(e,t){for(var n=e._attributes,i=n.length,a=0;a<i;++a){var o=n[a];o.enabled&&r(o.value)&&o.vertexAttrib(t)}}return _.fromGeometry=function(i){i=n(i,n.EMPTY_OBJECT),e.defined("options.context",i.context);var a,o,l,h=i.context,p=n(i.geometry,n.EMPTY_OBJECT),m=n(i.bufferUsage,d.DYNAMIC_DRAW),y=n(i.attributeLocations,n.EMPTY_OBJECT),v=n(i.interleave,!1),E=i.vertexArrayAttributes,T=r(E)?E:[],w=p.attributes;if(v){var b=g(w);if(r(b)){l=f.createVertexBuffer({context:h,typedArray:b.buffer,usage:m});var S=b.offsetsInBytes,C=b.vertexSizeInBytes;for(a in w)w.hasOwnProperty(a)&&r(w[a])&&(o=w[a],r(o.values)?T.push({index:y[a],vertexBuffer:l,componentDatatype:o.componentDatatype,componentsPerAttribute:o.componentsPerAttribute,normalize:o.normalize,offsetInBytes:S[a],strideInBytes:C}):T.push({index:y[a],value:o.value,componentDatatype:o.componentDatatype,normalize:o.normalize}))}}else for(a in w)if(w.hasOwnProperty(a)&&r(w[a])){o=w[a];var O=o.componentDatatype;O===t.DOUBLE&&(O=t.FLOAT),l=void 0,r(o.values)&&(l=f.createVertexBuffer({context:h,typedArray:t.createTypedArray(O,o.values),usage:m})),T.push({index:y[a],vertexBuffer:l,value:o.value,componentDatatype:O,componentsPerAttribute:o.componentsPerAttribute,normalize:o.normalize})}var A,x=p.indices;return r(x)&&(A=s.computeNumberOfVertices(p)>=c.SIXTY_FOUR_KILOBYTES&&h.elementIndexUint?f.createIndexBuffer({context:h,typedArray:new Uint32Array(x),usage:m,indexDatatype:u.UNSIGNED_INT}):f.createIndexBuffer({context:h,typedArray:new Uint16Array(x),usage:m,indexDatatype:u.UNSIGNED_SHORT})),new _({context:h,attributes:T,indexBuffer:A})},i(_.prototype,{numberOfAttributes:{get:function(){return this._attributes.length}},numberOfVertices:{get:function(){return this._numberOfVertices}},indexBuffer:{get:function(){return this._indexBuffer}}}),_.prototype.getAttribute=function(t){return e.defined("index",t),this._attributes[t]},_.prototype._bind=function(){r(this._vao)?(this._context.glBindVertexArray(this._vao),this._context.instancedArrays&&E(this),this._hasConstantAttributes&&T(this,this._gl)):m(this._gl,this._attributes,this._indexBuffer)},_.prototype._unBind=function(){if(r(this._vao))this._context.glBindVertexArray(null);else{for(var e=this._attributes,t=this._gl,n=0;n<e.length;++n){var i=e[n];i.enabled&&i.disableVertexAttribArray(t)}this._indexBuffer&&t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)}},_.prototype.isDestroyed=function(){return!1},_.prototype.destroy=function(){for(var e=this._attributes,t=0;t<e.length;++t){var n=e[t].vertexBuffer;r(n)&&!n.isDestroyed()&&n.vertexArrayDestroyable&&n.destroy()}var i=this._indexBuffer;return r(i)&&!i.isDestroyed()&&i.vertexArrayDestroyable&&i.destroy(),r(this._vao)&&this._context.glDeleteVertexArray(this._vao),a(this)},_}),define("Scene/BatchTable",["../Core/Cartesian2","../Core/Cartesian3","../Core/Cartesian4","../Core/combine","../Core/ComponentDatatype","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/FeatureDetection","../Core/Math","../Core/PixelFormat","../Renderer/ContextLimits","../Renderer/PixelDatatype","../Renderer/Sampler","../Renderer/Texture","../Renderer/TextureMagnificationFilter","../Renderer/TextureMinificationFilter"],function(e,t,n,r,i,a,o,s,u,c,l,f,d,h,p,m,_,y){"use strict";function v(t,r,i){if(!a(t))throw new u("context is required");if(!a(r))throw new u("attributes is required");if(!a(i))throw new u("numberOfInstances is required");if(this._attributes=r,this._numberOfInstances=i,0!==r.length){var o=g(r),s=t.floatingPointTexture,c=o===h.FLOAT&&!s,l=T(r,c),f=w(l,r,c),p=Math.floor(d.maximumTextureSize/f),m=Math.min(i,p),_=f*m,y=Math.ceil(i/m),v=1/_,E=.5*v,b=1/y,S=.5*b;this._textureDimensions=new e(_,y),this._textureStep=new n(v,E,b,S),this._pixelDatatype=c?h.UNSIGNED_BYTE:o,this._packFloats=c,this._offsets=l,this._stride=f,this._texture=void 0;var C=4*_*y;this._batchValues=o!==h.FLOAT||c?new Uint8Array(C):new Float32Array(C),this._batchValuesDirty=!1}}function g(e){for(var t=!1,n=e.length,r=0;r<n;++r)if(e[r].componentDatatype!==i.UNSIGNED_BYTE){t=!0;break}return t?h.FLOAT:h.UNSIGNED_BYTE}function E(r,i){var a=r[i].componentsPerAttribute;return 2===a?e:3===a?t:4===a?n:Number}function T(e,t){for(var n=new Array(e.length),r=0,a=e.length,o=0;o<a;++o){var s=e[o],u=s.componentDatatype;n[o]=r,u!==i.UNSIGNED_BYTE&&t?r+=4:++r}return n}function w(e,t,n){var r=e.length,a=e[r-1];return t[r-1].componentDatatype!==i.UNSIGNED_BYTE&&n?a+4:a+1}function b(e,t,r){var i=n.unpack(e,t,D),a=n.unpackFloat(i);i=n.unpack(e,t+4,D);var o=n.unpackFloat(i);i=n.unpack(e,t+8,D);var s=n.unpackFloat(i);i=n.unpack(e,t+12,D);var u=n.unpackFloat(i);return n.fromElements(a,o,s,u,r)}function S(e,t,r){var i=n.packFloat(e.x,D);n.pack(i,t,r),i=n.packFloat(e.y,i),n.pack(i,t,r+4),i=n.packFloat(e.z,i),n.pack(i,t,r+8),i=n.packFloat(e.w,i),n.pack(i,t,r+12)}function C(e,t){var n=e._textureDimensions;e._texture=new m({context:t,pixelFormat:f.RGBA,pixelDatatype:e._pixelDatatype,width:n.x,height:n.y,sampler:new p({minificationFilter:y.NEAREST,magnificationFilter:_.NEAREST}),flipY:!1})}function O(e){var t=e._textureDimensions;e._texture.copyFrom({width:t.x,height:t.y,arrayBufferView:e._batchValues})}function A(e){var t=e._stride;return 1===e._textureDimensions.y?"uniform vec4 batchTextureStep; \nvec2 computeSt(float batchId) \n{ \n    float stepX = batchTextureStep.x; \n    float centerX = batchTextureStep.y; \n    float numberOfAttributes = float("+t+"); \n    return vec2(centerX + (batchId * numberOfAttributes * stepX), 0.5); \n} \n":"uniform vec4 batchTextureStep; \nuniform vec2 batchTextureDimensions; \nvec2 computeSt(float batchId) \n{ \n    float stepX = batchTextureStep.x; \n    float centerX = batchTextureStep.y; \n    float stepY = batchTextureStep.z; \n    float centerY = batchTextureStep.w; \n    float numberOfAttributes = float("+t+"); \n    float xId = mod(batchId * numberOfAttributes, batchTextureDimensions.x); \n    float yId = floor(batchId * numberOfAttributes / batchTextureDimensions.x); \n    return vec2(centerX + (xId * stepX), centerY + (yId * stepY)); \n} \n"}function x(e){return 1===e?"float":"vec"+e}function R(e){return 1===e?".x":2===e?".xy":3===e?".xyz":""}function I(e,t){var n=e._attributes,r=n[t],a=r.componentsPerAttribute,o=r.functionName,s=x(a),u=R(a),c=e._offsets[t],l=s+" "+o+"(float batchId) \n{ \n    vec2 st = computeSt(batchId); \n    st.x += batchTextureStep.x * float("+c+"); \n";return e._packFloats&&r.componentDatatype!==h.UNSIGNED_BYTE?l+="vec4 textureValue; \ntextureValue.x = czm_unpackFloat(texture2D(batchTexture, st)); \ntextureValue.y = czm_unpackFloat(texture2D(batchTexture, st + vec2(batchTextureStep.x, 0.0))); \ntextureValue.z = czm_unpackFloat(texture2D(batchTexture, st + vec2(batchTextureStep.x * 2.0, 0.0))); \ntextureValue.w = czm_unpackFloat(texture2D(batchTexture, st + vec2(batchTextureStep.x * 3.0, 0.0))); \n":l+="    vec4 textureValue = texture2D(batchTexture, st); \n",l+="    "+s+" value = textureValue"+u+"; \n",e._pixelDatatype!==h.UNSIGNED_BYTE||r.componentDatatype!==i.UNSIGNED_BYTE||r.normalize?e._pixelDatatype===h.FLOAT&&r.componentDatatype===i.UNSIGNED_BYTE&&r.normalize&&(l+="value /= 255.0; \n"):l+="value *= 255.0; \n",l+="    return value; \n} \n"}o(v.prototype,{attributes:{get:function(){return this._attributes}},numberOfInstances:{get:function(){return this._numberOfInstances}}});var D=new n;if(c.supportsTypedArrays()){var P=new n;v.prototype.getBatchedAttribute=function(e,t,r){if(e<0||e>=this._numberOfInstances)throw new u("instanceIndex is out of range.");if(t<0||t>=this._attributes.length)throw new u("attributeIndex is out of range");var i,o=this._attributes,s=this._offsets[t],c=this._stride,l=4*c*e+4*s;i=this._packFloats&&o[t].componentDatatype!==h.UNSIGNED_BYTE?b(this._batchValues,l,P):n.unpack(this._batchValues,l,P);var f=E(o,t);return a(f.fromCartesian4)?f.fromCartesian4(i,r):a(f.clone)?f.clone(i,r):i.x};var N=[void 0,void 0,new e,new t,new n],M=new n;return v.prototype.setBatchedAttribute=function(e,t,r){if(e<0||e>=this._numberOfInstances)throw new u("instanceIndex is out of range.");if(t<0||t>=this._attributes.length)throw new u("attributeIndex is out of range");if(!a(r))throw new u("value is required.");var i=this._attributes,o=N[i[t].componentsPerAttribute],s=this.getBatchedAttribute(e,t,o),c=E(this._attributes,t);if(!(a(c.equals)?c.equals(s,r):s===r)){var l=M;l.x=a(r.x)?r.x:r,l.y=a(r.y)?r.y:0,l.z=a(r.z)?r.z:0,l.w=a(r.w)?r.w:0;var f=this._offsets[t],d=this._stride,p=4*d*e+4*f;this._packFloats&&i[t].componentDatatype!==h.UNSIGNED_BYTE?S(l,this._batchValues,p):n.pack(l,this._batchValues,p),this._batchValuesDirty=!0}},v.prototype.update=function(e){a(this._texture)&&!this._batchValuesDirty||0===this._attributes.length||(this._batchValuesDirty=!1,a(this._texture)||C(this,e.context),O(this))},v.prototype.getUniformMapCallback=function(){var e=this;return function(t){return 0===e._attributes.length?t:r(t,{batchTexture:function(){return e._texture},batchTextureDimensions:function(){return e._textureDimensions},batchTextureStep:function(){return e._textureStep}})}},v.prototype.getVertexShaderCallback=function(){var e=this._attributes;if(0===e.length)return function(e){return e};var t="uniform sampler2D batchTexture; \n";t+=A(this)+"\n";for(var n=e.length,r=0;r<n;++r)t+=I(this,r);return function(e){var n=e.indexOf("void main"),r=e.substring(0,n),i=e.substring(n);return r+"\n"+t+"\n"+i}},v.prototype.isDestroyed=function(){return!1},v.prototype.destroy=function(){return this._texture=this._texture&&this._texture.destroy(),s(this)},v}}),define("Scene/DepthFunction",["../Core/freezeObject","../Core/WebGLConstants"],function(e,t){"use strict";return e({NEVER:t.NEVER,LESS:t.LESS,EQUAL:t.EQUAL,LESS_OR_EQUAL:t.LEQUAL,GREATER:t.GREATER,NOT_EQUAL:t.NOTEQUAL,GREATER_OR_EQUAL:t.GEQUAL,ALWAYS:t.ALWAYS})}),define("Core/AttributeCompression",["./Cartesian2","./Cartesian3","./Check","./defined","./DeveloperError","./Math"],function(e,t,n,r,i,a){"use strict";function o(e){return l[0]=e,l[0]}function s(e){return e>>1^-(1&e)}var u={};u.octEncodeInRange=function(e,r,o){n.defined("vector",e),n.defined("result",o);var s=t.magnitudeSquared(e);if(Math.abs(s-1)>a.EPSILON6)throw new i("vector must be normalized.");if(o.x=e.x/(Math.abs(e.x)+Math.abs(e.y)+Math.abs(e.z)),o.y=e.y/(Math.abs(e.x)+Math.abs(e.y)+Math.abs(e.z)),e.z<0){var u=o.x,c=o.y;o.x=(1-Math.abs(c))*a.signNotZero(u),o.y=(1-Math.abs(u))*a.signNotZero(c)}return o.x=a.toSNorm(o.x,r),o.y=a.toSNorm(o.y,r),o},u.octEncode=function(e,t){return u.octEncodeInRange(e,255,t)};var c=new e,l=new Uint8Array(1);u.octEncodeToCartesian4=function(e,t){return u.octEncodeInRange(e,65535,c),t.x=o(c.x*(1/256)),t.y=o(c.x),t.z=o(c.y*(1/256)),t.w=o(c.y),t},u.octDecodeInRange=function(e,r,o,s){if(n.defined("result",s),e<0||e>o||r<0||r>o)throw new i("x and y must be unsigned normalized integers between 0 and "+o);if(s.x=a.fromSNorm(e,o),s.y=a.fromSNorm(r,o),s.z=1-(Math.abs(s.x)+Math.abs(s.y)),s.z<0){var u=s.x;s.x=(1-Math.abs(s.y))*a.signNotZero(u),s.y=(1-Math.abs(u))*a.signNotZero(s.y)}return t.normalize(s,s)},u.octDecode=function(e,t,n){return u.octDecodeInRange(e,t,255,n)},u.octDecodeFromCartesian4=function(e,t){n.typeOf.object("encoded",e),n.typeOf.object("result",t);var r=e.x,a=e.y,o=e.z,s=e.w;if(r<0||r>255||a<0||a>255||o<0||o>255||s<0||s>255)throw new i("x, y, z, and w must be unsigned normalized integers between 0 and 255");var c=256*r+a,l=256*o+s;return u.octDecodeInRange(c,l,65535,t)},u.octPackFloat=function(e){return n.defined("encoded",e),256*e.x+e.y};var f=new e;return u.octEncodeFloat=function(e){return u.octEncode(e,f),u.octPackFloat(f)},u.octDecodeFloat=function(e,t){n.defined("value",e);var r=e/256,i=Math.floor(r),a=256*(r-i);return u.octDecode(i,a,t)},u.octPack=function(e,t,r,i){n.defined("v1",e),n.defined("v2",t),n.defined("v3",r),n.defined("result",i);var a=u.octEncodeFloat(e),o=u.octEncodeFloat(t),s=u.octEncode(r,f);return i.x=65536*s.x+a,i.y=65536*s.y+o,i},u.octUnpack=function(e,t,r,i){n.defined("packed",e),n.defined("v1",t),n.defined("v2",r),n.defined("v3",i);var a=e.x/65536,o=Math.floor(a),s=65536*(a-o);a=e.y/65536;var c=Math.floor(a),l=65536*(a-c);u.octDecodeFloat(s,t),u.octDecodeFloat(l,r),u.octDecode(o,c,i)},u.compressTextureCoordinates=function(e){return n.defined("textureCoordinates",e),4096*(4095*e.x|0)+(4095*e.y|0)},u.decompressTextureCoordinates=function(e,t){n.defined("compressed",e),n.defined("result",t);var r=e/4096,i=Math.floor(r);return t.x=i/4095,t.y=(e-4096*i)/4095,t},u.zigZagDeltaDecode=function(e,t,i){n.defined("uBuffer",e),n.defined("vBuffer",t),n.typeOf.number.equals("uBuffer.length","vBuffer.length",e.length,t.length),r(i)&&n.typeOf.number.equals("uBuffer.length","heightBuffer.length",e.length,i.length);for(var a=e.length,o=0,u=0,c=0,l=0;l<a;++l)o+=s(e[l]),u+=s(t[l]),e[l]=o,t[l]=u,r(i)&&(c+=s(i[l]),i[l]=c)},u}),define("Core/barycentricCoordinates",["./Cartesian2","./Cartesian3","./Check","./defined","./Math"],function(e,t,n,r,i){"use strict";function a(a,c,l,f,d){n.defined("point",a),n.defined("p0",c),n.defined("p1",l),n.defined("p2",f),r(d)||(d=new t);var h,p,m,_,y,v,g,E;if(r(c.z)){if(t.equalsEpsilon(a,c,i.EPSILON14))return t.clone(t.UNIT_X,d);if(t.equalsEpsilon(a,l,i.EPSILON14))return t.clone(t.UNIT_Y,d);if(t.equalsEpsilon(a,f,i.EPSILON14))return t.clone(t.UNIT_Z,d);h=t.subtract(l,c,o),p=t.subtract(f,c,s),m=t.subtract(a,c,u),_=t.dot(h,h),y=t.dot(h,p),v=t.dot(h,m),g=t.dot(p,p),E=t.dot(p,m)}else{if(e.equalsEpsilon(a,c,i.EPSILON14))return t.clone(t.UNIT_X,d);if(e.equalsEpsilon(a,l,i.EPSILON14))return t.clone(t.UNIT_Y,d);if(e.equalsEpsilon(a,f,i.EPSILON14))return t.clone(t.UNIT_Z,d);h=e.subtract(l,c,o),p=e.subtract(f,c,s),m=e.subtract(a,c,u),_=e.dot(h,h),y=e.dot(h,p),v=e.dot(h,m),g=e.dot(p,p),E=e.dot(p,m)}var T=_*g-y*y,w=1/T;return d.y=(g*v-y*E)*w,d.z=(_*E-y*v)*w,d.x=1-d.y-d.z,d}var o=new t,s=new t,u=new t;return a}),define("Core/Tipsify",["./defaultValue","./defined","./DeveloperError"],function(e,t,n){"use strict";var r={};return r.calculateACMR=function(r){r=e(r,e.EMPTY_OBJECT);var i=r.indices,a=r.maximumIndex,o=e(r.cacheSize,24);if(!t(i))throw new n("indices is required.");var s=i.length;if(s<3||s%3!=0)throw new n("indices length must be a multiple of three.");if(a<=0)throw new n("maximumIndex must be greater than zero.");if(o<3)throw new n("cacheSize must be greater than two.");if(!t(a)){a=0;for(var u=0,c=i[u];u<s;)c>a&&(a=c),++u,c=i[u]}for(var l=[],f=0;f<a+1;f++)l[f]=0;for(var d=o+1,h=0;h<s;++h)d-l[i[h]]>o&&(l[i[h]]=d,++d);return(d-o+1)/(s/3)},r.tipsify=function(r){function i(e,t,n,r){for(;t.length>=1;){var i=t[t.length-1];if(t.splice(t.length-1,1),e[i].numLiveTriangles>0)return i}for(;a<r;){if(e[a].numLiveTriangles>0)return++a-1;++a}return-1}r=e(r,e.EMPTY_OBJECT);var a,o=r.indices,s=r.maximumIndex,u=e(r.cacheSize,24);if(!t(o))throw new n("indices is required.");var c=o.length;if(c<3||c%3!=0)throw new n("indices length must be a multiple of three.");if(s<=0)throw new n("maximumIndex must be greater than zero.");if(u<3)throw new n("cacheSize must be greater than two.");var l=0,f=0,d=o[f],h=c;if(t(s))l=s+1;else{for(;f<h;)d>l&&(l=d),++f,d=o[f];if(-1===l)return 0;++l}var p,m=[];for(p=0;p<l;p++)m[p]={numLiveTriangles:0,timeStamp:0,vertexTriangles:[]};f=0;for(var _=0;f<h;)m[o[f]].vertexTriangles.push(_),++m[o[f]].numLiveTriangles,m[o[f+1]].vertexTriangles.push(_),++m[o[f+1]].numLiveTriangles,m[o[f+2]].vertexTriangles.push(_),++m[o[f+2]].numLiveTriangles,++_,f+=3;var y=0,v=u+1;a=1;var g,E,T=[],w=[],b=0,S=[],C=c/3,O=[];for(p=0;p<C;p++)O[p]=!1;for(var A,x;-1!==y;){T=[],E=m[y],x=E.vertexTriangles.length;for(var R=0;R<x;++R)if(_=E.vertexTriangles[R],!O[_]){O[_]=!0,f=_+_+_;for(var I=0;I<3;++I)A=o[f],T.push(A),w.push(A),S[b]=A,++b,g=m[A],--g.numLiveTriangles,v-g.timeStamp>u&&(g.timeStamp=v,++v),++f}y=function(e,t,n,r,a,o,s){for(var u,c=-1,l=-1,f=0;f<n.length;){var d=n[f];r[d].numLiveTriangles&&(u=0,a-r[d].timeStamp+2*r[d].numLiveTriangles<=t&&(u=a-r[d].timeStamp),(u>l||-1===l)&&(l=u,c=d)),++f}return-1===c?i(r,o,e,s):c}(o,u,T,m,v,w,l)}return S},r}),define("Core/GeometryPipeline",["./AttributeCompression","./barycentricCoordinates","./BoundingSphere","./Cartesian2","./Cartesian3","./Cartesian4","./Cartographic","./ComponentDatatype","./defaultValue","./defined","./DeveloperError","./EncodedCartesian3","./GeographicProjection","./Geometry","./GeometryAttribute","./GeometryType","./IndexDatatype","./Intersect","./IntersectionTests","./Math","./Matrix3","./Matrix4","./Plane","./PrimitiveType","./Tipsify"],function(e,t,n,r,i,a,o,s,u,c,l,f,d,h,p,m,_,y,v,g,E,T,w,b,S){"use strict";function C(e,t,n,r,i){e[t++]=n,e[t++]=r,e[t++]=r,e[t++]=i,e[t++]=i,e[t]=n}function O(e){for(var t=e.length,n=t/3*6,r=_.createTypedArray(t,n),i=0,a=0;a<t;a+=3,i+=6)C(r,i,e[a],e[a+1],e[a+2]);return r}function A(e){var t=e.length;if(t>=3){var n=6*(t-2),r=_.createTypedArray(t,n);C(r,0,e[0],e[1],e[2]);for(var i=6,a=3;a<t;++a,i+=6)C(r,i,e[a-1],e[a],e[a-2]);return r}return new Uint16Array}function x(e){if(e.length>0){for(var t=e.length-1,n=6*(t-1),r=_.createTypedArray(t,n),i=e[0],a=0,o=1;o<t;++o,a+=6)C(r,a,i,e[o],e[o+1]);return r}return new Uint16Array}function R(e){var t={};for(var n in e)if(e.hasOwnProperty(n)&&c(e[n])&&c(e[n].values)){var r=e[n];t[n]=new p({componentDatatype:r.componentDatatype,componentsPerAttribute:r.componentsPerAttribute,normalize:r.normalize,values:[]})}return t}function I(e,t,n){for(var r in t)if(t.hasOwnProperty(r)&&c(t[r])&&c(t[r].values))for(var i=t[r],a=0;a<i.componentsPerAttribute;++a)e[r].values.push(i.values[n*i.componentsPerAttribute+a])}function D(e,t){if(c(t))for(var n=t.values,r=n.length,a=0;a<r;a+=3)i.unpack(n,a,ue),T.multiplyByPoint(e,ue,ue),i.pack(ue,n,a)}function P(e,t){if(c(t))for(var n=t.values,r=n.length,a=0;a<r;a+=3)i.unpack(n,a,ue),E.multiplyByVector(e,ue,ue),ue=i.normalize(ue,ue),i.pack(ue,n,a)}function N(e,t){var n,r=e.length,i={},a=e[0][t].attributes;for(n in a)if(a.hasOwnProperty(n)&&c(a[n])&&c(a[n].values)){for(var o=a[n],u=o.values.length,l=!0,f=1;f<r;++f){var d=e[f][t].attributes[n];if(!c(d)||o.componentDatatype!==d.componentDatatype||o.componentsPerAttribute!==d.componentsPerAttribute||o.normalize!==d.normalize){l=!1;break}u+=d.values.length}l&&(i[n]=new p({componentDatatype:o.componentDatatype,componentsPerAttribute:o.componentsPerAttribute,normalize:o.normalize,values:s.createTypedArray(o.componentDatatype,u)}))}return i}function M(e,t){var r,a,o,s,u=e.length,f=e[0].modelMatrix,d=c(e[0][t].indices),p=e[0][t].primitiveType;for(a=1;a<u;++a){if(!T.equals(e[a].modelMatrix,f))throw new l("All instances must have the same modelMatrix.");if(c(e[a][t].indices)!==d)throw new l("All instance geometries must have an indices or not have one.");if(e[a][t].primitiveType!==p)throw new l("All instance geometries must have the same primitiveType.")}var m,y,v,g=N(e,t);for(r in g)if(g.hasOwnProperty(r))for(m=g[r].values,s=0,a=0;a<u;++a)for(y=e[a][t].attributes[r].values,v=y.length,o=0;o<v;++o)m[s++]=y[o];var E;if(d){var w=0;for(a=0;a<u;++a)w+=e[a][t].indices.length;var S=h.computeNumberOfVertices(new h({attributes:g,primitiveType:b.POINTS})),C=_.createTypedArray(S,w),O=0,A=0;for(a=0;a<u;++a){var x=e[a][t].indices,R=x.length;for(s=0;s<R;++s)C[O++]=A+x[s];A+=h.computeNumberOfVertices(e[a][t])}E=C}var I,D=new i,P=0;for(a=0;a<u;++a){if(I=e[a][t].boundingSphere,!c(I)){D=void 0;break}i.add(I.center,D,D)}if(c(D))for(i.divideByScalar(D,u,D),a=0;a<u;++a){I=e[a][t].boundingSphere;var M=i.magnitude(i.subtract(I.center,D,fe))+I.radius;M>P&&(P=M)}return new h({attributes:g,indices:E,primitiveType:p,boundingSphere:c(D)?new n(D,P):void 0})}function z(e){if(c(e.indices))return e;var t=h.computeNumberOfVertices(e);if(t<3)throw new l("The number of vertices must be at least three.");if(t%3!=0)throw new l("The number of vertices must be a multiple of three.");for(var n=_.createTypedArray(t,t),r=0;r<t;++r)n[r]=r;return e.indices=n,e}function F(e){var t=h.computeNumberOfVertices(e);if(t<3)throw new l("The number of vertices must be at least three.");var n=_.createTypedArray(t,3*(t-2));n[0]=1,n[1]=0,n[2]=2;for(var r=3,i=3;i<t;++i)n[r++]=i-1,n[r++]=0,n[r++]=i;return e.indices=n,e.primitiveType=b.TRIANGLES,e}function L(e){var t=h.computeNumberOfVertices(e);if(t<3)throw new l("The number of vertices must be at least 3.");var n=_.createTypedArray(t,3*(t-2));n[0]=0,n[1]=1,n[2]=2,t>3&&(n[3]=0,n[4]=2,n[5]=3);for(var r=6,i=3;i<t-1;i+=2)n[r++]=i,n[r++]=i-1,n[r++]=i+1,i+2<t&&(n[r++]=i,n[r++]=i+1,n[r++]=i+2);return e.indices=n,e.primitiveType=b.TRIANGLES,e}function B(e){if(c(e.indices))return e;var t=h.computeNumberOfVertices(e);if(t<2)throw new l("The number of vertices must be at least two.");if(t%2!=0)throw new l("The number of vertices must be a multiple of 2.");for(var n=_.createTypedArray(t,t),r=0;r<t;++r)n[r]=r;return e.indices=n,e}function U(e){var t=h.computeNumberOfVertices(e);if(t<2)throw new l("The number of vertices must be at least two.");var n=_.createTypedArray(t,2*(t-1));n[0]=0,n[1]=1;for(var r=2,i=2;i<t;++i)n[r++]=i-1,n[r++]=i;return e.indices=n,e.primitiveType=b.LINES,e}function q(e){var t=h.computeNumberOfVertices(e);if(t<2)throw new l("The number of vertices must be at least two.");var n=_.createTypedArray(t,2*t);n[0]=0,n[1]=1;for(var r=2,i=2;i<t;++i)n[r++]=i-1,n[r++]=i;return n[r++]=t-1,n[r]=0,e.indices=n,e.primitiveType=b.LINES,e}function G(e){switch(e.primitiveType){case b.TRIANGLE_FAN:return F(e);case b.TRIANGLE_STRIP:return L(e);case b.TRIANGLES:return z(e);case b.LINE_STRIP:return U(e);case b.LINE_LOOP:return q(e);case b.LINES:return B(e)}return e}function V(e,t){Math.abs(e.y)<g.EPSILON6&&(e.y=t?-g.EPSILON6:g.EPSILON6)}function j(e,t,n){if(0!==e.y&&0!==t.y&&0!==n.y)return V(e,e.y<0),V(t,t.y<0),void V(n,n.y<0);var r,i=Math.abs(e.y),a=Math.abs(t.y),o=Math.abs(n.y);r=i>a?i>o?g.sign(e.y):g.sign(n.y):a>o?g.sign(t.y):g.sign(n.y);var s=r<0;V(e,s),V(t,s),V(n,s)}function k(e,t,n,r){i.add(e,i.multiplyByScalar(i.subtract(t,e,Se),e.y/(e.y-t.y),Se),n),i.clone(n,r),V(n,!0),V(r,!1)}function H(e,t,n){if(!(e.x>=0||t.x>=0||n.x>=0)){j(e,t,n);var r=e.y<0,i=t.y<0,a=n.y<0,o=0;o+=r?1:0,o+=i?1:0,o+=a?1:0;var s=Re.indices;1===o?(s[1]=3,s[2]=4,s[5]=6,s[7]=6,s[8]=5,r?(k(e,t,Ce,Ae),k(e,n,Oe,xe),s[0]=0,s[3]=1,s[4]=2,s[6]=1):i?(k(t,n,Ce,Ae),k(t,e,Oe,xe),s[0]=1,s[3]=2,s[4]=0,s[6]=2):a&&(k(n,e,Ce,Ae),k(n,t,Oe,xe),s[0]=2,s[3]=0,s[4]=1,s[6]=0)):2===o&&(s[2]=4,s[4]=4,s[5]=3,s[7]=5,s[8]=6,r?i?a||(k(n,e,Ce,Ae),k(n,t,Oe,xe),s[0]=0,s[1]=1,s[3]=0,s[6]=2):(k(t,n,Ce,Ae),k(t,e,Oe,xe),s[0]=2,s[1]=0,s[3]=2,s[6]=1):(k(e,t,Ce,Ae),k(e,n,Oe,xe),s[0]=1,s[1]=2,s[3]=1,s[6]=0));var u=Re.positions;return u[0]=e,u[1]=t,u[2]=n,u.length=3,1!==o&&2!==o||(u[3]=Ce,u[4]=Oe,u[5]=Ae,u[6]=xe,u.length=7),Re}}function W(e,t){var r=e.attributes;if(0!==r.position.values.length){for(var i in r)if(r.hasOwnProperty(i)&&c(r[i])&&c(r[i].values)){var a=r[i];a.values=s.createTypedArray(a.componentDatatype,a.values)}var o=h.computeNumberOfVertices(e);return e.indices=_.createTypedArray(o,e.indices),t&&(e.boundingSphere=n.fromVertices(r.position.values)),e}}function Y(e){var t=e.attributes,n={};for(var r in t)if(t.hasOwnProperty(r)&&c(t[r])&&c(t[r].values)){var i=t[r];n[r]=new p({componentDatatype:i.componentDatatype,componentsPerAttribute:i.componentsPerAttribute,normalize:i.normalize,values:[]})}return new h({attributes:n,indices:[],primitiveType:e.primitiveType})}function X(e,t,n){var r=c(e.geometry.boundingSphere);t=W(t,r),n=W(n,r),c(n)&&!c(t)?e.geometry=n:!c(n)&&c(t)?e.geometry=t:(e.westHemisphereGeometry=t,e.eastHemisphereGeometry=n,e.geometry=void 0)}function Z(e,t){var n=new e,r=new e,i=new e;return function(a,o,s,u,c,l,f,d){var h=e.fromArray(c,a*t,n),p=e.fromArray(c,o*t,r),m=e.fromArray(c,s*t,i);e.multiplyByScalar(h,u.x,h),e.multiplyByScalar(p,u.y,p),e.multiplyByScalar(m,u.z,m);var _=e.add(h,p,h);e.add(_,m,_),d&&e.normalize(_,_),e.pack(_,l,f*t)}}function K(e,n,r,a,o,s,u,l,f,d,h,p,m,_,y,v){if(c(s)||c(u)||c(l)||c(f)||c(d)||0!==_){var g=i.fromArray(o,3*e,Me),E=i.fromArray(o,3*n,ze),T=i.fromArray(o,3*r,Fe),w=t(a,g,E,T,Le);if(c(s)&&De(e,n,r,w,s,p.normal.values,v,!0),c(d)){var b=i.fromArray(d,3*e,Me),S=i.fromArray(d,3*n,ze),C=i.fromArray(d,3*r,Fe);i.multiplyByScalar(b,w.x,b),i.multiplyByScalar(S,w.y,S),i.multiplyByScalar(C,w.z,C);var O;i.equals(b,i.ZERO)&&i.equals(S,i.ZERO)&&i.equals(C,i.ZERO)?(O=Me,O.x=0,O.y=0,O.z=0):(O=i.add(b,S,b),i.add(O,C,O),i.normalize(O,O)),i.pack(O,p.extrudeDirection.values,3*v)}if(c(h)&&Ne(e,n,r,w,h,p.applyOffset.values,v),c(u)&&De(e,n,r,w,u,p.tangent.values,v,!0),c(l)&&De(e,n,r,w,l,p.bitangent.values,v,!0),c(f)&&Pe(e,n,r,w,f,p.st.values,v),_>0)for(var A=0;A<_;A++){var x=m[A];Q(e,n,r,w,v,y[x],p[x])}}}function Q(e,t,n,r,i,a,o){var s=a.componentsPerAttribute,u=a.values,c=o.values;switch(s){case 4:Ie(e,t,n,r,u,c,i,!1);break;case 3:De(e,t,n,r,u,c,i,!1);break;case 2:Pe(e,t,n,r,u,c,i,!1);break;default:c[i]=u[e]*r.x+u[t]*r.y+u[n]*r.z}}function J(e,t,n,r,i,a){var o=e.position.values.length/3;if(-1!==i){var s=r[i],u=n[s];return-1===u?(n[s]=o,e.position.values.push(a.x,a.y,a.z),t.push(o),o):(t.push(u),u)}return e.position.values.push(a.x,a.y,a.z),t.push(o),o}function $(e){var t=e.geometry,n=t.attributes,r=n.position.values,a=c(n.normal)?n.normal.values:void 0,o=c(n.bitangent)?n.bitangent.values:void 0,s=c(n.tangent)?n.tangent.values:void 0,u=c(n.st)?n.st.values:void 0,l=c(n.extrudeDirection)?n.extrudeDirection.values:void 0,f=c(n.applyOffset)?n.applyOffset.values:void 0,d=t.indices,h=[];for(var p in n)n.hasOwnProperty(p)&&!Be[p]&&c(n[p])&&h.push(p);var m,_,y,v,g,E=h.length,T=Y(t),w=Y(t),b=[];b.length=r.length/3;var S=[];for(S.length=r.length/3,g=0;g<b.length;++g)b[g]=-1,S[g]=-1;var C=d.length;for(g=0;g<C;g+=3){var O=d[g],A=d[g+1],x=d[g+2],R=i.fromArray(r,3*O),I=i.fromArray(r,3*A),D=i.fromArray(r,3*x),P=H(R,I,D);if(c(P)&&P.positions.length>3)for(var N=P.positions,M=P.indices,z=M.length,F=0;F<z;++F){var L=M[F],B=N[L];B.y<0?(m=w.attributes,_=w.indices,y=b):(m=T.attributes,_=T.indices,y=S),v=J(m,_,y,d,L<3?g+L:-1,B),K(O,A,x,B,r,a,s,o,u,l,f,m,h,E,n,v)}else c(P)&&(R=P.positions[0],I=P.positions[1],D=P.positions[2]),R.y<0?(m=w.attributes,_=w.indices,y=b):(m=T.attributes,_=T.indices,y=S),v=J(m,_,y,d,g,R),K(O,A,x,R,r,a,s,o,u,l,f,m,h,E,n,v),v=J(m,_,y,d,g+1,I),K(O,A,x,I,r,a,s,o,u,l,f,m,h,E,n,v),v=J(m,_,y,d,g+2,D),K(O,A,x,D,r,a,s,o,u,l,f,m,h,E,n,v)}X(e,w,T)}function ee(e,t,n,r,a,o,s){if(c(s)){var u=i.fromArray(r,3*e,Me);i.equalsEpsilon(u,n,g.EPSILON10)?o.applyOffset.values[a]=s[e]:o.applyOffset.values[a]=s[t]}}function te(e){var t,n=e.geometry,r=n.attributes,a=r.position.values,o=c(r.applyOffset)?r.applyOffset.values:void 0,s=n.indices,u=Y(n),l=Y(n),f=s.length,d=[];d.length=a.length/3;var h=[];for(h.length=a.length/3,t=0;t<d.length;++t)d[t]=-1,h[t]=-1;for(t=0;t<f;t+=2){var p,m=s[t],_=s[t+1],y=i.fromArray(a,3*m,Me),E=i.fromArray(a,3*_,ze);Math.abs(y.y)<g.EPSILON6&&(y.y<0?y.y=-g.EPSILON6:y.y=g.EPSILON6),Math.abs(E.y)<g.EPSILON6&&(E.y<0?E.y=-g.EPSILON6:E.y=g.EPSILON6);var T=u.attributes,w=u.indices,b=h,S=l.attributes,C=l.indices,O=d,A=v.lineSegmentPlane(y,E,Ue,Fe);if(c(A)){var x=i.multiplyByScalar(i.UNIT_Y,5*g.EPSILON9,qe);y.y<0&&(i.negate(x,x),T=l.attributes,w=l.indices,b=d,S=u.attributes,C=u.indices,O=h);var R=i.add(A,x,Ge);p=J(T,w,b,s,t,y),ee(m,_,y,a,p,T,o),p=J(T,w,b,s,-1,R),ee(m,_,R,a,p,T,o),i.negate(x,x),i.add(A,x,R),p=J(S,C,O,s,-1,R),ee(m,_,R,a,p,S,o),p=J(S,C,O,s,t+1,E),ee(m,_,E,a,p,S,o)}else{var I,D,P;y.y<0?(I=l.attributes,D=l.indices,P=d):(I=u.attributes,D=u.indices,P=h),p=J(I,D,P,s,t,y),ee(m,_,y,a,p,I,o),p=J(I,D,P,s,t+1,E),ee(m,_,E,a,p,I,o)}}X(e,l,u)}function ne(e){
for(var t=e.attributes,n=t.position.values,r=t.prevPosition.values,a=t.nextPosition.values,o=n.length,s=0;s<o;s+=3){var u=i.unpack(n,s,ke);if(!(u.x>0)){var c=i.unpack(r,s,He);(u.y<0&&c.y>0||u.y>0&&c.y<0)&&(s-3>0?(r[s]=n[s-3],r[s+1]=n[s-2],r[s+2]=n[s-1]):i.pack(u,r,s));var l=i.unpack(a,s,We);(u.y<0&&l.y>0||u.y>0&&l.y<0)&&(s+3<o?(a[s]=n[s+3],a[s+1]=n[s+4],a[s+2]=n[s+5]):i.pack(u,a,s))}}}function re(e){var t,n,o,s=e.geometry,u=s.attributes,l=u.position.values,f=u.prevPosition.values,d=u.nextPosition.values,h=u.expandAndWidth.values,p=c(u.st)?u.st.values:void 0,m=c(u.color)?u.color.values:void 0,_=Y(s),y=Y(s),E=!1,T=l.length/3;for(t=0;t<T;t+=4){var w=t,b=t+2,S=i.fromArray(l,3*w,ke),C=i.fromArray(l,3*b,He);if(Math.abs(S.y)<Je)for(S.y=Je*(C.y<0?-1:1),l[3*t+1]=S.y,l[3*(t+1)+1]=S.y,n=3*w;n<3*w+12;n+=3)f[n]=l[3*t],f[n+1]=l[3*t+1],f[n+2]=l[3*t+2];if(Math.abs(C.y)<Je)for(C.y=Je*(S.y<0?-1:1),l[3*(t+2)+1]=C.y,l[3*(t+3)+1]=C.y,n=3*w;n<3*w+12;n+=3)d[n]=l[3*(t+2)],d[n+1]=l[3*(t+2)+1],d[n+2]=l[3*(t+2)+2];var O=_.attributes,A=_.indices,x=y.attributes,R=y.indices,I=v.lineSegmentPlane(S,C,Ue,Ye);if(c(I)){E=!0;var D=i.multiplyByScalar(i.UNIT_Y,Qe,Xe);S.y<0&&(i.negate(D,D),O=y.attributes,A=y.indices,x=_.attributes,R=_.indices);var P=i.add(I,D,Ze);O.position.values.push(S.x,S.y,S.z,S.x,S.y,S.z),O.position.values.push(P.x,P.y,P.z),O.position.values.push(P.x,P.y,P.z),O.prevPosition.values.push(f[3*w],f[3*w+1],f[3*w+2]),O.prevPosition.values.push(f[3*w+3],f[3*w+4],f[3*w+5]),O.prevPosition.values.push(S.x,S.y,S.z,S.x,S.y,S.z),O.nextPosition.values.push(P.x,P.y,P.z),O.nextPosition.values.push(P.x,P.y,P.z),O.nextPosition.values.push(P.x,P.y,P.z),O.nextPosition.values.push(P.x,P.y,P.z),i.negate(D,D),i.add(I,D,P),x.position.values.push(P.x,P.y,P.z),x.position.values.push(P.x,P.y,P.z),x.position.values.push(C.x,C.y,C.z,C.x,C.y,C.z),x.prevPosition.values.push(P.x,P.y,P.z),x.prevPosition.values.push(P.x,P.y,P.z),x.prevPosition.values.push(P.x,P.y,P.z),x.prevPosition.values.push(P.x,P.y,P.z),x.nextPosition.values.push(C.x,C.y,C.z,C.x,C.y,C.z),x.nextPosition.values.push(d[3*b],d[3*b+1],d[3*b+2]),x.nextPosition.values.push(d[3*b+3],d[3*b+4],d[3*b+5]);var N=r.fromArray(h,2*w,Ve),M=Math.abs(N.y);O.expandAndWidth.values.push(-1,M,1,M),O.expandAndWidth.values.push(-1,-M,1,-M),x.expandAndWidth.values.push(-1,M,1,M),x.expandAndWidth.values.push(-1,-M,1,-M);var z=i.magnitudeSquared(i.subtract(I,S,We));if(z/=i.magnitudeSquared(i.subtract(C,S,We)),c(m)){var F=a.fromArray(m,4*w,Ke),L=a.fromArray(m,4*b,Ke),B=g.lerp(F.x,L.x,z),U=g.lerp(F.y,L.y,z),q=g.lerp(F.z,L.z,z),G=g.lerp(F.w,L.w,z);for(n=4*w;n<4*w+8;++n)O.color.values.push(m[n]);for(O.color.values.push(B,U,q,G),O.color.values.push(B,U,q,G),x.color.values.push(B,U,q,G),x.color.values.push(B,U,q,G),n=4*b;n<4*b+8;++n)x.color.values.push(m[n])}if(c(p)){var V=r.fromArray(p,2*w,Ve),j=r.fromArray(p,2*(t+3),je),k=g.lerp(V.x,j.x,z);for(n=2*w;n<2*w+4;++n)O.st.values.push(p[n]);for(O.st.values.push(k,V.y),O.st.values.push(k,j.y),x.st.values.push(k,V.y),x.st.values.push(k,j.y),n=2*b;n<2*b+4;++n)x.st.values.push(p[n])}o=O.position.values.length/3-4,A.push(o,o+2,o+1),A.push(o+1,o+2,o+3),o=x.position.values.length/3-4,R.push(o,o+2,o+1),R.push(o+1,o+2,o+3)}else{var H,W;for(S.y<0?(H=y.attributes,W=y.indices):(H=_.attributes,W=_.indices),H.position.values.push(S.x,S.y,S.z),H.position.values.push(S.x,S.y,S.z),H.position.values.push(C.x,C.y,C.z),H.position.values.push(C.x,C.y,C.z),n=3*t;n<3*t+12;++n)H.prevPosition.values.push(f[n]),H.nextPosition.values.push(d[n]);for(n=2*t;n<2*t+8;++n)H.expandAndWidth.values.push(h[n]),c(p)&&H.st.values.push(p[n]);if(c(m))for(n=4*t;n<4*t+16;++n)H.color.values.push(m[n]);o=H.position.values.length/3-4,W.push(o,o+2,o+1),W.push(o+1,o+2,o+3)}}E&&(ne(y),ne(_)),X(e,y,_)}var ie={};ie.toWireframe=function(e){if(!c(e))throw new l("geometry is required.");var t=e.indices;if(c(t)){switch(e.primitiveType){case b.TRIANGLES:e.indices=O(t);break;case b.TRIANGLE_STRIP:e.indices=A(t);break;case b.TRIANGLE_FAN:e.indices=x(t);break;default:throw new l("geometry.primitiveType must be TRIANGLES, TRIANGLE_STRIP, or TRIANGLE_FAN.")}e.primitiveType=b.LINES}return e},ie.createLineSegmentsForVectors=function(e,t,r){if(t=u(t,"normal"),!c(e))throw new l("geometry is required.");if(!c(e.attributes.position))throw new l("geometry.attributes.position is required.");if(!c(e.attributes[t]))throw new l("geometry.attributes must have an attribute with the same name as the attributeName parameter, "+t+".");r=u(r,1e4);for(var i=e.attributes.position.values,a=e.attributes[t].values,o=i.length,f=new Float64Array(2*o),d=0,m=0;m<o;m+=3)f[d++]=i[m],f[d++]=i[m+1],f[d++]=i[m+2],f[d++]=i[m]+a[m]*r,f[d++]=i[m+1]+a[m+1]*r,f[d++]=i[m+2]+a[m+2]*r;var _,y=e.boundingSphere;return c(y)&&(_=new n(y.center,y.radius+r)),new h({attributes:{position:new p({componentDatatype:s.DOUBLE,componentsPerAttribute:3,values:f})},primitiveType:b.LINES,boundingSphere:_})},ie.createAttributeLocations=function(e){if(!c(e))throw new l("geometry is required.");var t,n=["position","positionHigh","positionLow","position3DHigh","position3DLow","position2DHigh","position2DLow","pickColor","normal","st","tangent","bitangent","extrudeDirection","compressedAttributes"],r=e.attributes,i={},a=0,o=n.length;for(t=0;t<o;++t){var s=n[t];c(r[s])&&(i[s]=a++)}for(var u in r)r.hasOwnProperty(u)&&!c(i[u])&&(i[u]=a++);return i},ie.reorderForPreVertexCache=function(e){if(!c(e))throw new l("geometry is required.");var t=h.computeNumberOfVertices(e),n=e.indices;if(c(n)){for(var r=new Int32Array(t),i=0;i<t;i++)r[i]=-1;for(var a,o=n,u=o.length,f=_.createTypedArray(t,u),d=0,p=0,m=0;d<u;)a=r[o[d]],-1!==a?f[p]=a:(a=o[d],r[a]=m,f[p]=m,++m),++d,++p;e.indices=f;var y=e.attributes;for(var v in y)if(y.hasOwnProperty(v)&&c(y[v])&&c(y[v].values)){for(var g=y[v],E=g.values,T=0,w=g.componentsPerAttribute,b=s.createTypedArray(g.componentDatatype,m*w);T<t;){var S=r[T];if(-1!==S)for(var C=0;C<w;C++)b[w*S+C]=E[w*T+C];++T}g.values=b}}return e},ie.reorderForPostVertexCache=function(e,t){if(!c(e))throw new l("geometry is required.");var n=e.indices;if(e.primitiveType===b.TRIANGLES&&c(n)){for(var r=n.length,i=0,a=0;a<r;a++)n[a]>i&&(i=n[a]);e.indices=S.tipsify({indices:n,maximumIndex:i,cacheSize:t})}return e},ie.fitToUnsignedShortIndices=function(e){if(!c(e))throw new l("geometry is required.");if(c(e.indices)&&e.primitiveType!==b.TRIANGLES&&e.primitiveType!==b.LINES&&e.primitiveType!==b.POINTS)throw new l("geometry.primitiveType must equal to PrimitiveType.TRIANGLES, PrimitiveType.LINES, or PrimitiveType.POINTS.");var t=[],n=h.computeNumberOfVertices(e);if(c(e.indices)&&n>=g.SIXTY_FOUR_KILOBYTES){var r,i=[],a=[],o=0,s=R(e.attributes),u=e.indices,f=u.length;e.primitiveType===b.TRIANGLES?r=3:e.primitiveType===b.LINES?r=2:e.primitiveType===b.POINTS&&(r=1);for(var d=0;d<f;d+=r){for(var p=0;p<r;++p){var m=u[d+p],_=i[m];c(_)||(_=o++,i[m]=_,I(s,e.attributes,m)),a.push(_)}o+r>=g.SIXTY_FOUR_KILOBYTES&&(t.push(new h({attributes:s,indices:a,primitiveType:e.primitiveType,boundingSphere:e.boundingSphere,boundingSphereCV:e.boundingSphereCV})),i=[],a=[],o=0,s=R(e.attributes))}0!==a.length&&t.push(new h({attributes:s,indices:a,primitiveType:e.primitiveType,boundingSphere:e.boundingSphere,boundingSphereCV:e.boundingSphereCV}))}else t.push(e);return t};var ae=new i,oe=new o;ie.projectTo2D=function(e,t,n,r,a){if(!c(e))throw new l("geometry is required.");if(!c(t))throw new l("attributeName is required.");if(!c(n))throw new l("attributeName3D is required.");if(!c(r))throw new l("attributeName2D is required.");if(!c(e.attributes[t]))throw new l("geometry must have attribute matching the attributeName argument: "+t+".");if(e.attributes[t].componentDatatype!==s.DOUBLE)throw new l("The attribute componentDatatype must be ComponentDatatype.DOUBLE.");var o=e.attributes[t];a=c(a)?a:new d;for(var u=a.ellipsoid,f=o.values,h=new Float64Array(f.length),m=0,_=0;_<f.length;_+=3){var y=i.fromArray(f,_,ae),v=u.cartesianToCartographic(y,oe);if(!c(v))throw new l("Could not project point ("+y.x+", "+y.y+", "+y.z+") to 2D.");var g=a.project(v,ae);h[m++]=g.x,h[m++]=g.y,h[m++]=g.z}return e.attributes[n]=o,e.attributes[r]=new p({componentDatatype:s.DOUBLE,componentsPerAttribute:3,values:h}),delete e.attributes[t],e};var se={high:0,low:0};ie.encodeAttribute=function(e,t,n,r){if(!c(e))throw new l("geometry is required.");if(!c(t))throw new l("attributeName is required.");if(!c(n))throw new l("attributeHighName is required.");if(!c(r))throw new l("attributeLowName is required.");if(!c(e.attributes[t]))throw new l("geometry must have attribute matching the attributeName argument: "+t+".");if(e.attributes[t].componentDatatype!==s.DOUBLE)throw new l("The attribute componentDatatype must be ComponentDatatype.DOUBLE.");for(var i=e.attributes[t],a=i.values,o=a.length,u=new Float32Array(o),d=new Float32Array(o),h=0;h<o;++h)f.encode(a[h],se),u[h]=se.high,d[h]=se.low;var m=i.componentsPerAttribute;return e.attributes[n]=new p({componentDatatype:s.FLOAT,componentsPerAttribute:m,values:u}),e.attributes[r]=new p({componentDatatype:s.FLOAT,componentsPerAttribute:m,values:d}),delete e.attributes[t],e};var ue=new i,ce=new T,le=new E;ie.transformToWorldCoordinates=function(e){if(!c(e))throw new l("instance is required.");var t=e.modelMatrix;if(T.equals(t,T.IDENTITY))return e;var r=e.geometry.attributes;D(t,r.position),D(t,r.prevPosition),D(t,r.nextPosition),(c(r.normal)||c(r.tangent)||c(r.bitangent))&&(T.inverse(t,ce),T.transpose(ce,ce),T.getRotation(ce,le),P(le,r.normal),P(le,r.tangent),P(le,r.bitangent));var i=e.geometry.boundingSphere;return c(i)&&(e.geometry.boundingSphere=n.transform(i,t,i)),e.modelMatrix=T.clone(T.IDENTITY),e};var fe=new i;ie.combineInstances=function(e){if(!c(e)||e.length<1)throw new l("instances is required and must have length greater than zero.");for(var t=[],n=[],r=e.length,i=0;i<r;++i){var a=e[i];c(a.geometry)?t.push(a):c(a.westHemisphereGeometry)&&c(a.eastHemisphereGeometry)&&n.push(a)}var o=[];return t.length>0&&o.push(M(t,"geometry")),n.length>0&&(o.push(M(n,"westHemisphereGeometry")),o.push(M(n,"eastHemisphereGeometry"))),o};var de=new i,he=new i,pe=new i,me=new i;ie.computeNormal=function(e){if(!c(e))throw new l("geometry is required.");if(!c(e.attributes.position)||!c(e.attributes.position.values))throw new l("geometry.attributes.position.values is required.");if(!c(e.indices))throw new l("geometry.indices is required.");if(e.indices.length<2||e.indices.length%3!=0)throw new l("geometry.indices length must be greater than 0 and be a multiple of 3.");if(e.primitiveType!==b.TRIANGLES)throw new l("geometry.primitiveType must be PrimitiveType.TRIANGLES.");var t,n=e.indices,r=e.attributes,a=r.position.values,o=r.position.values.length/3,u=n.length,f=new Array(o),d=new Array(u/3),h=new Array(u);for(t=0;t<o;t++)f[t]={indexOffset:0,count:0,currentCount:0};var m=0;for(t=0;t<u;t+=3){var _=n[t],y=n[t+1],v=n[t+2],E=3*_,T=3*y,w=3*v;he.x=a[E],he.y=a[E+1],he.z=a[E+2],pe.x=a[T],pe.y=a[T+1],pe.z=a[T+2],me.x=a[w],me.y=a[w+1],me.z=a[w+2],f[_].count++,f[y].count++,f[v].count++,i.subtract(pe,he,pe),i.subtract(me,he,me),d[m]=i.cross(pe,me,new i),m++}var S=0;for(t=0;t<o;t++)f[t].indexOffset+=S,S+=f[t].count;m=0;var C;for(t=0;t<u;t+=3){C=f[n[t]];var O=C.indexOffset+C.currentCount;h[O]=m,C.currentCount++,C=f[n[t+1]],O=C.indexOffset+C.currentCount,h[O]=m,C.currentCount++,C=f[n[t+2]],O=C.indexOffset+C.currentCount,h[O]=m,C.currentCount++,m++}var A=new Float32Array(3*o);for(t=0;t<o;t++){var x=3*t;if(C=f[t],i.clone(i.ZERO,de),C.count>0){for(m=0;m<C.count;m++)i.add(de,d[h[C.indexOffset+m]],de);i.equalsEpsilon(i.ZERO,de,g.EPSILON10)&&i.clone(d[h[C.indexOffset]],de)}i.equalsEpsilon(i.ZERO,de,g.EPSILON10)&&(de.z=1),i.normalize(de,de),A[x]=de.x,A[x+1]=de.y,A[x+2]=de.z}return e.attributes.normal=new p({componentDatatype:s.FLOAT,componentsPerAttribute:3,values:A}),e};var _e=new i,ye=new i,ve=new i;ie.computeTangentAndBitangent=function(e){if(!c(e))throw new l("geometry is required.");var t=e.attributes,n=e.indices;if(!c(t.position)||!c(t.position.values))throw new l("geometry.attributes.position.values is required.");if(!c(t.normal)||!c(t.normal.values))throw new l("geometry.attributes.normal.values is required.");if(!c(t.st)||!c(t.st.values))throw new l("geometry.attributes.st.values is required.");if(!c(n))throw new l("geometry.indices is required.");if(n.length<2||n.length%3!=0)throw new l("geometry.indices length must be greater than 0 and be a multiple of 3.");if(e.primitiveType!==b.TRIANGLES)throw new l("geometry.primitiveType must be PrimitiveType.TRIANGLES.");var r,a=e.attributes.position.values,o=e.attributes.normal.values,u=e.attributes.st.values,f=e.attributes.position.values.length/3,d=n.length,h=new Array(3*f);for(r=0;r<h.length;r++)h[r]=0;var m,_,y;for(r=0;r<d;r+=3){var v=n[r],g=n[r+1],E=n[r+2];m=3*v,_=3*g,y=3*E;var T=2*v,w=2*g,S=2*E,C=a[m],O=a[m+1],A=a[m+2],x=u[T],R=u[T+1],I=u[w+1]-R,D=u[S+1]-R,P=1/((u[w]-x)*D-(u[S]-x)*I),N=(D*(a[_]-C)-I*(a[y]-C))*P,M=(D*(a[_+1]-O)-I*(a[y+1]-O))*P,z=(D*(a[_+2]-A)-I*(a[y+2]-A))*P;h[m]+=N,h[m+1]+=M,h[m+2]+=z,h[_]+=N,h[_+1]+=M,h[_+2]+=z,h[y]+=N,h[y+1]+=M,h[y+2]+=z}var F=new Float32Array(3*f),L=new Float32Array(3*f);for(r=0;r<f;r++){m=3*r,_=m+1,y=m+2;var B=i.fromArray(o,m,_e),U=i.fromArray(h,m,ve),q=i.dot(B,U);i.multiplyByScalar(B,q,ye),i.normalize(i.subtract(U,ye,U),U),F[m]=U.x,F[_]=U.y,F[y]=U.z,i.normalize(i.cross(B,U,U),U),L[m]=U.x,L[_]=U.y,L[y]=U.z}return e.attributes.tangent=new p({componentDatatype:s.FLOAT,componentsPerAttribute:3,values:F}),e.attributes.bitangent=new p({componentDatatype:s.FLOAT,componentsPerAttribute:3,values:L}),e};var ge=new r,Ee=new i,Te=new i,we=new i,be=new r;ie.compressVertices=function(t){if(!c(t))throw new l("geometry is required.");var n,a,o=t.attributes.extrudeDirection;if(c(o)){var u=o.values;a=u.length/3;var f=new Float32Array(2*a),d=0;for(n=0;n<a;++n)i.fromArray(u,3*n,Ee),i.equals(Ee,i.ZERO)?d+=2:(be=e.octEncodeInRange(Ee,65535,be),f[d++]=be.x,f[d++]=be.y);return t.attributes.compressedAttributes=new p({componentDatatype:s.FLOAT,componentsPerAttribute:2,values:f}),delete t.attributes.extrudeDirection,t}var h=t.attributes.normal,m=t.attributes.st,_=c(h),y=c(m);if(!_&&!y)return t;var v,g,E,T,w=t.attributes.tangent,b=t.attributes.bitangent,S=c(w),C=c(b);_&&(v=h.values),y&&(g=m.values),S&&(E=w.values),C&&(T=b.values),a=(_?v.length:g.length)/(_?3:2);var O=a,A=y&&_?2:1;A+=S||C?1:0,O*=A;var x=new Float32Array(O),R=0;for(n=0;n<a;++n){y&&(r.fromArray(g,2*n,ge),x[R++]=e.compressTextureCoordinates(ge));var I=3*n;_&&c(E)&&c(T)?(i.fromArray(v,I,Ee),i.fromArray(E,I,Te),i.fromArray(T,I,we),e.octPack(Ee,Te,we,ge),x[R++]=ge.x,x[R++]=ge.y):(_&&(i.fromArray(v,I,Ee),x[R++]=e.octEncodeFloat(Ee)),S&&(i.fromArray(E,I,Ee),x[R++]=e.octEncodeFloat(Ee)),C&&(i.fromArray(T,I,Ee),x[R++]=e.octEncodeFloat(Ee)))}return t.attributes.compressedAttributes=new p({componentDatatype:s.FLOAT,componentsPerAttribute:A,values:x}),_&&delete t.attributes.normal,y&&delete t.attributes.st,C&&delete t.attributes.bitangent,S&&delete t.attributes.tangent,t};var Se=new i,Ce=new i,Oe=new i,Ae=new i,xe=new i,Re={positions:new Array(7),indices:new Array(9)},Ie=Z(a,4),De=Z(i,3),Pe=Z(r,2),Ne=function(e,t,n,r,i,a,o){var s=i[e]*r.x,u=i[t]*r.y,c=i[n]*r.z;a[o]=s+u+c>g.EPSILON6?1:0},Me=new i,ze=new i,Fe=new i,Le=new i,Be={position:!0,normal:!0,bitangent:!0,tangent:!0,st:!0,extrudeDirection:!0,applyOffset:!0},Ue=w.fromPointNormal(i.ZERO,i.UNIT_Y),qe=new i,Ge=new i,Ve=new r,je=new r,ke=new i,He=new i,We=new i,Ye=new i,Xe=new i,Ze=new i,Ke=new a,Qe=5*g.EPSILON9,Je=g.EPSILON6;return ie.splitLongitude=function(e){if(!c(e))throw new l("instance is required.");var t=e.geometry,r=t.boundingSphere;if(c(r)){if(r.center.x-r.radius>0||n.intersectPlane(r,w.ORIGIN_ZX_PLANE)!==y.INTERSECTING)return e}if(t.geometryType!==m.NONE)switch(t.geometryType){case m.POLYLINES:re(e);break;case m.TRIANGLES:$(e);break;case m.LINES:te(e)}else G(t),t.primitiveType===b.TRIANGLES?$(e):t.primitiveType===b.LINES&&te(e);return e},ie}),define("Core/OffsetGeometryInstanceAttribute",["./Check","./ComponentDatatype","./defaultValue","./defined","./defineProperties"],function(e,t,n,r,i){"use strict";function a(e,t,r){e=n(e,0),t=n(t,0),r=n(r,0),this.value=new Float32Array([e,t,r])}return i(a.prototype,{componentDatatype:{get:function(){return t.FLOAT}},componentsPerAttribute:{get:function(){return 3}},normalize:{get:function(){return!1}}}),a.fromCartesian3=function(t){return e.defined("offset",t),new a(t.x,t.y,t.z)},a.toValue=function(t,n){return e.defined("offset",t),r(n)||(n=new Float32Array([t.x,t.y,t.z])),n[0]=t.x,n[1]=t.y,n[2]=t.z,n},a}),define("Scene/PrimitivePipeline",["../Core/BoundingSphere","../Core/ComponentDatatype","../Core/defaultValue","../Core/defined","../Core/DeveloperError","../Core/Ellipsoid","../Core/FeatureDetection","../Core/GeographicProjection","../Core/Geometry","../Core/GeometryAttribute","../Core/GeometryAttributes","../Core/GeometryPipeline","../Core/IndexDatatype","../Core/Matrix4","../Core/OffsetGeometryInstanceAttribute","../Core/WebMercatorProjection"],function(e,t,n,r,i,a,o,s,u,c,l,f,d,h,p,m){"use strict";function _(e,t,n){var i,a=!n,o=e.length;if(!a&&o>1){var s=e[0].modelMatrix;for(i=1;i<o;++i)if(!h.equals(s,e[i].modelMatrix)){a=!0;break}}if(a)for(i=0;i<o;++i)r(e[i].geometry)&&f.transformToWorldCoordinates(e[i]);else h.multiplyTransformation(t,e[0].modelMatrix,t)}function y(e,n){var r=e.attributes,i=r.position,a=i.values.length/i.componentsPerAttribute;r.batchId=new c({componentDatatype:t.FLOAT,componentsPerAttribute:1,values:new Float32Array(a)});for(var o=r.batchId.values,s=0;s<a;++s)o[s]=n}function v(e){for(var t=e.length,n=0;n<t;++n){var i=e[n];r(i.geometry)?y(i.geometry,n):r(i.westHemisphereGeometry)&&r(i.eastHemisphereGeometry)&&(y(i.westHemisphereGeometry,n),y(i.eastHemisphereGeometry,n))}}function g(n){var a,o,s,u=n.instances,c=n.projection,l=n.elementIndexUintSupported,d=n.scene3DOnly,h=n.vertexCacheOptimize,p=n.compressVertices,m=n.modelMatrix,y=u.length;for(a=0;a<y;++a)if(r(u[a].geometry)){s=u[a].geometry.primitiveType;break}for(a=1;a<y;++a)if(r(u[a].geometry)&&u[a].geometry.primitiveType!==s)throw new i("All instance geometries must have the same primitiveType.");if(_(u,m,d),!d)for(a=0;a<y;++a)r(u[a].geometry)&&f.splitLongitude(u[a]);if(v(u),h)for(a=0;a<y;++a){var g=u[a];r(g.geometry)?(f.reorderForPostVertexCache(g.geometry),f.reorderForPreVertexCache(g.geometry)):r(g.westHemisphereGeometry)&&r(g.eastHemisphereGeometry)&&(f.reorderForPostVertexCache(g.westHemisphereGeometry),f.reorderForPreVertexCache(g.westHemisphereGeometry),f.reorderForPostVertexCache(g.eastHemisphereGeometry),f.reorderForPreVertexCache(g.eastHemisphereGeometry))}var E=f.combineInstances(u);for(y=E.length,a=0;a<y;++a){o=E[a];var T,w=o.attributes;if(d)for(T in w)w.hasOwnProperty(T)&&w[T].componentDatatype===t.DOUBLE&&f.encodeAttribute(o,T,T+"3DHigh",T+"3DLow");else for(T in w)if(w.hasOwnProperty(T)&&w[T].componentDatatype===t.DOUBLE){var b=T+"3D",S=T+"2D";f.projectTo2D(o,T,b,S,c),r(o.boundingSphere)&&"position"===T&&(o.boundingSphereCV=e.fromVertices(o.attributes.position2D.values)),f.encodeAttribute(o,b,b+"High",b+"Low"),f.encodeAttribute(o,S,S+"High",S+"Low")}p&&f.compressVertices(o)}if(!l){var C=[];for(y=E.length,a=0;a<y;++a)o=E[a],C=C.concat(f.fitToUnsignedShortIndices(o));E=C}return E}function E(e,t,n,i){var a,o,s,u=i.length-1;if(u>=0){var c=i[u];a=c.offset+c.count,s=c.index,o=n[s].indices.length}else a=0,s=0,o=n[s].indices.length;for(var l=e.length,f=0;f<l;++f){var d=e[f],h=d[t];if(r(h)){var p=h.indices.length;a+p>o&&(a=0,o=n[++s].indices.length),i.push({index:s,offset:a,count:p}),a+=p}}}function T(e,t){var n=[];return E(e,"geometry",t,n),E(e,"westHemisphereGeometry",t,n),E(e,"eastHemisphereGeometry",t,n),n}function w(e,t){var n=e.attributes;for(var i in n)if(n.hasOwnProperty(i)){var a=n[i];r(a)&&r(a.values)&&t.push(a.values.buffer)}r(e.indices)&&t.push(e.indices.buffer)}function b(e,t){for(var n=e.length,r=0;r<n;++r)w(e[r],t)}function S(t){for(var n=1,i=t.length,a=0;a<i;a++){var o=t[a];if(++n,r(o)){var s=o.attributes;n+=7+2*e.packedLength+(r(o.indices)?o.indices.length:0);for(var u in s)if(s.hasOwnProperty(u)&&r(s[u])){var c=s[u];n+=5+c.values.length}}}return n}function C(e,t){var n=e.length,i=new Float64Array(1+19*n),a=0;i[a++]=n;for(var o=0;o<n;o++){var s=e[o];if(h.pack(s.modelMatrix,i,a),a+=h.packedLength,r(s.attributes)&&r(s.attributes.offset)){var u=s.attributes.offset.value;i[a]=u[0],i[a+1]=u[1],i[a+2]=u[2]}a+=3}return t.push(i.buffer),i}function O(e){for(var t=e,n=new Array(t[0]),i=0,a=1;a<t.length;){var o,s=h.unpack(t,a);a+=h.packedLength,r(t[a])&&(o={offset:new p(t[a],t[a+1],t[a+2])}),a+=3,n[i++]={modelMatrix:s,attributes:o}}return n}function A(t){var n=t.length,i=1+(e.packedLength+1)*n,a=new Float32Array(i),o=0;a[o++]=n;for(var s=0;s<n;++s){var u=t[s];r(u)?(a[o++]=1,e.pack(t[s],a,o)):a[o++]=0,o+=e.packedLength}return a}function x(t){for(var n=new Array(t[0]),r=0,i=1;i<t.length;)1===t[i++]&&(n[r]=e.unpack(t,i)),++r,i+=e.packedLength;return n}if(!o.supportsTypedArrays())return{};var R={};return R.combineGeometry=function(t){var n,i,a,o,s=t.instances,u=s.length,c=!1;u>0&&(n=g(t),n.length>0&&(i=f.createAttributeLocations(n[0]),t.createPickOffsets&&(a=T(s,n))),r(s[0].attributes)&&r(s[0].attributes.offset)&&(o=new Array(u),c=!0));for(var l=new Array(u),d=new Array(u),h=0;h<u;++h){var p=s[h],m=p.geometry;r(m)&&(l[h]=m.boundingSphere,d[h]=m.boundingSphereCV,c&&(o[h]=p.geometry.offsetAttribute));var _=p.eastHemisphereGeometry,y=p.westHemisphereGeometry;r(_)&&r(y)&&(r(_.boundingSphere)&&r(y.boundingSphere)&&(l[h]=e.union(_.boundingSphere,y.boundingSphere)),r(_.boundingSphereCV)&&r(y.boundingSphereCV)&&(d[h]=e.union(_.boundingSphereCV,y.boundingSphereCV)))}return{geometries:n,modelMatrix:t.modelMatrix,attributeLocations:i,pickOffsets:a,offsetInstanceExtend:o,boundingSpheres:l,boundingSpheresCV:d}},R.packCreateGeometryResults=function(t,i){var a=new Float64Array(S(t)),o=[],s={},u=t.length,c=0;a[c++]=u;for(var l=0;l<u;l++){var f=t[l],d=r(f);if(a[c++]=d?1:0,d){a[c++]=f.primitiveType,a[c++]=f.geometryType,a[c++]=n(f.offsetAttribute,-1);var h=r(f.boundingSphere)?1:0;a[c++]=h,h&&e.pack(f.boundingSphere,a,c),c+=e.packedLength;var p=r(f.boundingSphereCV)?1:0;a[c++]=p,p&&e.pack(f.boundingSphereCV,a,c),c+=e.packedLength;var m=f.attributes,_=[];for(var y in m)m.hasOwnProperty(y)&&r(m[y])&&(_.push(y),r(s[y])||(s[y]=o.length,o.push(y)));a[c++]=_.length;for(var v=0;v<_.length;v++){var g=_[v],E=m[g];a[c++]=s[g],a[c++]=E.componentDatatype,a[c++]=E.componentsPerAttribute,a[c++]=E.normalize?1:0,a[c++]=E.values.length,a.set(E.values,c),c+=E.values.length}var T=r(f.indices)?f.indices.length:0;a[c++]=T,T>0&&(a.set(f.indices,c),c+=T)}}return i.push(a.buffer),{stringTable:o,packedData:a}},R.unpackCreateGeometryResults=function(n){for(var r,i=n.stringTable,a=n.packedData,o=new Array(a[0]),s=0,f=1;f<a.length;){if(1===a[f++]){var h=a[f++],p=a[f++],m=a[f++];-1===m&&(m=void 0);var _,y;1===a[f++]&&(_=e.unpack(a,f)),f+=e.packedLength;1===a[f++]&&(y=e.unpack(a,f)),f+=e.packedLength;var v,g,E,T=new l,w=a[f++];for(r=0;r<w;r++){var b=i[a[f++]],S=a[f++];E=a[f++];var C=0!==a[f++];v=a[f++],g=t.createTypedArray(S,v);for(var O=0;O<v;O++)g[O]=a[f++];T[b]=new c({componentDatatype:S,componentsPerAttribute:E,normalize:C,values:g})}var A;if((v=a[f++])>0){var x=g.length/E;for(A=d.createTypedArray(x,v),r=0;r<v;r++)A[r]=a[f++]}o[s++]=new u({primitiveType:h,geometryType:p,boundingSphere:_,boundingSphereCV:y,indices:A,attributes:T,offsetAttribute:m})}else o[s++]=void 0}return o},R.packCombineGeometryParameters=function(e,t){for(var n=e.createGeometryResults,r=n.length,i=0;i<r;i++)t.push(n[i].packedData.buffer);return{createGeometryResults:e.createGeometryResults,packedInstances:C(e.instances,t),ellipsoid:e.ellipsoid,isGeographic:e.projection instanceof s,elementIndexUintSupported:e.elementIndexUintSupported,scene3DOnly:e.scene3DOnly,vertexCacheOptimize:e.vertexCacheOptimize,compressVertices:e.compressVertices,modelMatrix:e.modelMatrix,createPickOffsets:e.createPickOffsets}},R.unpackCombineGeometryParameters=function(e){for(var t=O(e.packedInstances),n=e.createGeometryResults,r=n.length,i=0,o=0;o<r;o++)for(var u=R.unpackCreateGeometryResults(n[o]),c=u.length,l=0;l<c;l++){var f=u[l],d=t[i];d.geometry=f,++i}var p=a.clone(e.ellipsoid);return{instances:t,ellipsoid:p,projection:e.isGeographic?new s(p):new m(p),elementIndexUintSupported:e.elementIndexUintSupported,scene3DOnly:e.scene3DOnly,vertexCacheOptimize:e.vertexCacheOptimize,compressVertices:e.compressVertices,modelMatrix:h.clone(e.modelMatrix),createPickOffsets:e.createPickOffsets}},R.packCombineGeometryResults=function(e,t){r(e.geometries)&&b(e.geometries,t);var n=A(e.boundingSpheres),i=A(e.boundingSpheresCV);return t.push(n.buffer,i.buffer),{geometries:e.geometries,attributeLocations:e.attributeLocations,modelMatrix:e.modelMatrix,pickOffsets:e.pickOffsets,offsetInstanceExtend:e.offsetInstanceExtend,boundingSpheres:n,boundingSpheresCV:i}},R.unpackCombineGeometryResults=function(e){return{geometries:e.geometries,attributeLocations:e.attributeLocations,modelMatrix:e.modelMatrix,pickOffsets:e.pickOffsets,offsetInstanceExtend:e.offsetInstanceExtend,boundingSpheres:x(e.boundingSpheres),boundingSpheresCV:x(e.boundingSpheresCV)}},R}),define("Scene/PrimitiveState",["../Core/freezeObject"],function(e){"use strict";return e({READY:0,CREATING:1,CREATED:2,COMBINING:3,COMBINED:4,COMPLETE:5,FAILED:6})}),define("Scene/SceneMode",["../Core/freezeObject"],function(e){"use strict";var t={MORPHING:0,COLUMBUS_VIEW:1,SCENE2D:2,SCENE3D:3};return t.getMorphTime=function(e){if(e===t.SCENE3D)return 1;if(e!==t.MORPHING)return 0},e(t)}),define("Scene/ShadowMode",["../Core/freezeObject"],function(e){"use strict";var t={DISABLED:0,ENABLED:1,CAST_ONLY:2,RECEIVE_ONLY:3,NUMBER_OF_SHADOW_MODES:4};return t.castShadows=function(e){return e===t.ENABLED||e===t.CAST_ONLY},t.receiveShadows=function(e){return e===t.ENABLED||e===t.RECEIVE_ONLY},t.fromCastReceive=function(e,n){return e&&n?t.ENABLED:e?t.CAST_ONLY:n?t.RECEIVE_ONLY:t.DISABLED},e(t)}),define("Scene/Primitive",["../Core/BoundingSphere","../Core/Cartesian2","../Core/Cartesian3","../Core/Cartesian4","../Core/Cartographic","../Core/clone","../Core/Color","../Core/combine","../Core/ComponentDatatype","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/EncodedCartesian3","../Core/FeatureDetection","../Core/Geometry","../Core/GeometryAttribute","../Core/GeometryAttributes","../Core/GeometryOffsetAttribute","../Core/Intersect","../Core/isArray","../Core/Matrix4","../Core/Plane","../Core/RuntimeError","../Core/subdivideArray","../Core/TaskProcessor","../Renderer/BufferUsage","../Renderer/ContextLimits","../Renderer/DrawCommand","../Renderer/Pass","../Renderer/RenderState","../Renderer/ShaderProgram","../Renderer/ShaderSource","../Renderer/VertexArray","../ThirdParty/when","./BatchTable","./CullFace","./DepthFunction","./PrimitivePipeline","./PrimitiveState","./SceneMode","./ShadowMode"],function(e,t,n,r,i,a,o,s,u,c,l,f,d,h,p,m,_,y,v,g,E,T,w,b,S,C,O,A,x,R,I,D,P,N,M,z,F,L,B,U,q,G,V){"use strict";function j(e){if(e=c(e,c.EMPTY_OBJECT),this.geometryInstances=e.geometryInstances,this.appearance=e.appearance,this._appearance=void 0,this._material=void 0,this.depthFailAppearance=e.depthFailAppearance,this._depthFailAppearance=void 0,this._depthFailMaterial=void 0,this.modelMatrix=w.clone(c(e.modelMatrix,w.IDENTITY)),this._modelMatrix=new w,this.show=c(e.show,!0),this._vertexCacheOptimize=c(e.vertexCacheOptimize,!1),this._interleave=c(e.interleave,!1),this._releaseGeometryInstances=c(e.releaseGeometryInstances,!0),this._allowPicking=c(e.allowPicking,!0),this._asynchronous=c(e.asynchronous,!0),this._compressVertices=c(e.compressVertices,!0),this.cull=c(e.cull,!0),this.debugShowBoundingVolume=c(e.debugShowBoundingVolume,!1),this.rtcCenter=e.rtcCenter,l(this.rtcCenter)&&(!l(this.geometryInstances)||T(this.geometryInstances)&&1!==this.geometryInstances))throw new h("Relative-to-center rendering only supports one geometry instance.");this.shadows=c(e.shadows,V.DISABLED),this._translucent=void 0,this._state=q.READY,this._geometries=[],this._error=void 0,this._numberOfInstances=0,this._boundingSpheres=[],this._boundingSphereWC=[],this._boundingSphereCV=[],this._boundingSphere2D=[],this._boundingSphereMorph=[],this._perInstanceAttributeCache=[],this._instanceIds=[],this._lastPerInstanceAttributeIndex=0,this._va=[],this._attributeLocations=void 0,this._primitiveType=void 0,this._frontFaceRS=void 0,this._backFaceRS=void 0,this._sp=void 0,this._depthFailAppearance=void 0,this._spDepthFail=void 0,this._frontFaceDepthFailRS=void 0,this._backFaceDepthFailRS=void 0,this._pickIds=[],this._colorCommands=[],this._pickCommands=[],this._readOnlyInstanceAttributes=e._readOnlyInstanceAttributes,this._createBoundingVolumeFunction=e._createBoundingVolumeFunction,this._createRenderStatesFunction=e._createRenderStatesFunction,this._createShaderProgramFunction=e._createShaderProgramFunction,this._createCommandsFunction=e._createCommandsFunction,this._updateAndQueueCommandsFunction=e._updateAndQueueCommandsFunction,this._createPickOffsets=e._createPickOffsets,this._pickOffsets=void 0,this._createGeometryResults=void 0,this._ready=!1,this._readyPromise=z.defer(),this._batchTable=void 0,this._batchTableAttributeIndices=void 0,this._offsetInstanceExtend=void 0,this._batchTableOffsetAttribute2DIndex=void 0,this._batchTableOffsetsUpdated=!1,this._instanceBoundingSpheres=void 0,this._instanceBoundingSpheresCV=void 0,this._tempBoundingSpheres=void 0,this._recomputeBoundingSpheres=!1,this._batchTableBoundingSpheresUpdated=!1,this._batchTableBoundingSphereAttributeIndices=void 0}function k(e){var t,n=e.length,r=[],i=e[0].attributes;for(t in i)if(i.hasOwnProperty(t)&&l(i[t])){for(var a=i[t],o=!0,s=1;s<n;++s){var u=e[s].attributes[t];if(!l(u)||a.componentDatatype!==u.componentDatatype||a.componentsPerAttribute!==u.componentsPerAttribute||a.normalize!==u.normalize){o=!1;break}}o&&r.push(t)}return r}function H(e){var i=e.length;return 1===i?e[0]:2===i?t.unpack(e,0,Ee):3===i?n.unpack(e,0,Te):4===i?r.unpack(e,0,we):void 0}function W(e,t){var n=e.geometryInstances,r=T(n)?n:[n],i=r.length;if(0!==i){var a,s,f,d,h=k(r),p=h.length,m=[],_={},y={},v=r[0],g=v.attributes;for(s=0;s<p;++s)f=h[s],d=g[f],_[f]=s,m.push({functionName:"czm_batchTable_"+f,componentDatatype:d.componentDatatype,componentsPerAttribute:d.componentsPerAttribute,normalize:d.normalize});-1!==h.indexOf("distanceDisplayCondition")&&(m.push({functionName:"czm_batchTable_boundingSphereCenter3DHigh",componentDatatype:u.FLOAT,componentsPerAttribute:3},{functionName:"czm_batchTable_boundingSphereCenter3DLow",componentDatatype:u.FLOAT,componentsPerAttribute:3},{functionName:"czm_batchTable_boundingSphereCenter2DHigh",componentDatatype:u.FLOAT,componentsPerAttribute:3},{functionName:"czm_batchTable_boundingSphereCenter2DLow",componentDatatype:u.FLOAT,componentsPerAttribute:3},{functionName:"czm_batchTable_boundingSphereRadius",componentDatatype:u.FLOAT,componentsPerAttribute:1}),y.center3DHigh=m.length-5,y.center3DLow=m.length-4,y.center2DHigh=m.length-3,y.center2DLow=m.length-2,y.radius=m.length-1),-1!==h.indexOf("offset")&&(m.push({functionName:"czm_batchTable_offset2D",componentDatatype:u.FLOAT,componentsPerAttribute:3}),a=m.length-1),m.push({functionName:"czm_batchTable_pickColor",componentDatatype:u.UNSIGNED_BYTE,componentsPerAttribute:4,normalize:!0});var E=m.length,w=new F(t,m,i);for(s=0;s<i;++s){var b=r[s];g=b.attributes;for(var S=0;S<p;++S){f=h[S],d=g[f];var C=H(d.value),O=_[f];w.setBatchedAttribute(s,O,C)}var A={primitive:c(b.pickPrimitive,e)};l(b.id)&&(A.id=b.id);var x=t.createPickId(A);e._pickIds.push(x);var R=x.color,I=we;I.x=o.floatToByte(R.red),I.y=o.floatToByte(R.green),I.z=o.floatToByte(R.blue),I.w=o.floatToByte(R.alpha),w.setBatchedAttribute(s,E-1,I)}e._batchTable=w,e._batchTableAttributeIndices=_,
e._batchTableBoundingSphereAttributeIndices=y,e._batchTableOffsetAttribute2DIndex=a}}function Y(e){var t;return t=T(e.values)?e.values.slice(0):new e.values.constructor(e.values),new y({componentDatatype:e.componentDatatype,componentsPerAttribute:e.componentsPerAttribute,normalize:e.normalize,values:t})}function X(t){var n=t.attributes,r=new v;for(var i in n)n.hasOwnProperty(i)&&l(n[i])&&(r[i]=Y(n[i]));var a;if(l(t.indices)){var o=t.indices;a=T(o)?o.slice(0):new o.constructor(o)}return new _({attributes:r,indices:a,primitiveType:t.primitiveType,boundingSphere:e.clone(t.boundingSphere)})}function Z(e,t){return{geometry:t,attributes:e.attributes,modelMatrix:w.clone(e.modelMatrix),pickPrimitive:e.pickPrimitive,id:e.id}}function K(e){return N.replaceMain(e,"czm_non_pick_main")+"\nvarying vec4 v_pickColor; \nvoid main() \n{ \n    czm_non_pick_main(); \n    v_pickColor = czm_batchTable_pickColor(batchId); \n}"}function Q(e){return"varying vec4 v_pickColor;\n"+e}function J(e,t){if(!e.compressVertices)return t;var n=-1!==t.search(/attribute\s+vec3\s+normal;/g),r=-1!==t.search(/attribute\s+vec2\s+st;/g);if(!n&&!r)return t;var i=-1!==t.search(/attribute\s+vec3\s+tangent;/g),a=-1!==t.search(/attribute\s+vec3\s+bitangent;/g),o=r&&n?2:1;o+=i||a?1:0;var s=o>1?"vec"+o:"float",u="compressedAttributes",c="attribute "+s+" "+u+";",l="",f="";if(r){l+="vec2 st;\n";f+="    st = czm_decompressTextureCoordinates("+(o>1?u+".x":u)+");\n"}n&&i&&a?(l+="vec3 normal;\nvec3 tangent;\nvec3 bitangent;\n",f+="    czm_octDecode("+u+"."+(r?"yz":"xy")+", normal, tangent, bitangent);\n"):(n&&(l+="vec3 normal;\n",f+="    normal = czm_octDecode("+u+(o>1?"."+(r?"y":"x"):"")+");\n"),i&&(l+="vec3 tangent;\n",f+="    tangent = czm_octDecode("+u+"."+(r&&n?"z":"y")+");\n"),a&&(l+="vec3 bitangent;\n",f+="    bitangent = czm_octDecode("+u+"."+(r&&n?"z":"y")+");\n"));var d=t;return d=d.replace(/attribute\s+vec3\s+normal;/g,""),d=d.replace(/attribute\s+vec2\s+st;/g,""),d=d.replace(/attribute\s+vec3\s+tangent;/g,""),d=d.replace(/attribute\s+vec3\s+bitangent;/g,""),d=N.replaceMain(d,"czm_non_compressed_main"),[c,l,d,"void main() \n{ \n"+f+"    czm_non_compressed_main(); \n}"].join("\n")}function $(e){var t=N.replaceMain(e,"czm_non_depth_clamp_main");return t+="varying float v_WindowZ;\nvoid main() {\n    czm_non_depth_clamp_main();\n    vec4 position = gl_Position;\n    v_WindowZ = (0.5 * (position.z / position.w) + 0.5) * position.w;\n    position.z = min(position.z, position.w);\n    gl_Position = position;\n}\n"}function ee(e){var t=N.replaceMain(e,"czm_non_depth_clamp_main");return t+="varying float v_WindowZ;\nvoid main() {\n    czm_non_depth_clamp_main();\n#if defined(GL_EXT_frag_depth) && !defined(LOG_DEPTH)\n    gl_FragDepthEXT = min(v_WindowZ * gl_FragCoord.w, 1.0);\n#endif\n}\n",t="#ifdef GL_EXT_frag_depth\n#extension GL_EXT_frag_depth : enable\n#endif\n"+t}function te(e,t){var n=e.vertexAttributes;for(var r in n)if(n.hasOwnProperty(r)&&!l(t[r]))throw new h("Appearance/Geometry mismatch.  The appearance requires vertex shader attribute input '"+r+"', which was not computed as part of the Geometry.  Use the appearance's vertexFormat property when constructing the geometry.")}function ne(e,t){return function(){return e[t]}}function re(e,t){var n,r,i,a,o=e._instanceIds;if(e._state===q.READY){n=T(e.geometryInstances)?e.geometryInstances:[e.geometryInstances];var s=e._numberOfInstances=n.length,u=[],f=[];for(i=0;i<s;++i){if(r=n[i].geometry,o.push(n[i].id),!l(r._workerName))throw new h("_workerName must be defined for asynchronous geometry.");f.push({moduleName:r._workerName,geometry:r})}if(!l(Se))for(Se=new Array(Ce),i=0;i<Ce;i++)Se[i]=new O("createGeometry",Number.POSITIVE_INFINITY);var d;for(f=C(f,Ce),i=0;i<f.length;i++){var p=0,m=f[i],_=m.length;for(a=0;a<_;++a)d=m[a],r=d.geometry,l(r.constructor.pack)&&(d.offset=p,p+=c(r.constructor.packedLength,r.packedLength));var y;if(p>0){var v=new Float64Array(p);for(y=[v.buffer],a=0;a<_;++a)d=m[a],r=d.geometry,l(r.constructor.pack)&&(r.constructor.pack(r,v,d.offset),d.geometry=v)}u.push(Se[i].scheduleTask({subTasks:f[i]},y))}e._state=q.CREATING,z.all(u,function(t){e._createGeometryResults=t,e._state=q.CREATED}).otherwise(function(n){ge(e,t,q.FAILED,n)})}else if(e._state===q.CREATED){var g=[];n=T(e.geometryInstances)?e.geometryInstances:[e.geometryInstances];var E=t.scene3DOnly,b=t.mapProjection,S=Oe.scheduleTask(U.packCombineGeometryParameters({createGeometryResults:e._createGeometryResults,instances:n,ellipsoid:b.ellipsoid,projection:b,elementIndexUintSupported:t.context.elementIndexUint,scene3DOnly:E,vertexCacheOptimize:e.vertexCacheOptimize,compressVertices:e.compressVertices,modelMatrix:e.modelMatrix,createPickOffsets:e._createPickOffsets},g),g);e._createGeometryResults=void 0,e._state=q.COMBINING,z(S,function(n){var r=U.unpackCombineGeometryResults(n);e._geometries=r.geometries,e._attributeLocations=r.attributeLocations,e.modelMatrix=w.clone(r.modelMatrix,e.modelMatrix),e._pickOffsets=r.pickOffsets,e._offsetInstanceExtend=r.offsetInstanceExtend,e._instanceBoundingSpheres=r.boundingSpheres,e._instanceBoundingSpheresCV=r.boundingSpheresCV,l(e._geometries)&&e._geometries.length>0?(e._recomputeBoundingSpheres=!0,e._state=q.COMBINED):ge(e,t,q.FAILED,void 0)}).otherwise(function(n){ge(e,t,q.FAILED,n)})}}function ie(e,t){var n,r,i=T(e.geometryInstances)?e.geometryInstances:[e.geometryInstances],a=e._numberOfInstances=i.length,o=new Array(a),s=e._instanceIds,u=0;for(r=0;r<a;r++){n=i[r];var c,f=n.geometry;c=l(f.attributes)&&l(f.primitiveType)?X(f):f.constructor.createGeometry(f),o[u++]=Z(n,c),s.push(n.id)}o.length=u;var d=t.scene3DOnly,h=t.mapProjection,p=U.combineGeometry({instances:o,ellipsoid:h.ellipsoid,projection:h,elementIndexUintSupported:t.context.elementIndexUint,scene3DOnly:d,vertexCacheOptimize:e.vertexCacheOptimize,compressVertices:e.compressVertices,modelMatrix:e.modelMatrix,createPickOffsets:e._createPickOffsets});e._geometries=p.geometries,e._attributeLocations=p.attributeLocations,e.modelMatrix=w.clone(p.modelMatrix,e.modelMatrix),e._pickOffsets=p.pickOffsets,e._offsetInstanceExtend=p.offsetInstanceExtend,e._instanceBoundingSpheres=p.boundingSpheres,e._instanceBoundingSpheresCV=p.boundingSpheresCV,l(e._geometries)&&e._geometries.length>0?(e._recomputeBoundingSpheres=!0,e._state=q.COMBINED):ge(e,t,q.FAILED,void 0)}function ae(t,r){var i=t._batchTableAttributeIndices.offset;if(!t._recomputeBoundingSpheres||!l(i))return void(t._recomputeBoundingSpheres=!1);var a,o=t._offsetInstanceExtend,s=t._instanceBoundingSpheres,u=s.length,c=t._tempBoundingSpheres;if(!l(c)){for(c=new Array(u),a=0;a<u;a++)c[a]=new e;t._tempBoundingSpheres=c}for(a=0;a<u;++a){var f=c[a],d=t._batchTable.getBatchedAttribute(a,i,new n);f=s[a].clone(f),pe(f,d,o[a])}var h=[],p=[],m=[];for(a=0;a<u;++a){var _=c[a];_.center.x-_.radius>0||e.intersectPlane(_,b.ORIGIN_ZX_PLANE)!==E.INTERSECTING?h.push(_):(p.push(_),m.push(_))}var y=h[0],v=m[0],g=p[0];for(a=1;a<h.length;a++)y=e.union(y,h[a]);for(a=1;a<m.length;a++)v=e.union(v,m[a]);for(a=1;a<p.length;a++)g=e.union(g,p[a]);var T=[];for(l(y)&&T.push(y),l(v)&&T.push(v),l(g)&&T.push(g),a=0;a<T.length;a++){var w=T[a].clone(t._boundingSpheres[a]);t._boundingSpheres[a]=w,t._boundingSphereCV[a]=e.projectTo2D(w,r.mapProjection,t._boundingSphereCV[a])}j._updateBoundingVolumes(t,r,t.modelMatrix,!0),t._recomputeBoundingSpheres=!1}function oe(t,n){if(l(t._batchTableAttributeIndices.distanceDisplayCondition)&&!t._batchTableBoundingSpheresUpdated){for(var r=t._batchTableBoundingSphereAttributeIndices,i=r.center3DHigh,a=r.center3DLow,o=r.center2DHigh,s=r.center2DLow,u=r.radius,c=n.mapProjection,f=c.ellipsoid,d=t._batchTable,h=t._instanceBoundingSpheres,m=h.length,_=0;_<m;++_){var y=h[_];if(l(y)){var v=t.modelMatrix;l(v)&&(y=e.transform(y,v,Ie));var g=y.center,E=y.radius,T=p.fromCartesian(g,Ae);if(d.setBatchedAttribute(_,i,T.high),d.setBatchedAttribute(_,a,T.low),!n.scene3DOnly){var w=f.cartesianToCartographic(g,xe),b=c.project(w,Re);T=p.fromCartesian(b,Ae),d.setBatchedAttribute(_,o,T.high),d.setBatchedAttribute(_,s,T.low)}d.setBatchedAttribute(_,u,E)}}t._batchTableBoundingSpheresUpdated=!0}}function se(t,r){if(l(t._batchTableAttributeIndices.offset)&&!t._batchTableOffsetsUpdated&&!r.scene3DOnly){for(var i=t._batchTableOffsetAttribute2DIndex,a=r.mapProjection,o=a.ellipsoid,s=t._batchTable,u=t._instanceBoundingSpheres,c=u.length,f=0;f<c;++f){var d=u[f];if(l(d)){var h=s.getBatchedAttribute(f,t._batchTableAttributeIndices.offset);if(n.equals(h,n.ZERO))s.setBatchedAttribute(f,i,n.ZERO);else{var p=t.modelMatrix;l(p)&&(d=e.transform(d,p,Ie));var m=d.center;m=o.scaleToGeodeticSurface(m,Pe);var _=o.cartesianToCartographic(m,xe),y=a.project(_,Re),v=n.add(h,m,De);_=o.cartesianToCartographic(v,_);var g=a.project(_,De),E=n.subtract(g,y,De),T=E.x;E.x=E.z,E.z=E.y,E.y=T,s.setBatchedAttribute(f,i,E)}}}t._batchTableOffsetsUpdated=!0}}function ue(t,n){for(var r=t._attributeLocations,i=t._geometries,a=n.scene3DOnly,o=n.context,s=[],u=i.length,c=0;c<u;++c){var f=i[c];if(s.push(M.fromGeometry({context:o,geometry:f,attributeLocations:r,bufferUsage:A.STATIC_DRAW,interleave:t._interleave})),l(t._createBoundingVolumeFunction))t._createBoundingVolumeFunction(n,f);else if(t._boundingSpheres.push(e.clone(f.boundingSphere)),t._boundingSphereWC.push(new e),!a){var d=f.boundingSphereCV.center,h=d.x,p=d.y,m=d.z;d.x=m,d.y=h,d.z=p,t._boundingSphereCV.push(e.clone(f.boundingSphereCV)),t._boundingSphere2D.push(new e),t._boundingSphereMorph.push(new e)}}t._va=s,t._primitiveType=i[0].primitiveType,t.releaseGeometryInstances&&(t.geometryInstances=void 0),t._geometries=void 0,ge(t,n,q.COMPLETE,void 0)}function ce(e,t,n,r){var i,o=n.getRenderState();r?(i=a(o,!1),i.cull={enabled:!0,face:L.BACK},e._frontFaceRS=D.fromCache(i),i.cull.face=L.FRONT,e._backFaceRS=D.fromCache(i)):(e._frontFaceRS=D.fromCache(o),e._backFaceRS=e._frontFaceRS),i=a(o,!1),l(e._depthFailAppearance)&&(i.depthTest.enabled=!1),l(e._depthFailAppearance)&&(o=e._depthFailAppearance.getRenderState(),i=a(o,!1),i.depthTest.func=B.GREATER,r?(i.cull={enabled:!0,face:L.BACK},e._frontFaceDepthFailRS=D.fromCache(i),i.cull.face=L.FRONT,e._backFaceDepthFailRS=D.fromCache(i)):(e._frontFaceDepthFailRS=D.fromCache(i),e._backFaceDepthFailRS=e._frontFaceRS))}function le(e,t,n){var r=t.context,i=e._attributeLocations,a=e._batchTable.getVertexShaderCallback()(n.vertexShaderSource);a=j._appendOffsetToShader(e,a),a=j._appendShowToShader(e,a),a=j._appendDistanceDisplayConditionToShader(e,a,t.scene3DOnly),a=K(a),a=j._updateColorAttribute(e,a,!1),a=J(e,a),a=j._modifyShaderPosition(e,a,t.scene3DOnly);var o=n.getFragmentShaderSource();o=Q(o),e._sp=P.replaceCache({context:r,shaderProgram:e._sp,vertexShaderSource:a,fragmentShaderSource:o,attributeLocations:i}),te(e._sp,i),l(e._depthFailAppearance)&&(a=e._batchTable.getVertexShaderCallback()(e._depthFailAppearance.vertexShaderSource),a=j._appendShowToShader(e,a),a=j._appendDistanceDisplayConditionToShader(e,a,t.scene3DOnly),a=K(a),a=j._updateColorAttribute(e,a,!0),a=J(e,a),a=j._modifyShaderPosition(e,a,t.scene3DOnly),a=$(a),o=e._depthFailAppearance.getFragmentShaderSource(),o=Q(o),o=ee(o),e._spDepthFail=P.replaceCache({context:r,shaderProgram:e._spDepthFail,vertexShaderSource:a,fragmentShaderSource:o,attributeLocations:i}),te(e._spDepthFail,i))}function fe(e,t,n,r){var i=l(n)?n._uniforms:void 0,a={},o=t.uniforms;if(l(o))for(var u in o)if(o.hasOwnProperty(u)){if(l(i)&&l(i[u]))throw new h("Appearance and material have a uniform with the same name: "+u);a[u]=ne(o,u)}var c=s(a,i);return c=e._batchTable.getUniformMapCallback()(c),l(e.rtcCenter)&&(c.u_modifiedModelView=function(){var t=r.context.uniformState.view;return w.multiply(t,e._modelMatrix,Ne),w.multiplyByPoint(Ne,e.rtcCenter,Me),w.setTranslation(Ne,Me,Ne),Ne}),c}function de(e,t,n,r,i,a,o,s){var u,c=fe(e,t,n,s);l(e._depthFailAppearance)&&(u=fe(e,e._depthFailAppearance,e._depthFailAppearance.material,s));var f=r?I.TRANSLUCENT:I.OPAQUE,d=i?2:1;d*=l(e._depthFailAppearance)?2:1,a.length=e._va.length*d;for(var h=a.length,p=0,m=0;m<h;++m){var _;i&&(_=a[m],l(_)||(_=a[m]=new R({owner:e,primitiveType:e._primitiveType})),_.vertexArray=e._va[p],_.renderState=e._backFaceRS,_.shaderProgram=e._sp,_.uniformMap=c,_.pass=f,++m),_=a[m],l(_)||(_=a[m]=new R({owner:e,primitiveType:e._primitiveType})),_.vertexArray=e._va[p],_.renderState=e._frontFaceRS,_.shaderProgram=e._sp,_.uniformMap=c,_.pass=f,l(e._depthFailAppearance)&&(i&&(++m,_=a[m],l(_)||(_=a[m]=new R({owner:e,primitiveType:e._primitiveType})),_.vertexArray=e._va[p],_.renderState=e._backFaceDepthFailRS,_.shaderProgram=e._spDepthFail,_.uniformMap=u,_.pass=f),++m,_=a[m],l(_)||(_=a[m]=new R({owner:e,primitiveType:e._primitiveType})),_.vertexArray=e._va[p],_.renderState=e._frontFaceDepthFailRS,_.shaderProgram=e._spDepthFail,_.uniformMap=u,_.pass=f),++p}}function he(e,t,n,r,i,a,o,s){if(t.mode!==G.SCENE3D&&!w.equals(i,w.IDENTITY))throw new h("Primitive.modelMatrix is only supported in 3D mode.");j._updateBoundingVolumes(e,t,i);var u;t.mode===G.SCENE3D?u=e._boundingSphereWC:t.mode===G.COLUMBUS_VIEW?u=e._boundingSphereCV:t.mode===G.SCENE2D&&l(e._boundingSphere2D)?u=e._boundingSphere2D:l(e._boundingSphereMorph)&&(u=e._boundingSphereMorph);var c=t.commandList,f=t.passes;if(f.render||f.pick){var d=e.allowPicking,p=V.castShadows(e.shadows),m=V.receiveShadows(e.shadows),_=n.length,y=s?2:1;y*=l(e._depthFailAppearance)?2:1;for(var v=0;v<_;++v){var g=Math.floor(v/y),E=n[v];E.modelMatrix=i,E.boundingVolume=u[g],E.cull=a,E.debugShowBoundingVolume=o,E.castShadows=p,E.receiveShadows=m,E.pickId=d?"v_pickColor":void 0,c.push(E)}}}function pe(t,r,i){if(i===g.TOP){var a=e.clone(t,ze),o=e.clone(t,Fe);o.center=n.add(o.center,r,o.center),t=e.union(a,o,t)}else i===g.ALL&&(t.center=n.add(t.center,r,t.center));return t}function me(e,t,n){return function(){var r=e.getBatchedAttribute(t,n),i=e.attributes[n],a=i.componentsPerAttribute,o=u.createTypedArray(i.componentDatatype,a);return l(r.constructor.pack)?r.constructor.pack(r,o,0):o[0]=r,o}}function _e(e,t,n,r,i){return function(a){if(!l(a)||!l(a.length)||a.length<1||a.length>4)throw new h("value must be and array with length between 1 and 4.");var o=H(a);e.setBatchedAttribute(t,n,o),"offset"===i&&(r._recomputeBoundingSpheres=!0,r._batchTableOffsetsUpdated=!1)}}function ye(t,r,i){r.boundingSphere={get:function(){var a=t._instanceBoundingSpheres[i];if(l(a)){a=a.clone();var o=t.modelMatrix,s=r.offset;l(s)&&pe(a,n.fromArray(s.get(),0,Le),t._offsetInstanceExtend[i]),l(o)&&(a=e.transform(a,o))}return a}},r.boundingSphereCV={get:function(){return t._instanceBoundingSpheresCV[i]}}}function ve(e,t,n){t.pickId={get:function(){return e._pickIds[n]}}}function ge(e,t,n,r){e._error=r,e._state=n,t.afterRender.push(function(){e._ready=e._state===q.COMPLETE||e._state===q.FAILED,l(r)?e._readyPromise.reject(r):e._readyPromise.resolve(e)})}f(j.prototype,{vertexCacheOptimize:{get:function(){return this._vertexCacheOptimize}},interleave:{get:function(){return this._interleave}},releaseGeometryInstances:{get:function(){return this._releaseGeometryInstances}},allowPicking:{get:function(){return this._allowPicking}},asynchronous:{get:function(){return this._asynchronous}},compressVertices:{get:function(){return this._compressVertices}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise.promise}}});var Ee=new t,Te=new n,we=new r,be=/attribute\s+vec(?:3|4)\s+(.*)3DHigh;/g;j._modifyShaderPosition=function(e,t,n){for(var r,i="",a="",o="";null!==(r=be.exec(t));){var s=r[1],u="vec4 czm_compute"+s[0].toUpperCase()+s.substr(1)+"()";"vec4 czm_computePosition()"!==u&&(i+=u+";\n"),l(e.rtcCenter)?(t=t.replace(/attribute\s+vec(?:3|4)\s+position3DHigh;/g,""),t=t.replace(/attribute\s+vec(?:3|4)\s+position3DLow;/g,""),i+="uniform mat4 u_modifiedModelView;\n",a+="attribute vec4 position;\n",o+=u+"\n{\n    return u_modifiedModelView * position;\n}\n\n",t=t.replace(/czm_modelViewRelativeToEye\s+\*\s+/g,""),t=t.replace(/czm_modelViewProjectionRelativeToEye/g,"czm_projection")):n?o+=u+"\n{\n    return czm_translateRelativeToEye("+s+"3DHigh, "+s+"3DLow);\n}\n\n":(a+="attribute vec3 "+s+"2DHigh;\nattribute vec3 "+s+"2DLow;\n",o+=u+"\n{\n    vec4 p;\n    if (czm_morphTime == 1.0)\n    {\n        p = czm_translateRelativeToEye("+s+"3DHigh, "+s+"3DLow);\n    }\n    else if (czm_morphTime == 0.0)\n    {\n        p = czm_translateRelativeToEye("+s+"2DHigh.zxy, "+s+"2DLow.zxy);\n    }\n    else\n    {\n        p = czm_columbusViewMorph(\n                czm_translateRelativeToEye("+s+"2DHigh.zxy, "+s+"2DLow.zxy),\n                czm_translateRelativeToEye("+s+"3DHigh, "+s+"3DLow),\n                czm_morphTime);\n    }\n    return p;\n}\n\n")}return[i,a,t,o].join("\n")},j._appendShowToShader=function(e,t){if(!l(e._batchTableAttributeIndices.show))return t;return N.replaceMain(t,"czm_non_show_main")+"\nvoid main() \n{ \n    czm_non_show_main(); \n    gl_Position *= czm_batchTable_show(batchId); \n}"},j._updateColorAttribute=function(e,t,n){if(!l(e._batchTableAttributeIndices.color)&&!l(e._batchTableAttributeIndices.depthFailColor))return t;if(-1===t.search(/attribute\s+vec4\s+color;/g))return t;if(n&&!l(e._batchTableAttributeIndices.depthFailColor))throw new h("A depthFailColor per-instance attribute is required when using a depth fail appearance that uses a color attribute.");var r=t;return r=r.replace(/attribute\s+vec4\s+color;/g,""),r=n?r.replace(/(\b)color(\b)/g,"$1czm_batchTable_depthFailColor(batchId)$2"):r.replace(/(\b)color(\b)/g,"$1czm_batchTable_color(batchId)$2")},j._updatePickColorAttribute=function(e){var t=e.replace(/attribute\s+vec4\s+pickColor;/g,"");return t=t.replace(/(\b)pickColor(\b)/g,"$1czm_batchTable_pickColor(batchId)$2")},j._appendOffsetToShader=function(e,t){if(!l(e._batchTableAttributeIndices.offset))return t;var n="attribute float batchId;\n";n+="attribute float applyOffset;";var r=t.replace(/attribute\s+float\s+batchId;/g,n),i="vec4 $1 = czm_computePosition();\n";return i+="    if (czm_sceneMode == czm_sceneMode3D)\n",i+="    {\n",i+="        $1 = $1 + vec4(czm_batchTable_offset(batchId) * applyOffset, 0.0);",i+="    }\n",i+="    else\n",i+="    {\n",i+="        $1 = $1 + vec4(czm_batchTable_offset2D(batchId) * applyOffset, 0.0);",i+="    }\n",r=r.replace(/vec4\s+([A-Za-z0-9_]+)\s+=\s+czm_computePosition\(\);/g,i)},j._appendDistanceDisplayConditionToShader=function(e,t,n){if(!l(e._batchTableAttributeIndices.distanceDisplayCondition))return t;var r=N.replaceMain(t,"czm_non_distanceDisplayCondition_main"),i="void main() \n{ \n    czm_non_distanceDisplayCondition_main(); \n    vec2 distanceDisplayCondition = czm_batchTable_distanceDisplayCondition(batchId);\n    vec3 boundingSphereCenter3DHigh = czm_batchTable_boundingSphereCenter3DHigh(batchId);\n    vec3 boundingSphereCenter3DLow = czm_batchTable_boundingSphereCenter3DLow(batchId);\n    float boundingSphereRadius = czm_batchTable_boundingSphereRadius(batchId);\n";return i+=n?"    vec4 centerRTE = czm_translateRelativeToEye(boundingSphereCenter3DHigh, boundingSphereCenter3DLow);\n":"    vec3 boundingSphereCenter2DHigh = czm_batchTable_boundingSphereCenter2DHigh(batchId);\n    vec3 boundingSphereCenter2DLow = czm_batchTable_boundingSphereCenter2DLow(batchId);\n    vec4 centerRTE;\n    if (czm_morphTime == 1.0)\n    {\n        centerRTE = czm_translateRelativeToEye(boundingSphereCenter3DHigh, boundingSphereCenter3DLow);\n    }\n    else if (czm_morphTime == 0.0)\n    {\n        centerRTE = czm_translateRelativeToEye(boundingSphereCenter2DHigh.zxy, boundingSphereCenter2DLow.zxy);\n    }\n    else\n    {\n        centerRTE = czm_columbusViewMorph(\n                czm_translateRelativeToEye(boundingSphereCenter2DHigh.zxy, boundingSphereCenter2DLow.zxy),\n                czm_translateRelativeToEye(boundingSphereCenter3DHigh, boundingSphereCenter3DLow),\n                czm_morphTime);\n    }\n",i+="    float radiusSq = boundingSphereRadius * boundingSphereRadius; \n    float distanceSq; \n    if (czm_sceneMode == czm_sceneMode2D) \n    { \n        distanceSq = czm_eyeHeight2D.y - radiusSq; \n    } \n    else \n    { \n        distanceSq = dot(centerRTE.xyz, centerRTE.xyz) - radiusSq; \n    } \n    distanceSq = max(distanceSq, 0.0); \n    float nearSq = distanceDisplayCondition.x * distanceDisplayCondition.x; \n    float farSq = distanceDisplayCondition.y * distanceDisplayCondition.y; \n    float show = (distanceSq >= nearSq && distanceSq <= farSq) ? 1.0 : 0.0; \n    gl_Position *= show; \n}",r+"\n"+i};var Se,Ce=Math.max(m.hardwareConcurrency-1,1),Oe=new O("combineGeometry",Number.POSITIVE_INFINITY),Ae=new p,xe=new i,Re=new n,Ie=new e,De=new n,Pe=new n,Ne=new w,Me=new n;j._updateBoundingVolumes=function(t,n,r,i){var a,o,s;if(i||!w.equals(r,t._modelMatrix))for(w.clone(r,t._modelMatrix),o=t._boundingSpheres.length,a=0;a<o;++a)s=t._boundingSpheres[a],l(s)&&(t._boundingSphereWC[a]=e.transform(s,r,t._boundingSphereWC[a]),n.scene3DOnly||(t._boundingSphere2D[a]=e.clone(t._boundingSphereCV[a],t._boundingSphere2D[a]),t._boundingSphere2D[a].center.x=0,t._boundingSphereMorph[a]=e.union(t._boundingSphereWC[a],t._boundingSphereCV[a])));var u=t.appearance.pixelSize;if(l(u))for(o=t._boundingSpheres.length,a=0;a<o;++a){s=t._boundingSpheres[a];var c=t._boundingSphereWC[a],f=n.camera.getPixelSize(s,n.context.drawingBufferWidth,n.context.drawingBufferHeight),d=f*u;c.radius=s.radius+d}},j.prototype.update=function(e){if(!(!l(this.geometryInstances)&&0===this._va.length||l(this.geometryInstances)&&T(this.geometryInstances)&&0===this.geometryInstances.length||!l(this.appearance)||e.mode!==G.SCENE3D&&e.scene3DOnly||!e.passes.render&&!e.passes.pick)){if(l(this._error))throw this._error;if(l(this.rtcCenter)&&!e.scene3DOnly)throw new h("RTC rendering is only available for 3D only scenes.");if(this._state!==q.FAILED){var t=e.context;if(l(this._batchTable)||W(this,t),this._batchTable.attributes.length>0){if(0===x.maximumVertexTextureImageUnits)throw new S("Vertex texture fetch support is required to render primitives with per-instance attributes. The maximum number of vertex texture image units must be greater than zero.");this._batchTable.update(e)}if(this._state!==q.COMPLETE&&this._state!==q.COMBINED&&(this.asynchronous?re(this,e):ie(this,e)),this._state===q.COMBINED&&(oe(this,e),se(this,e),ue(this,e)),this.show&&this._state===q.COMPLETE){this._batchTableOffsetsUpdated||se(this,e),this._recomputeBoundingSpheres&&ae(this,e);var n=this.appearance,r=n.material,i=!1,a=!1;this._appearance!==n?(this._appearance=n,this._material=r,i=!0,a=!0):this._material!==r&&(this._material=r,a=!0);var o=this.depthFailAppearance,s=l(o)?o.material:void 0;this._depthFailAppearance!==o?(this._depthFailAppearance=o,this._depthFailMaterial=s,i=!0,a=!0):this._depthFailMaterial!==s&&(this._depthFailMaterial=s,a=!0);var u=this._appearance.isTranslucent();this._translucent!==u&&(this._translucent=u,i=!0),l(this._material)&&this._material.update(t);var f=n.closed&&u;if(i){c(this._createRenderStatesFunction,ce)(this,t,n,f)}if(a){c(this._createShaderProgramFunction,le)(this,e,n)}if(i||a){c(this._createCommandsFunction,de)(this,n,r,u,f,this._colorCommands,this._pickCommands,e)}c(this._updateAndQueueCommandsFunction,he)(this,e,this._colorCommands,this._pickCommands,this.modelMatrix,this.cull,this.debugShowBoundingVolume,f)}}}};var ze=new e,Fe=new e,Le=new n;return j.prototype.getGeometryInstanceAttributes=function(e){if(!l(e))throw new h("id is required");if(!l(this._batchTable))throw new h("must call update before calling getGeometryInstanceAttributes");for(var t=-1,n=this._lastPerInstanceAttributeIndex,r=this._instanceIds,i=r.length,a=0;a<i;++a){var o=(n+a)%i;if(e===r[o]){t=o;break}}if(-1!==t){var s=this._perInstanceAttributeCache[t];if(l(s))return s;var u=this._batchTable,c=this._batchTableAttributeIndices;s={};var d={};for(var p in c)if(c.hasOwnProperty(p)){var m=c[p];d[p]={get:me(u,t,m)};var _=!0,y=this._readOnlyInstanceAttributes;if(_&&l(y)){i=y.length;for(var v=0;v<i;++v)if(p===y[v]){_=!1;break}}_&&(d[p].set=_e(u,t,m,this,p))}return ye(this,d,t),ve(this,d,t),f(s,d),this._lastPerInstanceAttributeIndex=t,this._perInstanceAttributeCache[t]=s,s}},j.prototype.isDestroyed=function(){return!1},j.prototype.destroy=function(){var e,t;this._sp=this._sp&&this._sp.destroy(),this._pickSP=this._pickSP&&this._pickSP.destroy();var n=this._va;for(e=n.length,t=0;t<e;++t)n[t].destroy();this._va=void 0;var r=this._pickIds;for(e=r.length,t=0;t<e;++t)r[t].destroy();return this._pickIds=void 0,this._batchTable=this._batchTable&&this._batchTable.destroy(),this._instanceIds=void 0,this._perInstanceAttributeCache=void 0,this._attributeLocations=void 0,d(this)},j}),define("Scene/GroundPolylinePrimitive",["../Core/ApproximateTerrainHeights","../Core/ComponentDatatype","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/GeometryInstance","../Core/GeometryInstanceAttribute","../Core/GroundPolylineGeometry","../Core/isArray","../Shaders/PolylineShadowVolumeVS","../Shaders/PolylineShadowVolumeFS","../Shaders/PolylineShadowVolumeMorphVS","../Shaders/PolylineShadowVolumeMorphFS","../Renderer/DrawCommand","../Renderer/Pass","../Renderer/RenderState","../Renderer/ShaderProgram","../Renderer/ShaderSource","../ThirdParty/when","./BlendingState","./CullFace","./PolylineColorAppearance","./PolylineMaterialAppearance","./Primitive","./SceneMode"],function(e,t,n,r,i,a,o,s,u,c,l,f,d,h,p,m,_,y,v,g,E,T,w,b,S,C,O){"use strict";function A(e){e=n(e,n.EMPTY_OBJECT),this.geometryInstances=e.geometryInstances,this._hasPerInstanceColors=!0;var t=e.appearance;r(t)||(t=new S),this.appearance=t,this.show=n(e.show,!0),this.debugShowBoundingVolume=n(e.debugShowBoundingVolume,!1),this._debugShowShadowVolume=n(e.debugShowShadowVolume,!1),this._primitiveOptions={geometryInstances:void 0,appearance:void 0,vertexCacheOptimize:!1,interleave:n(e.interleave,!1),releaseGeometryInstances:n(e.releaseGeometryInstances,!0),allowPicking:n(e.allowPicking,!0),asynchronous:n(e.asynchronous,!0),compressVertices:!1,_createShaderProgramFunction:void 0,_createCommandsFunction:void 0,_updateAndQueueCommandsFunction:void 0},this._zIndex=void 0,this._ready=!1,this._readyPromise=E.defer(),this._primitive=void 0,this._sp=void 0,this._sp2D=void 0,this._spMorph=void 0,this._renderState=y.fromCache({cull:{enabled:!0},blending:T.ALPHA_BLEND,depthMask:!1}),this._renderStateMorph=y.fromCache({cull:{enabled:!0,face:w.FRONT},depthTest:{enabled:!0},blending:T.ALPHA_BLEND,depthMask:!1})}function x(t,n,i){var a=n.context,o=t._primitive,s=o._attributeLocations,u=o._batchTable.getVertexShaderCallback()(f);u=C._appendShowToShader(o,u),u=C._appendDistanceDisplayConditionToShader(o,u),u=C._modifyShaderPosition(t,u,n.scene3DOnly);var c=o._batchTable.getVertexShaderCallback()(h);c=C._appendShowToShader(o,c),c=C._appendDistanceDisplayConditionToShader(o,c),c=C._modifyShaderPosition(t,c,n.scene3DOnly);var l=o._batchTable.getVertexShaderCallback()(d),m=["ENABLE_GL_POSITION_LOG_DEPTH_AT_HEIGHT","GLOBE_MINIMUM_ALTITUDE "+n.mapProjection.ellipsoid.minimumRadius.toFixed(1)],_="",y="";r(i.material)?(y=r(i.material)?i.material.shaderSource:"",-1!==y.search(/varying\s+float\s+v_polylineAngle;/g)&&m.push("ANGLE_VARYING"),-1!==y.search(/varying\s+float\s+v_width;/g)&&m.push("WIDTH_VARYING")):_="PER_INSTANCE_COLOR",m.push(_);var E=t.debugShowShadowVolume?["DEBUG_SHOW_VOLUME",_]:[_],T=new g({defines:m,sources:[u]}),w=new g({defines:E,sources:[y,l]});t._sp=v.replaceCache({context:a,shaderProgram:o._sp,vertexShaderSource:T,fragmentShaderSource:w,attributeLocations:s});var b=a.shaderCache.getDerivedShaderProgram(t._sp,"2dColor");if(!r(b)){var S=new g({defines:m.concat(["COLUMBUS_VIEW_2D"]),sources:[u]});b=a.shaderCache.createDerivedShaderProgram(t._sp,"2dColor",{context:a,shaderProgram:t._sp2D,vertexShaderSource:S,fragmentShaderSource:w,attributeLocations:s})}t._sp2D=b;var O=a.shaderCache.getDerivedShaderProgram(t._sp,"MorphColor");if(!r(O)){var A=new g({defines:m.concat(["MAX_TERRAIN_HEIGHT "+e._defaultMaxTerrainHeight.toFixed(1)]),sources:[c]});l=o._batchTable.getVertexShaderCallback()(p);var x=new g({defines:E,sources:[y,l]});O=a.shaderCache.createDerivedShaderProgram(t._sp,"MorphColor",{context:a,shaderProgram:t._spMorph,vertexShaderSource:A,fragmentShaderSource:x,attributeLocations:s})}t._spMorph=O}function R(e,t,n,i,a,o){var s=e._primitive,u=s._va.length;a.length=u,o.length=u;var c,l,f=t instanceof b,d=f?{}:n._uniforms,h=s._batchTable.getUniformMapCallback()(d),p=_.TERRAIN_CLASSIFICATION;for(c=0;c<u;c++){var y=s._va[c];l=a[c],r(l)||(l=a[c]=new m({owner:e,primitiveType:s._primitiveType})),l.vertexArray=y,l.renderState=e._renderState,l.shaderProgram=e._sp,l.uniformMap=h,l.pass=p,l.pickId="czm_batchTable_pickColor(v_endPlaneNormalEcAndBatchId.w)";var v=l.derivedCommands.color2D;r(v)||(v=m.shallowClone(l),l.derivedCommands.color2D=v),v.vertexArray=y,v.renderState=e._renderState,v.shaderProgram=e._sp2D,v.uniformMap=h,v.pass=p,v.pickId="czm_batchTable_pickColor(v_endPlaneNormalEcAndBatchId.w)",v=l.derivedCommands.colorMorph,r(v)||(v=m.shallowClone(l),l.derivedCommands.colorMorph=v),v.vertexArray=y,v.renderState=e._renderStateMorph,v.shaderProgram=e._spMorph,v.uniformMap=h,v.pass=p,v.pickId="czm_batchTable_pickColor(v_batchId)"}}function I(e,t,n,i,a,o,s){var u=e._primitive;C._updateBoundingVolumes(u,t,a);var c;t.mode===O.SCENE3D?c=u._boundingSphereWC:t.mode===O.COLUMBUS_VIEW?c=u._boundingSphereCV:t.mode===O.SCENE2D&&r(u._boundingSphere2D)?c=u._boundingSphere2D:r(u._boundingSphereMorph)&&(c=u._boundingSphereMorph);var l=t.commandList,f=t.passes;if(f.render||f.pick&&u.allowPicking)for(var d=n.length,h=0;h<d;++h){var p=n[h];t.mode===O.MORPHING&&p.shaderProgram!==e._spMorph?p=p.derivedCommands.colorMorph:t.mode!==O.SCENE3D&&p.shaderProgram!==e._sp2D&&(p=p.derivedCommands.color2D),p.modelMatrix=a,p.boundingVolume=c[h],p.cull=o,p.debugShowBoundingVolume=s,l.push(p)}}return i(A.prototype,{interleave:{get:function(){return this._primitiveOptions.interleave}},releaseGeometryInstances:{get:function(){return this._primitiveOptions.releaseGeometryInstances}},allowPicking:{get:function(){return this._primitiveOptions.allowPicking}},asynchronous:{get:function(){return this._primitiveOptions.asynchronous}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise.promise}},debugShowShadowVolume:{get:function(){return this._debugShowShadowVolume}}}),A._initialized=!1,A._initPromise=void 0,A.initializeTerrainHeights=function(){var t=A._initPromise;return r(t)?t:(A._initPromise=e.initialize().then(function(){A._initialized=!0}),A._initPromise)},A.prototype.update=function(e){if(r(this._primitive)||r(this.geometryInstances)){if(!A._initialized){if(!this.asynchronous)throw new o("For synchronous GroundPolylinePrimitives, you must call GroundPolylinePrimitives.initializeTerrainHeights() and wait for the returned promise to resolve.");return void A.initializeTerrainHeights()}var n,i=this,a=this._primitiveOptions;if(!r(this._primitive)){var f,d=l(this.geometryInstances)?this.geometryInstances:[this.geometryInstances],h=d.length,p=new Array(h);for(n=0;n<h;++n)if(f=d[n].attributes,!r(f)||!r(f.color)){this._hasPerInstanceColors=!1;break}for(n=0;n<h;++n){var m=d[n];f={};var _=m.attributes;for(var y in _)_.hasOwnProperty(y)&&(f[y]=_[y]);r(f.width)||(f.width=new u({componentDatatype:t.UNSIGNED_BYTE,componentsPerAttribute:1,value:[m.geometry.width]})),m.geometry._scene3DOnly=e.scene3DOnly,c.setProjectionAndEllipsoid(m.geometry,e.mapProjection),p[n]=new s({geometry:m.geometry,attributes:f,id:m.id})}a.geometryInstances=p,a.appearance=this.appearance,a._createShaderProgramFunction=function(e,t,n){x(i,t,n)},a._createCommandsFunction=function(e,t,n,r,a,o,s){R(i,t,n,r,o,s)},a._updateAndQueueCommandsFunction=function(e,t,n,r,a,o,s,u){I(i,t,n,r,a,o,s)},this._primitive=new C(a),this._primitive.readyPromise.then(function(e){i._ready=!0,
i.releaseGeometryInstances&&(i.geometryInstances=void 0);var t=e._error;r(t)?i._readyPromise.reject(t):i._readyPromise.resolve(i)})}if(this.appearance instanceof b&&!this._hasPerInstanceColors)throw new o("All GeometryInstances must have color attributes to use PolylineColorAppearance with GroundPolylinePrimitive.");this._primitive.appearance=this.appearance,this._primitive.show=this.show,this._primitive.debugShowBoundingVolume=this.debugShowBoundingVolume,this._primitive.update(e)}},A.prototype.getGeometryInstanceAttributes=function(e){if(!r(this._primitive))throw new o("must call update before calling getGeometryInstanceAttributes");return this._primitive.getGeometryInstanceAttributes(e)},A.isSupported=function(e){return e.frameState.context.depthTexture},A.prototype.isDestroyed=function(){return!1},A.prototype.destroy=function(){return this._primitive=this._primitive&&this._primitive.destroy(),this._sp=this._sp&&this._sp.destroy(),this._sp2D=void 0,this._spMorph=void 0,a(this)},A}),define("Workers/createGroundPolylineGeometry",["../Core/defined","../Core/GroundPolylineGeometry","../Scene/GroundPolylinePrimitive"],function(e,t,n){"use strict";function r(r,i){return n.initializeTerrainHeights().then(function(){return e(i)&&(r=t.unpack(r,i)),t.createGeometry(r)})}return r})}();